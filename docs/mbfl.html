<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This document describes version 2.2.0 of MBFL, a
library of functions for the GNU Bash shell.  The package is
distributed under the terms of the GNU Lesser General Public License
(LGPL); the home page is at:

https://marcomaggi.github.com/mbfl.html

development takes place at:

https://github.com/marcomaggi/mbfl/

and as backup at:

https://bitbucket.org/marcomaggi/mbfl

proper release tarballs for this package are in the download area at:

https://bitbucket.org/marcomaggi/mbfl/downloads/

Copyright (C) 2003-2005, 2009-2010, 2012-2015, 2017 by Marco Maggi marco.maggi-ipsu@poste.it

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with
Invariant Sections being "GNU Free Documentation License" and
"GNU Lesser General Public License", no Front-Cover Texts, and no
Back-Cover Texts.  A copy of the license is included in the section
entitled "GNU Free Documentation License". -->
<!-- Created by GNU Texinfo 6.4, http://www.gnu.org/software/texinfo/ -->
<head>
<title>Marco&rsquo;s Bash Functions Library</title>

<meta name="description" content="Marco&rsquo;s Bash Functions Library">
<meta name="keywords" content="Marco&rsquo;s Bash Functions Library">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="#Top" rel="start" title="Top">
<link href="#concept-index" rel="index" title="concept index">
<link href="#SEC_Contents" rel="contents" title="Table of Contents">
<link href="dir.html#Top" rel="up" title="(dir)">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<h1 class="settitle" align="center">Marco&rsquo;s Bash Functions Library</h1>














































































































































































































<a name="Top"></a>
<div class="header">
<p>
Next: <a href="#overview" accesskey="n" rel="next">overview</a>, Up: <a href="dir.html#Top" accesskey="u" rel="up">(dir)</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Marco_0027s-Bash-Functions-Library"></a>
<h1 class="top">Marco&rsquo;s Bash Functions Library</h1>

<p>This document describes version 2.2.0 of <acronym>MBFL</acronym>, a
library of functions for the <acronym>GNU</acronym> Bash shell.  The package is
distributed under the terms of the <acronym>GNU</acronym> Lesser General Public License
(<acronym>LGPL</acronym>); the home page is at:
</p>
<div align="center"><a href="https://marcomaggi.github.com/mbfl.html">https://marcomaggi.github.com/mbfl.html</a>
</div>
<p>development takes place at:
</p>
<div align="center"><a href="https://github.com/marcomaggi/mbfl/">https://github.com/marcomaggi/mbfl/</a>
</div>
<p>and as backup at:
</p>
<div align="center"><a href="https://bitbucket.org/marcomaggi/mbfl">https://bitbucket.org/marcomaggi/mbfl</a>
</div>
<p>proper release tarballs for this package are in the download area at:
</p>
<div align="center"><a href="https://bitbucket.org/marcomaggi/mbfl/downloads/">https://bitbucket.org/marcomaggi/mbfl/downloads/</a>
</div>
<p>Copyright &copy; 2003-2005, 2009-2010, 2012-2015, 2017 by Marco Maggi <a href="mailto:marco.maggi-ipsu@poste.it">marco.maggi-ipsu@poste.it</a>
</p>
<blockquote>
<p>Permission is granted to copy, distribute and/or modify this document
under the terms of the <acronym>GNU</acronym> Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with
Invariant Sections being &ldquo;<acronym>GNU</acronym> Free Documentation License&rdquo; and
&ldquo;<acronym>GNU</acronym> Lesser General Public License&rdquo;, no Front&ndash;Cover Texts, and no
Back&ndash;Cover Texts.  A copy of the license is included in the section
entitled &ldquo;<acronym>GNU</acronym> Free Documentation License&rdquo;.
</p></blockquote>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#overview" accesskey="1">overview</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Overview of the package.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#preprocessor" accesskey="2">preprocessor</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Using the script preprocessor.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#service-variables" accesskey="3">service variables</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Required user defined variables.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#base" accesskey="4">base</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Some base functions.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#encoding" accesskey="5">encoding</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Encoding and decoding strings.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file" accesskey="6">file</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Manipulating files and pathnames.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#actions" accesskey="7">actions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Selecting actions to perform.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#getopts" accesskey="8">getopts</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Parsing command line options.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#message" accesskey="9">message</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Printing messages to the console.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#program">program</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Using external programs.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#interfaces">interfaces</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Interfaces to external programs.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#signal">signal</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Catching signals.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#string">string</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Manipulating strings.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#dialog">dialog</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Interacting with the user.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#variables">variables</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Manipulating variables.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#system">system</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Interfacing with the system.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#main">main</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Main function.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#testing">testing</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Building test suites.
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Appendices

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#sendmail">sendmail</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Examples for sending email.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Package-License">Package License</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">GNU Lesser General Public License.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Documentation-License">Documentation License</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">GNU Free Documentation License.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#references">references</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Bibliography and references.
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Indexes

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#concept-index">concept index</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">An entry for each concept.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#function-index">function index</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">An entry for each function.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#variable-index">variable index</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">An entry for each variable.
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

</pre></th></tr></table>

<hr>
<a name="overview"></a>
<div class="header">
<p>
Next: <a href="#preprocessor" accesskey="n" rel="next">preprocessor</a>, Previous: <a href="#Top" accesskey="p" rel="prev">Top</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Overview-of-the-package"></a>
<h2 class="chapter">1 Overview of the package</h2>


<p>This package is an attempt to make <acronym>GNU</acronym> Bash a viable solution for
medium sized scripts; it needs at least Bash version 4.  A set of
modules implementing common operations and a script template are offered
by this package and the author has used them with success in
implementing non&ndash;small scripts.
</p>
<p>The philosophy of <acronym>MBFL</acronym> is to do the work as much as possible without
external commands.  For example: string manipulation is done using the
special variable substitution provided by Bash, and no use is done of
utilities like <code>sed</code>, <code>grep</code> and <code>ed</code>.
</p>
<p>The library is better used starting from the template scripts in the
<samp>examples/</samp> subdirectory of the distribution, especially
<samp>template.sh</samp> and <samp>template-actions.sh</samp>.  This is because with
<acronym>MBFL</acronym> some choices have been made to reduce the application&ndash;dependent
part of the script to the smallest dimension; if we follow another
schema, <acronym>MBFL</acronym> modules may be inadequate.  This is especially true for
the options parsing module.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#overview-quick" accesskey="1">overview quick</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Quick run&ndash;time loading.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#overview-reliable" accesskey="2">overview reliable</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Reliable run&ndash;time loading.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#overview-direct" accesskey="3">overview direct</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Direct inclusion.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#overview-notes" accesskey="4">overview notes</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Notes.
</td></tr>
</table>

<hr>
<a name="overview-quick"></a>
<div class="header">
<p>
Next: <a href="#overview-reliable" accesskey="n" rel="next">overview reliable</a>, Up: <a href="#overview" accesskey="u" rel="up">overview</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Quick-run_002d_002dtime-loading"></a>
<h3 class="section">1.1 Quick run&ndash;time loading</h3>


<p>The easiest way to use the library is to include at run&ndash;time the library
file <samp>libmbfl.sh</samp> in the script.  To do it, we install the package
on the system and use this code in the scripts:
</p>
<div class="example">
<pre class="example">source &quot;${MBFL_LIBRARY:=$(type -p mbfl-config &amp;&gt;/dev/null \
   &amp;&amp; mbfl-config)}&quot;
</pre></div>

<p>after the service variables have been declared.  <a href="#service-variables">Required user defined variables</a>.
</p>
<p>This code will read the full pathname of the library from the
environment variable <code>MBFL_LIBRARY</code>; if this variable is not set:
the script <code>mbfl-config</code> is invoked with no arguments to acquire
the pathname.  <code>mbfl-config</code> is installed by the package in the
<code>$(bindir)</code> directory, which we must include in the <code>PATH</code>
environment variable.
</p>
<hr>
<a name="overview-reliable"></a>
<div class="header">
<p>
Next: <a href="#overview-direct" accesskey="n" rel="next">overview direct</a>, Previous: <a href="#overview-quick" accesskey="p" rel="prev">overview quick</a>, Up: <a href="#overview" accesskey="u" rel="up">overview</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Reliable-run_002d_002dtime-loading"></a>
<h3 class="section">1.2 Reliable run&ndash;time loading</h3>


<p>A more reliable way to load the library is:
</p>
<div class="smallexample">
<pre class="smallexample">script_PROGNAME=script.sh
mbfl_INTERACTIVE=no
mbfl_LOADED=no
mbfl_INSTALLED=$(type -p mbfl-config &amp;&gt;/dev/null \
   &amp;&amp; mbfl-config) &amp;&gt;/dev/null
mbfl_HARDCODED=./some/dir/libmbfl.sh
for item in &quot;$MBFL_LIBRARY&quot; &quot;$mbfl_HARDCODED&quot; &quot;$mbfl_INSTALLED&quot;
do
    if test -n &quot;$item&quot; -a -f &quot;$item&quot; -a -r &quot;$item&quot;
    then
        if ! source &quot;$item&quot; &amp;&gt;/dev/null
        then
            printf '%s error: loading MBFL file &quot;%s&quot;\n' \
                &quot;$script_PROGNAME&quot; &quot;$item&quot; &gt;&amp;2
            exit 2
        fi
        break
    fi
done
unset -v item
if test &quot;$mbfl_LOADED&quot; != yes
then
    printf '%s error: incorrect evaluation of MBFL\n' \
        &quot;$script_PROGNAME&quot; &gt;&amp;2
    exit 2
fi
</pre></div>

<p>where the optional <samp>./some/dir/libmbfl.sh</samp> can be the pathname of a
known location in which to find the library.  This code:
</p>
<ol>
<li> Looks for the pathname in the <code>MBFL_LIBRARY</code> variable, to allow us
to explicitly select the file from the command line; example:

<div class="example">
<pre class="example">$ MBFL_LIBRARY=/path/to/libmbfl.sh script.sh
</pre></div>

</li><li> Looks in some known directory; for example a subdirectory of a software
package that we have distributed.

</li><li> As a last resort tries to evaluate the <code>mbfl-config</code> script to
pick up a library installed on the system.
</li></ol>

<p>We see that the output of the <code>source</code> command is discarded:
this is because we assume that:
</p>
<ul>
<li> If an error occurs evaluating the library a lot of error messages may
fill the screen, confusing the user; we just want a single error message
pointing the finger of blame.

</li><li> An error in the evaluation of the library code can be replicated because
the evaluation does not heavily depend on the environment, so we can
track down library errors later.
</li></ul>

<p>This code is included in the <acronym>MBFL</acronym> distribution in the
<samp>src/lib/loader.sh</samp> file.
</p>
<hr>
<a name="overview-direct"></a>
<div class="header">
<p>
Next: <a href="#overview-notes" accesskey="n" rel="next">overview notes</a>, Previous: <a href="#overview-reliable" accesskey="p" rel="prev">overview reliable</a>, Up: <a href="#overview" accesskey="u" rel="up">overview</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Direct-inclusion"></a>
<h3 class="section">1.3 Direct inclusion</h3>


<p>Another solution is to directly include the library in the script; this
is easy if we preprocess our scripts with <acronym>GNU</acronym> <code>m4</code>.  We only need
to put the following in the script:
</p>
<div class="example">
<pre class="example">m4_changequote([[,]])
m4_include(libmbfl.sh)
</pre></div>

<p>then preprocess the script with:
</p>
<div class="example">
<pre class="example">$ m4 --prefix-builtins --include=/path/to/library \
         script.sh.m4 &gt;script.sh
</pre></div>

<p>easy to do in a <samp>Makefile</samp>.  The installation directory pathname of
the library (<samp>/path/to/library</samp> in the example) is the output of
<code>mbfl-config --libpath</code>.
</p>
<p>It is also interesting to process the script with the following rule of
<acronym>GNU</acronym> Make: assuming that the source scripts are in the
<samp>src/modules</samp> directory of the source tree:
</p>
<div class="example">
<pre class="example">vpath	%.sh.m4		$(srcdir)/src/modules

M4      = ...
M4FLAGS = --prefix-builtins --include=/path/to/library

%.sh: %.sh.m4
        $(M4) $(M4FLAGS) $(&lt;) | \
        grep --invert-match -e '^#' -e '^$$' | \
        sed -e &quot;s/^ \\+//&quot; &gt;$(@)
</pre></div>

<p>this will remove all the comments and blank lines, decreasing the size
of the script significantly if one makes use of verbose comments; note
that this will wipe out the <code>#!/bin/bash</code> first line, too.
</p>
<p>Usually we want the script to begin with <code>#!/bin/bash</code> followed by
a comment describing the license terms.  We can do it by preparing a
script like the following:
</p>
<div class="example">
<pre class="example">#!/bin/bash
# ... license ...

m4_include(realscript.sh)

### end of file
</pre></div>

<p>and processing it with the following makefile rule:
</p>
<div class="example">
<pre class="example">M4      = ...
M4FLAGS = --prefix-builtins --include=/path/to/library

script.sh: script.sh.m4 realscript.sh
        $(M4) $(M4FLAGS) $(&lt;) &gt;$(@)
</pre></div>

<p><samp>realscript.sh</samp> can be processed as explained above.
</p>
<p>At this point, though, it is better to use the <acronym>MBFL</acronym> preprocessor.
<a href="#preprocessor">Using the script preprocessor</a>.
</p>
<hr>
<a name="overview-notes"></a>
<div class="header">
<p>
Previous: <a href="#overview-direct" accesskey="p" rel="prev">overview direct</a>, Up: <a href="#overview" accesskey="u" rel="up">overview</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Notes"></a>
<h3 class="section">1.4 Notes</h3>


<p>When using <acronym>MBFL</acronym> we want to be aware of the following:
</p>
<ul>
<li> Some functions take a variable name as argument and store in the
referenced variable some value; to avoid name collision: select a name
that starts with <code>p_</code>.  It is guaranteed that <acronym>MBFL</acronym> never uses
variables with name starting with such a prefix.

</li><li> It is possible, but not recommended, to source the library in an
interactive shell, though some modules must be disabled.  The purpose of
interactive loading is only to test and debug the functions by hand.

<p>To do this execute the following code in the shell before sourcing the
library:
</p>
<div class="example">
<pre class="example">mbfl_INTERACTIVE=yes
</pre></div>

<p>without exporting the variable.  The &ldquo;dangerous&rdquo; blocks of code in the
library are surrounded by:
</p>
<div class="example">
<pre class="example">test &quot;$mbfl_INTERACTIVE&quot; = yes || {
    ...
}
</pre></div>

<p>so they are not executed.  Disabled modules are: main, actions, getopts,
signal; &ldquo;disabled&rdquo; does not mean that the functions are not there:
only the global variable declarations are excluded; this is a little
dirty, but, at present, it should work.
</p>
</li><li> The <code>read</code> built in does word splitting on the text it reads, even
when there is a single output variable.  We can verify it with:

<div class="example">
<pre class="example">printf '\tciao\n' | {
    read line
    echo line was &quot;'$line'&quot;
}
-| line was 'ciao'
</pre></div>

<p>we see that the initial tabulation character has been stripped, because
it is a character in the default value of <code>IFS</code>.  Word splitting
does not happen when we set <code>IFS</code> to the empty string:
</p>
<div class="example">
<pre class="example">printf '\tciao\n' | {
    IFS= read line
    echo line was &quot;'$line'&quot;
}
-| line was '        ciao'
</pre></div>

<p>To avoid the mutation of text read with <code>read</code>, <acronym>MBFL</acronym> always sets
<code>IFS</code> to the empty string in the environment in which <code>read</code>
is evaluated.  This happens in functions like
<code>mbfl_read_maybe_null()</code> and <code>mbfl_dialog_ask_password()</code>;
notice, though, that these functions <strong>do not</strong> mutate the
<code>IFS</code> value in the environment of the caller.
</p></li></ul>

<hr>
<a name="preprocessor"></a>
<div class="header">
<p>
Next: <a href="#service-variables" accesskey="n" rel="next">service variables</a>, Previous: <a href="#overview" accesskey="p" rel="prev">overview</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Using-the-script-preprocessor"></a>
<h2 class="chapter">2 Using the script preprocessor</h2>


<p>The <acronym>MBFL</acronym> script preprocessor is a command line program named
<code>mbflpp.sh</code>; it is itself a Bash script that makes use of the
<acronym>MBFL</acronym> library.  It can remove comments, blank lines, blank characters
at the beginning of lines, and it can expand macros.
</p>
<p>The macro preprocessing is done with the <acronym>GNU</acronym> <code>m4</code> program, using
a library of macros called <samp>preprocessor.m4</samp> which is installed on
the system with the <acronym>MBFL</acronym> package.
</p>
<p>The use of the preprocessor is fully optional: every feature of the
<acronym>MBFL</acronym> library can be used without the preprocessor.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#preprocessor-invoking" accesskey="1">preprocessor invoking</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Invoking the preprocessor.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#preprocessor-macros" accesskey="2">preprocessor macros</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Macros library.
</td></tr>
</table>

<hr>
<a name="preprocessor-invoking"></a>
<div class="header">
<p>
Next: <a href="#preprocessor-macros" accesskey="n" rel="next">preprocessor macros</a>, Up: <a href="#preprocessor" accesskey="u" rel="up">preprocessor</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Invoking-the-preprocessor"></a>
<h3 class="section">2.1 Invoking the preprocessor</h3>


<p>The basic synopsis is:
</p>
<div class="smallexample">
<pre class="smallexample">mbflpp.sh [options] &lt;INFILE &gt;OUTFILE
mbflpp.sh [options] --outfile=OUTFILE [--] INFILE1 INFILE2 ...
</pre></div>

<p>all the <code>INFILE</code> pathnames are interpreted as files to concatenate
in the specified order.
</p>
<p>All the <acronym>MBFL</acronym> built in command line options are available,
additionally the following options are supported.
</p>
<dl compact="compact">
<dt><code>--preserve-comments</code></dt>
<dd><p>Do not filter out comments.
</p>
</dd>
<dt><code>--add-bash</code></dt>
<dd><p>Add <code>#!$BASH</code> at the beginning of the output, where <code>BASH</code> is
the built&ndash;in variable of Bash, <a href="http://www.gnu.org/software/bash/manual/bash.html#Bash-Variables">(bash)BASH</a>.
</p>
</dd>
<dt><code>--define=VALUE</code></dt>
<dd><p>Define a new symbol (<code>m4</code> syntax).  This is equivalent to the
<samp>--define</samp> option of <code>m4</code>.
</p>
</dd>
<dt><code>--include=VALUE</code></dt>
<dd><p>Add a search path for files.  <code>VALUE</code> must be a directory pathname
and it is handed to <code>m4</code> to search for macro files.  Can be used
multiple times.
</p>
</dd>
<dt><code>--library=VALUE</code></dt>
<dd><p>Include an <code>m4</code> library.  <code>VALUE</code> must be the name of an
<code>m4</code> macro file which is evaluated before the input files.
</p>
</dd>
<dt><code>-oVALUE</code></dt>
<dt><code>--output=VALUE</code></dt>
<dd><p>Select an output file, <code>-</code> for stdout.
</p>
</dd>
<dt><code>-e</code></dt>
<dt><code>--eval</code></dt>
<dd><p>If used evaluates the output script in <code>bash</code>, instead of printing it.
</p></dd>
</dl>

<hr>
<a name="preprocessor-macros"></a>
<div class="header">
<p>
Previous: <a href="#preprocessor-invoking" accesskey="p" rel="prev">preprocessor invoking</a>, Up: <a href="#preprocessor" accesskey="u" rel="up">preprocessor</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Macros-library"></a>
<h3 class="section">2.2 Macros library</h3>


<p>The <code>m4</code> preprocessor is invoked by <code>mbflpp.sh</code> with the
<samp>--prefix-builtins</samp> option; so all the <code>m4</code> built in macros
and directives are available prefixed with <code>m4_</code>.
</p>

<dl>
<dt><a name="index-mbfl_005fmandatory_005fparameter"></a>Preprocessor Macro: <strong>mbfl_mandatory_parameter</strong> <em><var>varname</var> <var>number</var> <var>name</var></em></dt>
<dd><p>Define a variable local to a shell function holding an argument to the
function.  <var>varname</var> is the name of the variable; <var>number</var> is
the positional parameter number; <var>name</var> is a description of the
argument.
</p>
<p>Example, the following:
</p>
<div class="example">
<pre class="example">mbfl_mandatory_parameter(PATHNAME, 2, file pathname)
</pre></div>

<p>is expanded to:
</p>
<div class="smallexample">
<pre class="smallexample">local PATHNAME=${2:?&quot;missing file pathname parameter to '$FUNCNAME'&quot;}
</pre></div>

<p>Another example the following function:
</p>
<div class="example">
<pre class="example">function message () {
  mbfl_mandatory_parameter(PROGNAME, 1, program name)
  mbfl_mandatory_parameter(STRING,   2, message string)

  printf '%s: %s\n' &quot;$PROGNAME&quot; &quot;$STRING&quot;
}
</pre></div>

<p>is expanded to:
</p>
<div class="smallexample">
<pre class="smallexample">function message () {
  local PROGNAME=${1:?&quot;missing program name parameter to '$FUNCNAME'&quot;}
  local STRING=${2:?&quot;missing message string parameter to '$FUNCNAME'&quot;}

  printf '%s: %s\n' &quot;$PROGNAME&quot; &quot;$STRING&quot;
}
</pre></div>

<p>and so it is a function with two mandatory parameters.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005foptional_005fparameter"></a>Preprocessor Macro: <strong>mbfl_optional_parameter</strong> <em><var>varname</var> <var>number</var> <var>default_value</var></em></dt>
<dd><p>Define a variable local to a shell function holding an argument to the
function.  <var>varname</var> is the name of the variable; <var>number</var> is
the positional parameter number; <var>default_value</var> is the
initialisation value for the variable if the argument is not used.
</p>
<p>Example, the following:
</p>
<div class="example">
<pre class="example">mbfl_optional_parameter(COUNT, 2, 123)
</pre></div>

<p>is expanded to:
</p>
<div class="smallexample">
<pre class="smallexample">local COUNT=${2:-123}&quot;
</pre></div>
</dd></dl>


<dl>
<dt><a name="index-mbfl_005fcommand_005fline_005fargument"></a>Preprocessor Macro: <strong>mbfl_command_line_argument</strong> <em><var>varname</var> <var>argindex</var></em></dt>
<dd><p>Define a variable local to a shell function holding an argument to the
script.  <var>varname</var> is the variable name, <var>argindex</var> is the
argument index in the <code>ARGV</code> array.
</p>
<p>Example, the following:
</p>
<div class="example">
<pre class="example">mbfl_command_line_argument(PATHNAME,3)
</pre></div>

<p>is expanded to:
</p>
<div class="example">
<pre class="example">local PATHNAME=&quot;${ARGV[3]}&quot;
</pre></div>
</dd></dl>

<hr>
<a name="service-variables"></a>
<div class="header">
<p>
Next: <a href="#base" accesskey="n" rel="next">base</a>, Previous: <a href="#preprocessor" accesskey="p" rel="prev">preprocessor</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Required-user-defined-variables"></a>
<h2 class="chapter">3 Required user defined variables</h2>


<p>The following variables are expected to be defined before the <acronym>MBFL</acronym>
code is evaluated.  They are used by <acronym>MBFL</acronym> to compute values for its
own variables.
</p>

<dl>
<dt><a name="index-script_005fPROGNAME"></a>Variable: <strong>script_PROGNAME</strong></dt>
<dd><p>The name of the script.  It is used, for example, in error and verbose
messages.
</p></dd></dl>


<dl>
<dt><a name="index-script_005fAUTHOR"></a>Variable: <strong>script_AUTHOR</strong></dt>
<dd><p>The name of the script author(s).  It is used in copyright statements.
</p></dd></dl>


<dl>
<dt><a name="index-script_005fCOPYRIGHT_005fYEARS"></a>Variable: <strong>script_COPYRIGHT_YEARS</strong></dt>
<dd><p>A comma separated list of years of copyright.  It is used in copyright
statements.
</p></dd></dl>


<dl>
<dt><a name="index-script_005fVERSION"></a>Variable: <strong>script_VERSION</strong></dt>
<dd><p>The version number of the script.  It is used in copyright statements
and it can be directly queried using the command line options
<samp>--version</samp> and <samp>--version-only</samp>.
</p></dd></dl>


<dl>
<dt><a name="index-script_005fLICENSE"></a>Variable: <strong>script_LICENSE</strong></dt>
<dd><p>The identifier of the license under which the script is released.
Accepted values are: <code>GPL</code> or <code>GPL2</code>, <code>GPL3</code>, <code>LGPL</code>
or <code>LGPL2</code>, <code>LGPL3</code>, <code>BSD</code>.  It is used to select the
appropriate value to be displayed when the user of the script selects
the <code>--license</code> option.  <a href="#getopts-options">Predefined options</a>
</p></dd></dl>

<dl>
<dt><a name="index-script_005fUSAGE"></a>Variable: <strong>script_USAGE</strong></dt>
<dd><p>Must be a string, of one or more lines, describing the synopsis of the
program.  It is usually something like:
</p>
<div class="example">
<pre class="example">script_USAGE=&quot;usage: ${script_PROGNAME} [options] ...&quot;
</pre></div>

<p>if the script accepts either input from the stdin channel and input from
a selected file, it is useful to present both cases:
</p>
<div class="example">
<pre class="example">script_USAGE=&quot;usage: ${script_PROGNAME} [options] &lt;INPUT-FILE
usage: ${script_PROGNAME} [options] INPUT-FILE&quot;
</pre></div>

<p>If the script defines multiple actions: it is better to define a
synopsis description for every supported action, by setting this
variable in the action&ndash;specific &ldquo;before parsing options&rdquo; function.
<a href="#actions">actions</a> for details.
</p></dd></dl>


<dl>
<dt><a name="index-script_005fDESCRIPTION"></a>Variable: <strong>script_DESCRIPTION</strong></dt>
<dd><p>One line string providing a brief description of the program.  It is used
in the help screen (the one echoed when the <samp>--help</samp> option is
used) right after the content of <code>script_USAGE</code>.
</p>
<p>If the script defines multiple actions: it is better to define a usage
description for every supported action, by setting this variable in the
action&ndash;specific &ldquo;before parsing options&rdquo; function.  <a href="#actions">actions</a> for
details.
</p></dd></dl>

<dl>
<dt><a name="index-script_005fEXAMPLES"></a>Variable: <strong>script_EXAMPLES</strong></dt>
<dd><p>One or more lines of text to be displayed at the end of the help screen,
after the options description.  It should contain examples of common
invocations for the script.
</p>
<p>If the script defines multiple actions: it is better to define a set of
examples description for every supported action, by setting this
variable in the action&ndash;specific &ldquo;before parsing options&rdquo; function.
<a href="#actions">actions</a> for details.
</p></dd></dl>


<p>All the text in these variables is used as argument to the <code>printf</code>
built&ndash;in command; in particular: <code>script_DESCRIPTION</code> and
<code>script_EXAMPLES</code> are used as first argument to <code>printf</code>, so
the escape sequences (in particular <code>\t</code> and <code>\n</code>) are
expanded.
</p>

<a name="Examples-1"></a>
<h4 class="subsubheading">Examples</h4>

<p>The following example shows how to declare the variables.
</p>
<div class="example">
<pre class="example">script_PROGNAME=myscript.sh
script_AUTHOR='Marco Maggi and Marco Maggi'
script_COPYRIGHT_YEARS='2002, 2003, 2004'
script_VERSION=1.0
script_LICENSE=GPL3
script_USAGE=&quot;usage: $script_PROGNAME [options] ...&quot;
script_DESCRIPTION='Does this and that.'
script_EXAMPLES='Examples:

\tmyscript.sh --do-something arg arg ...
\tmyscript.sh --do-other arg arg ...'
</pre></div>

<p>Notice that <code>script_DESCRIPTION</code> and <code>script_EXAMPLES</code>
<strong>do not</strong> end with a newline character.
</p>
<hr>
<a name="base"></a>
<div class="header">
<p>
Next: <a href="#encoding" accesskey="n" rel="next">encoding</a>, Previous: <a href="#service-variables" accesskey="p" rel="prev">service variables</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Some-base-functions"></a>
<h2 class="chapter">4 Some base functions</h2>



<dl>
<dt><a name="index-mbfl_005fset_005fmaybe"></a>Function: <strong>mbfl_set_maybe</strong> <em><var>name</var> <var>value</var></em></dt>
<dd><p>Set a variable named <var>name</var> to <var>value</var>, but only if <var>name</var>
is not the empty string; if <var>value</var> is the empty string: the old
value of <var>name</var> is left untouched.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fread_005fmaybe_005fnull"></a>Function: <strong>mbfl_read_maybe_null</strong> <em><var>varname</var></em></dt>
<dd><p>Read a line from its stdin and store it in a variable named
<var>varname</var>.  If <code>mbfl_option_null()</code> returns true: the null
character is used as terminator, as in:
</p>
<div class="example">
<pre class="example">IFS= read -d $'\x00'
</pre></div>
</dd></dl>

<hr>
<a name="encoding"></a>
<div class="header">
<p>
Next: <a href="#file" accesskey="n" rel="next">file</a>, Previous: <a href="#base" accesskey="p" rel="prev">base</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Encoding-and-decoding-strings"></a>
<h2 class="chapter">5 Encoding and decoding strings</h2>


<p>The purpose of this module is to let an external process invoke a Bash
script with <em>damned</em> command line arguments: strings including
blanks or strange characters that may trigger quoting rules.
</p>
<p>This problem can arise when using scripting languages with some sort of
<code>eval</code> command.
</p>
<p>The solution is to encode the argument string in hexadecimal or octal
format strings, so that all the damned characters are converted to
&ldquo;good&rdquo; ones.  The Bash script can convert them back.
</p>

<dl>
<dt><a name="index-mbfl_005fdecode_005fhex"></a>Function: <strong>mbfl_decode_hex</strong> <em><var>hex_string</var></em></dt>
<dd><p>Decode a hex string and outputs it on stdout.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fdecode_005foct"></a>Function: <strong>mbfl_decode_oct</strong> <em><var>oct_string</var></em></dt>
<dd><p>Decode a oct string and outputs it on stdout.
</p></dd></dl>


<p>Example:
</p>
<div class="example">
<pre class="example">mbfl_decode_hex 414243
-&gt; ABC
</pre></div>

<hr>
<a name="file"></a>
<div class="header">
<p>
Next: <a href="#actions" accesskey="n" rel="next">actions</a>, Previous: <a href="#encoding" accesskey="p" rel="prev">encoding</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Manipulating-files-and-pathnames"></a>
<h2 class="chapter">6 Manipulating files and pathnames</h2>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#file-names" accesskey="1">file names</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Manipulating file names.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-commands" accesskey="2">file commands</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Manipulating files with external
                                commands.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-testing" accesskey="3">file testing</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Testing file existence and the like.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-read-and-write" accesskey="4">file read and write</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Reading and writing files with
                                privileges.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-misc" accesskey="5">file misc</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Miscellaneous commands.
</td></tr>
</table>

<hr>
<a name="file-names"></a>
<div class="header">
<p>
Next: <a href="#file-commands" accesskey="n" rel="next">file commands</a>, Up: <a href="#file" accesskey="u" rel="up">file</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="File-names"></a>
<h3 class="section">6.1 File names</h3>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#file-name-parts" accesskey="1">file name parts</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Splitting a file name into its
                                components.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-name-path" accesskey="2">file name path</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Handling relative pathnames.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-name-system" accesskey="3">file name system</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Finding pathnames on the system.
</td></tr>
</table>


<hr>
<a name="file-name-parts"></a>
<div class="header">
<p>
Next: <a href="#file-name-path" accesskey="n" rel="next">file name path</a>, Up: <a href="#file-names" accesskey="u" rel="up">file names</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Splitting-a-file-name-into-its-components"></a>
<h4 class="subsection">6.1.1 Splitting a file name into its components</h4>



<dl>
<dt><a name="index-mbfl_005ffile_005fextension"></a>Function: <strong>mbfl_file_extension</strong> <em><var>pathname</var></em></dt>
<dd><p>Extract the extension from a file name.  Starting from the end of the
string <var>pathname</var>: search the last dot character in the argument
string and echo to stdout the range of characters from the dot to the
end, not including the dot.  If a slash character or the beginning of
the string is found first: echoes to stdout the empty string.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fdirname"></a>Function: <strong>mbfl_file_dirname</strong> <em><var>pathname</var></em></dt>
<dd><p>Extract the directory part from a fully qualified file name.  Search the
last slash character in the input string and echo to stdout the range of
characters from the first to the slash, not including the slash.
</p>
<p>If no slash is found: echo a single dot (the current directory).
</p>
<p>If the input string begins with <code>/</code> or <code>//</code> with no slash
characters after the first ones: echo a single slash.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005frootname"></a>Function: <strong>mbfl_file_rootname</strong> <em><var>pathname</var></em></dt>
<dd><p>Extract the root portion of a file name.  Search the last dot character
in the argument string and echo to stdout the range of characters from
the beginning to the dot, not including the dot.
</p>
<p>If a slash character is found first, or no dot is found, or the dot is
the first character: echo the empty string.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005ftail"></a>Function: <strong>mbfl_file_tail</strong> <em><var>pathname</var></em></dt>
<dd><p>Extract the file portion from a fully qualified file name.  Search the
last slash character in the input string and echo to stdout the range of
characters from the slash to the end, not including the slash.  If no
slash is found: echo the whole string.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fsplit"></a>Function: <strong>mbfl_file_split</strong> <em><var>pathname</var></em></dt>
<dd><p>Separate a file name into its components.  One or more contiguous
occurrences of the slash character is used as separator.  The components
are stored in an array named <code>SPLITPATH</code>, that may be declared
<code>local</code> in the scope of the caller; the base index is zero.  The
number of elements in the array is stored in a variable named
<code>SPLITCOUNT</code>.  Return true.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fstrip_005ftrailing_005fslash"></a>Function: <strong>mbfl_file_strip_trailing_slash</strong> <em><var>pathname</var></em></dt>
<dd><p>If the last character in <var>pathname</var> is a slash (<code>/</code>): remove it
and print the result on stdout.
</p></dd></dl>

<hr>
<a name="file-name-path"></a>
<div class="header">
<p>
Next: <a href="#file-name-system" accesskey="n" rel="next">file name system</a>, Previous: <a href="#file-name-parts" accesskey="p" rel="prev">file name parts</a>, Up: <a href="#file-names" accesskey="u" rel="up">file names</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Handling-relative-pathnames"></a>
<h4 class="subsection">6.1.2 Handling relative pathnames</h4>


<dl>
<dt><a name="index-mbfl_005ffile_005fnormalise"></a>Function: <strong>mbfl_file_normalise</strong> <em><var>pathname</var></em></dt>
<dt><a name="index-mbfl_005ffile_005fnormalise-1"></a>Function: <strong>mbfl_file_normalise</strong> <em><var>pathname</var> <var>prefix</var></em></dt>
<dd><p>Normalise a file name: remove all the occurrences of <code>.</code> and
<code>..</code>.
</p>
<p>If <var>pathname</var> is relative (according to
<code>mbfl_file_is_absolute()</code>) and <var>prefix</var> is not present or it
is the empty string: the current process working directory is prepended
to <var>pathname</var>.
</p>
<p>If <var>prefix</var> is present and non empty, and <var>pathname</var> is relative
(according to <code>mbfl_file_is_absolute()</code>): <var>prefix</var> is
prepended to <var>pathname</var> and normalised, too.
</p>
<p>Echo to stdout the normalised file name.  Return true.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fsubpathname"></a>Function: <strong>mbfl_file_subpathname</strong> <em><var>pathname</var> <var>basedir</var></em></dt>
<dd><p>If <var>pathname</var> is a subdirectory or file under <var>basedir</var>: print
to stdout the subpathname portion.  Example:
</p>
<div class="example">
<pre class="example">mbfl_file_subpathname /a/b/c /a
-&gt; ./b/c
</pre></div>

<p>Both <var>pathname</var> and <var>basedir</var> must be full (normalised)
pathnames for this function to work.
</p>
<p>If <var>pathname</var> is recognised  as subpathname of <var>basedir</var>: the
return code is zero; else the return code is one.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fis_005fabsolute"></a>Function: <strong>mbfl_file_is_absolute</strong> <em><var>pathname</var></em></dt>
<dd><p>Return true if the first character in <var>pathname</var> is a slash
(<code>/</code>); else return false.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fis_005fabsolute_005fdirname"></a>Function: <strong>mbfl_file_is_absolute_dirname</strong> <em><var>pathname</var></em></dt>
<dd><p>Return true if <var>pathname</var> is a directory according to
<code>mbfl_file_is_directory()</code> and an absolute pathname according to
<code>mbfl_file_is_absolute()</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fis_005fabsolute_005ffilename"></a>Function: <strong>mbfl_file_is_absolute_filename</strong> <em><var>pathname</var></em></dt>
<dd><p>Return true if <var>pathname</var> is a file according to
<code>mbfl_file_is_file()</code> and an absolute pathname according to
<code>mbfl_file_is_absolute()</code>.
</p></dd></dl>

<hr>
<a name="file-name-system"></a>
<div class="header">
<p>
Previous: <a href="#file-name-path" accesskey="p" rel="prev">file name path</a>, Up: <a href="#file-names" accesskey="u" rel="up">file names</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Finding-pathnames-on-the-system"></a>
<h4 class="subsection">6.1.3 Finding pathnames on the system</h4>


<dl>
<dt><a name="index-mbfl_005ffile_005ffind_005ftmpdir"></a>Function: <strong>mbfl_file_find_tmpdir</strong></dt>
<dt><a name="index-mbfl_005ffile_005ffind_005ftmpdir-1"></a>Function: <strong>mbfl_file_find_tmpdir</strong> <em><var>PATHNAME</var></em></dt>
<dd><p>Find a value for a temporary directory according to the following rules:
</p>
<ol>
<li> If <var>PATHNAME</var> argument is not used: it defaults to the current value
of <code>mbfl_option_TMPDIR</code>.

</li><li> If <var>PATHNAME</var> is not null and it is a directory and it is writable:
it is accepted as value.

</li><li> If <var>PATHNAME</var> argument is invalid: the value <samp>/tmp/$USER</samp>,
where <code>USER</code> is the environment variable, is tried; finally the
value <samp>/tmp</samp> is tried.
</li></ol>

<p>Echo the accepted value to stdout.  Return true if a value is found,
false otherwise.
</p></dd></dl>

<hr>
<a name="file-commands"></a>
<div class="header">
<p>
Next: <a href="#file-testing" accesskey="n" rel="next">file testing</a>, Previous: <a href="#file-names" accesskey="p" rel="prev">file names</a>, Up: <a href="#file" accesskey="u" rel="up">file</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="File-Commands"></a>
<h3 class="section">6.2 File Commands</h3>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#file-commands-listing" accesskey="1">file commands listing</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Retrieving informations.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-commands-mkdir" accesskey="2">file commands mkdir</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Creating directories.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-commands-copy" accesskey="3">file commands copy</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Copying files.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-commands-move" accesskey="4">file commands move</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Moving files.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-commands-removing" accesskey="5">file commands removing</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Removing files and directories.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-commands-symlink" accesskey="6">file commands symlink</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Creating symbolic links.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-commands-tar" accesskey="7">file commands tar</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Manipulating tar archives.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-commands-perms" accesskey="8">file commands perms</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Set/get file permissions.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-commands-owner" accesskey="9">file commands owner</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Setting file owner and group.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-commands-compress">file commands compress</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Compressing files.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#file-commands-stat">file commands stat</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Inspecting files and directories.
</td></tr>
</table>

<hr>
<a name="file-commands-listing"></a>
<div class="header">
<p>
Next: <a href="#file-commands-mkdir" accesskey="n" rel="next">file commands mkdir</a>, Up: <a href="#file-commands" accesskey="u" rel="up">file commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Retrieving-informations"></a>
<h4 class="subsection">6.2.1 Retrieving informations</h4>


<a name="index-Files_002c-listing"></a>
<a name="index-Files_002c-owner"></a>
<a name="index-Files_002c-group"></a>
<a name="index-Files_002c-size"></a>
<a name="index-Listing-files"></a>
<a name="index-Owner-of-files"></a>
<a name="index-Group-of-files"></a>
<a name="index-Size-of-files"></a>
<a name="index-Getting-owner-of-files"></a>
<a name="index-Getting-group-of-files"></a>
<a name="index-Getting-size-of-files"></a>
<a name="index-ls_002c-command"></a>
<a name="index-Command-ls"></a>
<a name="index-Executing-command-ls"></a>
<a name="index-readlink_002c-command"></a>
<a name="index-Command-readlink"></a>
<a name="index-Executing-command-readlink"></a>
<a name="index-chmod_002c-command"></a>
<a name="index-Command-chmod"></a>
<a name="index-Executing-command-chmod"></a>
<a name="index-chown_002c-command"></a>
<a name="index-Command-chown"></a>
<a name="index-Executing-command-chown"></a>


<dl>
<dt><a name="index-mbfl_005ffile_005fenable_005flisting"></a>Function: <strong>mbfl_file_enable_listing</strong></dt>
<dd><p>Declare the commands required to retrieve informations about files and
directories.  <a href="#program-declaring">Declaring the intention to use a
program</a>
</p>
<p>The programs are: <code>ls</code>, <code>readlink</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005flisting"></a>Function: <strong>mbfl_file_listing</strong> <em><var>pathname</var></em></dt>
<dd><p>Execute <code>ls</code> with <var>pathname</var> as argument.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005flong_005flisting"></a>Function: <strong>mbfl_file_long_listing</strong> <em><var>pathname</var></em></dt>
<dd><p>Execute <code>ls</code> with <var>pathname</var> as argument and the flag
<code>-l</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fget_005fowner"></a>Function: <strong>mbfl_file_get_owner</strong> <em><var>pathname</var></em></dt>
<dd><p>Print the owner of the file.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fget_005fgroup"></a>Function: <strong>mbfl_file_get_group</strong> <em><var>pathname</var></em></dt>
<dd><p>Print the group of the file.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fget_005fsize"></a>Function: <strong>mbfl_file_get_size</strong> <em><var>pathname</var></em></dt>
<dd><p>Print the size of the file in bytes.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fnormalise_005flink"></a>Function: <strong>mbfl_file_normalise_link</strong> <em><var>pathname</var></em></dt>
<dd><p>Make use of the <code>readlink</code> to normalise the pathname of a
symbolic link (remember that a symbolic link references a file, never a
directory).  Echo to stdout the normalised pathname.
</p>
<p>The command line of <code>readlink</code> is:
</p>
<div class="example">
<pre class="example">readlink -fn &quot;$<var>pathname</var>&quot;
</pre></div>
</dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fread_005flink"></a>Function: <strong>mbfl_file_read_link</strong> <em><var>pathname</var></em></dt>
<dd><p>Make use of <code>readlink</code> to acquire the original pathname
referenced by <var>pathname</var>, then print it.
</p></dd></dl>

<hr>
<a name="file-commands-mkdir"></a>
<div class="header">
<p>
Next: <a href="#file-commands-copy" accesskey="n" rel="next">file commands copy</a>, Previous: <a href="#file-commands-listing" accesskey="p" rel="prev">file commands listing</a>, Up: <a href="#file-commands" accesskey="u" rel="up">file commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Creating-directories"></a>
<h4 class="subsection">6.2.2 Creating directories</h4>


<a name="index-Creating-directories"></a>
<a name="index-Directories_002c-creating"></a>
<a name="index-mkdir_002c-command"></a>
<a name="index-Command-mkdir"></a>
<a name="index-Executing-command-mkdir"></a>


<dl>
<dt><a name="index-mbfl_005ffile_005fenable_005fmake_005fdirectory"></a>Function: <strong>mbfl_file_enable_make_directory</strong></dt>
<dd><p>Declare the commands required to create directories.  <a href="#program-declaring">Declaring the intention to use a program</a>
</p>
<p>The programs are: <code>mkdir</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fmake_005fdirectory"></a>Function: <strong>mbfl_file_make_directory</strong> <em><var>pathname</var></em></dt>
<dt><a name="index-mbfl_005ffile_005fmake_005fdirectory-1"></a>Function: <strong>mbfl_file_make_directory</strong> <em><var>pathname</var> <var>permissions</var></em></dt>
<dd><p>Create a directory named <var>pathname</var>; all the non&ndash;existent parents are
created, too.  If <var>permissions</var> is present: it is the specification
of directory permissions in octal mode.
</p>
<p>This function does not test if the directory already exists: the command
is always executed.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fmake_005fif_005fnot_005fdirectory"></a>Function: <strong>mbfl_file_make_if_not_directory</strong> <em><var>pathname</var></em></dt>
<dt><a name="index-mbfl_005ffile_005fmake_005fif_005fnot_005fdirectory-1"></a>Function: <strong>mbfl_file_make_if_not_directory</strong> <em><var>pathname</var> <var>permissions</var></em></dt>
<dd><p>Wrapper for <code>mbfl_file_make_directory()</code> that creates the
directory if it does not exist.
</p>
<p>If a <code>sudo</code> user was requested: this function resets the request
even if no command has been executed.
</p></dd></dl>

<hr>
<a name="file-commands-copy"></a>
<div class="header">
<p>
Next: <a href="#file-commands-move" accesskey="n" rel="next">file commands move</a>, Previous: <a href="#file-commands-mkdir" accesskey="p" rel="prev">file commands mkdir</a>, Up: <a href="#file-commands" accesskey="u" rel="up">file commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Copying-files"></a>
<h4 class="subsection">6.2.3 Copying files</h4>


<a name="index-Copying-files"></a>
<a name="index-Files_002c-copying"></a>
<a name="index-cp_002c-command"></a>
<a name="index-Command-cp"></a>
<a name="index-Executing-command-cp"></a>


<p>At present, copying of directories is not supported; we have to create
the directory and then copy files into it.
</p>

<dl>
<dt><a name="index-mbfl_005ffile_005fenable_005fcopy"></a>Function: <strong>mbfl_file_enable_copy</strong></dt>
<dd><p>Declare the commands required to copy files and directories.
<a href="#program-declaring">Declaring the intention to use a program</a>
</p>
<p>The programs are: <code>cp</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fcopy"></a>Function: <strong>mbfl_file_copy</strong> <em><var>source</var> <var>target</var> ?&hellip;?</em></dt>
<dd><p>Copy the <var>source</var>, a file pathname, to <var>target</var>, a file
pathname.  Additional arguments are handed to the command unchanged.
</p>
<p>If <var>source</var> does not exist, or if it is not a file, an error is
generated and the return value is 1.  If <var>target</var> exists an error is
generated and the return value is 1.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fcopy_005fto_005fdirectory"></a>Function: <strong>mbfl_file_copy_to_directory</strong> <em><var>source</var> <var>target</var> ?&hellip;?</em></dt>
<dd><p>Copy the <var>source</var>, a file pathname, into the directory <var>target</var>.
Additional arguments are handed to the command unchanged.
</p>
<p>If <var>source</var> does not exist, or if it is not a file, an error is
generated and the return value is 1.  If <var>target</var> does not exist or
it is not a directory: an error message is generated and the return
value is 1.
</p></dd></dl>

<hr>
<a name="file-commands-move"></a>
<div class="header">
<p>
Next: <a href="#file-commands-removing" accesskey="n" rel="next">file commands removing</a>, Previous: <a href="#file-commands-copy" accesskey="p" rel="prev">file commands copy</a>, Up: <a href="#file-commands" accesskey="u" rel="up">file commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Moving-files"></a>
<h4 class="subsection">6.2.4 Moving files</h4>


<a name="index-Moving-files"></a>
<a name="index-Files_002c-moving"></a>
<a name="index-mv_002c-command"></a>
<a name="index-Command-mv"></a>
<a name="index-Executing-command-mv"></a>


<dl>
<dt><a name="index-mbfl_005ffile_005fenable_005fmove"></a>Function: <strong>mbfl_file_enable_move</strong></dt>
<dd><p>Declare the commands required to move files and directories.
<a href="#program-declaring">Declaring the intention to use a program</a>
</p>
<p>The programs are: <code>mv</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fmove"></a>Function: <strong>mbfl_file_move</strong> <em><var>source</var> <var>target</var> ?&hellip;?</em></dt>
<dd><p>Move the <var>source</var>, a file or directory, to <var>target</var>, a pathname.
Additional arguments are handed to the command unchanged.
</p>
<p>If <var>source</var> does not exist, or if it is not readable, an error is
generated and the return value is 1.  If <var>target</var> exists an error is
generated and the return value is 1.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fmove_005fto_005fdirectory"></a>Function: <strong>mbfl_file_move_to_directory</strong> <em><var>source</var> <var>target</var> ?&hellip;?</em></dt>
<dd><p>Move the <var>source</var>, a file or directory, into the directory
<var>target</var>.  Additional arguments are handed to the command unchanged.
</p>
<p>If <var>source</var> does not exist, or if it is not readable, an error
message is generated and the return value is 1.  If <var>target</var> does
not exist or it is not a directory: an error is generated and the return
value is 1.
</p></dd></dl>

<hr>
<a name="file-commands-removing"></a>
<div class="header">
<p>
Next: <a href="#file-commands-symlink" accesskey="n" rel="next">file commands symlink</a>, Previous: <a href="#file-commands-move" accesskey="p" rel="prev">file commands move</a>, Up: <a href="#file-commands" accesskey="u" rel="up">file commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Removing-files-and-directories"></a>
<h4 class="subsection">6.2.5 Removing files and directories</h4>


<a name="index-Removing-files"></a>
<a name="index-Files_002c-removing"></a>
<a name="index-rm_002c-command"></a>
<a name="index-Command-rm"></a>
<a name="index-Executing-command-rm"></a>
<a name="index-rmdir_002c-command"></a>
<a name="index-Command-rmdir"></a>
<a name="index-Executing-command-rmdir"></a>


<p>Files removal is forced: the <code>--force</code> option to <code>rm</code> is
always used.  It is responsibility of the caller to validate the
operation before invoking these functions.
</p>
<p>Some functions test the existence of the pathname before attempting to
remove it: this is done only if test execution is disabled; if test
execution is enabled the command line is echoed to stderr to make it
easier to debug scripts.
</p>

<dl>
<dt><a name="index-mbfl_005ffile_005fenable_005fremove"></a>Function: <strong>mbfl_file_enable_remove</strong></dt>
<dd><p>Declare the commands required to remove files and directories.
<a href="#program-declaring">Declaring the intention to use a program</a>
</p>
<p>The programs are: <code>rm</code>, <code>rmdir</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fremove"></a>Function: <strong>mbfl_file_remove</strong> <em><var>pathname</var></em></dt>
<dd><p>Remove <var>pathname</var>, no matter if it is a file or directory.  If it is
a directory: descend the sub-levels removing all of them.  If an error
occurs return 1.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fremove_005ffile"></a>Function: <strong>mbfl_file_remove_file</strong> <em><var>pathname</var></em></dt>
<dd><p>Remove the file or symbolic link selected by <var>pathname</var>.  If the
file does not exist or it is not a file or an error occurs: return 1.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fremove_005fsymlink"></a>Function: <strong>mbfl_file_remove_symlink</strong> <em><var>pathname</var></em></dt>
<dd><p>Remove the symbolic link selected by <var>pathname</var>.  If the link does
not exist or it is not a symbolic link or an error occurs: return 1.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fremove_005ffile_005for_005fsymlink"></a>Function: <strong>mbfl_file_remove_file_or_symlink</strong> <em><var>pathname</var></em></dt>
<dd><p>Remove the file or symbolic link selected by <var>pathname</var>.  If the
file does not exist or it is not a file or an error occurs: return 1.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fremove_005fdirectory"></a>Function: <strong>mbfl_file_remove_directory</strong> <em><var>pathname</var></em></dt>
<dd><p>Remove the directory selected by <var>pathname</var>.  If the directory does
not exist or an error occurs: return 1.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fremove_005fdirectory_005fsilently"></a>Function: <strong>mbfl_file_remove_directory_silently</strong> <em><var>pathname</var></em></dt>
<dd><p>Like <code>mbfl_file_remove_directory()</code>, but do not print messages if
the directory is not empty.
</p></dd></dl>

<hr>
<a name="file-commands-symlink"></a>
<div class="header">
<p>
Next: <a href="#file-commands-tar" accesskey="n" rel="next">file commands tar</a>, Previous: <a href="#file-commands-removing" accesskey="p" rel="prev">file commands removing</a>, Up: <a href="#file-commands" accesskey="u" rel="up">file commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Creating-symbolic-links"></a>
<h4 class="subsection">6.2.6 Creating symbolic links</h4>


<a name="index-Files_002c-symbolic-links"></a>
<a name="index-Symbolic-links"></a>
<a name="index-Creating-symbolic-links"></a>
<a name="index-ln_002c-command"></a>
<a name="index-Command-ln"></a>
<a name="index-Executing-command-ln"></a>


<dl>
<dt><a name="index-mbfl_005ffile_005fenable_005fsymlink"></a>Function: <strong>mbfl_file_enable_symlink</strong></dt>
<dd><p>Declare the commands required to create symbolic links.  <a href="#program-declaring">Declaring the intention to use a program</a>
</p>
<p>The programs are: <code>ln</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fsymlink"></a>Function: <strong>mbfl_file_symlink</strong> <em><var>original_name</var> <var>symlink_name</var></em></dt>
<dd><p>Create a symbolic link.
</p></dd></dl>

<hr>
<a name="file-commands-tar"></a>
<div class="header">
<p>
Next: <a href="#file-commands-perms" accesskey="n" rel="next">file commands perms</a>, Previous: <a href="#file-commands-symlink" accesskey="p" rel="prev">file commands symlink</a>, Up: <a href="#file-commands" accesskey="u" rel="up">file commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Manipulating-tar-archives"></a>
<h4 class="subsection">6.2.7 Manipulating tar archives</h4>


<a name="index-tar-archives"></a>
<a name="index-Creating-tar-archives"></a>
<a name="index-Archives_002c-tar"></a>
<a name="index-tar_002c-command"></a>
<a name="index-Command-tar"></a>
<a name="index-Executing-command-tar"></a>


<p>Remember that when we execute a script with the <samp>--test</samp> option:
the external commands are not executed: a command line is echoed to
stdout.  It is recommended to use this mode to fine tune the command line
options required by <code>tar</code>.
</p>

<dl>
<dt><a name="index-mbfl_005ffile_005fenable_005ftar"></a>Function: <strong>mbfl_file_enable_tar</strong></dt>
<dd><p>Declare the <code>tar</code> command.  <a href="#program-declaring">Declaring
the intention to use a program</a>
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ftar_005fexec"></a>Function: <strong>mbfl_tar_exec</strong> <em>?...?</em></dt>
<dd><p>Execute <code>tar</code> with whatever arguments are used.  Return the
return code of <code>tar</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ftar_005fcreate_005fto_005fstdout"></a>Function: <strong>mbfl_tar_create_to_stdout</strong> <em><var>directory</var> ?...?</em></dt>
<dd><p>Create an archive and send it to stdout.  The root of the archive is the
<var>directory</var>.  Files are selected with the <code>.</code>  pattern.
<code>tar</code> flags may be appended to the invocation to this function.
In case of error return 1.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ftar_005fextract_005ffrom_005fstdin"></a>Function: <strong>mbfl_tar_extract_from_stdin</strong> <em><var>directory</var> ?...?</em></dt>
<dd><p>Read an archive from stdin and extract it under <var>directory</var>.
<code>tar</code> flags may be appended to the invocation to this function.
In case of error return 1.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ftar_005fextract_005ffrom_005ffile"></a>Function: <strong>mbfl_tar_extract_from_file</strong> <em><var>directory</var> <var>archive</var> ?...?</em></dt>
<dd><p>Read an archive from a file and extract it under <var>directory</var>.
<code>tar</code> flags may be appended to the invocation to this function.
In case of error return 1.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ftar_005fcreate_005fto_005ffile"></a>Function: <strong>mbfl_tar_create_to_file</strong> <em><var>directory</var> <var>archive</var> ?...?</em></dt>
<dd><p>Create an archive named <var>archive</var> holding the contents of
<var>directory</var>.  Before creating the archive, the process changes the
current directory to <var>directory</var> and selects the files with the
pattern <code>.</code>.  <code>tar</code> flags may be appended to the invocation
to this function.  In case of error return 1.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ftar_005farchive_005fdirectory_005fto_005ffile"></a>Function: <strong>mbfl_tar_archive_directory_to_file</strong> <em><var>directory</var> <var>archive</var> ?...?</em></dt>
<dd><p>Like <code>mbfl_tar_create_to_file()</code> but archive all the contents of
<var>directory</var>, including the directory itself (not its parents).
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ftar_005flist"></a>Function: <strong>mbfl_tar_list</strong> <em><var>archive</var> ?...?</em></dt>
<dd><p>Print to stdout the list of files in <var>archive</var>.  <code>tar</code> flags
may be appended to the invocation to this function.  In case of error
return 1.
</p></dd></dl>

<hr>
<a name="file-commands-perms"></a>
<div class="header">
<p>
Next: <a href="#file-commands-owner" accesskey="n" rel="next">file commands owner</a>, Previous: <a href="#file-commands-tar" accesskey="p" rel="prev">file commands tar</a>, Up: <a href="#file-commands" accesskey="u" rel="up">file commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Set_002fget-file-permissions"></a>
<h4 class="subsection">6.2.8 Set/get file permissions</h4>


<a name="index-Files_002c-permissions"></a>
<a name="index-Getting-file-permissions"></a>
<a name="index-Permissions-of-files"></a>
<a name="index-chmod_002c-command-1"></a>
<a name="index-Command-chmod-1"></a>
<a name="index-Executing-command-chmod-1"></a>


<dl>
<dt><a name="index-mbfl_005ffile_005fenable_005fpermissions"></a>Function: <strong>mbfl_file_enable_permissions</strong></dt>
<dd><p>Declare the intention to use the programs required to get/set file
permissions.  <a href="#program-declaring">Declaring the intention to use a
program</a>
</p>
<p>The programs are: <code>ls</code>, <code>chmod</code>, <code>cut</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fget_005fpermissions"></a>Function: <strong>mbfl_file_get_permissions</strong> <em><var>pathname</var></em></dt>
<dd><p>Print the access permissions for <var>pathname</var>, in octal format.
</p></dd></dl>


<p>To set permissions one may request the use of <code>sudo</code>: just
request a user before invoking the following function.  <a href="#program-executing">Executing a program</a>
</p>

<dl>
<dt><a name="index-mbfl_005ffile_005fset_005fpermissions"></a>Function: <strong>mbfl_file_set_permissions</strong> <em><var>mode</var> <var>pathname</var></em></dt>
<dd><p>Set the access permissions for <var>pathname</var>; <var>mode</var> must be in a
form accepted by <code>chmod</code>.
</p></dd></dl>

<hr>
<a name="file-commands-owner"></a>
<div class="header">
<p>
Next: <a href="#file-commands-compress" accesskey="n" rel="next">file commands compress</a>, Previous: <a href="#file-commands-perms" accesskey="p" rel="prev">file commands perms</a>, Up: <a href="#file-commands" accesskey="u" rel="up">file commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Setting-file-owner-and-group"></a>
<h4 class="subsection">6.2.9 Setting file owner and group</h4>


<a name="index-Files_002c-owner-and-group"></a>
<a name="index-Owner-of-of-files"></a>
<a name="index-Group-of-of-files"></a>
<a name="index-chown_002c-command-1"></a>
<a name="index-Command-chown-1"></a>
<a name="index-Executing-command-chown-1"></a>
<a name="index-chgrp_002c-command"></a>
<a name="index-Command-chgrp"></a>
<a name="index-Executing-command-chgrp"></a>


<dl>
<dt><a name="index-mbfl_005ffile_005fenable_005fowner_005fand_005fgroup"></a>Function: <strong>mbfl_file_enable_owner_and_group</strong></dt>
<dd><p>Declare the intention to use the programs required to change file owner and group.  <a href="#program-declaring">Declaring the intention to use a program</a>
</p>
<p>The programs are: <code>chown</code>, <code>chgrp</code>.
</p></dd></dl>


<p>To change the file owner and group one may request the use of <code>sudo</code>: just request a user
before invoking the following function.  <a href="#program-executing">Executing a program</a>
</p>

<dl>
<dt><a name="index-mbfl_005ffile_005fset_005fowner"></a>Function: <strong>mbfl_file_set_owner</strong> <em><var>owner</var> <var>pathname</var></em></dt>
<dd><p>Change the file owner for <var>pathname</var>; <var>owner</var> must be in a form accepted by <code>chown</code>.
If verbose mode is enabled: hand the <samp>--verbose</samp> option to <code>chown</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fset_005fgroup"></a>Function: <strong>mbfl_file_set_group</strong> <em><var>group</var> <var>pathname</var></em></dt>
<dd><p>Change the file group for <var>pathname</var>; <var>group</var> must be in a form accepted by <code>chgrp</code>.
If verbose mode is enabled: hand the <samp>--verbose</samp> option to <code>chgrp</code>.
</p></dd></dl>

<hr>
<a name="file-commands-compress"></a>
<div class="header">
<p>
Next: <a href="#file-commands-stat" accesskey="n" rel="next">file commands stat</a>, Previous: <a href="#file-commands-owner" accesskey="p" rel="prev">file commands owner</a>, Up: <a href="#file-commands" accesskey="u" rel="up">file commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Compressing-files"></a>
<h4 class="subsection">6.2.10 Compressing files</h4>


<a name="index-Files_002c-compression"></a>
<a name="index-Compressing-files"></a>
<a name="index-gzip_002c-command"></a>
<a name="index-Command-gzip"></a>
<a name="index-Executing-command-gzip"></a>
<a name="index-bzip2_002c-command"></a>
<a name="index-Command-bzip2"></a>
<a name="index-Executing-command-bzip2"></a>


<p>This module has an internal state, stored in global variables.  The
state holds informations about:
</p>
<ul>
<li> The selected compression external program (default: <code>gzip</code>).

</li><li> Whether the program should keep the original files or replace them with
the (de)compressed version (default: do not keep).

</li><li> Whether the output must be sent to standard output or a file.
</li></ul>


<a name="Initialisation"></a>
<h4 class="subsubheading">Initialisation</h4>

<dl>
<dt><a name="index-mbfl_005ffile_005fenable_005fcompress"></a>Function: <strong>mbfl_file_enable_compress</strong></dt>
<dd><p>Declare the programs required to compress a file.  <a href="#program-declaring">Declaring the intention to use a program</a>
</p>
<p>The programs are: <code>gzip</code>, <code>bzip2</code>.
</p></dd></dl>


<a name="Configuration"></a>
<h4 class="subsubheading">Configuration</h4>

<p>The selection will affect all the future invocations of the
compression/decompression functions.
</p>
<dl>
<dt><a name="index-mbfl_005ffile_005fcompress_005fselect_005fgzip"></a>Function: <strong>mbfl_file_compress_select_gzip</strong></dt>
<dt><a name="index-mbfl_005ffile_005fcompress_005fselect_005fbzip"></a>Function: <strong>mbfl_file_compress_select_bzip</strong></dt>
<dd><p>Select a compressor program.
</p></dd></dl>

<dl>
<dt><a name="index-mbfl_005ffile_005fcompress_005fkeep"></a>Function: <strong>mbfl_file_compress_keep</strong></dt>
<dt><a name="index-mbfl_005ffile_005fcompress_005fnokeep"></a>Function: <strong>mbfl_file_compress_nokeep</strong></dt>
<dd><p>Select whether the compress program should keep the original file or
not.
</p></dd></dl>

<dl>
<dt><a name="index-mbfl_005ffile_005fcompress_005fselect_005fstdout"></a>Function: <strong>mbfl_file_compress_select_stdout</strong></dt>
<dt><a name="index-mbfl_005ffile_005fcompress_005fselect_005fnostdout"></a>Function: <strong>mbfl_file_compress_select_nostdout</strong></dt>
<dd><p>Select if the output must be sent to stdout or a file.  This takes
precedence over the keep/no keep configuration: if the output is sent to
stdout the original file is kept.
</p></dd></dl>


<a name="Actions"></a>
<h4 class="subsubheading">Actions</h4>

<p>Additional arguments to the selected compressor may be appended to the
invocation of the following functions and are handed to the compressor
unchanged.
</p>
<dl>
<dt><a name="index-mbfl_005ffile_005fcompress"></a>Function: <strong>mbfl_file_compress</strong> <em><var>PATHNAME</var> ?&hellip;?</em></dt>
<dd><p>Compress <var>PATHNAME</var>, a file pathname, with the currently selected
compressor program.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fdecompress"></a>Function: <strong>mbfl_file_decompress</strong> <em><var>PATHNAME</var> ?&hellip;?</em></dt>
<dd><p>Decompress <var>PATHNAME</var>, a file pathname, with the currently selected
compressor program.
</p></dd></dl>

<hr>
<a name="file-commands-stat"></a>
<div class="header">
<p>
Previous: <a href="#file-commands-compress" accesskey="p" rel="prev">file commands compress</a>, Up: <a href="#file-commands" accesskey="u" rel="up">file commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Inspecting-files-and-directories"></a>
<h4 class="subsection">6.2.11 Inspecting files and directories</h4>


<p>The <acronym>GNU</acronym> Coreutils package comes with a command line program
<code>stat</code> which implements advanced inspection of file and
directory status.  See <a href="http://www.gnu.org/software/coreutils/manual/coreutils#stat-invocation">(coreutils)Report file or file
system status</a>.
</p>

<dl>
<dt><a name="index-mbfl_005ffile_005fenable_005fstat"></a>Function: <strong>mbfl_file_enable_stat</strong></dt>
<dd><p>Declare the intention to use the program <code>stat</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fstat"></a>Function: <strong>mbfl_file_stat</strong> <em><var>pathname</var> <var>arg</var> &hellip;</em></dt>
<dd><p>Execute <code>stat</code> with <var>pathname</var> as first argument and
<var>arg</var> as other arguments.
</p>
<div class="example">
<pre class="example">mbfl_file_enable_stat

mbfl_file_stat /bin/ls --format='%F'
&rArr; 0
-| regular

mbfl_file_stat /bin --format='%F'
&rArr; 0
-| directory
</pre></div>
</dd></dl>

<hr>
<a name="file-testing"></a>
<div class="header">
<p>
Next: <a href="#file-read-and-write" accesskey="n" rel="next">file read and write</a>, Previous: <a href="#file-commands" accesskey="p" rel="prev">file commands</a>, Up: <a href="#file" accesskey="u" rel="up">file</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Testing-file-existence-and-the-like"></a>
<h3 class="section">6.3 Testing file existence and the like</h3>


<a name="index-Files_002c-existence-and-permissions"></a>
<a name="index-Existence-of-files"></a>


<p>When using the following functions: the optional argument
<var>PRINT_ERROR</var> will cause an error message to be printed with
<code>mbfl_message_error()</code> if the test fails; the argument value must be
<code>print_error</code>.
</p>

<a name="File-functions"></a>
<h4 class="subsubheading">File functions</h4>

<dl>
<dt><a name="index-mbfl_005ffile_005fexists"></a>Function: <strong>mbfl_file_exists</strong> <em><var>pathname</var></em></dt>
<dd><p>Return true if <var>pathname</var> exists.
</p></dd></dl>

<dl>
<dt><a name="index-mbfl_005ffile_005fis_005ffile"></a>Function: <strong>mbfl_file_is_file</strong> <em><var>filename</var></em></dt>
<dt><a name="index-mbfl_005ffile_005fis_005ffile-1"></a>Function: <strong>mbfl_file_is_file</strong> <em><var>filename</var> <var>PRINT_ERROR</var></em></dt>
<dd><p>Return true if <var>filename</var> is not the empty string and is a file.
</p></dd></dl>

<dl>
<dt><a name="index-mbfl_005ffile_005fis_005freadable"></a>Function: <strong>mbfl_file_is_readable</strong> <em><var>filename</var></em></dt>
<dt><a name="index-mbfl_005ffile_005fis_005freadable-1"></a>Function: <strong>mbfl_file_is_readable</strong> <em><var>filename</var> <var>PRINT_ERROR</var></em></dt>
<dd><p>Return true if <var>filename</var> is not the empty string, is a file and is
readable.
</p></dd></dl>

<dl>
<dt><a name="index-mbfl_005ffile_005fis_005fwritable"></a>Function: <strong>mbfl_file_is_writable</strong> <em><var>filename</var></em></dt>
<dt><a name="index-mbfl_005ffile_005fis_005fwritable-1"></a>Function: <strong>mbfl_file_is_writable</strong> <em><var>filename</var> <var>PRINT_ERROR</var></em></dt>
<dd><p>Return true if <var>filename</var> is not the empty string, is a file and is
writable.
</p></dd></dl>

<dl>
<dt><a name="index-mbfl_005ffile_005fis_005fexecutable"></a>Function: <strong>mbfl_file_is_executable</strong> <em><var>filename</var></em></dt>
<dt><a name="index-mbfl_005ffile_005fis_005fexecutable-1"></a>Function: <strong>mbfl_file_is_executable</strong> <em><var>filename</var> <var>PRINT_ERROR</var></em></dt>
<dd><p>Return true if <var>filename</var> is not the empty string, is a file and is
executable.
</p></dd></dl>


<a name="Directory-functions"></a>
<h4 class="subsubheading">Directory functions</h4>

<dl>
<dt><a name="index-mbfl_005ffile_005fis_005fdirectory"></a>Function: <strong>mbfl_file_is_directory</strong> <em><var>directory</var></em></dt>
<dt><a name="index-mbfl_005ffile_005fis_005fdirectory-1"></a>Function: <strong>mbfl_file_is_directory</strong> <em><var>directory</var> <var>PRINT_ERROR</var></em></dt>
<dd><p>Return true if <var>directory</var> is not the empty string and is a
directory.
</p></dd></dl>

<dl>
<dt><a name="index-mbfl_005ffile_005fdirectory_005fis_005freadable"></a>Function: <strong>mbfl_file_directory_is_readable</strong> <em><var>directory</var></em></dt>
<dt><a name="index-mbfl_005ffile_005fdirectory_005fis_005freadable-1"></a>Function: <strong>mbfl_file_directory_is_readable</strong> <em><var>directory</var> <var>PRINT_ERROR</var></em></dt>
<dd><p>Return true if <var>directory</var> is not the empty string, is a directory
and is readable.
</p></dd></dl>

<dl>
<dt><a name="index-mbfl_005ffile_005fdirectory_005fis_005fwritable"></a>Function: <strong>mbfl_file_directory_is_writable</strong> <em><var>directory</var></em></dt>
<dt><a name="index-mbfl_005ffile_005fdirectory_005fis_005fwritable-1"></a>Function: <strong>mbfl_file_directory_is_writable</strong> <em><var>directory</var> <var>PRINT_ERROR</var></em></dt>
<dd><p>Return true if <var>directory</var> is not the empty string, is a directory
and is writable.
</p></dd></dl>

<dl>
<dt><a name="index-mbfl_005ffile_005fdirectory_005fis_005fexecutable"></a>Function: <strong>mbfl_file_directory_is_executable</strong> <em><var>directory</var></em></dt>
<dt><a name="index-mbfl_005ffile_005fdirectory_005fis_005fexecutable-1"></a>Function: <strong>mbfl_file_directory_is_executable</strong> <em><var>directory</var> <var>PRINT_ERROR</var></em></dt>
<dd><p>Return true if <var>directory</var> is not the empty string, is a directory
and is executable.
</p></dd></dl>

<dl>
<dt><a name="index-mbfl_005ffile_005fdirectory_005fvalidate_005fwritability"></a>Function: <strong>mbfl_file_directory_validate_writability</strong> <em><var>directory</var> <var>description</var></em></dt>
<dd><p>Test directory existence and writability; return true if the directory
exists and is writable.  If the condition is not met: Print informative
messages using <var>description</var> to refer to the directory.
</p></dd></dl>


<a name="Symbolic-link-functions"></a>
<h4 class="subsubheading">Symbolic link functions</h4>

<dl>
<dt><a name="index-mbfl_005ffile_005fis_005fsymlink"></a>Function: <strong>mbfl_file_is_symlink</strong> <em><var>pathname</var></em></dt>
<dt><a name="index-mbfl_005ffile_005fis_005fsymlink-1"></a>Function: <strong>mbfl_file_is_symlink</strong> <em><var>pathname</var> <var>PRINT_ERROR</var></em></dt>
<dd><p>Return true if <var>pathname</var> is not the empty string and is a symbolic
link.
</p></dd></dl>


<a name="Generic-pathname-functions"></a>
<h4 class="subsubheading">Generic pathname functions</h4>

<dl>
<dt><a name="index-mbfl_005ffile_005fpathname_005fis_005freadable"></a>Function: <strong>mbfl_file_pathname_is_readable</strong> <em><var>pathname</var></em></dt>
<dt><a name="index-mbfl_005ffile_005fpathname_005fis_005freadable-1"></a>Function: <strong>mbfl_file_pathname_is_readable</strong> <em><var>pathname</var> <var>PRINT_ERROR</var></em></dt>
<dd><p>Return true if <var>pathname</var> is not the empty string and is readable.
</p></dd></dl>

<dl>
<dt><a name="index-mbfl_005ffile_005fpathname_005fis_005fwritable"></a>Function: <strong>mbfl_file_pathname_is_writable</strong> <em><var>pathname</var></em></dt>
<dt><a name="index-mbfl_005ffile_005fpathname_005fis_005fwritable-1"></a>Function: <strong>mbfl_file_pathname_is_writable</strong> <em><var>pathname</var> <var>PRINT_ERROR</var></em></dt>
<dd><p>Return true if <var>pathname</var> is not the empty string and is writable.
</p></dd></dl>

<dl>
<dt><a name="index-mbfl_005ffile_005fpathname_005fis_005fexecutable"></a>Function: <strong>mbfl_file_pathname_is_executable</strong> <em><var>pathname</var></em></dt>
<dt><a name="index-mbfl_005ffile_005fpathname_005fis_005fexecutable-1"></a>Function: <strong>mbfl_file_pathname_is_executable</strong> <em><var>pathname</var> <var>PRINT_ERROR</var></em></dt>
<dd><p>Return true if <var>pathname</var> is not the empty string and is
executable.
</p></dd></dl>

<hr>
<a name="file-read-and-write"></a>
<div class="header">
<p>
Next: <a href="#file-misc" accesskey="n" rel="next">file misc</a>, Previous: <a href="#file-testing" accesskey="p" rel="prev">file testing</a>, Up: <a href="#file" accesskey="u" rel="up">file</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Reading-and-writing-files-with-privileges"></a>
<h3 class="section">6.4 Reading and writing files with privileges</h3>


<a name="index-Files_002c-reading-and-writing"></a>
<a name="index-Reading-and-writing-files"></a>
<a name="index-Writing-and-reading-files"></a>


<p>The following functions perform actions that can normally be done
directly with the redirection operators of Bash:
</p>
<div class="example">
<pre class="example"># write to a file
printf '%s' &quot;$string&quot; &gt;&quot;$filename&quot;

# append to a file
printf '%s' &quot;$string&quot; &gt;&gt;&quot;$filename&quot;

# read a file, print contents
printf '%s' &quot;$(&lt;$filename)&quot;
</pre></div>

<p>The functions act differently in that they spawn a <code>bash</code>
subprocess, by invoking <code>mbfl_program_exec()</code>, and let it do the
operation; this allows us to request the usage of <code>sudo</code> and so
to read and write files with modified privileges, but only for the time
needed to do the operation, not for the whole script.
</p>

<dl>
<dt><a name="index-mbfl_005ffile_005fwrite"></a>Function: <strong>mbfl_file_write</strong> <em><var>string</var> <var>filename</var></em></dt>
<dd><p>Write <var>string</var> to <var>filename</var>, eventually creating it or
overwriting old contents.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fappend"></a>Function: <strong>mbfl_file_append</strong> <em><var>string</var> <var>filename</var></em></dt>
<dd><p>Append <var>string</var> to <var>filename</var>, eventually creating it.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005ffile_005fread"></a>Function: <strong>mbfl_file_read</strong> <em><var>filename</var></em></dt>
<dd><p>Read and print <strong>all</strong> the contents of <var>filename</var>.
</p></dd></dl>

<hr>
<a name="file-misc"></a>
<div class="header">
<p>
Previous: <a href="#file-read-and-write" accesskey="p" rel="prev">file read and write</a>, Up: <a href="#file" accesskey="u" rel="up">file</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Miscellaneous-commands"></a>
<h3 class="section">6.5 Miscellaneous commands</h3>


<a name="index-Changing-directory"></a>
<a name="index-Directory_002c-changing"></a>
<a name="index-Files_002c-changing-directory"></a>


<dl>
<dt><a name="index-mbfl_005fchange_005fdirectory"></a>Function: <strong>mbfl_change_directory</strong> <em><var>dirname</var> ?...?</em></dt>
<dd><p>Change directory to <var>dirname</var>.  Optional flags to <code>cd</code> may
be appended.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fcd"></a>Function: <strong>mbfl_cd</strong> <em><var>dirname</var> ?...?</em></dt>
<dd><p>Wrapper for <code>mbfl_change_directory()</code>.  If verbose mode is on:
print a message.
</p></dd></dl>

<hr>
<a name="actions"></a>
<div class="header">
<p>
Next: <a href="#getopts" accesskey="n" rel="next">getopts</a>, Previous: <a href="#file" accesskey="p" rel="prev">file</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Selecting-actions-to-perform"></a>
<h2 class="chapter">7 Selecting actions to perform</h2>


<p>The <code>actions</code> module allows the command line selection of different
actions a script can perform.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#actions-intro" accesskey="1">actions intro</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Introduction to action trees.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#actions-declare" accesskey="2">actions declare</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Declaring actions and action sets.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#actions-dispatch" accesskey="3">actions dispatch</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Dispatching action arguments.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#actions-inspect" accesskey="4">actions inspect</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Inspecting action trees.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#actions-misc" accesskey="5">actions misc</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Other functions.
</td></tr>
</table>

<hr>
<a name="actions-intro"></a>
<div class="header">
<p>
Next: <a href="#actions-declare" accesskey="n" rel="next">actions declare</a>, Up: <a href="#actions" accesskey="u" rel="up">actions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Introduction-to-action-trees"></a>
<h3 class="section">7.1 Introduction to action trees</h3>


<p>Traditional Unix&ndash;style command line programs perform a single action,
with behaviour variants selected by command line dash and double&ndash;dash
options.  For example <code>ls</code> prints a list of directory entries
and the format of the output can be custommised with options like
<samp>-1</samp> and <samp>--color</samp>.  <acronym>MBFL</acronym> implements this behaviour by
default when the <code>actions</code> module is <strong>not</strong> used.
</p>
<p>Other Unix&ndash;style command line programs offer a set of possible actions
and allow the executor to select one by specifying command line options.
For example <code>tar</code> acts on archive files and it can pack, unpack,
validate them along with other actions selected with by the double&ndash;dash
options <samp>--create</samp>, <samp>--extract</samp>, <samp>--validate</samp> and
others.  <acronym>MBFL</acronym> implements this behaviour through &ldquo;action options&rdquo;
provided by the <code>getopts</code> module; action options are available also
when using the <code>actions</code> module.
</p>
<p>Other command line programs break this Unix&ndash;style to offer action
selection throuh &ldquo;action arguments&rdquo;.  For example <code>git</code> acts
upon revision control repositories offering a big set of actions
selected with its first argument: &lsquo;<samp>commit</samp>&rsquo;, &lsquo;<samp>log</samp>&rsquo;,
&lsquo;<samp>merge</samp>&rsquo; and many others; the behaviour of each &ldquo;subcommand&rdquo; can
be customised with a specific set of dash and double&ndash;dash options.
<acronym>MBFL</acronym> implements this behaviour through the <code>actions</code> module.
</p>

<a name="One_002d_002dlevel-actions"></a>
<h4 class="subsubheading">One&ndash;level actions</h4>


<p>The script below (<samp>one-level-actions.sh</samp>, available in the
<samp>doc/</samp> directory of the source distribution) shows how to implement
one&ndash;level actions.  It implements the following behaviour:
</p>
<dl compact="compact">
<dt><code>one-level-actions.sh</code></dt>
<dd><p>With no action argument: print a generic help screen and exit.
</p>
</dd>
<dt><code>one-level-actions.sh one</code></dt>
<dd><p>With the action argument <code>one</code>: perform the action &lsquo;<samp>ONE</samp>&rsquo;,
possibly with the options <samp>-a</samp> and <samp>-b</samp>.
</p>
</dd>
<dt><code>one-level-actions.sh one -H</code></dt>
<dd><p>With the action argument <code>one</code> and the option <samp>-H</samp>: print
the brief help screen for the action &lsquo;<samp>ONE</samp>&rsquo; and exit.
</p>
</dd>
<dt><code>one-level-actions.sh two</code></dt>
<dd><p>With the action argument <code>two</code>: perform the action &lsquo;<samp>TWO</samp>&rsquo;,
possibly with the options <samp>-d</samp> and <samp>-g</samp>.
</p>
</dd>
<dt><code>one-level-actions.sh two -H</code></dt>
<dd><p>With the action argument <code>two</code> and the option <samp>-H</samp>: print
the brief help screen for the action &lsquo;<samp>TWO</samp>&rsquo; and exit.
</p>
</dd>
<dt><code>one-level-actions.sh help</code></dt>
<dd><p>With the action argument <code>help</code>: print a generic help screen and
exit.  Notice how the &lsquo;<samp>HELP</samp>&rsquo; action function makes use of
<code>mbfl_actions_fake_action_set()</code> to print the same help screen of the
main action.
</p></dd>
</dl>

<div class="smallexample">
<pre class="verbatim"># one-level-actions.sh --

script_PROGNAME=one-level-actions.sh
script_VERSION=1.0
script_COPYRIGHT_YEARS='2013'
script_AUTHOR='Marco Maggi'
script_LICENSE=BSD
script_USAGE=&quot;usage: ${script_PROGNAME} [action] [options]&quot;
script_DESCRIPTION='Example script showing action arguments.'
script_EXAMPLES=

source &quot;${MBFL_LIBRARY:=$(mbfl-config)}&quot;

mbfl_declare_action_set MAIN
mbfl_declare_action MAIN ONE  NONE one  'Do main action one.'
mbfl_declare_action MAIN TWO  NONE two  'Do main action two.'
mbfl_declare_action MAIN HELP NONE help 'Do main action help.'

function script_before_parsing_options_ONE () {
    script_USAGE=&quot;usage: ${script_PROGNAME} one [options]&quot;
    script_DESCRIPTION='Example action tree: one.'
    mbfl_declare_option ALPHA no a alpha noarg 'Enable option alpha.'
    mbfl_declare_option BETA  '' b beta  witharg 'Set option beta.'
}
function script_before_parsing_options_TWO () {
    script_USAGE=&quot;usage: ${script_PROGNAME} two [options]&quot;
    script_DESCRIPTION='Example action tree: two.'
    mbfl_declare_option DELTA no d delta noarg 'Enable option delta.'
    mbfl_declare_option GAMMA '' g gamma witharg 'Set option gamma.'
}
function main () {
    mbfl_main_print_usage_screen_brief
}
function script_action_HELP () {
    mbfl_actions_fake_action_set MAIN
    mbfl_main_print_usage_screen_brief
}
function script_action_ONE () {
    printf 'performing action one: alpha=%s, beta=%s\n' \
        &quot;$script_option_ALPHA&quot; &quot;$script_option_beta&quot;
}
function script_action_TWO () {
    printf 'performing action two: delta=%s, gamma=%s\n' \
        &quot;$script_option_DELTA&quot; &quot;$script_option_GAMMA&quot;
}
mbfl_main

### end of file
# Local Variables:
# mode: sh
# End:
</pre></div>


<a name="Two_002d_002dlevels-actions"></a>
<h4 class="subsubheading">Two&ndash;levels actions</h4>


<p>The script below (<samp>two-levels-actions.sh</samp>, available in the
<samp>doc/</samp> directory of the source distribution) shows how to implement
two&ndash;levels actions.  It implements the following behaviour:
</p>
<dl compact="compact">
<dt><code>two-levels-actions.sh</code></dt>
<dd><p>With no action argument: print a generic help screen and exit.
</p>
</dd>
<dt><code>two-levels-actions.sh help</code></dt>
<dd><p>With the action argument <code>help</code>: print a generic help screen and
exit.  Notice how the &lsquo;<samp>HELP</samp>&rsquo; action function makes use of
<code>mbfl_actions_fake_action_set()</code> to print the same help screen of the
main action.
</p>
</dd>
<dt><code>two-levels-actions.sh one</code></dt>
<dd><p>With the non&ndash;leaf action argument <code>one</code>: print the help screen of
the action &lsquo;<samp>ONE</samp>&rsquo;.
</p>
</dd>
<dt><code>two-levels-actions.sh two</code></dt>
<dd><p>With the non&ndash;leaf action argument <code>two</code>: print the help screen of
the action &lsquo;<samp>TWO</samp>&rsquo;.
</p>
</dd>
<dt><code>two-levels-actions.sh one red</code></dt>
<dd><p>With the action arguments <code>one red</code>: perform the action &lsquo;<samp>RED</samp>&rsquo;,
possibly with the options <samp>-a</samp> and <samp>-b</samp>.
</p>
</dd>
<dt><code>two-levels-actions.sh one red -H</code></dt>
<dd><p>With the action argument <code>one red</code> and the option <samp>-H</samp>:
print the brief help screen for the action &lsquo;<samp>RED</samp>&rsquo; and exit.
</p>
</dd>
<dt><code>two-levels-actions.sh one blue</code></dt>
<dd><p>With the action arguments <code>one blue</code>: perform the action
&lsquo;<samp>BLUE</samp>&rsquo;, possibly with the options <samp>-a</samp> and <samp>-b</samp>.
</p>
</dd>
<dt><code>two-levels-actions.sh one blue -H</code></dt>
<dd><p>With the action argument <code>one blue</code> and the option <samp>-H</samp>:
print the brief help screen for the action &lsquo;<samp>BLUE</samp>&rsquo; and exit.
</p>
</dd>
<dt><code>two-levels-actions.sh two green</code></dt>
<dd><p>With the action arguments <code>two green</code>: perform the action
&lsquo;<samp>GREEN</samp>&rsquo;, possibly with the options <samp>-d</samp> and <samp>-g</samp>.
</p>
</dd>
<dt><code>two-levels-actions.sh two green -H</code></dt>
<dd><p>With the action argument <code>two green</code> and the option <samp>-H</samp>:
print the brief help screen for the action &lsquo;<samp>GREEN</samp>&rsquo; exit.
</p>
</dd>
<dt><code>two-levels-actions.sh two cyan</code></dt>
<dd><p>With the action arguments <code>two cyan</code>: perform the action
&lsquo;<samp>CYAN</samp>&rsquo;, possibly with the options <samp>-d</samp> and <samp>-g</samp>.
</p>
</dd>
<dt><code>two-levels-actions.sh two cyan -H</code></dt>
<dd><p>With the action argument <code>two cyan</code> and the option <samp>-H</samp>:
print the brief help screen for the action &lsquo;<samp>CYAN</samp>&rsquo; exit.
</p></dd>
</dl>

<p>notice how the action functions of the non&ndash;leaf nodes print the help
screen describing the subactions.
</p>
<div class="smallexample">
<pre class="verbatim"># two-level-actions.sh --

script_PROGNAME=two-levels-actions.sh
script_VERSION=1.0
script_COPYRIGHT_YEARS='2013'
script_AUTHOR='Marco Maggi'
script_LICENSE=BSD
script_USAGE=&quot;usage: ${script_PROGNAME} [action] [subaction] [options]&quot;
script_DESCRIPTION='Example script showing action arguments.'
script_EXAMPLES=

source &quot;${MBFL_LIBRARY:=$(mbfl-config)}&quot;

mbfl_declare_action_set ONE
mbfl_declare_action ONE RED  NONE red  'Do main action one red.'
mbfl_declare_action ONE BLUE NONE blue 'Do main action one blue.'

mbfl_declare_action_set TWO
mbfl_declare_action TWO GREEN NONE green 'Do main action one green.'
mbfl_declare_action TWO CYAN  NONE cyan  'Do main action one cyan.'

mbfl_declare_action_set MAIN
mbfl_declare_action MAIN ONE  ONE  one  'Do main action one.'
mbfl_declare_action MAIN TWO  TWO  two  'Do main action two.'
mbfl_declare_action MAIN HELP NONE help 'Do main action help.'

function script_before_parsing_options_ONE () {
    script_USAGE=&quot;usage: ${script_PROGNAME} one [action] [options]&quot;
    script_DESCRIPTION='Example action tree: one.'
}
function script_before_parsing_options_TWO () {
    script_USAGE=&quot;usage: ${script_PROGNAME} two [action] [options]&quot;
    script_DESCRIPTION='Example action tree: two.'
}

function script_before_parsing_options_RED () {
    script_USAGE=&quot;usage: ${script_PROGNAME} one red [options]&quot;
    script_DESCRIPTION='Example action tree: one red.'
    mbfl_declare_option ALPHA no a alpha noarg 'Enable option alpha.'
    mbfl_declare_option BETA  '' b beta  witharg 'Set option beta.'
}
function script_before_parsing_options_BLUE () {
    script_USAGE=&quot;usage: ${script_PROGNAME} one blue [options]&quot;
    script_DESCRIPTION='Example action tree: one blue.'
    mbfl_declare_option DELTA no d delta noarg 'Enable option delta.'
    mbfl_declare_option GAMMA '' g gamma witharg 'Set option gamma.'
}
function script_before_parsing_options_GREEN () {
    script_USAGE=&quot;usage: ${script_PROGNAME} two green [options]&quot;
    script_DESCRIPTION='Example action tree: two green.'
    mbfl_declare_option ALPHA no a alpha noarg 'Enable option alpha.'
    mbfl_declare_option BETA  '' b beta  witharg 'Set option beta.'
}
function script_before_parsing_options_CYAN () {
    script_USAGE=&quot;usage: ${script_PROGNAME} two cyan [options]&quot;
    script_DESCRIPTION='Example action tree: two cyan.'
    mbfl_declare_option DELTA no d delta noarg 'Enable option delta.'
    mbfl_declare_option GAMMA '' g gamma witharg 'Set option gamma.'
}

function main () {
    mbfl_main_print_usage_screen_brief
}
function script_action_ONE () {
    mbfl_main_print_usage_screen_brief
}
function script_action_TWO () {
    mbfl_main_print_usage_screen_brief
}
function script_action_HELP () {
    mbfl_actions_fake_action_set MAIN
    mbfl_main_print_usage_screen_brief
}

function script_action_RED () {
    printf 'performing action red: alpha=%s, beta=%s\n' \
        &quot;$script_option_ALPHA&quot; &quot;$script_option_BETA&quot;
}
function script_action_BLUE () {
    printf 'performing action blue: delta=%s, gamma=%s\n' \
        &quot;$script_option_DELTA&quot; &quot;$script_option_GAMMA&quot;
}
function script_action_GREEN () {
    printf 'performing action green: alpha=%s, beta=%s\n' \
        &quot;$script_option_ALPHA&quot; &quot;$script_option_BETA&quot;
}
function script_action_CYAN () {
    printf 'performing action cyan: delta=%s, gamma=%s\n' \
        &quot;$script_option_DELTA&quot; &quot;$script_option_GAMMA&quot;
}

mbfl_main

### end of file
# Local Variables:
# mode: sh
# End:
</pre></div>

<hr>
<a name="actions-declare"></a>
<div class="header">
<p>
Next: <a href="#actions-dispatch" accesskey="n" rel="next">actions dispatch</a>, Previous: <a href="#actions-intro" accesskey="p" rel="prev">actions intro</a>, Up: <a href="#actions" accesskey="u" rel="up">actions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Declaring-actions-and-action-sets"></a>
<h3 class="section">7.2 Declaring actions and action sets</h3>


<p>The structure of the action sets tree is stored in global variables
defined by default; we should never try to access such variables
directly.
</p>

<dl>
<dt><a name="index-mbfl_005fdeclare_005faction_005fset"></a>Function: <strong>mbfl_declare_action_set</strong> <em><var>action-set</var></em></dt>
<dd><p>Declare a new action set.  <var>action-set</var> must be a string satisfying
<code>mbfl_string_is_name()</code> and representing the identifier of the action
set.  It is an error to declare the same action set twice.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fdeclare_005faction"></a>Function: <strong>mbfl_declare_action</strong> <em><var>action-set</var> <var>keyword</var> <var>subset</var> <var>identifier</var> <var>description</var></em></dt>
<dd><p>Declare a new action belonging to an action set.  The arguments are:
</p>
<dl compact="compact">
<dt><var>action-set</var></dt>
<dd><p>A string representing the name of the action set this action belongs to.
The action set must have been previously declared with a call to
<code>mbfl_declare_action_set()</code>.
</p>
</dd>
<dt><var>keyword</var></dt>
<dd><p>A unique string (in this script) satisfying <code>mbfl_string_is_name()</code>
and identifying this action.  The &ldquo;main&rdquo;, &ldquo;before parsing options&rdquo;
and &ldquo;after parsing options&rdquo; function names associated to this action
are built as:
</p>
<div class="example">
<pre class="example">script_action_$<var>keyword</var>
script_before_parsing_options_$<var>keyword</var>
script_after_parsing_options_$<var>keyword</var>
</pre></div>

</dd>
<dt><var>subset</var></dt>
<dd><p>If <var>subset</var> is the string <code>NONE</code> it means that this action is a
leaf and it implements a script action; else <var>subset</var> must be the
identifier of an action set subordinate to <var>action-set</var>: this
function is recursively called to process it.  The subordinate action
set must have been previously declared with a call to
<code>mbfl_declare_action_set()</code>.
</p>
</dd>
<dt><var>identifier</var></dt>
<dd><p>A string satisfying <code>mbfl_string_is_identifier()</code> and representing
the argument on the command line used to select this action.  This
string must be unique for this <var>action-set</var>.
</p>
</dd>
<dt><var>description</var></dt>
<dd><p>A string describing this action, to be used to compose the help screen.
</p></dd>
</dl>
</dd></dl>

<hr>
<a name="actions-dispatch"></a>
<div class="header">
<p>
Next: <a href="#actions-inspect" accesskey="n" rel="next">actions inspect</a>, Previous: <a href="#actions-declare" accesskey="p" rel="prev">actions declare</a>, Up: <a href="#actions" accesskey="u" rel="up">actions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Dispatching-action-arguments"></a>
<h3 class="section">7.3 Dispatching action arguments</h3>


<dl>
<dt><a name="index-mbfl_005factions_005fdispatch"></a>Function: <strong>mbfl_actions_dispatch</strong> <em><var>action-set</var></em></dt>
<dd><p>Parse the next command line argument and select accordingly the
functions for the main module making use of the functions:
</p>
<div class="example">
<pre class="example">mbfl_main_set_before_parsing_options
mbfl_main_set_after_parsing_options
mbfl_main_set_main
</pre></div>

<p>If successful return true, else return false and print an error message
to <code>stderr</code>.  This function recursively calls itself, parsing
command line arguments and traversing the tree of declared actions.
</p>
<p><var>action-set</var> must be the name of an action set previously declared
with <code>mbfl_declare_action_set()</code>.  It is an error if this function is
called with an <var>action-set</var> name specifying a non&ndash;existent action
set.  If there are no command line arguments left upon entering this
function: the values previously selected are silently accepted.
</p>
<p>The function <code>mbfl_main()</code> verifies that the action set <code>MAIN</code>
exists and, if it does, it calls this function with argument
<code>MAIN</code>.
</p>
<p>Upon entering this function, the following global variables must exist
and have the specified values:
</p>
<dl compact="compact">
<dt><code>ARGV1</code></dt>
<dd><p>An array containing all the command line arguments.
</p>
</dd>
<dt><code>ARGC1</code></dt>
<dd><p>A non&ndash;negative integer representing the number of values in
<code>ARGV1</code>.
</p>
</dd>
<dt><code>ARG1ST</code></dt>
<dd><p>A non&ndash;negative integer representing the index in <code>ARGV1</code> of the
next argument to be processed.
</p></dd>
</dl>

<p>all these variables are created by default by the <acronym>MBFL</acronym> <code>main</code>
module, <a href="#main-variables">Command line arguments variables</a>.
</p></dd></dl>

<hr>
<a name="actions-inspect"></a>
<div class="header">
<p>
Next: <a href="#actions-misc" accesskey="n" rel="next">actions misc</a>, Previous: <a href="#actions-dispatch" accesskey="p" rel="prev">actions dispatch</a>, Up: <a href="#actions" accesskey="u" rel="up">actions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Inspecting-action-trees"></a>
<h3 class="section">7.4 Inspecting action trees</h3>


<dl>
<dt><a name="index-mbfl_005factions_005fset_005fexists"></a>Function: <strong>mbfl_actions_set_exists</strong> <em><var>action-set</var></em></dt>
<dd><p>Return true if <var>action-set</var> is the identifier of an existent action
set; else return false.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005factions_005fset_005fexists_005for_005fnone"></a>Function: <strong>mbfl_actions_set_exists_or_none</strong> <em><var>action-set</var></em></dt>
<dd><p>Return true if <var>action-set</var> is the identifier of an existent action
set or it is the string <code>NONE</code>; else return false.
</p></dd></dl>

<hr>
<a name="actions-misc"></a>
<div class="header">
<p>
Previous: <a href="#actions-inspect" accesskey="p" rel="prev">actions inspect</a>, Up: <a href="#actions" accesskey="u" rel="up">actions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Other-functions"></a>
<h3 class="section">7.5 Other functions</h3>


<dl>
<dt><a name="index-mbfl_005factions_005ffake_005faction_005fset"></a>Function: <strong>mbfl_actions_fake_action_set</strong> <em><var>action-set</var></em></dt>
<dd><p>Mutate <acronym>MBFL</acronym> state to mimic the selection of an action set.  It is an
error if <var>action-set</var> is not the name of an existent action set.
This function should be used with care.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005factions_005fprint_005fusage_005fscreen"></a>Function: <strong>mbfl_actions_print_usage_screen</strong></dt>
<dd><p>If an action set has been selected and its name is not &lsquo;<samp>NONE</samp>&rsquo;:
print the help screen documenting the available actions.
</p></dd></dl>

<hr>
<a name="getopts"></a>
<div class="header">
<p>
Next: <a href="#message" accesskey="n" rel="next">message</a>, Previous: <a href="#actions" accesskey="p" rel="prev">actions</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Parsing-command-line-options"></a>
<h2 class="chapter">8 Parsing command line options</h2>


<a name="index-Parsing-command-line-options"></a>
<a name="index-Command-line-options_002c-parsing"></a>
<a name="index-Program-command-line-options_002c-parsing"></a>


<p>The <code>getopts</code> module defines a set of procedures to be used to
process command line arguments with the following format:
</p>
<dl compact="compact">
<dt><code>-a</code></dt>
<dd><p>Brief option <code>a</code> with no value.
</p>
</dd>
<dt><code>-a123</code></dt>
<dd><p>Brief option <code>a</code> with value <code>123</code>.
</p>
</dd>
<dt><code>--bianco</code></dt>
<dd><p>Long option <code>bianco</code> with no value.
</p>
</dd>
<dt><code>--color=bianco</code></dt>
<dd><p>Long option <code>color</code> with value <code>bianco</code>.
</p></dd>
</dl>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#getopts-arguments" accesskey="1">getopts arguments</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Arguments.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#getopts-usage" accesskey="2">getopts usage</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Using the module.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#getopts-options" accesskey="3">getopts options</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Predefined options.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#getopts-interface" accesskey="4">getopts interface</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Interface functions.
</td></tr>
</table>

<hr>
<a name="getopts-arguments"></a>
<div class="header">
<p>
Next: <a href="#getopts-usage" accesskey="n" rel="next">getopts usage</a>, Up: <a href="#getopts" accesskey="u" rel="up">getopts</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Arguments"></a>
<h3 class="section">8.1 Arguments</h3>


<p>The <code>main</code> module contains, at the root level, a block of code like
the following:
</p>
<div class="example">
<pre class="example">declare -i ARGC=0 ARGC1=0 ARG1ST=0
declare -a ARGV ARGV1

for ((ARGC1=0; $# &gt; 0; ++ARGC1))
do
    ARGV1[$ARGC1]=$1
    shift
done
</pre></div>

<p>this block is executed when <acronym>MBFL</acronym> (and the script that loads it) is
evaluated.  Its purpose is to store command line arguments in the global
array <code>ARGV1</code> and the number of command line arguments in the
global variable <code>ARGC1</code>; the variable <code>ARG1ST</code> references the
next argument in <code>ARGV1</code> that must be processed.
</p>
<p>The global array <code>ARGV</code> and the global variable <code>ARGC</code> are
predefined and should be used by the <code>mbfl_getopts_*</code> functions to
store non&ndash;option command line arguments.  Processing performed by the
<code>getopts</code> module must happen after processing performed by the
<code>actions</code> module.
</p>
<p>Example:
</p>
<div class="example">
<pre class="example">$ script --gulp wo --gasp=123 wa
</pre></div>

<p>if the script makes use of <acronym>MBFL</acronym>, the strings <code>wo</code> and <code>wa</code>
will go into <code>ARGV</code> and <code>ARGC</code> will be set to 2.  The option
arguments are processed and some action is performed to register them.
</p>
<p>We can access the non&ndash;option arguments with the following code:
</p>
<div class="example">
<pre class="example">for ((i=0; $i &lt; $ARGC; ++i))
do
    # do something with ${ARGV[$i]}
done
</pre></div>

<p>When using the <code>actions</code> module: the first arguments can be
interpreted as special values that select an action to be performed by
the script; in such case the first argument is removed from the
<code>ARGV</code> array, so that processing the other arguments is not
affected.  <a href="#actions-intro">Introduction to action trees</a>.
</p>
<hr>
<a name="getopts-usage"></a>
<div class="header">
<p>
Next: <a href="#getopts-options" accesskey="n" rel="next">getopts options</a>, Previous: <a href="#getopts-arguments" accesskey="p" rel="prev">getopts arguments</a>, Up: <a href="#getopts" accesskey="u" rel="up">getopts</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Using-the-module"></a>
<h3 class="section">8.2 Using the module</h3>


<p>To use this module we have to declare a set of script options with the
function <code>mbfl_declare_option()</code>.  Options declarations should be
done at the beginning of the script, before doing anything else, or in
the &ldquo;before parsing options&rdquo; functions.
</p>
<p>In the main block of the script, options are parsed by invoking
<code>mbfl_getopts_parse()</code>: this function will update global variables
and invoke a script function for each option on the command line.  It
can also select a function to be invoked as the main action of the
script.
</p>

<a name="Option-with-no-argument"></a>
<h4 class="subsubheading">Option with no argument</h4>

<p>Example of option declaration:
</p>
<div class="example">
<pre class="example">mbfl_declare_option ALPHA no a alpha noarg &quot;enable alpha option&quot;
</pre></div>

<p>this code declares an option with no argument having properties:
</p>
<ul>
<li> Global variable <code>script_option_ALPHA</code>, which will be set to
<code>no</code> by default and to <code>yes</code> if the option is used.

</li><li> Brief switch <samp>-a</samp>.

</li><li> Long switch <samp>--alpha</samp>.

</li><li> Description <code>enable alpha option</code>, to be shown in the usage help
screen.
</li></ul>

<p>If the option is used: the function <code>script_option_update_alpha</code> is
invoked (if it exists) with no arguments, after the variable
<code>script_option_ALPHA</code> has been set to <code>yes</code>.  Valid option
uses are:
</p>
<div class="example">
<pre class="example">$ script.sh -a
$ script.sh --alpha
</pre></div>


<a name="Option-with-argument"></a>
<h4 class="subsubheading">Option with argument</h4>

<p>Example of option declaration:
</p>
<div class="example">
<pre class="example">mbfl_declare_option BETA 123 b beta witharg &quot;select beta value&quot;
</pre></div>

<p>this code declares an option with argument having properties:
</p>
<ul>
<li> Global variable <code>script_option_BETA</code>, which will be set to
<code>123</code> by default and to the value selected on the command line if
the option is used.

</li><li> Brief switch <samp>-b</samp>.

</li><li> Long switch <samp>--beta</samp>.

</li><li> Description <code>select beta value</code>, to be shown in the usage output.
</li></ul>

<p>If the option is used: the function <code>script_option_update_beta</code> is
invoked (if it exists) with no arguments, after the variable
<code>script_option_BETA</code> has been set to the selected value.  Valid
option uses are:
</p>
<div class="example">
<pre class="example">$ script.sh -b456
$ script.sh --beta=456
</pre></div>

<p>it is an error to use the switch <samp>-b</samp> or  <samp>--beta</samp> with
no argument (that is: with an empty string as argument).
</p>

<a name="Action-options"></a>
<h4 class="subsubheading">Action options</h4>

<p>A special option example:
</p>
<div class="example">
<pre class="example">mbfl_declare_option ACTION_GAMMA \
   no g gamma noarg &quot;do gamma action&quot;
mbfl_declare_option ACTION_DELTA \
   yes d delta noarg &quot;do delta action&quot;
</pre></div>

<p>this code declares two options with no arguments; the difference from
the other declarations is that the keywords are prefixed with
<code>ACTION_</code>: this prefix is recognised by the module and causes, if
the option is used on the command line, the following code to be
evaluated at arguments parsing time:
</p>
<div class="example">
<pre class="example">mbfl_main_set_main script_action_gamma
</pre></div>

<p>or:
</p>
<div class="example">
<pre class="example">mbfl_main_set_main script_action_delta
</pre></div>

<p>where the argument <code>script_action_gamma</code> is built by prefixing the
lower case version of the keyword with <code>script_</code>.  The code selects
a function as main function for the script.  <a href="#main-function">Driving
script execution</a>.
</p>
<p>Additionally, if the default value is <code>yes</code>: the main function is
selected at declaration time (that is by <code>mbfl_declare_option()</code>);
this is useful to declare an action option and select automatically the
action function.  In the example: the function
<code>script_action_delta()</code> is selected as main action function.
</p>
<p>It is an error to declare a keyword prefixed with <code>ACTION_</code> with an
option with argument (<code>witharg</code> as argument to
<code>mbfl_declare_option()</code>).
</p>
<hr>
<a name="getopts-options"></a>
<div class="header">
<p>
Next: <a href="#getopts-interface" accesskey="n" rel="next">getopts interface</a>, Previous: <a href="#getopts-usage" accesskey="p" rel="prev">getopts usage</a>, Up: <a href="#getopts" accesskey="u" rel="up">getopts</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Predefined-options"></a>
<h3 class="section">8.3 Predefined options</h3>


<p>A set of predefined options is recognised by the library and not handed
to the user defined functions.
</p>
<dl compact="compact">
<dt><samp>--tmpdir=DIR</samp></dt>
<dd><a name="index-_002d_002dtmpdir_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dtmpdir"></a>
<p>Selects a directory for temporary files.  The default value is the one in
the environment variable <code>TMPDIR</code>, or <samp>/tmp/$USER</samp> if that
variable is not set.  The value is stored in the variable
<code>mbfl_option_TMPDIR</code>.
</p>
</dd>
<dt><samp>--encoded-args</samp></dt>
<dd><a name="index-_002d_002dencoded_002dargs_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dencoded_002dargs"></a>
<p>Signals to the library that the non&ndash;option arguments and the option
values are encoded in hexadecimal strings.  Encoding is useful to avoid
quoting problems when invoking a script from another one.
</p>
<p>If this option is used: the values are decoded by
<code>mbfl_getopts_parse()</code> before storing them in the <code>ARGV</code>
array and before being stored in the option&rsquo;s specific global variables.
</p>
</dd>
<dt><samp>-v</samp></dt>
<dt><samp>--verbose</samp></dt>
<dd><a name="index-_002dv_002c-predefined-option"></a>
<a name="index-Predefined-option-_002dv"></a>
<a name="index-_002d_002dverbose_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dverbose"></a>
<p>Turns on verbose messages.  If this option is used: The function
<code>mbfl_option_verbose()</code> returns true.  <a href="#message">Printing
messages to the console</a>.
</p>
</dd>
<dt><samp>--silent</samp></dt>
<dd><a name="index-_002d_002dsilent_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dsilent"></a>
<p>Turns off verbose messages.  If this option is used: The function
<code>mbfl_option_verbose()</code> returns false.
</p>
</dd>
<dt><samp>--verbose-program</samp></dt>
<dd><a name="index-_002d_002dverbose_002dprogram_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dverbose_002dprogram"></a>
<p>If used: The <samp>--verbose</samp> option is added to the command line of
external programs that support it.  The function
<code>mbfl_option_verbose_program()</code> returns true or false depending on
the state of this option.
</p>
</dd>
<dt><samp>--show-program</samp></dt>
<dt><samp>--show-programs</samp></dt>
<dd><a name="index-_002d_002dshow_002dprogram_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dshow_002dprogram"></a>
<a name="index-_002d_002dshow_002dprograms_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dshow_002dprograms"></a>
<p>Prints the command line of executed external programs.
</p>
</dd>
<dt><samp>--debug</samp></dt>
<dd><a name="index-_002d_002ddebug_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002ddebug"></a>
<p>Turns on debugging messages.  Automatically turns on verbose messages
and program showing.  <a href="#message">Printing messages to the console</a>.
</p>
</dd>
<dt><samp>--test</samp></dt>
<dd><a name="index-_002d_002dtest_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dtest"></a>
<p>Turns on test execution.  <a href="#program-testing">Testing a script and
external programs</a>.
</p>
</dd>
<dt><samp>--null</samp></dt>
<dd><a name="index-_002d_002dnull_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dnull"></a>
<p>Signals to the script that it has to use the null character to separate
values, instead of the common newline.  The global variable
<code>mbfl_option_NULL</code> is set to <code>yes</code>.
</p>
</dd>
<dt><samp>-f</samp></dt>
<dt><samp>--force</samp></dt>
<dd><a name="index-_002df_002c-predefined-option"></a>
<a name="index-Predefined-option-_002df"></a>
<a name="index-_002d_002dforce_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dforce"></a>
<p>Signals to the script that it does <strong>not</strong> have to query the user
before doing dangerous operations, like overwriting files.  The global
variable <code>mbfl_option_INTERACTIVE</code> is set to <code>no</code>.
</p>
</dd>
<dt><samp>-i</samp></dt>
<dt><samp>--interactive</samp></dt>
<dd><a name="index-_002di_002c-predefined-option"></a>
<a name="index-Predefined-option-_002di"></a>
<a name="index-_002d_002dinteractive_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dinteractive"></a>
<p>Signals to the script that it <strong>does</strong> have to query the user
before doing dangerous operations, like overwriting files.  The global
variable <code>mbfl_option_INTERACTIVE</code> is set to <code>yes</code>.
</p>
</dd>
<dt><samp>--validate-programs</samp></dt>
<dd><a name="index-_002d_002dvalidate_002dprograms_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dvalidate_002dprograms"></a>
<p>Validates the existence of all the programs needed by the script; then
exits.  The exit code is zero if all the programs were found, one
otherwise.
</p>
</dd>
<dt><samp>--list-exit-codes</samp></dt>
<dd><a name="index-_002d_002dlist_002dexit_002dcodes_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dlist_002dexit_002dcodes"></a>
<p>Prints a list of numerical exit codes and their associated names, as
declared in the script.  <a href="#main-exit">Declaring exit codes</a>.
</p>
</dd>
<dt><samp>--print-exit-code=NAME</samp></dt>
<dd><a name="index-_002d_002dprint_002dexit_002dcode_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dprint_002dexit_002dcode"></a>
<p>Prints the numerical exit code associated to <code>NAME</code>.
</p>
</dd>
<dt><samp>--print-exit-code-names=CODE</samp></dt>
<dd><a name="index-_002d_002dprint_002dexit_002dcode_002dnames_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dprint_002dexit_002dcode_002dnames"></a>
<p>Prints the list of names associated to the numerical exit <code>CODE</code>.
</p>
</dd>
<dt><samp>--version</samp></dt>
<dd><a name="index-_002d_002dversion_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dversion"></a>
<p>Prints to the standard output of the script the contents of the global
variable <code>mbfl_message_VERSION</code>, then exits with code zero.  The
variable makes use of the service variables.  <a href="#service-variables">Required user defined variables</a>.
</p>
</dd>
<dt><samp>--version-only</samp></dt>
<dd><a name="index-_002d_002dversion_002donly_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dversion_002donly"></a>
<p>Prints to the standard output of the script the contents of the global
variable <code>script_VERSION</code>, then exits with code zero.  <a href="#service-variables">Required user defined variables</a>.
</p>
</dd>
<dt><samp>--license</samp></dt>
<dd><a name="index-_002d_002dlicense_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dlicense"></a>
<p>Prints to the standard output of the script the contents of one of the
global variables <code>mbfl_message_LICENSE_*</code>, then exits with code
zero.  The variable makes use of the service variables.  <a href="#service-variables">Required user defined variables</a>.
</p>
</dd>
<dt><samp>-h</samp></dt>
<dt><samp>--help</samp></dt>
<dt><samp>--usage</samp></dt>
<dd><a name="index-_002dh_002c-predefined-option"></a>
<a name="index-Predefined-option-_002dh"></a>
<a name="index-_002d_002dhelp_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dhelp"></a>
<a name="index-_002d_002dusage_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dusage"></a>
<p>Prints to the standard output of the script: the contents of the global
variable <code>script_USAGE</code>; a newline; the string <code>options:</code>; a
newline; an automatically generated string describing the options
declared with <code>mbfl_declare_option()</code>; a string describing the
<acronym>MBFL</acronym> default options; the contents of the global variable
<code>script_EXAMPLES</code>.  Then exits with code zero.  <a href="#service-variables">Required user defined variables</a>.
</p>
</dd>
<dt><samp>-H</samp></dt>
<dt><samp>--brief-help</samp></dt>
<dt><samp>--brief-usage</samp></dt>
<dd><a name="index-_002dH_002c-predefined-option"></a>
<a name="index-Predefined-option-_002dH"></a>
<a name="index-_002d_002dbrief_002dhelp_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dbrief_002dhelp"></a>
<a name="index-_002d_002dbrief_002dusage_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dbrief_002dusage"></a>
<p>Prints to the standard output of the script: the contents of the global
variable <code>script_USAGE</code>; a newline; the string <code>options:</code>; a
newline; an automatically generated string describing the options
declared with <code>mbfl_declare_option()</code>.  Then exits with code zero.
</p>
<p>The difference with <samp>--help</samp> is that predefined options and usage
examples are not displayed.
</p>
</dd>
<dt><samp>--print-options</samp></dt>
<dd><a name="index-_002d_002dprint_002doptions_002c-predefined-option"></a>
<a name="index-Predefined-option-_002d_002dprint_002doptions"></a>
<p>Print all the long options with
<code>mbfl_getopts_print_long_switches()</code>, then exit the script with code
zero.
</p></dd>
</dl>


<p>The following functions may be used to set, unset and query the state of
the predefined options.
</p>

<dl>
<dt><a name="index-mbfl_005foption_005fencoded_005fargs"></a>Function: <strong>mbfl_option_encoded_args</strong></dt>
<dt><a name="index-mbfl_005fset_005foption_005fencoded_005fargs"></a>Function: <strong>mbfl_set_option_encoded_args</strong></dt>
<dt><a name="index-mbfl_005funset_005foption_005fencoded_005fargs"></a>Function: <strong>mbfl_unset_option_encoded_args</strong></dt>
<dd><p>Query/set/unset the encoded arguments option.
</p>
<p><code>mbfl_option_encoded_args()</code> returns true if the option
<samp>--encoded-args</samp> was used on the command line.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005foption_005fverbose"></a>Function: <strong>mbfl_option_verbose</strong></dt>
<dt><a name="index-mbfl_005fset_005foption_005fverbose"></a>Function: <strong>mbfl_set_option_verbose</strong></dt>
<dt><a name="index-mbfl_005funset_005foption_005fverbose"></a>Function: <strong>mbfl_unset_option_verbose</strong></dt>
<dd><p>Query/set/unset the verbose messages option.
</p>
<p><code>mbfl_option_verbose()</code> returns true if the option
<samp>--verbose</samp> was used on the command line after all the
occurrences of <samp>--silent</samp>; it returns false if the option
<samp>--silent</samp> was used on the command line after all the occurrences
of <samp>--verbose</samp>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005foption_005fverbose_005fprogram"></a>Function: <strong>mbfl_option_verbose_program</strong></dt>
<dt><a name="index-mbfl_005fset_005foption_005fverbose_005fprogram"></a>Function: <strong>mbfl_set_option_verbose_program</strong></dt>
<dt><a name="index-mbfl_005funset_005foption_005fverbose_005fprogram"></a>Function: <strong>mbfl_unset_option_verbose_program</strong></dt>
<dd><p>Query/set/unset verbose execution for external programs.
</p>
<p>This option, of course, is supported only for programs that are known by
<acronym>MBFL</acronym> (like <code>rm</code>): if a program is executed with
<code>mbfl_program_exec()</code>, it is responsibility of the caller to use
the option.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005foption_005fshow_005fprogram"></a>Function: <strong>mbfl_option_show_program</strong></dt>
<dt><a name="index-mbfl_005fset_005foption_005fshow_005fprogram"></a>Function: <strong>mbfl_set_option_show_program</strong></dt>
<dt><a name="index-mbfl_005funset_005foption_005fshow_005fprogram"></a>Function: <strong>mbfl_unset_option_show_program</strong></dt>
<dd><p>Print the command line of executed external program.  This does not
disable program execution, it just prints the command line before
executing it.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005foption_005ftest"></a>Function: <strong>mbfl_option_test</strong></dt>
<dt><a name="index-mbfl_005fset_005foption_005ftest"></a>Function: <strong>mbfl_set_option_test</strong></dt>
<dt><a name="index-mbfl_005funset_005foption_005ftest"></a>Function: <strong>mbfl_unset_option_test</strong></dt>
<dd><p>Query/set/unset the test execution option.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005foption_005fdebug"></a>Function: <strong>mbfl_option_debug</strong></dt>
<dt><a name="index-mbfl_005fset_005foption_005fdebug"></a>Function: <strong>mbfl_set_option_debug</strong></dt>
<dt><a name="index-mbfl_005funset_005foption_005fdebug"></a>Function: <strong>mbfl_unset_option_debug</strong></dt>
<dd><p>Query/set/unset the debug messages option.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005foption_005fnull"></a>Function: <strong>mbfl_option_null</strong></dt>
<dt><a name="index-mbfl_005fset_005foption_005fnull"></a>Function: <strong>mbfl_set_option_null</strong></dt>
<dt><a name="index-mbfl_005funset_005foption_005fnull"></a>Function: <strong>mbfl_unset_option_null</strong></dt>
<dd><p>Query/set/unset the null list separator option.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005foption_005finteractive"></a>Function: <strong>mbfl_option_interactive</strong></dt>
<dt><a name="index-mbfl_005fset_005foption_005finteractive"></a>Function: <strong>mbfl_set_option_interactive</strong></dt>
<dt><a name="index-mbfl_005funset_005foption_005finteractive"></a>Function: <strong>mbfl_unset_option_interactive</strong></dt>
<dd><p>Query/set/unset the interactive execution option.
</p>
<p><code>mbfl_option_interactive()</code> returns true if the option
<samp>--interactive</samp> was used on the command line after all the
occurrences of <samp>--force</samp>; it returns false if the option
<samp>--force</samp> was used on the command line after all the occurrences
of <samp>--interactive</samp>.
</p></dd></dl>


<p>The following are special option functions.
</p>

<dl>
<dt><a name="index-mbfl_005foption_005ftest_005fsave"></a>Function: <strong>mbfl_option_test_save</strong></dt>
<dd><p>Save the current state of the test option then invokes
<code>mbfl_unset_option_test()</code>.
</p></dd></dl>

<dl>
<dt><a name="index-mbfl_005foption_005ftest_005frestore"></a>Function: <strong>mbfl_option_test_restore</strong></dt>
<dd><p>Restore the state of the test option to the one before the invocation to
<code>mbfl_option_test_save()</code>.
</p></dd></dl>

<hr>
<a name="getopts-interface"></a>
<div class="header">
<p>
Previous: <a href="#getopts-options" accesskey="p" rel="prev">getopts options</a>, Up: <a href="#getopts" accesskey="u" rel="up">getopts</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Interface-functions"></a>
<h3 class="section">8.4 Interface functions</h3>


<p>Every declared option should have a long switch, the brief switch can be
omitted.
</p>

<dl>
<dt><a name="index-mbfl_005fdeclare_005foption"></a>Function: <strong>mbfl_declare_option</strong> <em><var>keyword</var> <var>default</var> <var>brief</var> <var>long</var> <var>hasarg</var> <var>description</var></em></dt>
<dd><p>Declare a new option.  Arguments description follows.
</p>
<dl compact="compact">
<dt><var>keyword</var></dt>
<dd><p>A string identifying the option; internally it is used to build a
function name and a variable name.  It is safer to limit this string to
the letters in the ranges <code>a-z</code>, <code>A-Z</code> and underscores.
</p>
</dd>
<dt><var>default</var></dt>
<dd><p>The default value for the option.  For an option with argument it can be
anything; for an option with no argument: it must be <code>yes</code> or
<code>no</code>.
</p>
</dd>
<dt><var>brief</var></dt>
<dd><p>The brief option selector: a single character.  It is safer to choose a
single letter (lower or upper case) in the <acronym>ASCII</acronym> standard.
</p>
</dd>
<dt><var>long</var></dt>
<dd><p>The long option selector: a string.  It is safer to choose a sequence of
letters in the <acronym>ASCII</acronym> standard, separated by underscores or
dashes.
</p>
</dd>
<dt><var>hasarg</var></dt>
<dd><p>Either <code>witharg</code> or <code>noarg</code>: declares if the option requires
an argument or not.
</p>
</dd>
<dt><var>description</var></dt>
<dd><p>A one&ndash;line string briefly describing the option.
</p></dd>
</dl>
</dd></dl>


<dl>
<dt><a name="index-mbfl_005fgetopts_005fparse"></a>Function: <strong>mbfl_getopts_parse</strong></dt>
<dd><p>Parse a set of command line options.  The options are handed to user
defined functions.  The global array <code>ARGV1</code> and the global
variable <code>ARGC1</code> must hold the command line arguments and the
number of command line arguments, the global variable <code>ARG1ST</code> must
hold the index of the first element in <code>ARGV1</code> that must be parsed.
Non&ndash;option arguments are left in the global array <code>ARGV</code>, the
global variable <code>ARGC</code> holds the number of elements in <code>ARGV</code>.
</p>
<p>If successful return <code>0</code>, else return <code>1</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fgetopts_005fislong"></a>Function: <strong>mbfl_getopts_islong</strong> <em><var>string</var></em></dt>
<dt><a name="index-mbfl_005fgetopts_005fislong-1"></a>Function: <strong>mbfl_getopts_islong</strong> <em><var>string</var> <var>varname</var></em></dt>
<dd><p>Verify if a string has the format of a long option without argument.
<var>string</var> is the string to validate.  The optional <var>varname</var> is
the name of a variable that this function will set to the option name
from <var>string</var>, without the leading dashes.
</p>
<p>Return with code zero if the string is a long option without argument,
else returns with code one.
</p>
<p>An option must be of the form <code>--option</code>, only characters in the
ranges <code>A-Z</code>, <code>a-z</code>, <code>0-9</code> and the characters <code>-</code>
and <code>_</code> are allowed in the option name.
</p>
<p>Usage examples:
</p>
<div class="example">
<pre class="example">mbfl_getopts_islong --option            &rArr; 0
mbfl_getopts_islong --option=123        &rArr; 1
mbfl_getopts_islong gasp                &rArr; 1
</pre></div>
</dd></dl>


<dl>
<dt><a name="index-mbfl_005fgetopts_005fislong_005fwith"></a>Function: <strong>mbfl_getopts_islong_with</strong> <em><var>string</var></em></dt>
<dt><a name="index-mbfl_005fgetopts_005fislong_005fwith-1"></a>Function: <strong>mbfl_getopts_islong_with</strong> <em><var>string</var> <var>optname</var> <var>varname</var></em></dt>
<dd><p>Verify if a string has the format of a long option with argument.
Arguments:
</p>
<dl compact="compact">
<dt><var>string</var></dt>
<dd><p>The string to validate.
</p>
</dd>
<dt><var>optname</var></dt>
<dd><p>Optional name of a variable that this function will set to the option
name from <var>string</var>, without the leading dashes.
</p>
</dd>
<dt><var>varname</var></dt>
<dd><p>Optional name of a variable that this function will set to the option
value from <var>string</var>.
</p></dd>
</dl>

<p>Return with code zero if the string is a long option with argument, else
return with code one.
</p>
<p>An option must be of the form <code>--option=value</code>, only characters in
the ranges <code>A-Z</code>, <code>a-z</code>, <code>0-9</code> and the characters
<code>-</code> and <code>_</code> are allowed in the option name.
</p>
<p>If the argument is not an option with value, the variable names are
ignored.
</p>
<p>Usage examples:
</p>
<div class="example">
<pre class="example">mbfl_getopts_islong_with --option=one   &rArr; 0
mbfl_getopts_islong_with --option       &rArr; 1
mbfl_getopts_islong_with wappa          &rArr; 1
</pre></div>
</dd></dl>


<dl>
<dt><a name="index-mbfl_005fgetopts_005fisbrief"></a>Function: <strong>mbfl_getopts_isbrief</strong> <em><var>string</var></em></dt>
<dt><a name="index-mbfl_005fgetopts_005fisbrief-1"></a>Function: <strong>mbfl_getopts_isbrief</strong> <em><var>string</var> <var>varname</var></em></dt>
<dd><p>Verify if a string has the format of a brief option without argument.
<var>string</var> is the string to validate.  The optional <var>varname</var> is
the name of a variable that this function will set to the option name
from <var>string</var>, without the leading dash.
</p>
<p>Return with code zero if the argument is a brief option without
argument, else return with code one.
</p>
<p>A brief option must be of the form <code>-a</code>, only characters in the
ranges <code>A-Z</code>, <code>a-z</code>, <code>0-9</code> are allowed as option letters.
</p>
<p>Usage examples:
</p>
<div class="example">
<pre class="example">mbfl_getopts_isbrief -o         &rArr; 0
mbfl_getopts_isbrief -o123      &rArr; 1
mbfl_getopts_isbrief gasp       &rArr; 1
</pre></div>
</dd></dl>


<dl>
<dt><a name="index-mbfl_005fgetopts_005fisbrief_005fwith"></a>Function: <strong>mbfl_getopts_isbrief_with</strong> <em><var>string</var></em></dt>
<dt><a name="index-mbfl_005fgetopts_005fisbrief_005fwith-1"></a>Function: <strong>mbfl_getopts_isbrief_with</strong> <em><var>string</var> <var>optname</var> <var>valname</var></em></dt>
<dd><p>Verify if a string has the format of a brief option with argument.
Arguments:
</p>
<dl compact="compact">
<dt><var>string</var></dt>
<dd><p>The string to validate.
</p>
</dd>
<dt><var>optname</var></dt>
<dd><p>Optional name of a variable that this function will set to the option
name from <var>string</var>, without the leading dashes.
</p>
</dd>
<dt><var>valname</var></dt>
<dd><p>Optional name of a variable that this function will set to the option
value.
</p></dd>
</dl>

<p>Return with code zero if the argument is a brief option without
argument, else return with code one.
</p>
<p>A brief option must be of the form <code>-aV</code> (<code>a</code> is the option,
<code>V</code> is the value), only characters in the ranges <code>A-Z</code>,
<code>a-z</code>, <code>0-9</code> are allowed as option letters.
</p>
<p>Usage examples:
</p>
<div class="example">
<pre class="example">mbfl_getopts_isbrief_with -o123         &rArr; 0
mbfl_getopts_isbrief_with -o            &rArr; 1
mbfl_getopts_isbrief_with --option      &rArr; 1
mbfl_getopts_isbrief_with wappa         &rArr; 1
</pre></div>
</dd></dl>


<dl>
<dt><a name="index-mbfl_005fwrong_005fnum_005fargs"></a>Function: <strong>mbfl_wrong_num_args</strong> <em><var>required</var> <var>present</var></em></dt>
<dd><p>Validate the number of arguments.  <var>required</var> is the required number
of arguments, <var>present</var> is the given number of arguments on the
command line.  If the number of arguments is different from the required
one: print an error message and return with code one; else return with
code zero.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fwrong_005fnum_005fargs_005frange"></a>Function: <strong>mbfl_wrong_num_args_range</strong> <em><var>min_required</var> <var>max_required</var> <var>argc</var></em></dt>
<dd><p>Validate the number of arguments.  <var>argc</var> must be between
<var>min_required</var> and <var>max_required</var>, inclusive.
</p></dd></dl>


<dl>
<dt><a name="index-exit_005fbecause_005fwrong_005fnum_005fargs"></a>Function: <strong>exit_because_wrong_num_args</strong></dt>
<dd><p>Exit with code <code>98</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fargv_005ffrom_005fstdin"></a>Function: <strong>mbfl_argv_from_stdin</strong></dt>
<dd><p>If the <code>ARGC</code> global variable is set to zero: fills the global
variable <code>ARGV</code> with lines read from stdin.  If the global variable
<code>mbfl_option_NULL</code> is set to <code>yes</code>: lines are read using the
null character as terminator, else they are read using the standard
newline as terminator.
</p>
<p>This function may block waiting for input.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fargv_005fall_005ffiles"></a>Function: <strong>mbfl_argv_all_files</strong></dt>
<dd><p>Check that all the arguments in <code>ARGV</code> are file names of existent
files.  Return with code zero if no errors, else print an error message
and return with code 1.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fgetopts_005fprint_005flong_005fswitches"></a>Function: <strong>mbfl_getopts_print_long_switches</strong></dt>
<dd><p>Print all the long switches in a row, separated by spaces.  This is
useful to retrieve the option for Bash programmable completion.
</p></dd></dl>

<hr>
<a name="message"></a>
<div class="header">
<p>
Next: <a href="#program" accesskey="n" rel="next">program</a>, Previous: <a href="#getopts" accesskey="p" rel="prev">getopts</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Printing-messages-to-the-console"></a>
<h2 class="chapter">9 Printing messages to the console</h2>


<p>This module allows us to print messages on an output channel.  Various
forms of message are supported.  All the function names are prefixed
with <code>mbfl_message_</code>.  All the messages will have the forms:
</p>
<div class="example">
<pre class="example">&lt;progname&gt;: &lt;message&gt;
&lt;progname&gt;: [error|warning]: &lt;message&gt;
</pre></div>


<dl>
<dt><a name="index-mbfl_005fmessage_005fset_005fprogname"></a>Function: <strong>mbfl_message_set_progname</strong> <em><var>PROGNAME</var></em></dt>
<dd><p>Set the script official name to put at the beginning of messages.  This
value is initialised to <code>script_PROGNAME</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmessage_005fset_005fchannel"></a>Function: <strong>mbfl_message_set_channel</strong> <em><var>channel</var></em></dt>
<dd><p>Select the channel to be used to output messages.  This value is
initialised to 2, which is stderr.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmessage_005fstring"></a>Function: <strong>mbfl_message_string</strong> <em><var>string</var></em></dt>
<dd><p>Output a message to the selected output channel.  Echo a string composed
of: the selected program name, a colon, a space, <var>string</var>.  No
newline character is appended to the message.  Escape characters
supported by <code>printf</code> are allowed in <var>string</var>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmessage_005fverbose"></a>Function: <strong>mbfl_message_verbose</strong> <em><var>string</var></em></dt>
<dd><p>Output a message to the selected output channel, but only if the
evaluation of the function <code>mbfl_option_verbose()</code> returns true.
</p>
<p>Echo a string composed of: the selected program name, a colon, a space,
<var>string</var>. No newline character is appended to the message.  Escape
characters supported by <code>printf</code> are allowed in <var>string</var>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmessage_005fverbose_005fend"></a>Function: <strong>mbfl_message_verbose_end</strong> <em><var>string</var></em></dt>
<dd><p>Output a message to the selected output channel, but only if the
evaluation of the function <code>mbfl_option_verbose()</code> returns true.
Echo the string.  No newline character is appended to the message.
Escape characters supported by <code>printf</code> are allowed in
<var>string</var>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmessage_005fdebug"></a>Function: <strong>mbfl_message_debug</strong> <em><var>string</var></em></dt>
<dd><p>Output a message to the selected output channel, but only if the
evaluation of the function <code>mbfl_option_debug()</code> returns true.  Echo
a string composed of: the selected program name, a colon, a space,
<var>string</var>.  No newline character is appended to the message.  Escape
characters supported by <code>printf</code> are allowed in <var>string</var>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmessage_005fdebug_005fprintf"></a>Function: <strong>mbfl_message_debug_printf</strong> <em><var>string</var></em></dt>
<dt><a name="index-mbfl_005fmessage_005fdebug_005fprintf-1"></a>Function: <strong>mbfl_message_debug_printf</strong> <em><var>pattern</var> <var>arg</var> ...</em></dt>
<dd><p>Format the arguments in the same way <code>printf</code> would do; output the
resulting string to the selected output channel, but only if the
evaluation of the function <code>mbfl_option_debug()</code> returns true.
</p>
<p>Echo a string composed of: the selected program name, a colon, a space,
the string <code>debug</code>, a colon, a space, the formatting result.  No
newline character is appended to the message.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmessage_005fverbose_005fprintf"></a>Function: <strong>mbfl_message_verbose_printf</strong> <em><var>string</var></em></dt>
<dt><a name="index-mbfl_005fmessage_005fverbose_005fprintf-1"></a>Function: <strong>mbfl_message_verbose_printf</strong> <em><var>pattern</var> <var>arg</var> ...</em></dt>
<dd><p>Format the arguments in the same way <code>printf</code> would do; output the
resulting string to the selected output channel, but only if the
evaluation of the function <code>mbfl_option_verbose()</code> returns true.
</p>
<p>Echo a string composed of: the selected program name, a colon, a space,
the formatting result.  No newline character is appended to the message.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmessage_005fwarning"></a>Function: <strong>mbfl_message_warning</strong> <em><var>string</var></em></dt>
<dd><p>Output a warning message to the selected output channel.  Echo a string
composed of: the selected program name, a colon, a space, the string
<code>warning</code>, a colon, a space, <var>string</var>, a newline character.
Escape characters supported by <code>printf</code> are allowed in
<var>string</var>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmessage_005fwarning_005fprintf"></a>Function: <strong>mbfl_message_warning_printf</strong> <em><var>string</var></em></dt>
<dt><a name="index-mbfl_005fmessage_005fwarning_005fprintf-1"></a>Function: <strong>mbfl_message_warning_printf</strong> <em><var>pattern</var> <var>arg</var> ...</em></dt>
<dd><p>Format the arguments in the same way <code>printf</code> would do; output the
resulting string to the selected output channel.
</p>
<p>Echo a string composed of: the selected program name, a colon, a space,
the string <code>warning</code>, a colon, a space, the formatting result.  No
newline character is appended to the message.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmessage_005ferror"></a>Function: <strong>mbfl_message_error</strong> <em><var>string</var></em></dt>
<dd><p>Output an error message to the selected output channel.  Echo a string
composed of: the selected program name, a colon, a space, the string
<code>error</code>, a colon, a space, <var>string</var>, a newline character.
Escape characters supported by <code>printf</code> are allowed in
<var>string</var>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmessage_005ferror_005fprintf"></a>Function: <strong>mbfl_message_error_printf</strong> <em><var>string</var></em></dt>
<dt><a name="index-mbfl_005fmessage_005ferror_005fprintf-1"></a>Function: <strong>mbfl_message_error_printf</strong> <em><var>pattern</var> <var>arg</var> ...</em></dt>
<dd><p>Format the arguments in the same way <code>printf</code> would do; output the
resulting string to the selected output channel.
</p>
<p>Echo a string composed of: the selected program name, a colon, a space,
the string <code>error</code>, a colon, a space, the formatting result.  No
newline character is appended to the message.
</p></dd></dl>

<hr>
<a name="program"></a>
<div class="header">
<p>
Next: <a href="#interfaces" accesskey="n" rel="next">interfaces</a>, Previous: <a href="#message" accesskey="p" rel="prev">message</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Using-external-programs"></a>
<h2 class="chapter">10 Using external programs</h2>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#program-testing" accesskey="1">program testing</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Testing a script and running programs.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#program-checking" accesskey="2">program checking</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Checking programs existence.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#program-executing" accesskey="3">program executing</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Executing a program.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#program-declaring" accesskey="4">program declaring</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Declaring the intention to use a
                                program.
</td></tr>
</table>

<hr>
<a name="program-testing"></a>
<div class="header">
<p>
Next: <a href="#program-checking" accesskey="n" rel="next">program checking</a>, Up: <a href="#program" accesskey="u" rel="up">program</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Testing-a-script-and-running-programs"></a>
<h3 class="section">10.1 Testing a script and running programs</h3>


<p><acronym>MBFL</acronym> allows a script to execute a &ldquo;dry run&rdquo;, that is: do not
perform any operation on the system, just print messages describing what
will happen if the script is executed with the selected options.  This
implies, in the <acronym>MBFL</acronym> model, that no external program is executed.
</p>
<p>When this feature is turned on: <code>mbfl_program_exec()</code> does not
execute the program, instead it prints the command line on standard
error and it returns true.
</p>

<dl>
<dt><a name="index-mbfl_005fset_005foption_005ftest-1"></a>Function: <strong>mbfl_set_option_test</strong></dt>
<dd><p>Enable the script test option.  After this: a script must not mutate the
system in any way, it should just print messages describing the
operations.
</p>
<p>However, the script is allowed to acquire informations from the system;
for example it can acquire the list of files in a directory or load the
contents of a file.
</p>
<p>This function is invoked when the predefined option <samp>--test</samp> is
used on the command line.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005funset_005foption_005ftest-1"></a>Function: <strong>mbfl_unset_option_test</strong></dt>
<dd><p>Disable the script test option.  After this a script must perform normal
operations.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005foption_005ftest-1"></a>Function: <strong>mbfl_option_test</strong></dt>
<dd><p>Return true if test execution is enabled, else return false.
</p></dd></dl>


<hr>
<a name="program-checking"></a>
<div class="header">
<p>
Next: <a href="#program-executing" accesskey="n" rel="next">program executing</a>, Previous: <a href="#program-testing" accesskey="p" rel="prev">program testing</a>, Up: <a href="#program" accesskey="u" rel="up">program</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Checking-programs-existence"></a>
<h3 class="section">10.2 Checking programs existence</h3>


<p>The simpler way to test the availability of a program is to look for it
just before it is used.
</p>

<dl>
<dt><a name="index-mbfl_005fprogram_005ffind"></a>Function: <strong>mbfl_program_find</strong> <em><var>program</var></em></dt>
<dd><p>A wrapper for:
</p>
<div class="example">
<pre class="example">type -ap <var>program</var>
</pre></div>

<p>that looks for a program in the current search path.  It prints the full
pathname of the program found, or an empty string if nothing is found.
The exit status is always <code>0</code>.
</p>
<p><var>program</var> may be a program name with no directory part (examples:
<code>sed</code>, <code>grep</code>), or an absolute or relative pathname
(examples: <samp>/bin/sed</samp>, <samp>../bin/grep</samp>).  If <var>program</var> is a
relative pathname and it is an executable file: the output of the
function is exactly <var>program</var>, it is <strong>not</strong> normalised.
</p>
<p>If an alias exists for a program, <code>type -p <var>program</var></code> will
return the empty string; that is why we have to use <code>type -ap
<var>program</var></code>, which will return the correct file pathname.
</p>
<p>If the environment variable <code>PATH</code> holds the same directory more
than once, or there exist programs with the same name in more than one
<code>PATH</code> elements: <code>type -ap $program</code> will return more than one
line of output, one for each executable file found.  The first value
(the first line) is the one selected by this function.
</p></dd></dl>

<hr>
<a name="program-executing"></a>
<div class="header">
<p>
Next: <a href="#program-declaring" accesskey="n" rel="next">program declaring</a>, Previous: <a href="#program-checking" accesskey="p" rel="prev">program checking</a>, Up: <a href="#program" accesskey="u" rel="up">program</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Executing-a-program"></a>
<h3 class="section">10.3 Executing a program</h3>


<p>This module provides an <acronym>API</acronym> to execute a program under the privileges
of the current user or under a more or less privileged user;
<code>sudo</code> is used run a program as a different user: refer to its
documentation for the required configuration; <code>whoami</code> is used
to determine to which user the process belongs.
</p>
<p>At package configuration time we can specify which <code>sudo</code> and
<code>whoami</code> executables to use through the following options for
the configuration script <code>configure</code>:
</p>
<dl compact="compact">
<dt><code>--with-sudo=/path/to/sudo</code></dt>
<dd><p>Allows the selection of the pathname to the executable <code>sudo</code>;
this pathname is hard&ndash;coded in the library.  It defaults to:
<samp>/usr/bin/sudo</samp>.
</p>
</dd>
<dt><code>--with-whoami=/path/to/whoami</code></dt>
<dd><p>Allows the selection of the pathname to the executable <code>whoami</code>;
this pathname is hard&ndash;coded in the library.  It defaults to:
<samp>/usr/bin/whoami</samp>.
</p></dd>
</dl>

<p>The functions described here must be used in the following way:
</p>
<ul>
<li> To execute a program under the current user privileges:

<div class="example">
<pre class="example">mbfl_program_exec ls /bin
</pre></div>

</li><li> To execute a program under a more or less privileged user:

<div class="example">
<pre class="example"># At the beginning of the script:
mbfl_program_enable_sudo

# When executing a program:
mbfl_program_declare_sudo_user root
mbfl_program_exec ls /root
</pre></div>
</li></ul>

<p>Every time we execute a program with <code>sudo</code>: we have to select
the user under which to execute it; if we do not do it: the internally
registered user defaults to <code>nosudo</code>, which tells the function
<strong>not</strong> to use <code>sudo</code>.  So the following script works as
commented:
</p>
<div class="example">
<pre class="example">mbfl_program_enable_sudo

# This is executed with the privileges of the user that
# launched the script.
mbfl_program_exec ls /bin

mbfl_program_declare_sudo_user root
# This is executed with root privileges.
mbfl_program_exec ls /root

# This is executed with the privileges of the user that
# launched the script.
mbfl_program_exec ls /bin
</pre></div>


<dl>
<dt><a name="index-mbfl_005fprogram_005fexec"></a>Function: <strong>mbfl_program_exec</strong> <em><var>program</var></em></dt>
<dt><a name="index-mbfl_005fprogram_005fexec-1"></a>Function: <strong>mbfl_program_exec</strong> <em><var>program</var> <var>arg</var> ...</em></dt>
<dd><p>Evaluate a command line.  <var>program</var> identifies an executable file:
it can be the program name, or a relative or absolute pathname.  The
optional <var>arg</var> values are command line arguments that are handed to
the program unchanged.
</p>
<p>If usage of <code>sudo</code> was requested, the command is executed with
it; then the <code>sudo</code> request is reset.  This means that this
function &ldquo;consumes&rdquo; a <code>sudo</code> request.
</p>
<p>See below for the redirection of the standard error channel.
</p>
<p>If the function <code>mbfl_option_test()</code> returns true: instead of
evaluation, the command line is sent to stderr.
</p>
<p>If the function <code>mbfl_option_show_program()</code> returns true: the
command line is sent to stderr, then it is executed.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fprogram_005fexecbg"></a>Function: <strong>mbfl_program_execbg</strong> <em><var>inchan</var> <var>ouchan</var> <var>program</var></em></dt>
<dt><a name="index-mbfl_005fprogram_005fexecbg-1"></a>Function: <strong>mbfl_program_execbg</strong> <em><var>inchan</var> <var>ouchan</var> <var>program</var> <var>arg</var> ...</em></dt>
<dd><p>Does all the same things of <code>mbfl_program_exec()</code>, running the given
command line as:
</p>
<div class="example">
<pre class="example"><var>program</var> <var>arg</var> ... &lt;&amp;<var>inchan</var> &gt;&amp;<var>ouchan</var> &amp;
</pre></div>

<p>additionally: set the global variable <code>mbfl_program_BGPID</code> to the
process ID of the background process; that is: <code>mbfl_program_BGPID</code>
is the value of <code>$!</code> right after the process execution.
</p>
<p>Using this function is different from calling:
</p>
<div class="example">
<pre class="example">mbfl_program_exec ls &lt;&amp;<var>inchan</var> &gt;&amp;<var>ouchan</var> &amp;
</pre></div>

<p>because doing so puts in the background the function call (in a subshell)
and then runs the program.
</p>
<p>Notice that we <strong>must</strong> always use numeric file descriptors as <var>inchan</var> and <var>ouchan</var>
arguments.  Also we can always use the default file descriptors, for example:
</p>
<div class="example">
<pre class="example">mbfl_program_execbg 0 1 /bin/ls
</pre></div>

<p>The readable aliases <samp>/dev/stdin</samp>, <samp>/dev/stdout</samp>, <samp>/dev/fd/0</samp>, <samp>/dev/fd/1</samp> are
<strong>not</strong> usable as <var>inchan</var> and <var>ouchan</var> arguments (remember that the aliases are
<strong>not</strong> available, for example, when the script is run from a cron job).
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fprogram_005freplace"></a>Function: <strong>mbfl_program_replace</strong> <em><var>program</var></em></dt>
<dt><a name="index-mbfl_005fprogram_005freplace-1"></a>Function: <strong>mbfl_program_replace</strong> <em><var>program</var> <var>arg</var> &hellip;</em></dt>
<dd><p>Like <code>mbfl_program_exec()</code>, but execute the program through the Bash
command <code>exec</code>, so replacing the current process without creating a
new one.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fprogram_005fBGPID"></a>Variable: <strong>mbfl_program_BGPID</strong></dt>
<dd><p>Used by <code>mbfl_program_execbg()</code> to store the process id of the
program executed in background.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fprogram_005fenable_005fsudo"></a>Function: <strong>mbfl_program_enable_sudo</strong></dt>
<dd><p>Declare the intention to use <code>sudo</code> and other commands required
to use it.  The declared programs are: <code>sudo</code>, <code>whoami</code>.
</p>
<p>This function does <strong>not</strong> use <code>mbfl_declare_program()</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fprogram_005fdeclare_005fsudo_005fuser"></a>Function: <strong>mbfl_program_declare_sudo_user</strong> <em><var>user</var></em></dt>
<dd><p>Register <var>user</var> as the user under which to execute the next program
through <code>sudo</code>; the user will be selected using the <code>-u</code>
option of <code>sudo</code>.  The value <code>nosudo</code> means: do not use
<code>sudo</code>.
</p>
<p>The string <var>user</var> must satisfy the function
<code>mbfl_string_is_username()</code>, else the function will print an error
message to <code>stderr</code> and exit with
<code>exit_because_invalid_username()</code>.
</p>
<p>When the time comes: if the selected user name equals the value printed
by <code>whoami</code>, <code>sudo</code> is not used.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fprogram_005freset_005fsudo_005fuser"></a>Function: <strong>mbfl_program_reset_sudo_user</strong></dt>
<dd><p>Reset the previously requested <code>sudo</code> user to a value that will
cause <code>sudo</code> not to be used in the next program invocation.
This is useful to abort a user request.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fprogram_005fsudo_005fuser"></a>Function: <strong>mbfl_program_sudo_user</strong></dt>
<dd><p>Print the current <code>sudo</code> user.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fprogram_005frequested_005fsudo"></a>Function: <strong>mbfl_program_requested_sudo</strong></dt>
<dd><p>Return true if the usage of <code>sudo</code> has been requested for the
next command execution.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fprogram_005fdeclare_005fsudo_005foptions"></a>Function: <strong>mbfl_program_declare_sudo_options</strong> <em><var>arg</var> &hellip;</em></dt>
<dd><p>Select additional command line options to use on the next invocation of
<code>sudo</code>.  These values are consumed by the first use of
<code>mbfl_program_exec()</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fprogram_005freset_005fsudo_005foptions"></a>Function: <strong>mbfl_program_reset_sudo_options</strong></dt>
<dd><p>Clean the options previously set by
<code>mbfl_program_declare_sudo_options()</code>.
</p></dd></dl>


<a name="Executing-a-subshell"></a>
<h4 class="subsubheading">Executing a subshell</h4>


<dl>
<dt><a name="index-mbfl_005fprogram_005fbash"></a>Function: <strong>mbfl_program_bash</strong> <em><var>arg</var> &hellip;</em></dt>
<dd><p>Execute <code>bash</code> with the <var>arg</var> arguments appended.  The
<code>bash</code> pathname is registered in the library at start up, from
the built in variable <code>BASH</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fprogram_005fbash_005fcommand"></a>Function: <strong>mbfl_program_bash_command</strong> <em><var>command</var></em></dt>
<dd><p>Execute <var>command</var> in a <code>bash</code> subprocess, using the
<code>-c</code> switch.  The <code>bash</code> pathname is registered in the
library at start up, from the built in variable <code>BASH</code>.
</p></dd></dl>


<a name="Redirecting-the-standard-error-channel"></a>
<h4 class="subsubheading">Redirecting the standard error channel</h4>

<p>There are programs that output useful informations on their stderr
channel (example: the <code>at</code> command).
</p>

<dl>
<dt><a name="index-mbfl_005fprogram_005fredirect_005fstderr_005fto_005fstdout"></a>Function: <strong>mbfl_program_redirect_stderr_to_stdout</strong></dt>
<dd><p>Just for the next invocation to <code>mbfl_program_exec()</code> redirect
stderr to stdout, that is: use the <code>2&gt;&amp;1</code> redirection for the
executed program.
</p></dd></dl>


<p>This is useful because redirecting the output of
<code>mbfl_program_exec()</code>:
</p>
<div class="example">
<pre class="example">echo ls | \
    mbfl_program_exec at 'now +25 minutes' 2&gt;&amp;1 | \
    while read
</pre></div>

<p>redirects also the &ldquo;show program&rdquo; output (<a href="#getopts-options">getopts options</a> for
the <samp>--show-program</samp> option explanation and see the above
description of <code>mbfl_program_exec()</code>).  Instead By using:
</p>
<div class="example">
<pre class="example">mbfl_program_redirect_stderr_to_stdout
echo ls | \
    mbfl_program_exec at 'now +25 minutes' | \
    while read
</pre></div>

<p>the &ldquo;show program&rdquo; output goes to stderr and the stderr output of the
<code>at</code> command is, internally, redirected to the stdout of
<code>mbfl_program_exec()</code>.
</p>
<hr>
<a name="program-declaring"></a>
<div class="header">
<p>
Previous: <a href="#program-executing" accesskey="p" rel="prev">program executing</a>, Up: <a href="#program" accesskey="u" rel="up">program</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Declaring-the-intention-to-use-a-program"></a>
<h3 class="section">10.4 Declaring the intention to use a program</h3>


<p>To make a script model simpler, we assume that the unavailability of a
program at the time of its execution is a fatal error.  So if we need to
execute a program and the executable is not there, the script must be
aborted on the spot.
</p>
<p>Functions are provided to test the availability of a program, so we can
try to locate an alternative or terminate the process under the script
control.  On a system where executables may vanish from one moment to
another, no matter how we test a program&rsquo;s existence, there&rsquo;s always the
possibility that the program is not &ldquo;there&rdquo; when we invoke it.
</p>
<p>If we just use <code>mbfl_program_exec()</code> to invoke an external
program, the function will try and fail if the executable is
unavailable: the return code will be false.
</p>
<p>The vanishing of a program is a rare event: if it&rsquo;s there when we look
for it, probably it will be there also a few moments later when we
invoke it.  For this reason, <acronym>MBFL</acronym> proposes a set of functions with
which we can declare the intention of a script to use a set of programs.
</p>
<p>A command line option is predefined to let the user test the
availability of all the declared programs before invoking the script.
<a href="#getopts-options">Predefined options</a>.
</p>

<dl>
<dt><a name="index-mbfl_005fdeclare_005fprogram"></a>Function: <strong>mbfl_declare_program</strong> <em><var>program</var></em></dt>
<dd><p>Register <var>program</var> as the name of a program required by the script;
<code>mbfl_program_find()</code> is used to locate the program on the system.
<a href="#program-checking">Checking programs existence</a>.
</p>
<p>If <var>program</var> is a file name with no directory part (examples:
<code>sed</code>, <code>grep</code>) the selected program is the full pathname
of the file in one of the directories of <code>PATH</code>.
</p>
<p>If <var>program</var> is a relative pathname (examples: <samp>../bin/sed</samp>,
<samp>./grep</samp>): the selected program is the full pathname of the file
normalised by this function with respect to the current working
directory (with a call to <code>mbfl_file_normalise()</code>).
</p>
<p>The return value is always zero.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fprogram_005fvalidate_005fdeclared"></a>Function: <strong>mbfl_program_validate_declared</strong></dt>
<dd><p>Validate the existence of all the declared programs.  The return value
is zero if all the programs are found, one otherwise.
</p>
<p>This function is invoked by <code>mbfl_getopts_parse()</code> when the
<samp>--validate-programs</samp> option is used on the command line.
</p>
<p>It may be a good idea to invoke this function at the beginning of a
script, just before starting to do stuff, example:
</p>
<div class="example">
<pre class="example">mbfl_program_validate_declared || \
   exit_because_program_not_found
</pre></div>

<p>If verbose messages are enabled: a brief summary is echoed to stderr;
from the command line the option <samp>--verbose</samp> must be used before
<samp>--validate-programs</samp>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fprogram_005ffound"></a>Function: <strong>mbfl_program_found</strong> <em><var>program</var></em></dt>
<dd><p>Print the pathname of the previously declared <var>program</var>.  Return
zero if the program was found, otherwise print an error message and exit
the current (sub)shell by invoking
<code>exit_because_program_not_found()</code>.
</p>
<p>This function should be used to retrieve the pathname of the program to
be used as first argument to <code>mbfl_program_exec()</code>:
</p>
<div class="example">
<pre class="example">function program_wrapper () {
    local ARGUMENT PROGNAME FLAGS

    ARGUMENT=${1:?&quot;missing 'ARGUMENT'&quot;}
    shift
    PROGNAME=$(mbfl_program_found myprog) || exit $?

    mbfl_option_verbose_program &amp;&amp; \
       FLAGS=&quot;$FLAGS --verbose&quot;
    mbfl_program_exec &quot;$PROGNAME&quot; \
       $FLAGS &quot;$ARGUMENT&quot; &quot;$@&quot;
}
</pre></div>

<p>Remember that we cannot use:
</p>
<div class="example">
<pre class="example">local PROGNAME=$(mbfl_program_found 'myprog') || \
    exit $?
</pre></div>

<p>because <code>local</code> will return with code zero even if
<code>mbfl_program_found()</code> fails, so the error will not be reported.
</p></dd></dl>


<dl>
<dt><a name="index-exit_005fbecause_005fprogram_005fnot_005ffound"></a>Function: <strong>exit_because_program_not_found</strong></dt>
<dd><p>Terminate the script with exit code <code>99</code>.
</p></dd></dl>

<hr>
<a name="interfaces"></a>
<div class="header">
<p>
Next: <a href="#signal" accesskey="n" rel="next">signal</a>, Previous: <a href="#program" accesskey="p" rel="prev">program</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Interfaces-to-external-programs"></a>
<h2 class="chapter">11 Interfaces to external programs</h2>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#interfaces-at" accesskey="1">interfaces at</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Scheduling jobs for later execution.
</td></tr>
</table>


<hr>
<a name="interfaces-at"></a>
<div class="header">
<p>
Up: <a href="#interfaces" accesskey="u" rel="up">interfaces</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Scheduling-jobs-for-later-execution"></a>
<h3 class="section">11.1 Scheduling jobs for later execution</h3>


<p>This section documents the interface to the <code>atd</code> daemon; we may
want to read the <code>at</code>(1) manual page.  The <code>at</code> service
allows a user to schedule commands to be executed at a later time.
</p>
<p>This interface is suitable for scripts that define a unique simple
policy to schedule commands; example: at each run they schedule a
command in a fixed queue, to be executed at a fixed time in the future.
</p>
<p>This is good to implement the logic: if a condition does not happen
before time <code>T</code>, then execute command <code>C</code>.
</p>

<a name="Commands-declaration"></a>
<h4 class="subsubheading">Commands declaration</h4>


<dl>
<dt><a name="index-mbfl_005fat_005fenable"></a>Function: <strong>mbfl_at_enable</strong></dt>
<dd><p>Declare the intention to use the <code>at</code> interface.  <a href="#program-declaring">Declaring the intention to use a program</a>.
</p>
<p>The declared programs are: <code>at</code>, <code>atq</code>, <code>atrm</code>.
</p></dd></dl>


<a name="Arguments-validation"></a>
<h4 class="subsubheading">Arguments validation</h4>


<dl>
<dt><a name="index-mbfl_005fat_005fvalidate_005fqueue_005fletter"></a>Function: <strong>mbfl_at_validate_queue_letter</strong> <em><var>letter</var></em></dt>
<dd><p>Return true if <var>letter</var> is a valid queue identifier, else return
false.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fat_005fvalidate_005fselected_005fqueue"></a>Function: <strong>mbfl_at_validate_selected_queue</strong></dt>
<dd><p>Return true if the currently selected queue identifier is valid, else
print an error message and return false.  A false return code means
that an internal error has corrupted the module state.
</p></dd></dl>


<a name="Commands-scheduling"></a>
<h4 class="subsubheading">Commands scheduling</h4>


<dl>
<dt><a name="index-mbfl_005fat_005fselect_005fqueue"></a>Function: <strong>mbfl_at_select_queue</strong> <em><var>letter</var></em></dt>
<dd><p>Select and register in an internal state a queue identifier; invoke
<code>mbfl_at_validate_queue_letter()</code> to validate the selection.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fat_005fschedule"></a>Function: <strong>mbfl_at_schedule</strong> <em><var>command</var> <var>time</var></em></dt>
<dd><p>Schedule <var>command</var> in the currently selected queue; the script will
be executed at <var>time</var>.
</p>
<p>If no error occurs: print to stdout the identifier of the scheduled
job; the identifier can be used as argument to <code>mbfl_at_drop()</code>.
</p>
<blockquote>
<p>The <code>at</code> command outputs some text (in which the job is
embedded) on its stderr channel, so this function redirects stderr to
stdout to return the value; this operation conflicts with the use of the
&ldquo;show program&rdquo; feature of <code>mbfl_program_exec()</code>.
</p></blockquote>

<p><var>command</var> must be a string representing the invocation of an
external executable program: it is sent unchanged to the <code>at</code>
command.  <var>time</var> is the argument to the <code>at</code> command, see the
manual page for its description.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fat_005fdrop"></a>Function: <strong>mbfl_at_drop</strong> <em><var>identifier</var></em></dt>
<dd><p>Remove a job; the identifier of a job is unique in all the queues, so
this function is not affected by the currently selected queue.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fat_005fqueue_005fclean"></a>Function: <strong>mbfl_at_queue_clean</strong></dt>
<dd><p>Remove all the jobs from the currently selected queue.
</p></dd></dl>


<a name="Inspection"></a>
<h4 class="subsubheading">Inspection</h4>


<dl>
<dt><a name="index-mbfl_005fat_005fqueue_005fprint_005fidentifiers"></a>Function: <strong>mbfl_at_queue_print_identifiers</strong></dt>
<dd><p>Print all the job identifiers in the currently selected queue.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fat_005fqueue_005fprint_005fjobs"></a>Function: <strong>mbfl_at_queue_print_jobs</strong></dt>
<dd><p>Print all the job descriptions in the currently selected queue.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fat_005fqueue_005fprint_005fqueues"></a>Function: <strong>mbfl_at_queue_print_queues</strong></dt>
<dd><p>Print the letters identifying queues with pending jobs.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fat_005fprint_005fqueue"></a>Function: <strong>mbfl_at_print_queue</strong></dt>
<dd><p>Print the currently selected queue letter.
</p></dd></dl>

<hr>
<a name="signal"></a>
<div class="header">
<p>
Next: <a href="#string" accesskey="n" rel="next">string</a>, Previous: <a href="#interfaces" accesskey="p" rel="prev">interfaces</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Catching-signals"></a>
<h2 class="chapter">12 Catching signals</h2>


<p><acronym>MBFL</acronym> provides an interface to the <code>trap</code> builtin that allows the
execution of more than one function when a signal is received; this may
sound useless, but that is it.
</p>

<dl>
<dt><a name="index-mbfl_005fsignal_005fmap_005fsigname_005fto_005fsignum"></a>Function: <strong>mbfl_signal_map_signame_to_signum</strong> <em><var>sigspec</var></em></dt>
<dd><p>Convert <var>sigspec</var> to the corresponding signal number, then print
the number.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fsignal_005fattach"></a>Function: <strong>mbfl_signal_attach</strong> <em><var>sigspec</var> <var>handler</var></em></dt>
<dd><p>Append <var>handler</var> to the list of functions that are executed whenever
<var>sigspec</var> is received.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fsignal_005finvoke_005fhandlers"></a>Function: <strong>mbfl_signal_invoke_handlers</strong> <em><var>signum</var></em></dt>
<dd><p>Invoke all the handlers registered for <var>signum</var>.  This function is
not meant to be used during normal scripts execution, but it may be
useful to debug a script.
</p></dd></dl>

<hr>
<a name="string"></a>
<div class="header">
<p>
Next: <a href="#dialog" accesskey="n" rel="next">dialog</a>, Previous: <a href="#signal" accesskey="p" rel="prev">signal</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Manipulating-strings"></a>
<h2 class="chapter">13 Manipulating strings</h2>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#string-quote" accesskey="1">string quote</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Quoted characters.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#string-inspection" accesskey="2">string inspection</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Inspecting a string.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#string-splitting" accesskey="3">string splitting</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Splitting a string.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#string-case" accesskey="4">string case</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Converting between upper and lower case.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#string-class" accesskey="5">string class</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Matching a string with a class.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#string-misc" accesskey="6">string misc</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Miscellaneous functions.
</td></tr>
</table>

<hr>
<a name="string-quote"></a>
<div class="header">
<p>
Next: <a href="#string-inspection" accesskey="n" rel="next">string inspection</a>, Up: <a href="#string" accesskey="u" rel="up">string</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Quoted-characters"></a>
<h3 class="section">13.1 Quoted characters</h3>


<dl>
<dt><a name="index-mbfl_005fstring_005fis_005fquoted_005fchar"></a>Function: <strong>mbfl_string_is_quoted_char</strong> <em><var>string</var> <var>position</var></em></dt>
<dd><p>Return true if the character at <var>position</var> in <var>string</var> is
quoted; else return false.  A character is considered quoted if it is
preceded by an odd number of backslashes (<code>\</code>).  <var>position</var> is
a zero&ndash;based index.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005fis_005fequal_005funquoted_005fchar"></a>Function: <strong>mbfl_string_is_equal_unquoted_char</strong> <em><var>string</var> <var>position</var> <var>char</var></em></dt>
<dd><p>Return true if the character at <var>position</var> in <var>string</var> is equal
to <var>char</var> and is not quoted (according to
<code>mbfl_string_is_quoted_char()</code>); else return false.  <var>position</var>
is a zero&ndash;based index.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005fquote"></a>Function: <strong>mbfl_string_quote</strong> <em><var>string</var></em></dt>
<dd><p>Print <var>string</var> with quoted characters.  All the occurrences of the
backslash character, <code>\</code>, are substituted with a quoted backslash,
<code>\\</code>.  Return true.
</p></dd></dl>

<hr>
<a name="string-inspection"></a>
<div class="header">
<p>
Next: <a href="#string-splitting" accesskey="n" rel="next">string splitting</a>, Previous: <a href="#string-quote" accesskey="p" rel="prev">string quote</a>, Up: <a href="#string" accesskey="u" rel="up">string</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Inspecting-a-string"></a>
<h3 class="section">13.2 Inspecting a string</h3>


<dl>
<dt><a name="index-mbfl_005fstring_005findex"></a>Function: <strong>mbfl_string_index</strong> <em><var>string</var> <var>index</var></em></dt>
<dd><p>Select a character from a string.  Echo to stdout the selected
character.  If the index is out of range: the empty string is echoed to
stdout, that is: a newline is echoed to stdout.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005ffirst"></a>Function: <strong>mbfl_string_first</strong> <em><var>string</var> <var>char</var></em></dt>
<dt><a name="index-mbfl_005fstring_005ffirst-1"></a>Function: <strong>mbfl_string_first</strong> <em><var>string</var> <var>char</var> <var>begin</var></em></dt>
<dd><p>Search characters in a string.  Arguments: <var>string</var>, the target
string; <var>char</var>, the character to look for; <var>begin</var>, optional,
the index of the character in the target string from which the search
begins (defaults to zero).
</p>
<p>Print an integer representing the index of the first occurrence of
<var>char</var> in <var>string</var>.  If the character is not found: nothing is
sent to stdout.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005flast"></a>Function: <strong>mbfl_string_last</strong> <em><var>string</var> <var>char</var></em></dt>
<dt><a name="index-mbfl_005fstring_005flast-1"></a>Function: <strong>mbfl_string_last</strong> <em><var>string</var> <var>char</var> <var>begin</var></em></dt>
<dd><p>Search characters in a string starting from the end.  Arguments:
<var>string</var>, the target string; <var>char</var>, the character to look for;
<var>begin</var>, optional, the index of the character in the target string
from which the search begins (defaults to zero).
</p>
<p>Print an integer representing the index of the last occurrence of
<var>char</var> in <var>string</var>.  If the character is not found: nothing is
sent to stdout.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005frange"></a>Function: <strong>mbfl_string_range</strong> <em><var>string</var> <var>begin</var> <var>end</var></em></dt>
<dd><p>Extract a range of characters from a string.  Arguments: <var>string</var>,
the source string; <var>begin</var>, the index of the first character in the
range; <var>end</var>, optional, the index of the character next to the last
in the range, this character is not extracted.  <var>end</var> defaults to
the last character in the string; if equal to <code>end</code>: the end of the
range is the end of the string.  Echo to stdout the selected range of
characters.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005fequal_005fsubstring"></a>Function: <strong>mbfl_string_equal_substring</strong> <em><var>string</var> <var>position</var> <var>pattern</var></em></dt>
<dd><p>Return true if the substring starting at <var>position</var> in <var>string</var>
is equal to <var>pattern</var>; else return false.  If <var>position</var> plus
the length of <var>pattern</var> is greater than the length of <var>string</var>:
the return value is false, always.
</p></dd></dl>

<hr>
<a name="string-splitting"></a>
<div class="header">
<p>
Next: <a href="#string-case" accesskey="n" rel="next">string case</a>, Previous: <a href="#string-inspection" accesskey="p" rel="prev">string inspection</a>, Up: <a href="#string" accesskey="u" rel="up">string</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Splitting-a-string"></a>
<h3 class="section">13.3 Splitting a string</h3>


<dl>
<dt><a name="index-mbfl_005fstring_005fchars"></a>Function: <strong>mbfl_string_chars</strong> <em><var>string</var></em></dt>
<dd><p>Split a string into characters.  Fill an array named <code>SPLITFIELD</code>
with the characters from the string; the number of elements in the array
is stored in a variable named <code>SPLITCOUNT</code>.  Both <code>SPLITFIELD</code>
and <code>SPLITCOUNT</code> can be declared <code>local</code> in the scope of the
caller.
</p>
<p>The difference between this function and using <code>${STRING:$i:1}</code>,
is that this function detects backslash characters, <code>\</code>, and treats
them as part of the following character.  So, for example, the sequence
<code>\n</code> is treated as a single char.
</p></dd></dl>


<p>Example of usage for <code>mbfl_string_chars()</code>:
</p>
<div class="example">
<pre class="example">string=&quot;abcde\nfghilm&quot;
mbfl_string_chars &quot;${string}&quot;
# Now:
# &quot;${#string}&quot; = $SPLITCOUNT
#  a = &quot;${SPLITFIELD[0]}&quot;
#  b = &quot;${SPLITFIELD[1]}&quot;
#  c = &quot;${SPLITFIELD[2]}&quot;
#  d = &quot;${SPLITFIELD[3]}&quot;
#  e = &quot;${SPLITFIELD[4]}&quot;
#  \n = &quot;${SPLITFIELD[5]}&quot;
#  f = &quot;${SPLITFIELD[6]}&quot;
#  g = &quot;${SPLITFIELD[7]}&quot;
#  h = &quot;${SPLITFIELD[8]}&quot;
#  i = &quot;${SPLITFIELD[9]}&quot;
#  l = &quot;${SPLITFIELD[10]}&quot;
#  m = &quot;${SPLITFIELD[11]}&quot;
</pre></div>


<dl>
<dt><a name="index-mbfl_005fstring_005fsplit"></a>Function: <strong>mbfl_string_split</strong> <em><var>string</var> <var>separator</var></em></dt>
<dd><p>Split <var>string</var> into fields using <var>separator</var>.  Fill an array
named <code>SPLITFIELD</code> with the characters from the string; the number
of elements in the array is stored in a variable named
<code>SPLITCOUNT</code>.  Both <code>SPLITFIELD</code> and <code>SPLITCOUNT</code> can be
declared <code>local</code> in the scope of the caller.
</p></dd></dl>

<hr>
<a name="string-case"></a>
<div class="header">
<p>
Next: <a href="#string-class" accesskey="n" rel="next">string class</a>, Previous: <a href="#string-splitting" accesskey="p" rel="prev">string splitting</a>, Up: <a href="#string" accesskey="u" rel="up">string</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Converting-between-upper-and-lower-case"></a>
<h3 class="section">13.4 Converting between upper and lower case</h3>


<dl>
<dt><a name="index-mbfl_005fstring_005ftoupper"></a>Function: <strong>mbfl_string_toupper</strong> <em><var>string</var></em></dt>
<dd><p>Output <var>string</var> with all the occurrences of lower case <acronym>ASCII</acronym>
characters (no accents) turned into upper case.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005ftolower"></a>Function: <strong>mbfl_string_tolower</strong> <em><var>string</var></em></dt>
<dd><p>Output <var>string</var> with all the occurrences of upper case <acronym>ASCII</acronym>
characters (no accents) turned into lower case.
</p></dd></dl>

<hr>
<a name="string-class"></a>
<div class="header">
<p>
Next: <a href="#string-misc" accesskey="n" rel="next">string misc</a>, Previous: <a href="#string-case" accesskey="p" rel="prev">string case</a>, Up: <a href="#string" accesskey="u" rel="up">string</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Matching-a-string-with-a-class"></a>
<h3 class="section">13.5 Matching a string with a class</h3>


<dl>
<dt><a name="index-mbfl_005fstring_005fis_005falpha_005fchar"></a>Function: <strong>mbfl_string_is_alpha_char</strong> <em><var>char</var></em></dt>
<dd><p>Return true if <var>char</var> is in one of the ranges: &lsquo;<samp>[a-z]</samp>&rsquo;,
&lsquo;<samp>[A-Z]</samp>&rsquo;.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005fis_005fdigit_005fchar"></a>Function: <strong>mbfl_string_is_digit_char</strong> <em><var>char</var></em></dt>
<dd><p>Return true if <var>char</var> is in the range: <code>0-9</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005fis_005falnum_005fchar"></a>Function: <strong>mbfl_string_is_alnum_char</strong> <em><var>char</var></em></dt>
<dd><p>Return true if:
</p>
<div class="example">
<pre class="example">mbfl_string_is_alpha_char <var>char</var> || \
   mbfl_string_is_digit_char <var>char</var>
</pre></div>
</dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005fis_005fnoblank_005fchar"></a>Function: <strong>mbfl_string_is_noblank_char</strong> <em><var>char</var></em></dt>
<dd><p>Return true if <var>char</var> is none of the characters: &lsquo;<samp> </samp>&rsquo;,
&lsquo;<samp>\n</samp>&rsquo;, &lsquo;<samp>\r</samp>&rsquo;, &lsquo;<samp>\f</samp>&rsquo;, &lsquo;<samp>\t</samp>&rsquo;.  <var>char</var> is meant to be
the unquoted version of the non&ndash;blank characters, the one obtained
with:
</p>
<div class="example">
<pre class="example">$'char'
</pre></div>
</dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005fis_005fname_005fchar"></a>Function: <strong>mbfl_string_is_name_char</strong> <em><var>char</var></em></dt>
<dd><p>Return true if <code>mbfl_string_is_alnum_char()</code> returns true when
applied to <var>char</var> or <var>char</var> is an underscore, &lsquo;<samp>_</samp>&rsquo;.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005fis_005fidentifier_005fchar"></a>Function: <strong>mbfl_string_is_identifier_char</strong> <em><var>char</var></em></dt>
<dd><p>Return true if <code>mbfl_string_is_alnum_char()</code> returns true when
applied to <var>char</var> or <var>char</var> is an underscore, &lsquo;<samp>_</samp>&rsquo;, or dash,
&lsquo;<samp>-</samp>&rsquo;.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005fis_005fextended_005fidentifier_005fchar"></a>Function: <strong>mbfl_string_is_extended_identifier_char</strong> <em><var>char</var></em></dt>
<dd><p>Like <code>mbfl_string_is_identifier_char()</code>, but also accept dots
&lsquo;<samp>.</samp>&rsquo;.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005fis_005falpha"></a>Function: <strong>mbfl_string_is_alpha</strong> <em><var>string</var></em></dt>
<dt><a name="index-mbfl_005fstring_005fis_005fdigit"></a>Function: <strong>mbfl_string_is_digit</strong> <em><var>string</var></em></dt>
<dt><a name="index-mbfl_005fstring_005fis_005falnum"></a>Function: <strong>mbfl_string_is_alnum</strong> <em><var>string</var></em></dt>
<dt><a name="index-mbfl_005fstring_005fis_005fnoblank"></a>Function: <strong>mbfl_string_is_noblank</strong> <em><var>string</var></em></dt>
<dt><a name="index-mbfl_005fstring_005fis_005fname"></a>Function: <strong>mbfl_string_is_name</strong> <em><var>string</var></em></dt>
<dt><a name="index-mbfl_005fstring_005fis_005fidentifier"></a>Function: <strong>mbfl_string_is_identifier</strong> <em><var>string</var></em></dt>
<dt><a name="index-mbfl_005fstring_005fis_005fextended_005fidentifier"></a>Function: <strong>mbfl_string_is_extended_identifier</strong> <em><var>string</var></em></dt>
<dd><p>Return true if <var>string</var> is non&ndash;empty and the associated char
function returns true for each character in <var>string</var>.  As additional
constraint:
</p>
<ul>
<li> <code>mbfl_string_is_name()</code> returns false if <code>mbfl_string_is_digit()</code>
returns true when applied to the first character of <var>string</var>.

</li><li> <code>mbfl_string_is_identifier()</code> and
<code>mbfl_string_is_extended_identifier()</code> return false if
<code>mbfl_string_is_digit()</code> returns true when applied to the first
character of <var>string</var> or the first char of <var>string</var> is a dash.
</li></ul>
</dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005fis_005fusername"></a>Function: <strong>mbfl_string_is_username</strong> <em><var>string</var></em></dt>
<dd><p>Return true if <var>string</var> is non&ndash;empty, all its characters are in the
ranges <code>[a-zA-Z0-9_-]</code>, the first character is in the range
<code>[a-zA-Z_]</code>; else return false.
</p></dd></dl>

<hr>
<a name="string-misc"></a>
<div class="header">
<p>
Previous: <a href="#string-class" accesskey="p" rel="prev">string class</a>, Up: <a href="#string" accesskey="u" rel="up">string</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Miscellaneous-functions"></a>
<h3 class="section">13.6 Miscellaneous functions</h3>


<dl>
<dt><a name="index-mbfl_005fstring_005freplace"></a>Function: <strong>mbfl_string_replace</strong> <em><var>string</var> <var>pattern</var></em></dt>
<dt><a name="index-mbfl_005fstring_005freplace-1"></a>Function: <strong>mbfl_string_replace</strong> <em><var>string</var> <var>pattern</var> <var>subst</var></em></dt>
<dd><p>Replace all the occurrences of <var>pattern</var> in <var>string</var> with
<var>subst</var>, then print the result.  If not used, <var>subst</var> defaults
to the empty string.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fsprintf"></a>Function: <strong>mbfl_sprintf</strong> <em><var>varname</var> <var>format</var> ...</em></dt>
<dd><p>Make use of <code>printf</code> to format the string <var>format</var> with the
additional arguments, then store the result in <var>varname</var>: If this
name is local in the scope of the caller, this has the effect of filling
the variable in that scope.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fstring_005fskip"></a>Function: <strong>mbfl_string_skip</strong> <em><var>string</var> <var>varname</var> <var>char</var></em></dt>
<dd><p>Skip all the characters in a string equal to <var>char</var>.  <var>varname</var>
is the name of a variable in the scope of the caller: Its value is the
offset of the first character to test in <var>string</var>.  The offset is
incremented until a char different from <var>char</var> is found, then the
value of <var>varname</var> is updated to the position of the different char.
If the initial value of the offset corresponds to a char equal to
<var>char</var>, the variable is left untouched.  Return true.
</p></dd></dl>

<hr>
<a name="dialog"></a>
<div class="header">
<p>
Next: <a href="#variables" accesskey="n" rel="next">variables</a>, Previous: <a href="#string" accesskey="p" rel="prev">string</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Interacting-with-the-user"></a>
<h2 class="chapter">14 Interacting with the user</h2>


<dl>
<dt><a name="index-mbfl_005fdialog_005fyes_005for_005fno"></a>Function: <strong>mbfl_dialog_yes_or_no</strong> <em><var>string</var></em></dt>
<dt><a name="index-mbfl_005fdialog_005fyes_005for_005fno-1"></a>Function: <strong>mbfl_dialog_yes_or_no</strong> <em><var>string</var> <var>progname</var></em></dt>
<dd><p>Print the question <var>string</var> on the standard output and wait for the
user to type <code>yes</code> or <code>no</code> in the standard input.  Return true
if the user has typed <code>yes</code>, false if the user has typed <code>no</code>.
</p>
<p>The optional parameter <var>progname</var> is used as prefix for the prompt;
if not given: It defaults to the value of <code>script_PROGNAME</code>.
<a href="#service-variables">Required user defined variables</a>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fdialog_005fenable_005fprograms"></a>Function: <strong>mbfl_dialog_enable_programs</strong></dt>
<dd><p>Declare the usage of the external program <code>stty</code>, which is used
by <code>mbfl_dialog_ask_password()</code> to turn of password echoing on the
terminal.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fdialog_005fask_005fpassword"></a>Function: <strong>mbfl_dialog_ask_password</strong> <em><var>prompt</var></em></dt>
<dd><p>Print <var>prompt</var> followed by a colon and a space, then reads a
password from the terminal.  Print the password.
</p></dd></dl>

<hr>
<a name="variables"></a>
<div class="header">
<p>
Next: <a href="#system" accesskey="n" rel="next">system</a>, Previous: <a href="#dialog" accesskey="p" rel="prev">dialog</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Manipulating-variables"></a>
<h2 class="chapter">15 Manipulating variables</h2>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#variables-arrays" accesskey="1">variables arrays</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Manipulating arrays.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#variables-colon" accesskey="2">variables colon</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Manipulating colon variables.
</td></tr>
</table>

<hr>
<a name="variables-arrays"></a>
<div class="header">
<p>
Next: <a href="#variables-colon" accesskey="n" rel="next">variables colon</a>, Up: <a href="#variables" accesskey="u" rel="up">variables</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Manipulating-arrays"></a>
<h3 class="section">15.1 Manipulating arrays</h3>


<p><a href="#variables-colon">Manipulating colon variables</a>, for the use of the
following functions.
</p>

<dl>
<dt><a name="index-mbfl_005fvariable_005ffind_005fin_005farray"></a>Function: <strong>mbfl_variable_find_in_array</strong> <em><var>element</var></em></dt>
<dd><p>Search the array <code>mbfl_FIELDS</code> for a value equal to <var>element</var>.
If it is found: Print the index and return true; else print nothing and
return false.
</p>
<p><code>mbfl_FIELDS</code> must be filled with elements having subsequent
indexes starting at zero.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fvariable_005felement_005fis_005fin_005farray"></a>Function: <strong>mbfl_variable_element_is_in_array</strong> <em><var>element</var></em></dt>
<dd><p>A wrapper for <code>mbfl_variable_find_in_array()</code> that does not print
anything.
</p></dd></dl>

<hr>
<a name="variables-colon"></a>
<div class="header">
<p>
Previous: <a href="#variables-arrays" accesskey="p" rel="prev">variables arrays</a>, Up: <a href="#variables" accesskey="u" rel="up">variables</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Manipulating-colon-variables"></a>
<h3 class="section">15.2 Manipulating colon variables</h3>


<dl>
<dt><a name="index-mbfl_005fvariable_005fcolon_005fvariable_005fto_005farray"></a>Function: <strong>mbfl_variable_colon_variable_to_array</strong> <em><var>varname</var></em></dt>
<dd><p>Take <var>varname</var>&rsquo;s value, a colon separated list of string, and store
each string in the array <code>mbfl_FIELDS</code>, starting with a base index
of zero.
</p>
<p>Example:
</p>
<div class="example">
<pre class="example">VAR=a:b:c:d:e
declare -a mbfl_FIELDS

mbfl_variable_colon_variable_to_array VAR

echo ${#mbfl_FIELDS[*]}       -| 5
echo &quot;${mbfl_FIELDS[0]}&quot;      -| a
echo &quot;${mbfl_FIELDS[1]}&quot;      -| b
echo &quot;${mbfl_FIELDS[2]}&quot;      -| c
echo &quot;${mbfl_FIELDS[3]}&quot;      -| d
echo &quot;${mbfl_FIELDS[4]}&quot;      -| e
</pre></div>
</dd></dl>


<dl>
<dt><a name="index-mbfl_005fvariable_005farray_005fto_005fcolon_005fvariable"></a>Function: <strong>mbfl_variable_array_to_colon_variable</strong> <em><var>varname</var></em></dt>
<dd><p>Store each value from the array <code>mbfl_FIELDS</code> (with base index
zero) in <var>varname</var> as a colon separated list of strings.
</p>
<p>Example:
</p>
<div class="example">
<pre class="example">declare -a mbfl_FIELDS=(a b c d e)

mbfl_variable_array_to_colon_variable VAR
echo $VAR                       -| a:b:c:d:e
</pre></div>
</dd></dl>


<dl>
<dt><a name="index-mbfl_005fvariable_005fcolon_005fvariable_005fdrop_005fduplicate"></a>Function: <strong>mbfl_variable_colon_variable_drop_duplicate</strong> <em><var>varname</var></em></dt>
<dd><p>Take <var>varname</var>&rsquo;s value, a colon separated list of string, and
remove duplicates.  Reset <var>varname</var> to the result.
</p></dd></dl>

<hr>
<a name="system"></a>
<div class="header">
<p>
Next: <a href="#main" accesskey="n" rel="next">main</a>, Previous: <a href="#variables" accesskey="p" rel="prev">variables</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Interfacing-with-the-system"></a>
<h2 class="chapter">16 Interfacing with the system</h2>


<dl>
<dt><a name="index-mbfl_005fsystem_005fenable_005fprograms"></a>Function: <strong>mbfl_system_enable_programs</strong></dt>
<dd><p>Declare the intention to use the programs required by this module.
<a href="#program-declaring">Declaring the intention to use a program</a>.
</p>
<p>Required programs are: <code>grep</code>, <code>cut</code>.
</p></dd></dl>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#system-user-id" accesskey="1">system user id</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Converting user identifiers.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#system-file-perms" accesskey="2">system file perms</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Converting file permissions.
</td></tr>
</table>

<hr>
<a name="system-user-id"></a>
<div class="header">
<p>
Next: <a href="#system-file-perms" accesskey="n" rel="next">system file perms</a>, Up: <a href="#system" accesskey="u" rel="up">system</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Converting-user-identifiers"></a>
<h3 class="section">16.1 Converting user identifiers</h3>


<dl>
<dt><a name="index-mbfl_005fsystem_005fnumerical_005fuser_005fid_005fto_005fname"></a>Function: <strong>mbfl_system_numerical_user_id_to_name</strong> <em><var>id</var></em></dt>
<dd><p>Convert the numerical user <var>id</var> to the user name found in the
<samp>/etc/passwd</samp> file.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fsystem_005fnumerical_005fuser_005fid_005fto_005fname-1"></a>Function: <strong>mbfl_system_numerical_user_id_to_name</strong> <em><var>name</var></em></dt>
<dd><p>Convert the symbolic user <var>name</var> to the numerical identifier found
in the <samp>/etc/passwd</samp> file.
</p></dd></dl>

<hr>
<a name="system-file-perms"></a>
<div class="header">
<p>
Previous: <a href="#system-user-id" accesskey="p" rel="prev">system user id</a>, Up: <a href="#system" accesskey="u" rel="up">system</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Converting-file-permissions"></a>
<h3 class="section">16.2 Converting file permissions</h3>


<dl>
<dt><a name="index-mbfl_005fsystem_005fsymbolic_005fto_005foctal_005fpermissions"></a>Function: <strong>mbfl_system_symbolic_to_octal_permissions</strong> <em><var>mode</var></em></dt>
<dd><p>Convert three chars representing file permissions in a single octal
digit.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fsystem_005foctal_005fto_005fsymbolic_005fpermissions"></a>Function: <strong>mbfl_system_octal_to_symbolic_permissions</strong> <em><var>mode</var></em></dt>
<dd><p>Convert a single octal digit representing file permissions into three
chars.
</p></dd></dl>

<hr>
<a name="main"></a>
<div class="header">
<p>
Next: <a href="#testing" accesskey="n" rel="next">testing</a>, Previous: <a href="#system" accesskey="p" rel="prev">system</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Main-function"></a>
<h2 class="chapter">17 Main function</h2>


<p><acronym>MBFL</acronym> declares a function to drive the execution of the script; its
purpose is to make use of the other modules to reduce the size of
scripts depending on <acronym>MBFL</acronym>.   All the code blocks in the script, with
the exception of global variables declaration, should be enclosed in
functions.
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#main-variables" accesskey="1">main variables</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Command line arguments variables.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#main-function" accesskey="2">main function</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Driving script execution.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#main-exit" accesskey="3">main exit</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Declaring exit codes.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#main-misc" accesskey="4">main misc</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Other functions.
</td></tr>
</table>

<hr>
<a name="main-variables"></a>
<div class="header">
<p>
Next: <a href="#main-function" accesskey="n" rel="next">main function</a>, Up: <a href="#main" accesskey="u" rel="up">main</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Command-line-arguments-variables"></a>
<h3 class="section">17.1 Command line arguments variables</h3>


<p>The following global variables are defined by default.
</p>

<dl>
<dt><a name="index-ARGV1"></a>Variable: <strong>ARGV1</strong></dt>
<dd><p>An array containing all the command line arguments.  When no command
line arguments are present: this array is empty.
</p></dd></dl>


<dl>
<dt><a name="index-ARGC1"></a>Variable: <strong>ARGC1</strong></dt>
<dd><p>A non&ndash;negative integer representing the number of values in
<code>ARGV1</code>.  When no command line arguments are present: this variable
is set to zero.
</p></dd></dl>


<dl>
<dt><a name="index-ARG1ST"></a>Variable: <strong>ARG1ST</strong></dt>
<dd><p>A non&ndash;negative integer representing the index in <code>ARGV1</code> of the
next argument to be processed.  It is initialised to zero; the
<code>actions</code> module increments it to reflect its consuming of action
arguments; the <code>getopts</code> module uses this value to locate the first
argument to parse.
</p></dd></dl>


<dl>
<dt><a name="index-ARGV"></a>Variable: <strong>ARGV</strong></dt>
<dd><p>An array containing all the non&ndash;action and non&ndash;option command line
arguments.  When no such arguments are present: this array is empty.
This variable is filled by the <code>getopts</code> module.
</p></dd></dl>


<dl>
<dt><a name="index-ARGC"></a>Variable: <strong>ARGC</strong></dt>
<dd><p>A non&ndash;negative integer representing the number of values in
<code>ARGV</code>.  When no arguments are present: this variable is set to
zero.
</p></dd></dl>

<hr>
<a name="main-function"></a>
<div class="header">
<p>
Next: <a href="#main-exit" accesskey="n" rel="next">main exit</a>, Previous: <a href="#main-variables" accesskey="p" rel="prev">main variables</a>, Up: <a href="#main" accesskey="u" rel="up">main</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Driving-script-execution"></a>
<h3 class="section">17.2 Driving script execution</h3>


<a name="index-script_005fafter_005fparsing_005foptions"></a>
<a name="index-script_005fbefore_005fparsing_005foptions"></a>


<dl>
<dt><a name="index-mbfl_005fmain"></a>Function: <strong>mbfl_main</strong></dt>
<dd><p>The invocation to this function must be the last line of code in the
script.  It does the following:
</p>
<ol>
<li> Register the value of the variable <code>script_PROGNAME</code> in the message
module using the function <code>mbfl_message_set_progname()</code>.

</li><li> Invoke <code>mbfl_main_create_exit_functions()</code>.  <a href="#main-exit">Declaring exit codes</a>.

</li><li> Parse the command line arguments according to the command actions
configuration; this step may change the selection of: main function,
&ldquo;before parsing options&rdquo; function, &ldquo;after parsing options&rdquo; function;
if no command actions are configured: nothing is done.

<p>This function searches for a declared action set with name <code>MAIN</code>:
if such set exists, it expects the first argument to be an action
identifier in the set.
</p>
</li><li> If it exists: invoke the function <code>script_before_parsing_options()</code>
or the one selected by <code>mbfl_main_set_before_parsing_options()</code>.

</li><li> Parse command line options with <code>mbfl_getopts_parse()</code>.

</li><li> If it exists: invoke the function <code>script_after_parsing_options()</code>
or the one selected by <code>mbfl_main_set_after_parsing_options()</code>.

</li><li> Invoke the function whose name is stored in the global variable
<code>mbfl_main_SCRIPT_FUNCTION</code>, if it exists, with no arguments; if
its return value is non&ndash;zero: exit the script with the same code.  The
default value is <code>main</code>.

</li><li> Exit the script with the return code of the action function or zero.
</li></ol>
</dd></dl>


<dl>
<dt><a name="index-mbfl_005fmain_005fset_005fmain"></a>Function: <strong>mbfl_main_set_main</strong> <em><var>funcname</var></em></dt>
<dd><p>Select the main function storing <var>funcname</var> into
<code>mbfl_main_SCRIPT_FUNCTION</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmain_005fSCRIPT_005fFUNCTION"></a>Variable: <strong>mbfl_main_SCRIPT_FUNCTION</strong></dt>
<dd><p>Global variable that holds the name of the custom main script function.
The default name is <code>main</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmain_005fset_005fbefore_005fparsing_005foptions"></a>Function: <strong>mbfl_main_set_before_parsing_options</strong> <em><var>funcname</var></em></dt>
<dd><p>The name of the function to be called right before parsing command line
options.  This value can be customised by both the <acronym>MBFL</acronym> and the user
script.
</p>
<p>The default function name is: <code>script_before_parsing_options()</code>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmain_005fset_005fafter_005fparsing_005foptions"></a>Function: <strong>mbfl_main_set_after_parsing_options</strong> <em><var>funcname</var></em></dt>
<dd><p>The name of the function to be called right after parsing command line
options.  This value can be customised by both the <acronym>MBFL</acronym> and the user
script.
</p>
<p>The default function name is: <code>script_after_parsing_options()</code>.
</p></dd></dl>

<hr>
<a name="main-exit"></a>
<div class="header">
<p>
Next: <a href="#main-misc" accesskey="n" rel="next">main misc</a>, Previous: <a href="#main-function" accesskey="p" rel="prev">main function</a>, Up: <a href="#main" accesskey="u" rel="up">main</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Declaring-exit-codes"></a>
<h3 class="section">17.3 Declaring exit codes</h3>


<p>Some functions and global variables are provided to declare script&rsquo;s
exit codes.
</p>

<dl>
<dt><a name="index-mbfl_005fmain_005fdeclare_005fexit_005fcode"></a>Function: <strong>mbfl_main_declare_exit_code</strong> <em><var>code</var> <var>name</var></em></dt>
<dd><p>Declare an exit code with value <var>code</var> and identifier <var>name</var>.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmain_005fcreate_005fexit_005ffunctions"></a>Function: <strong>mbfl_main_create_exit_functions</strong></dt>
<dd><p>For each of the codes declared with <code>mbfl_main_declare_exit_code()</code>:
Create a function for the <code>exit</code> command using the numerical code.
For example, if a code is declared as:
</p>
<div class="example">
<pre class="example">mbfl_main_declare_exit_code 4 unexistent_file
</pre></div>

<p>a function is created with:
</p>
<div class="example">
<pre class="example">function exit_because_unexistent_file () { exit 4; }
</pre></div>

<p>the name of the function is the string <code>exit_because_</code> followed by
the exit code name.  The function may be used in the script to exit the
process.
</p></dd></dl>


<p>By default the exit code <code>0</code> is associated to the name
<code>success</code> and the exit code <code>1</code> is associated to the name
<code>failure</code>; so the following functions exist.
</p>

<dl>
<dt><a name="index-exit_005fbecause_005fsuccess"></a>Function: <strong>exit_because_success</strong></dt>
<dt><a name="index-exit_005fsuccess"></a>Function: <strong>exit_success</strong></dt>
<dd><p>Exit the script with code zero.
</p></dd></dl>


<dl>
<dt><a name="index-exit_005fbecause_005ffailure"></a>Function: <strong>exit_because_failure</strong></dt>
<dt><a name="index-exit_005ffailure"></a>Function: <strong>exit_failure</strong></dt>
<dd><p>Exit the script with code one.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmain_005fprint_005fexit_005fcode"></a>Function: <strong>mbfl_main_print_exit_code</strong> <em><var>name</var></em></dt>
<dd><p>Print the code associated to <var>name</var>.
</p></dd></dl>

<hr>
<a name="main-misc"></a>
<div class="header">
<p>
Previous: <a href="#main-exit" accesskey="p" rel="prev">main exit</a>, Up: <a href="#main" accesskey="u" rel="up">main</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Other-functions-1"></a>
<h3 class="section">17.4 Other functions</h3>


<dl>
<dt><a name="index-mbfl_005finvoke_005fscript_005ffunction"></a>Function: <strong>mbfl_invoke_script_function</strong> <em><var>funcname</var></em></dt>
<dd><p>If <var>funcname</var> is the name of an existing function: it is invoked
with no arguments; the return value is the one of the called function.
The existence test is performed with:
</p>
<div class="example">
<pre class="example">type -t <var>FUNCNAME</var> = function
</pre></div>
</dd></dl>


<dl>
<dt><a name="index-mbfl_005finvoke_005fexistent_005fscript_005ffunction"></a>Function: <strong>mbfl_invoke_existent_script_function</strong> <em><var>funcname</var></em></dt>
<dd><p>Like <code>mbfl_invoke_script_function()</code>, but if the function does not
exist: print an error message to <code>stderr</code> and exit with failure.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmain_005fprint_005fusage_005fscreen_005flong"></a>Function: <strong>mbfl_main_print_usage_screen_long</strong></dt>
<dd><p>Print the help screen, long version.  It <strong>includes</strong> the
predefined command line options.
</p></dd></dl>


<dl>
<dt><a name="index-mbfl_005fmain_005fprint_005fusage_005fscreen_005fbrief"></a>Function: <strong>mbfl_main_print_usage_screen_brief</strong></dt>
<dd><p>Print the help screen, brief version.  It <strong>excludes</strong> the
predefined command line options.
</p></dd></dl>

<hr>
<a name="testing"></a>
<div class="header">
<p>
Next: <a href="#sendmail" accesskey="n" rel="next">sendmail</a>, Previous: <a href="#main" accesskey="p" rel="prev">main</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Building-test-suites"></a>
<h2 class="chapter">18 Building test suites</h2>


<p><acronym>MBFL</acronym> comes with a little library of functions that may be used to
build test suites; its aim is at building tests for Bash functions,
commands and scripts.
</p>
<p>The ideas at the base of this library are taken from the <code>tcltest</code>
package distributed with the <acronym>TCL</acronym> core <a name="DOCF1" href="#FOOT1"><sup>1</sup></a>;
this package had contributions from the following people/entities: Sun
Microsystems, Inc.; Scriptics Corporation; Ajuba Solutions; Don Porter,
<acronym>NIST</acronym>; probably many many others.
</p>
<p>The library tries to do as much as possible using functions and aliases,
not variables; this is an attempt to let the user redefine functions to
his taste.
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#testing-intro" accesskey="1">testing intro</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">A way to organise a test suite.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#testing-shell" accesskey="2">testing shell</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">A script to run tests.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#testing-config" accesskey="3">testing config</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Configuring the package.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#testing-running" accesskey="4">testing running</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Running tests.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#testing-compare" accesskey="5">testing compare</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Validating results by comparing.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#testing-output" accesskey="6">testing output</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Validating results by output.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#testing-messages" accesskey="7">testing messages</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Printing messages from test functions.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#testing-files" accesskey="8">testing files</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Handling files in tests.
</td></tr>
</table>

<hr>
<a name="testing-intro"></a>
<div class="header">
<p>
Next: <a href="#testing-shell" accesskey="n" rel="next">testing shell</a>, Up: <a href="#testing" accesskey="u" rel="up">testing</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="A-way-to-organise-a-test-suite"></a>
<h3 class="section">18.1 A way to organise a test suite</h3>


<p>A useful way to organise a test suite is to split it into a set of
files: one for each module to be tested.
</p>
<p>The file <samp>libmbfltest.sh</samp> must be sourced at the beginning of each
test file.  This means that the variables that you set may interfere
with the ones in the library; this should not happen because the test
library prefixes variable names with <code>mbfl_</code> or <code>dotest_</code>, but
one exception is <code>TMPDIR</code>: do not set it in your script, use
<code>dotest-echo-tmpdir()</code> to access that value.  <a href="#testing-files">Handling files in tests</a>.
</p>

<a name="A-not-so-automated-example"></a>
<h4 class="subsubheading">A not so automated example</h4>

<p>To understand how the library works lets examine a bare bones example.
</p>
<p>The function <code>dotest</code> should be invoked at the end of each module
in the test suite; each module should define functions starting with the
same prefix.  A module should be stored in a file, and should look like
the following:
</p>
<div class="example">
<pre class="example"># mymodule.test --

source libmbfltest.sh
source module.sh

function module-featureA-1.1 () { ... }
function module-featureA-1.2 () { ... }
function module-featureA-2.1 () { ... }
function module-featureB-1.1 () { ... }
function module-featureB-1.2 () { ... }

dotest module-
dotest-final-report

### end of file
</pre></div>

<p>the file should be executed with:
</p>
<div class="example">
<pre class="example">$ bash mymodule.test
</pre></div>

<p>To test just &quot;feature A&quot;:
</p>
<div class="example">
<pre class="example">$ TESTMATCH=module-featureA bash mymodule.test
</pre></div>

<p>Remember that the <code>source</code> builtin will look for files in the
directories selected by the <code>PATH</code> environment variables, so we may
want to do:
</p>
<div class="example">
<pre class="example">$ PATH=path/to/modules:${PATH} \
TESTMATCH=module-featureA bash mymodule.test
</pre></div>

<p>It is better to put such stuff in a <samp>Makefile</samp>, with <acronym>GNU</acronym> Make:
</p>
<div class="example">
<pre class="example">srcdir        = ...
builddir      = ...
BASH_PROGRAM  = bash
MODULES       = moduleA moduleB

testdir       = $(srcdir)/tests
test_FILES    = $(foreach f,$(MODULES),$(testdir)/$(f).test)

test_ENV      = PATH=$(builddir):$(testdir):$(PATH) \
                TESTMATCH=$(TESTMATCH)
test_CMD      = $(test_ENV) $(BASH_PROGRAM)

.PHONY: test-modules

test-modules:
        @$(foreach f,$(test_FILES),$(test_CMD) $(f);)
</pre></div>

<hr>
<a name="testing-shell"></a>
<div class="header">
<p>
Next: <a href="#testing-config" accesskey="n" rel="next">testing config</a>, Previous: <a href="#testing-intro" accesskey="p" rel="prev">testing intro</a>, Up: <a href="#testing" accesskey="u" rel="up">testing</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="A-script-to-run-tests"></a>
<h3 class="section">18.2 A script to run tests</h3>


<p><acronym>MBFL</acronym> comes with a script that can be used to handle the execution
of tests; it is called <code>mbfltest.sh</code>.  Synopsis:
</p>
<div class="example">
<pre class="example">mbfltest.sh [options] TESTFILE ...
</pre></div>

<p>supported options are all the <acronym>MBFL</acronym> generic ones (<a href="#getopts-options">Predefined options</a>) and additionally:
</p>
<dl compact="compact">
<dt><code>--start</code></dt>
<dd><p>Print start messages for tests, it is the same as invoking
<code>dotest-set-report-start()</code>.
</p>
</dd>
<dt><code>--end</code></dt>
<dd><p>Print end messages for tests, it is the same as invoking
<code>dotest-set-report-success()</code>.
</p>
</dd>
<dt><code>--match=VALUE</code></dt>
<dd><p>Select match pattern for tests, it is the same as setting the
<code>TESTMATCH</code> variable.
</p>
</dd>
<dt><code>--directory=VALUE</code></dt>
<dd><p>Change directory before executing tests, but after having located the
test files on the file system.
</p>
</dd>
<dt><code>--library=VALUE</code></dt>
<dd><p>Select a specific version of the <acronym>MBFL</acronym> library.
</p></dd>
</dl>

<p>When running tests with the script: in the test modules we can omit the
sourcing of <acronym>MBFL</acronym> and the <acronym>MBFL</acronym> test library, <code>mbfltest.sh</code>
does this before sourcing the test module.  Each test module is evaluated
in a <code>bash</code> subprocess, so: there is no interference between modules;
each module has to do its own initialisation and finalisation.
</p>
<p>With <acronym>GNU</acronym> Make we can do:
</p>
<div class="example">
<pre class="example">MBFLTEST        = mbfltest.sh
MBFLTEST_FLAGS  = --end
ifneq (,$(TESTMATCH))
MBFLTEST_FLAGS  += --match=$(TESTMATCH)
endif

srcdir          = ...
testdir         = $(srcdir)/tests
TESTNAME        = *
TESTFILES       = $(wildcard $(testdir)/$(TESTNAME).test)

.PHONY: test tests

ifneq ($(strip $(TESTFILES)),)
test tests:
        $(MBFLTEST) $(MBFLTEST_FLAGS) $(TESTFILES)
endif
</pre></div>

<hr>
<a name="testing-config"></a>
<div class="header">
<p>
Next: <a href="#testing-running" accesskey="n" rel="next">testing running</a>, Previous: <a href="#testing-shell" accesskey="p" rel="prev">testing shell</a>, Up: <a href="#testing" accesskey="u" rel="up">testing</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Configuring-the-package"></a>
<h3 class="section">18.3 Configuring the package</h3>


<dl>
<dt><a name="index-dotest_002dset_002dverbose"></a>Function: <strong>dotest-set-verbose</strong></dt>
<dt><a name="index-dotest_002dunset_002dverbose"></a>Function: <strong>dotest-unset-verbose</strong></dt>
<dd><p>Set or unset verbose execution.  If verbose mode is on: some commands
output messages on stderr describing what is going on.  Examples: files
and directories creation/removal.
</p></dd></dl>


<dl>
<dt><a name="index-dotest_002doption_002dverbose"></a>Function: <strong>dotest-option-verbose</strong></dt>
<dd><p>Return true if verbose mode is on, false otherwise.
</p></dd></dl>


<dl>
<dt><a name="index-dotest_002dset_002dtest"></a>Function: <strong>dotest-set-test</strong></dt>
<dt><a name="index-dotest_002dunset_002dtest"></a>Function: <strong>dotest-unset-test</strong></dt>
<dd><p>Set or unset test execution.  If test mode is on: external commands (like
<code>rm</code> and <code>mkdir</code>) are not executed, the command line is
sent to stderr.  Test mode is meant to be used to debug the test library
functions.
</p></dd></dl>


<dl>
<dt><a name="index-dotest_002doption_002dtest"></a>Function: <strong>dotest-option-test</strong></dt>
<dd><p>Return true if test mode is on, false otherwise.
</p></dd></dl>


<dl>
<dt><a name="index-dotest_002dset_002dreport_002dstart"></a>Function: <strong>dotest-set-report-start</strong></dt>
<dt><a name="index-dotest_002dunset_002dreport_002dstart"></a>Function: <strong>dotest-unset-report-start</strong></dt>
<dd><p>Set or unset printing a message upon starting a function.
</p></dd></dl>


<dl>
<dt><a name="index-dotest_002doption_002dreport_002dstart"></a>Function: <strong>dotest-option-report-start</strong></dt>
<dd><p>Return true if start function reporting is on; otherwise return false.
</p></dd></dl>


<dl>
<dt><a name="index-dotest_002dset_002dreport_002dsuccess"></a>Function: <strong>dotest-set-report-success</strong></dt>
<dt><a name="index-dotest_002dunset_002dreport_002dsuccess"></a>Function: <strong>dotest-unset-report-success</strong></dt>
<dd><p>Set or unset printing a message when a function execution
succeeds.  Failed tests always cause a message to be printed.
</p></dd></dl>


<dl>
<dt><a name="index-dotest_002doption_002dreport_002dsuccess"></a>Function: <strong>dotest-option-report-success</strong></dt>
<dd><p>Return true if success function reporting is on; otherwise return
false.
</p></dd></dl>

<hr>
<a name="testing-running"></a>
<div class="header">
<p>
Next: <a href="#testing-compare" accesskey="n" rel="next">testing compare</a>, Previous: <a href="#testing-config" accesskey="p" rel="prev">testing config</a>, Up: <a href="#testing" accesskey="u" rel="up">testing</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Running-test-functions"></a>
<h3 class="section">18.4 Running test functions</h3>


<dl>
<dt><a name="index-dotest_002dfinal_002dreport"></a>Function: <strong>dotest-final-report</strong></dt>
<dd><p>This function must be invoked as last command in the test file to report
errors and correctly exit the test script (in a way compatible with the
requirements of <acronym>GNU</acronym> Automake).
</p></dd></dl>


<dl>
<dt><a name="index-dotest"></a>Function: <strong>dotest</strong> <em><var>pattern</var></em></dt>
<dd><p>Run all the functions matching <var>pattern</var>.  Usually <var>pattern</var> is
the first part of the name of the functions to be executed; the function
names are selected with the following code:
</p>
<div class="example">
<pre class="example">compgen -A function <var>pattern</var>
</pre></div>

<p>There&rsquo;s no constraint on function names, but they must be one&ndash;word
names.
</p>
<p>Before running a test function: the current process working directory is
saved, and it is restored after the execution is terminated.
</p>
<p>The return value of the test functions is used as result of the test:
true, the test succeeded; false, the test failed.  Remembering that the
return value of a function is the return value of its last executed
command, the functions <code>dotest-equal()</code> and <code>dotest-output()</code>, and
of course the <code>test</code> command, may be used to return the correct
value.
</p></dd></dl>


<p>Messages are printed before and after the execution of each function,
according to the mode selected with: <code>dotest-set-report-success()</code>,
<code>dotest-set-report-start()</code>, &hellip;  <a href="#testing-config">Configuring the package</a>
</p>
<p>The following environment variables will influence the behaviour of
<code>dotest()</code>.
</p>

<dl>
<dt><a name="index-TESTMATCH"></a>Variable: <strong>TESTMATCH</strong></dt>
<dd><p>Override the <var>pattern</var> argument to <code>dotest()</code>.
</p></dd></dl>


<dl>
<dt><a name="index-TESTSTART"></a>Variable: <strong>TESTSTART</strong></dt>
<dd><p>If <code>yes</code>: It is equivalent to invoking
<code>dotest-set-report-start()</code>.  If <code>no</code>: It is equivalent to
invoking <code>dotest-unset-report-start()</code>.
</p></dd></dl>


<dl>
<dt><a name="index-TESTSUCCESS"></a>Variable: <strong>TESTSUCCESS</strong></dt>
<dd><p>If <code>yes</code>: It is equivalent to invoking
<code>dotest-set-report-success()</code>.  If <code>no</code>: It is equivalent to
invoking <code>dotest-unset-report-success()</code>.
</p></dd></dl>

<hr>
<a name="testing-compare"></a>
<div class="header">
<p>
Next: <a href="#testing-output" accesskey="n" rel="next">testing output</a>, Previous: <a href="#testing-running" accesskey="p" rel="prev">testing running</a>, Up: <a href="#testing" accesskey="u" rel="up">testing</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Validating-results-by-comparing"></a>
<h3 class="section">18.5 Validating results by comparing</h3>


<dl>
<dt><a name="index-dotest_002dequal"></a>Function: <strong>dotest-equal</strong> <em><var>expected</var> <var>got</var></em></dt>
<dd><p>Compare the two parameters and return true if they are equal; return
false otherwise.  In the latter case print a message showing the
expected value and the wrong one.  Must be used as last command in a
function, so that its return value is equal to that of the function.
</p></dd></dl>


<p>Example:
</p>
<div class="example">
<pre class="example">function my-func () {
    echo $(($1 + $2))
}
function mytest-1.1 () {
    dotest-result 5 `my-func 2 3`
}
dotest mytest-
</pre></div>

<p>another example:
</p>
<div class="example">
<pre class="example">function my-func () {
    echo $(($1 + $2))
}
function mytest-1.1 () {
    dotest-result 5 `my-func 2 3` &amp;&amp; \
      dotest-result 5 `my-func 1 4` &amp;&amp; \
      dotest-result 5 `my-func 3 2` &amp;&amp; \
}
dotest mytest-
</pre></div>

<hr>
<a name="testing-output"></a>
<div class="header">
<p>
Next: <a href="#testing-messages" accesskey="n" rel="next">testing messages</a>, Previous: <a href="#testing-compare" accesskey="p" rel="prev">testing compare</a>, Up: <a href="#testing" accesskey="u" rel="up">testing</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Validating-results-by-output"></a>
<h3 class="section">18.6 Validating results by output</h3>


<dl>
<dt><a name="index-dotest_002doutput"></a>Function: <strong>dotest-output</strong></dt>
<dt><a name="index-dotest_002doutput-1"></a>Function: <strong>dotest-output</strong> <em><var>string</var></em></dt>
<dd><p>Read all the available lines from stdin accumulating them into a local
variable, separated by <code>\n</code>; then compare the input with
<var>string</var>, or the empty string if <var>string</var> is not present, and
return true if they are equal, false otherwise.
</p></dd></dl>


<p>Example of test for a function that echoes its three parameters:
</p>
<div class="example">
<pre class="example">function my-lib-function () {
    echo $1 $2 $3
}
function mytest-1.1 () {
    my-lib-function a b c | dotest-output &quot;a b c&quot;
}
dotest mytest
</pre></div>

<p>Example of test for a function that is supposed to print nothing:
</p>
<div class="example">
<pre class="example">function my-lib-function () {
    test &quot;$1&quot; != &quot;$2&quot; &amp;&amp; echo error
}
function mytest-1.1 () {
    my-lib-function a a | dotest-output
}
dotest mytest
</pre></div>

<hr>
<a name="testing-messages"></a>
<div class="header">
<p>
Next: <a href="#testing-files" accesskey="n" rel="next">testing files</a>, Previous: <a href="#testing-output" accesskey="p" rel="prev">testing output</a>, Up: <a href="#testing" accesskey="u" rel="up">testing</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Printing-messages-from-test-functions"></a>
<h3 class="section">18.7 Printing messages from test functions</h3>


<dl>
<dt><a name="index-dotest_002decho"></a>Alias: <strong>dotest-echo</strong> <em><var>string</var> ?...?</em></dt>
<dt><a name="index-dotest_002ddebug"></a>Alias: <strong>dotest-debug</strong> <em><var>string</var> ?...?</em></dt>
<dd><p>Print the parameters on stderr.  <code>dotest-debug</code> prints some <code>*</code>
to make the message more visible.
</p></dd></dl>


<hr>
<a name="testing-files"></a>
<div class="header">
<p>
Previous: <a href="#testing-messages" accesskey="p" rel="prev">testing messages</a>, Up: <a href="#testing" accesskey="u" rel="up">testing</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Handling-files-in-tests"></a>
<h3 class="section">18.8 Handling files in tests</h3>


<p>In this section are described functions to be used to create temporary
files; it is a common task to write scripts to manipulate files and
directories.  All the files should be created under a temporary
directory that must be removed after each test function is invoked; the
library automatically invokes <code>dotest-clean-files()</code> when exiting
(using <code>trap</code>), but it is safer to invoke it at the end of each
function that creates files.
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#testing-files-directories" accesskey="1">testing files directories</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Directories.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#testing-files-files" accesskey="2">testing files files</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Files.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#testing-files-examples" accesskey="3">testing files examples</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Examples.
</td></tr>
</table>

<hr>
<a name="testing-files-directories"></a>
<div class="header">
<p>
Next: <a href="#testing-files-files" accesskey="n" rel="next">testing files files</a>, Up: <a href="#testing-files" accesskey="u" rel="up">testing files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Directories"></a>
<h4 class="subsection">18.8.1 Directories</h4>


<dl>
<dt><a name="index-dotest_002dcd"></a>Function: <strong>dotest-cd</strong> <em><var>directory</var></em></dt>
<dd><p>Change the working directory.  This is just a wrapper for <code>cd</code>;
if verbose mode is on: print a message.
</p></dd></dl>


<dl>
<dt><a name="index-dotest_002dmkdir"></a>Function: <strong>dotest-mkdir</strong> <em><var>directory</var></em></dt>
<dt><a name="index-dotest_002dmkdir-1"></a>Function: <strong>dotest-mkdir</strong> <em><var>directory</var> <var>prefix</var></em></dt>
<dd><p>Create <var>directory</var> under the temporary directory; <var>directory</var>
must be a relative pathname (that is: it must not begin with a slash).
</p>
<p>The optional <var>prefix</var> is a relative pathname that is prepended to
<var>directory</var>: it is useful to prepend the name of a parent directory.
</p>
<p>Print to stdout the full pathname of the directory.
</p></dd></dl>


<a name="Temporary-directory"></a>
<h4 class="subsubheading">Temporary directory</h4>

<dl>
<dt><a name="index-dotest_002decho_002dtmpdir"></a>Function: <strong>dotest-echo-tmpdir</strong></dt>
<dd><p>Print the value of the temporary directory in which all the files and
directories will be created.  The value is prefixed with the value of
the environment variable <code>TMPDIR</code>, or <samp>/tmp</samp> if not set.
</p></dd></dl>


<dl>
<dt><a name="index-dotest_002dcd_002dtmpdir"></a>Function: <strong>dotest-cd-tmpdir</strong></dt>
<dd><p>Change the working directory to the temporary directory.
</p></dd></dl>


<dl>
<dt><a name="index-dotest_002dmktmpdir"></a>Function: <strong>dotest-mktmpdir</strong></dt>
<dd><p>Create the temporary directory.  This is automatically invoked by
<code>dotest-mkfile()</code> before creating files; <code>dotest-mkdir()</code>
creates the temporary directory automatically by using the
<samp>--parents</samp> option of <code>mkdir</code>.
</p></dd></dl>

<hr>
<a name="testing-files-files"></a>
<div class="header">
<p>
Next: <a href="#testing-files-examples" accesskey="n" rel="next">testing files examples</a>, Previous: <a href="#testing-files-directories" accesskey="p" rel="prev">testing files directories</a>, Up: <a href="#testing-files" accesskey="u" rel="up">testing files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Files"></a>
<h4 class="subsection">18.8.2 Files</h4>


<dl>
<dt><a name="index-dotest_002dmkfile"></a>Function: <strong>dotest-mkfile</strong> <em><var>pathname</var></em></dt>
<dt><a name="index-dotest_002dmkfile-1"></a>Function: <strong>dotest-mkfile</strong> <em><var>pathname</var> <var>prefix</var></em></dt>
<dd><p>Create an empty file.  The optional <var>prefix</var> is a relative pathname
that is prepended to <var>pathname</var>: It is useful to prepend the name of
a parent directory.  Print to stdout the full pathname of the file.
</p></dd></dl>


<dl>
<dt><a name="index-dotest_002dclean_002dfiles"></a>Function: <strong>dotest-clean-files</strong></dt>
<dd><p>Remove the temporary directory and all its children.  Should be invoked
at the end of each function that creates temporary files or directories.
</p>
<p>Return the value of the last command executed before the invocation,
that way it can be used right after <code>dotest-output()</code> and
<code>dotest-equal()</code> without loosing the return value of the function.
</p></dd></dl>


<a name="Testing-conditions"></a>
<h4 class="subsubheading">Testing conditions</h4>


<dl>
<dt><a name="index-dotest_002dassert_002dfile_002dexists"></a>Function: <strong>dotest-assert-file-exists</strong> <em><var>file</var> <var>error_message</var></em></dt>
<dd><p>Test that <var>file</var> exists: If true returns with code zero; else print
<var>error_message</var>, invoke <code>dotest-clean-files()</code> and return with
code one.
</p></dd></dl>


<dl>
<dt><a name="index-dotest_002dassert_002dfile_002dunexists"></a>Function: <strong>dotest-assert-file-unexists</strong> <em><var>file</var> <var>error_message</var></em></dt>
<dd><p>Test that <var>file</var> does not exist: If true return with code zero; else
print <var>error_message</var>, invoke <code>dotest-clean-files()</code> and return
with code one.
</p></dd></dl>

<hr>
<a name="testing-files-examples"></a>
<div class="header">
<p>
Previous: <a href="#testing-files-files" accesskey="p" rel="prev">testing files files</a>, Up: <a href="#testing-files" accesskey="u" rel="up">testing files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Examples"></a>
<h4 class="subsection">18.8.3 Examples</h4>


<p>Examples of usage of <code>dotest-clean-files</code>:
</p>
<div class="example">
<pre class="example">function mytest-1.1 () {
    local dir=$(dotest-mkdir a/b)
    local result=

    ...
    result=...
    dotest-equal 123 $result
    dotest-clean-files
}
function mytest-1.2 () {
    local dir=$(dotest-mkfile file.ext)
    local result=

    ...
    result=...
    dotest-equal 123 $result
    dotest-clean-files
}

dotest mytest-
dotest-final-report
</pre></div>

<hr>
<a name="sendmail"></a>
<div class="header">
<p>
Next: <a href="#Package-License" accesskey="n" rel="next">Package License</a>, Previous: <a href="#testing" accesskey="p" rel="prev">testing</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Examples-for-sending-email"></a>
<h2 class="appendix">Appendix A Examples for sending email</h2>


<p>In this appendix we review some example scripts that can be used to send
email from a Bash script.  All the scripts are in the <acronym>MBFL</acronym>
distribution under the <samp>examples</samp> directory.
</p>
<p>First we examine plain scripts (making no use of <acronym>MBFL</acronym>) to understand
the basics of how to handle the <acronym>SMTP</acronym> protocol and how to &ldquo;talk&rdquo; to
a process in background.
</p>
<p>Then we see the documentation of a complex script,
<code>sendmail-mbfl.sh</code>, which can be used to send mail with plain or
encrypted connections.
</p>
<p>Finally we see how to use the <acronym>GNU</acronym> Emacs interface to the script,
<samp>sendmail-mbfl.el</samp>.  <a href="#sendmail-script-emacs">sendmail script emacs</a>.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#sendmail-message" accesskey="1">sendmail message</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">How to compose a test email message.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#sendmail-plain" accesskey="2">sendmail plain</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Just send an email message.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#sendmail-connector" accesskey="3">sendmail connector</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Send email through a process in
                                background.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#sendmail-gnutls" accesskey="4">sendmail gnutls</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Using <code>gnutls-cli</code> as connector.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#sendmail-openssl" accesskey="5">sendmail openssl</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Using <code>openssl</code> as connector.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#sendmail-script" accesskey="6">sendmail script</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Sending email.
</td></tr>
</table>

<hr>
<a name="sendmail-message"></a>
<div class="header">
<p>
Next: <a href="#sendmail-plain" accesskey="n" rel="next">sendmail plain</a>, Up: <a href="#sendmail" accesskey="u" rel="up">sendmail</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="How-to-compose-a-test-email-message"></a>
<h3 class="appendixsec">A.1 How to compose a test email message</h3>


<p>Here we discuss how to programmatically compose a minimal email message
to be used in testing email scripts.  Basically a message should look
like this:
</p>
<div class="example">
<pre class="example">Sender: marco@localhost
From: marco@localhost
To: root@localhost
Subject: proof from sendmail-plain.sh
Message-ID: &lt;15704-6692-23464@this.hostname&gt;
Date: Tue, 28 Apr 2009 06:16:01 +0200

This is a text proof from the sendmail-plain.sh script.
--
Marco
</pre></div>

<p>We have to remember that the <acronym>SMTP</acronym> server receiving the message may
rewrite the addresses, for example: replacing <code>localhost</code> with the
fully qualified local host name (the output of the command
<code>hostname --fqdn</code>); so, when reading the delivered message, we
do not have to be surprised to find changed addresses.
</p>
<p>We want to notice the following:
</p>
<ul>
<li> The fully qualified local host name is useful to build header values.
We can acquire it with the <code>hostname</code> command like this:

<div class="example">
<pre class="example">LOCAL_HOSTNAME=$(hostname --fqdn)
</pre></div>

<p>do not confuse this value with the host name of the <acronym>SMTP</acronym> server!
</p>
</li><li> The value of the <code>Message-ID</code> header must be enclosed in angular
parentheses, and it must contain an address&ndash;like string with random
characters in the name part.  It can be generated with:

<div class="example">
<pre class="example">MESSAGE_ID=$(printf '%d-%d-%d@%s' \
    $RANDOM $RANDOM $RANDOM &quot;$LOCAL_HOSTNAME&quot;)
</pre></div>

<p>or with:
</p>
<div class="example">
<pre class="example">MESSAGE_ID=$(printf '%s@%s'                    \
    $({ IFS= read -n 15 line &lt;/dev/random      \
         echo &quot;$line&quot; ; } |                    \
         md5sum --binary | cut -f1 -d' ')      \
    &quot;$LOCAL_HOSTNAME&quot;)
</pre></div>

</li><li> The value of the <code>Date</code> header must be the current date in a
specified format.  We can generate it using the <acronym>GNU</acronym> Date program like
this:

<div class="example">
<pre class="example">DATE=$(date --rfc-2822) || exit 2
</pre></div>

</li><li> In the body of the message: the string that separates the text from the
signature is the three characters string <code>-- </code> (dash, dash, white
space).  When composing the message we have to be careful to use
commands that <strong>do not</strong> drop white spaces.
</li></ul>

<p>In the end, we can use the following chunk of code to compose an email
message:
</p>
<div class="example">
<pre class="example">PROGNAME=${0##*/}
FROM_ADDRESS=marco@localhost
TO_ADDRESS=root@localhost

function print_message () {
    local LOCAL_HOSTNAME DATE MESSAGE_ID MESSAGE
    LOCAL_HOSTNAME=$(hostname --fqdn) || exit 2
    DATE=$(date --rfc-2822) || exit 2
    MESSAGE_ID=$(printf '%d-%d-%d@%s' \
        $RANDOM $RANDOM $RANDOM &quot;$LOCAL_HOSTNAME&quot;)
    MESSAGE=&quot;Sender: $FROM_ADDRESS
From: $FROM_ADDRESS
To: $TO_ADDRESS
Subject: proof from $PROGNAME
Message-ID: &lt;$MESSAGE_ID&gt;
Date: $DATE

This is a text proof from the $PROGNAME script.
--\x20
Marco
&quot;
    printf &quot;$MESSAGE&quot;
}
</pre></div>

<p>notice that to put the required single white space character in the
text/signature separator we use the escape sequence <code>\x20</code> (where
20 is the hexadecimal value of the white space character in the <acronym>ASCII</acronym>
encoding) and print the message with <code>printf</code>, which expands the
escape sequences.
</p>
<p>When sending the message to the <acronym>SMTP</acronym> server we have to:
</p>
<ul>
<li> Be careful in not to wrongly modify it.

</li><li> Send it one line at a time, terminating each line with a carriage
return, line feed sequence (<code>\r\n</code>).

</li><li> Quote with a dot lines starting with a dot.
</li></ul>

<p>So we can use an equivalent of the following chunk of code, assuming
<code>3</code> is the file descriptor connected to the remote <acronym>SMTP</acronym> server:
</p>
<div class="example">
<pre class="example">print_message | while IFS= read line
do
    if test &quot;${line:0:1}&quot; = '.'
    then printf '.%s\r\n' &quot;$line&quot; &gt;&amp;3
    else printf  '%s\r\n' &quot;$line&quot; &gt;&amp;3
    fi
done
</pre></div>

<p>notice that <code>read</code> is executed in an environment in which
<code>IFS</code> is set to the empty string, this is to prevent unwanted
modification of the message text.  <code>read</code> splits the string it
reads into words according to the current value of <code>IFS</code>, and this
may lead to mutation of the input string; word splitting happens when
there is a single output variable, too.  To prevent word splitting, we
set <code>IFS</code> to the empty string.
</p>
<hr>
<a name="sendmail-plain"></a>
<div class="header">
<p>
Next: <a href="#sendmail-connector" accesskey="n" rel="next">sendmail connector</a>, Previous: <a href="#sendmail-message" accesskey="p" rel="prev">sendmail message</a>, Up: <a href="#sendmail" accesskey="u" rel="up">sendmail</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Just-send-an-email-message"></a>
<h3 class="appendixsec">A.2 Just send an email message</h3>


<p>The script below can be found in <samp>examples/sendmail-plain.sh</samp>.  It
just sends a hard&ndash;coded email message, from a hard&ndash;coded address to a
hard&ndash;coded address.  It makes no use of <acronym>MBFL</acronym>.
</p>

<dl>
<dt><a name="index-main"></a>Function: <strong>main</strong></dt>
<dd><p>Drive the script controlling the <acronym>SMTP</acronym> protocol.  It should be obvious
what it does once we understand the following functions.
</p></dd></dl>


<dl>
<dt><a name="index-open_005fsession"></a>Function: <strong>open_session</strong> <em><var>hostname</var></em></dt>
<dd><p>Open a connection to the <acronym>SMTP</acronym> server using a fake device that Bash
gives us as interface to the network.  For the <code>localhost</code>, it ends
up being:
</p>
<div class="example">
<pre class="example">/dev/tcp/localhost/25
</pre></div>

<p>where 25 is the <acronym>TCP</acronym> port which is officially assigned to the <acronym>SMTP</acronym>
service.  To open the connection we use the idiom:
</p>
<div class="example">
<pre class="example">exec 3&lt;&gt;/dev/tcp/localhost/25
</pre></div>

<p>which means: open a read and write connection to the selected hostname,
using file descriptor number 3.  There is nothing special in number 3,
it is just the first free file descriptor number after 0 (standard
input), 1 (standard output) and 2 (standard error).
</p>
<p>The line:
</p>
<div class="example">
<pre class="example">trap 'exec 3&lt;&amp;-' EXIT
</pre></div>

<p>means: close file descriptor 3 whenever the script terminates.  This is
redundant in such a simple script, it is there for completeness.
</p></dd></dl>


<dl>
<dt><a name="index-send"></a>Function: <strong>send</strong> <em><var>string</var></em></dt>
<dt><a name="index-send-1"></a>Function: <strong>send</strong> <em><var>pattern</var> <var>arg</var> &hellip;</em></dt>
<dd><p>Send a string to the <acronym>SMTP</acronym> server.  Use <code>printf()</code> to format the
string <var>pattern</var> with the optional arguments, then write the
resulting string to file descriptor 3.  The string written out is
terminated with the sequence <code>\r\n</code> as mandated by the <acronym>SMTP</acronym>
protocol.
</p></dd></dl>


<dl>
<dt><a name="index-read_005fand_005fsend_005fmessage"></a>Function: <strong>read_and_send_message</strong></dt>
<dd><p>Read an email message from stdin line by line (newline terminator), and
rewrite it to file descriptor 3 terminating each line with the sequence
carriage return/line feed.  With the exception of the terminating
sequence, the lines are left unchanged.
</p></dd></dl>


<dl>
<dt><a name="index-recv"></a>Function: <strong>recv</strong> <em><var>expected_code</var></em></dt>
<dd><p>Read a line (a sequence of characters up until the first <code>\n</code>) from
file descriptor 3.  The line is interpreted as a message from the
<acronym>SMTP</acronym> server: the first three characters are a numeric code.  If the
code is different from <var>expected_code</var>, raise an error.
</p></dd></dl>

<div class="smallexample">
<pre class="verbatim">#! /bin/bash
#
# Part of: Marco's Bash Functions Library
# Contents: example script to send email
# Date: Thu Apr 23, 2009
#
# Abstract
#
#       This script just sends a hardcoded email message from
#       a hardcoded address to a hardcoded address.  It makes
#       no use of MBFL.
#
#         The purpose of this script is to understand how to
#       handle the SMTP protocol.
#
# Copyright (c) 2009, 2010 Marco Maggi &lt;marco.maggi-ipsu@poste.it&gt;
#
# This  program  is free  software:  you  can redistribute  it
# and/or modify it  under the terms of the  GNU General Public
# License as published by the Free Software Foundation, either
# version  3 of  the License,  or (at  your option)  any later
# version.
#
# This  program is  distributed in  the hope  that it  will be
# useful, but  WITHOUT ANY WARRANTY; without  even the implied
# warranty  of  MERCHANTABILITY or  FITNESS  FOR A  PARTICULAR
# PURPOSE.   See  the  GNU  General Public  License  for  more
# details.
#
# You should  have received a  copy of the GNU  General Public
# License   along   with    this   program.    If   not,   see
# &lt;http://www.gnu.org/licenses/&gt;.
#

PROGNAME=${0##*/}

function main () {
    local HOSTNAME=localhost
    local SMTP_PORT=25
    local FROM_ADDRESS=marco@localhost
    local TO_ADDRESS=root@localhost
    local LOGGING_TO_STDERR=yes

    open_session &quot;$HOSTNAME&quot;
    recv 220
    send 'HELO %s' 127.0.0.1
    recv 250
    send 'MAIL FROM:&lt;%s&gt;' &quot;$FROM_ADDRESS&quot;
    recv 250
    send 'RCPT TO:&lt;%s&gt;' &quot;$TO_ADDRESS&quot;
    recv 250
    send %s DATA
    recv 354
    print_message | read_and_send_message
    send %s .
    recv 250
    send %s QUIT
    recv 221
}
function print_message () {
    local LOCAL_HOSTNAME DATE MESSAGE_ID MESSAGE
    LOCAL_HOSTNAME=$(hostname --fqdn) || exit 2
    DATE=$(date --rfc-2822) || exit 2
    MESSAGE_ID=$(printf '%d-%d-%d@%s' \
        $RANDOM $RANDOM $RANDOM &quot;$LOCAL_HOSTNAME&quot;)
    MESSAGE=&quot;Sender: $FROM_ADDRESS
From: $FROM_ADDRESS
To: $TO_ADDRESS
Subject: proof from $PROGNAME
Message-ID: &lt;$MESSAGE_ID&gt;
Date: $DATE

This is a text proof from the $PROGNAME script.
--\x20
Marco
&quot;
    printf &quot;$MESSAGE&quot;
}
function open_session () {
    local HOSTNAME=${1:?}
    local DEVICE=$(printf '/dev/tcp/%s/%d' &quot;$HOSTNAME&quot; $SMTP_PORT)
    exec 3&lt;&gt;&quot;$DEVICE&quot;
    trap 'exec 3&lt;&amp;-' EXIT
}
function recv () {
    local EXPECTED_CODE=${1:?}
    local line=
    IFS= read -t 5 line &lt;&amp;3
    test 127 -lt $? &amp;&amp; {
        printf '%s: connection timed out\n' &quot;$PROGNAME&quot; &gt;&amp;2
        exit 2
    }
    test &quot;$LOGGING_TO_STDERR&quot; = yes &amp;&amp; \
        printf '%s log: recv: %s\n' &quot;$PROGNAME&quot; &quot;$line&quot;
    test &quot;${line:0:3}&quot; = &quot;$EXPECTED_CODE&quot; || {
        send %s QUIT
        # It is cleaner to wait for the reply from the
        # server.
        IFS= read -t 5 line &lt;&amp;3
        test 127 -lt $? &amp;&amp; {
            printf '%s: connection timed out\n' &quot;$PROGNAME&quot; &gt;&amp;2
            exit 2
        }
        test &quot;$LOGGING_TO_STDERR&quot; = yes &amp;&amp; \
            printf '%s log: recv: %s\n' &quot;$PROGNAME&quot; &quot;$line&quot;
        exit 2
    }
}
function send () {
    local pattern=${1:?}
    shift
    local line=$(printf &quot;$pattern&quot; &quot;$@&quot;)
    printf '%s\r\n' &quot;$line&quot; &gt;&amp;3
    test &quot;$LOGGING_TO_STDERR&quot; = yes &amp;&amp; \
        printf '%s log: sent: %s\n' &quot;$PROGNAME&quot; &quot;$line&quot;
}
function read_and_send_message () {
    local line
    local -i count=0
    while IFS= read line
    do
        if test &quot;${line:0:1}&quot; = '.'
        then printf '.%s\r\n' &quot;$line&quot; &gt;&amp;3
        else printf  '%s\r\n' &quot;$line&quot; &gt;&amp;3
        fi
        let ++count
    done
    test &quot;$LOGGING_TO_STDERR&quot; = yes &amp;&amp; \
        printf '%s log: sent message (%d lines)\n' &quot;$PROGNAME&quot; $count
}

main

### end of file
</pre></div>

<hr>
<a name="sendmail-connector"></a>
<div class="header">
<p>
Next: <a href="#sendmail-gnutls" accesskey="n" rel="next">sendmail gnutls</a>, Previous: <a href="#sendmail-plain" accesskey="p" rel="prev">sendmail plain</a>, Up: <a href="#sendmail" accesskey="u" rel="up">sendmail</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Send-email-through-a-process-in-background"></a>
<h3 class="appendixsec">A.3 Send email through a process in background</h3>


<p>The script below can be found in <samp>examples/sendmail-connector.sh</samp>.
It just sends a hard&ndash;coded email message, from a hard&ndash;coded address to a
hard&ndash;coded address.  It makes no use of <acronym>MBFL</acronym>.
</p>
<blockquote>
<p>Bash version 4 introduced the new keyword <code>coproc</code>, which can be
used to spawn processes in background and talk to them via pipes.  This
keyword in <strong>not</strong> used in this appendix.
</p></blockquote>

<p>The purpose of the script is to understand how to send a message through
a process in background.  It does the same things of the example
described in <a href="#sendmail-plain">Just send an email message</a>.  The main
difference is that the single function <code>open_session()</code> is replaced
by the two functions <code>open_session()</code> and <code>connector()</code>.
</p>
<p>What is important to understand, is how <code>open_session()</code> runs
<code>connector()</code> in background and sets up two file descriptors to talk
to it.  In the real world we never use this technique with a function;
this example script makes use of <code>connector()</code> as a replacement for
an external program that can establish sophisticated connections to
remote hosts, for example using the <acronym>TLS</acronym>/<acronym>SSL</acronym> protocols.
</p>

<dl>
<dt><a name="index-open_005fsession-1"></a>Function: <strong>open_session</strong> <em><var>hostname</var></em></dt>
<dd><p>Open a connection to the <acronym>SMTP</acronym> server spawning a background process
represented by the <code>connector()</code> function.  It makes use of two
<acronym>FIFO</acronym>s (First In, First Out).
</p>
<p>If we were to do it from a C language program: we would use the
<code>pipe()</code> system function to create two pipes connecting script&rsquo;s
process to the background process.
</p>
<div class="example">
<pre class="example"> ---------  out pipe  -----------  socket  --------
| script  |---------&gt;| connector |&lt;======&gt;| SMTP   |
| process |&lt;---------| process   |        | server |
 ---------  in pipe   -----------          --------
</pre></div>

<p>Bash has no way to create a pipe using the <code>pipe()</code> system function
(up until version 4), so we use two <acronym>FIFO</acronym> channels created by the
<code>mkfifo</code> program:
</p>
<div class="example">
<pre class="example">: ${TMPDIR:=/tmp}
local INFIFO=${TMPDIR}/in.$$
local OUFIFO=${TMPDIR}/out.$$

mkfifo --mode=0600 $INFIFO $OUFIFO
</pre></div>

<p>the script will use <code>INFIFO</code> to read characters from
<code>connector()</code>, and <code>OUFIFO</code> to send characters to
<code>connector()</code>.
</p>
<div class="example">
<pre class="example"> ---------  OUFIFO   -----------  socket  --------
| script  |--------&gt;| connector |&lt;======&gt;| SMTP   |
| process |&lt;--------| process   |        | server |
 ---------  INFIFO   -----------          --------
</pre></div>

<p>Once the <acronym>FIFO</acronym>s exist on the file system, we run <code>connector()</code> in
background, connecting its standard input and output to the <acronym>FIFO</acronym>s:
</p>
<div class="example">
<pre class="example">connector $HOSTNAME $SMTP_PORT &lt;$OUFIFO &gt;$INFIFO &amp;
</pre></div>

<p>be careful in selecting the redirections.  Notice that, in this simple
example, we ignore errors running <code>connector()</code>.
</p>
<p>Now we open file descriptors connecting them to the <acronym>FIFO</acronym>s:
</p>
<div class="example">
<pre class="example">exec 3&lt;&gt;$INFIFO 4&gt;$OUFIFO
</pre></div>

<p>the script will use file descriptor 3 to read characters from
<code>connector()</code>, and file descriptor 4 to send characters to
<code>connector()</code>.  We open the input <acronym>FIFO</acronym> for both reading and
writing, else <code>exec</code> will block waiting for the first char.
</p>
<p>We have connected both the ends of both the <acronym>FIFO</acronym>s, so we can remove
them from the file system:
</p>
<div class="example">
<pre class="example">rm $INFIFO $OUFIFO
</pre></div>

<p>the <acronym>FIFO</acronym>s will continue to exist in the OS kernel until the file
descriptors are closed.
</p>
<p>Finally we register a clean up handler that closes the descriptors:
</p>
<div class="example">
<pre class="example">trap 'exec 3&lt;&amp;- 4&gt;&amp;-' EXIT
</pre></div>
</dd></dl>


<dl>
<dt><a name="index-connector"></a>Function: <strong>connector</strong> <em><var>hostname</var></em></dt>
<dd><p>Establish a connection to the <acronym>SMTP</acronym> server at <var>hostname</var>.  It is
not important here to fully understand how this function works; suffice
it to say that it reads lines from stdin, and echoes them to the server;
it reads lines from the server, and echoes them to stdout.
</p></dd></dl>


<div class="smallexample">
<pre class="verbatim">#! /bin/bash
#
# Part of: Marco's Bash Functions Library
# Contents: example script to send email using bg process
# Date: Thu Apr 23, 2009
#
# Abstract
#
#       This script just sends a hardcoded email message from
#       a hardcoded address to a hardcoded address.  It makes
#       no use of MBFL.
#
#         The purpose of this script is to understand how to
#       send a message through a process in background.
#
# Copyright (c) 2009, 2010 Marco Maggi &lt;marco.maggi-ipsu@poste.it&gt;
#
# This  program  is free  software:  you  can redistribute  it
# and/or modify it  under the terms of the  GNU General Public
# License as published by the Free Software Foundation, either
# version  3 of  the License,  or (at  your option)  any later
# version.
#
# This  program is  distributed in  the hope  that it  will be
# useful, but  WITHOUT ANY WARRANTY; without  even the implied
# warranty  of  MERCHANTABILITY or  FITNESS  FOR A  PARTICULAR
# PURPOSE.   See  the  GNU  General Public  License  for  more
# details.
#
# You should  have received a  copy of the GNU  General Public
# License   along   with    this   program.    If   not,   see
# &lt;http://www.gnu.org/licenses/&gt;.
#

PROGNAME=${0##*/}
: ${TMPDIR:=/tmp}

function main () {
    local HOSTNAME=localhost
    local SMTP_PORT=25
    local FROM_ADDRESS=marco@localhost
    local TO_ADDRESS=root@localhost
    local LOGGING_TO_STDERR=yes

    open_session &quot;$HOSTNAME&quot;
    recv 220
    send 'HELO %s' 127.0.0.1
    recv 250
    send 'MAIL FROM:&lt;%s&gt;' &quot;$FROM_ADDRESS&quot;
    recv 250
    send 'RCPT TO:&lt;%s&gt;' &quot;$TO_ADDRESS&quot;
    recv 250
    send %s DATA
    recv 354
    print_message | read_and_send_message
    send %s .
    recv 250
    send %s QUIT
    recv 221
}
function print_message () {
    local LOCAL_HOSTNAME DATE MESSAGE_ID MESSAGE
    LOCAL_HOSTNAME=$(hostname --fqdn) || exit 2
    DATE=$(date --rfc-2822) || exit 2
    MESSAGE_ID=$(printf '%d-%d-%d@%s' \
        $RANDOM $RANDOM $RANDOM &quot;$LOCAL_HOSTNAME&quot;)
    MESSAGE=&quot;Sender: $FROM_ADDRESS
From: $FROM_ADDRESS
To: $TO_ADDRESS
Subject: proof from $PROGNAME
Message-ID: &lt;$MESSAGE_ID&gt;
Date: $DATE

This is a text proof from the $PROGNAME script.
--\x20
Marco
&quot;
    printf &quot;$MESSAGE&quot;
}
function open_session () {
    local HOSTNAME=${1:?}
    local INFIFO=${TMPDIR}/in.$$
    local OUFIFO=${TMPDIR}/out.$$
    # Bash  has  no  operation  equivalent to  the  C  level
    # &quot;pipe()&quot; function, so we have to use FIFOs.
    mkfifo --mode=0600 $INFIFO $OUFIFO
    connector &quot;$HOSTNAME&quot; &lt;$OUFIFO &gt;$INFIFO &amp;
    # Open the input FIFO for both reading and writing, else
    # &quot;exec&quot; will block waiting for the first char.
    exec 3&lt;&gt;$INFIFO 4&gt;$OUFIFO
    # We have connected both the  ends of both the FIFOs, so
    # we  can remove them  from the  file system:  the FIFOs
    # will continue to exist  until the file descriptors are
    # closed.
    rm $INFIFO $OUFIFO
    trap 'exec 3&lt;&amp;- 4&gt;&amp;-' EXIT
}
function recv () {
    local EXPECTED_CODE=${1:?}
    local line=
    IFS= read line &lt;&amp;3
    test &quot;$LOGGING_TO_STDERR&quot; = yes &amp;&amp; \
        printf '%s log: recv: %s\n' &quot;$PROGNAME&quot; &quot;$line&quot;
    if test &quot;${line:0:3}&quot; != &quot;$EXPECTED_CODE&quot;
    then
        send %s QUIT
        # It is cleaner to wait for the reply from the
        # server.
        IFS= read line &lt;&amp;3
        test &quot;$LOGGING_TO_STDERR&quot; = yes &amp;&amp; \
            printf '%s log: recv: %s\n' &quot;$PROGNAME&quot; &quot;$line&quot;
        exit 2
    fi
}
function send () {
    local pattern=${1:?}
    shift
    local line=$(printf &quot;$pattern&quot; &quot;$@&quot;)
    printf '%s\r\n' &quot;$line&quot; &gt;&amp;4
    test &quot;$LOGGING_TO_STDERR&quot; = yes &amp;&amp; \
        printf '%s log: sent: %s\n' &quot;$PROGNAME&quot; &quot;$line&quot;
}
function read_and_send_message () {
    local line
    local -i count=0
    while IFS= read line
    do
        if test &quot;${line:0:1}&quot; = '.'
        then printf '.%s\r\n' &quot;$line&quot; &gt;&amp;4
        else printf  '%s\r\n' &quot;$line&quot; &gt;&amp;4
        fi
        let ++count
    done
    test &quot;$LOGGING_TO_STDERR&quot; = yes &amp;&amp; \
        printf '%s log: sent message (%d lines)\n' &quot;$PROGNAME&quot; $count
}
function connector () {
    local HOSTNAME=${1:?} query= answer= line=
    local DEVICE=$(printf '/dev/tcp/%s/%d' &quot;$HOSTNAME&quot; $SMTP_PORT)
    exec 3&lt;&gt;&quot;$DEVICE&quot;
    # Read the  greetings from the server, echo  them to the
    # client.
    IFS= read -t 5 answer &lt;&amp;3
    test 127 -lt $? &amp;&amp; {
        printf '%s: connection timed out\n' &quot;$PROGNAME&quot; &gt;&amp;2
        exit 2
    }
    printf '%s\n' &quot;$answer&quot;
    # Read the query from the client, echo it to the server.
    while read query
    do
        printf '%s\r\n' &quot;$query&quot; &gt;&amp;3
        # Read the  answer from the  server, echo it  to the
        # client.
        IFS= read -t 5 answer &lt;&amp;3
        test 127 -lt $? &amp;&amp; {
            printf '%s: connection timed out\n' &quot;$PROGNAME&quot; &gt;&amp;2
            exit 2
        }
        printf '%s\n' &quot;$answer&quot;
        # Test special queries.
        test &quot;$query&quot; = QUIT$'\r' &amp;&amp; {
            IFS= read -t 5 answer &lt;&amp;3
            test 127 -lt $? &amp;&amp; {
                printf '%s: connection timed out\n' &quot;$PROGNAME&quot; &gt;&amp;2
                exit 2
            }
            printf '%s\n' &quot;$answer&quot;
            exit
        }
        test &quot;$query&quot; = DATA$'\r' &amp;&amp; {
            # Read data lines from  the client, echo them to
            # the server up until &quot;.\r&quot; is read.
            while IFS= read line
            do
                printf '%s\n' &quot;$line&quot; &gt;&amp;3
                test &quot;${line:0:2}&quot; = .$'\r' &amp;&amp; break
            done
            # Read the answer to  data from the server, echo
            # it to the client.
            IFS= read -t 5 answer &lt;&amp;3
            test 127 -lt $? &amp;&amp; {
                printf '%s: connection timed out\n' &quot;$PROGNAME&quot; &gt;&amp;2
                exit 2
            }
            printf '%s\n' &quot;$answer&quot;
        }
    done
    # We should never come here.
    exit 1
}

main

### end of file
</pre></div>

<hr>
<a name="sendmail-gnutls"></a>
<div class="header">
<p>
Next: <a href="#sendmail-openssl" accesskey="n" rel="next">sendmail openssl</a>, Previous: <a href="#sendmail-connector" accesskey="p" rel="prev">sendmail connector</a>, Up: <a href="#sendmail" accesskey="u" rel="up">sendmail</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Using-gnutls_002dcli-as-connector"></a>
<h3 class="appendixsec">A.4 Using <code>gnutls-cli</code> as connector</h3>


<p><acronym>GNU</acronym> <acronym>TLS</acronym> is a library implementing the <acronym>TLS</acronym> protocol; it can be
used to establish encrypted and authenticated connections to a remote
host.  The <acronym>SMTP</acronym> protocol has extensions to allow usage of a <acronym>TLS</acronym>
layer.
</p>
<p>A <acronym>GNU</acronym> <acronym>TLS</acronym> installation comes with a command line test program,
<code>gnutls-cli</code>, that can be used to establish an encrypted
connection by a shell script.  This command can be used as the
&ldquo;connector&rdquo; modeled in <a href="#sendmail-connector">Send email through a
process in background</a>.  It has a manual page, which we may want to
read.
</p>
<p>When handling an encrypted connection we have to know in advance how the
remote <acronym>SMTP</acronym> server behaves.  Let&rsquo;s see first the simpler example,
using the a human driven interactive session; then we will describe a
more complex interaction.
</p>
<blockquote>
<p>Notice that <code>gnutls-cli</code> has a <samp>--crlf</samp> option that will
cause all the lines sent to the server to be terminated by a carriage
return/line feed sequence (<code>\r\n</code> or <code>\x0d\x0a</code>).  If we write
a script that terminates by itself the lines with this sequence, for
example:
</p>
<div class="example">
<pre class="example">printf 'ehlo localhost.localdomain\r\n'
</pre></div>

<p>we must <strong>avoid</strong> this option, else <acronym>SMTP</acronym> protocol violation
errors may occur.  However, if we try a hand&ndash;driven interactive
session, we want to use this option to send protocol&ndash;compliant lines.
</p></blockquote>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#sendmail-gnutls-now" accesskey="1">sendmail gnutls now</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Immediate encrypted bridge.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#sendmail-gnutls-delay" accesskey="2">sendmail gnutls delay</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Delayed encrypted bridge.
</td></tr>
</table>

<hr>
<a name="sendmail-gnutls-now"></a>
<div class="header">
<p>
Next: <a href="#sendmail-gnutls-delay" accesskey="n" rel="next">sendmail gnutls delay</a>, Up: <a href="#sendmail-gnutls" accesskey="u" rel="up">sendmail gnutls</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Immediate-encrypted-bridge"></a>
<h4 class="appendixsubsec">A.4.1 Immediate encrypted bridge</h4>


<p>We use as example the server <code>relay.poste.it</code>, port <code>465</code>.
You have to have an account there to use it; do not bomb this server
with fake connections.  This server requests us to build the encrypted
bridge immediately after the connection has been established, without
waiting for any line of greetings from the server.
</p>
<p>So, we start the connector like this:
</p>
<div class="example">
<pre class="example">$ gnutls-cli --port 465 relay.poste.it
</pre></div>

<p>if the connection succeeds: <code>gnutls-cli</code> prints a lot of message
lines on its standard output explaining what is going on; at last comes
the line of greetings from the server, which begins with code <code>220</code>.
</p>
<p>The server supports the <code>AUTH LOGIN</code> authentication mechanism,
which requires the base64 encoding of the user name and password; we can
perform it with the external program <code>base64</code> (which comes with
<acronym>GNU</acronym> Coreutils) like this:
</p>
<div class="example">
<pre class="example">ENCODED_USERNAME=$(echo -n 'the-user-name' | base64)
ENCODED_PASSWORD=$(echo -n 'the-pass-word' | base64)
</pre></div>

<p><acronym>GNU</acronym> Emacs users can do it with:
</p>
<div class="example">
<pre class="example">(setq my-usr (base64-encode-string &quot;the-user-name&quot;))
(setq my-pwd (base64-encode-string &quot;the-pass-word&quot;))
</pre></div>

<p>The authentication dialogue goes like this:
</p>
<ol>
<li> We send <code>AUTH LOGIN</code>, to start the authentication.

</li><li> It replies with <code>334 VXNlcm5hbWU6</code> which is the request for the
username.  The string <code>VXNlcm5hbWU6</code> is the base64 encoding of the
string <code>Username:</code> (without trailing newline); we can verify this
with:

<div class="example">
<pre class="example">$ echo -n Username: | base64
</pre></div>

<p>or in the Emacs&rsquo; scratch buffer:
</p>
<div class="example">
<pre class="example">(base64-encode-string &quot;Username:&quot;)
</pre></div>

</li><li> We send the login user name encoded in base64.

</li><li> It checks the string and, if the format is correct, it replies with
<code>334 UGFzc3dvcmQ6</code> (this should happen even if the username is
unknown to the server).  The string <code>UGFzc3dvcmQ6</code> is the base64
encoding of the string <code>Password:</code> (without ending newline); we can
verify this with:

<div class="example">
<pre class="example">$ echo -n Password: | base64
</pre></div>

<p>or in the Emacs&rsquo; scratch buffer:
</p>
<div class="example">
<pre class="example">(base64-encode-string &quot;Password:&quot;)
</pre></div>

</li><li> We send the login password encoded in base64.

</li><li> It checks it and, if correct, it replies with a line starting with code
<code>235</code>.
</li></ol>

<p>Beware that if we are not quick to send the encoded password after the
encoded user name, the server may reset the authentication process as if
we sent a wrong user name.
</p>

<p>So we can do the <acronym>SMTP</acronym> dialogue reported below by hand (which is an
edited log of a session under Emacs&rsquo; eshell); lines starting with
<code>recv&gt;</code> are the ones received from the server, lines starting with
<code>send&gt;</code> are the ones we send to the server, the ellipses <code>...</code>
are replacements for server text we are not interested in.
</p>
<div class="smallexample">
<pre class="smallexample">$ gnutls-cli --crlf --port 465 relay.poste.it

recv&gt; 220 ... ESMTP Service ...
send&gt; ehlo localhost.localdomain
recv&gt; 250-...
recv&gt; 250-DSN
recv&gt; 250-8BITMIME
recv&gt; 250-PIPELINING
recv&gt; 250-HELP
recv&gt; 250-AUTH=LOGIN
recv&gt; 250-AUTH LOGIN CRAM-MD5 DIGEST-MD5 PLAIN
recv&gt; 250-DELIVERBY 300
recv&gt; 250 SIZE
send&gt; auth login
recv&gt; 334 VXNlcm5hbWU6
send&gt; &lt;the-base64-username&gt;
recv&gt; 334 UGFzc3dvcmQ6
send&gt; &lt;the-base64-password&gt;
recv&gt; 235 login authentication successful
send&gt; mail from:&lt;from-address@poste.it&gt;
recv&gt; 250 MAIL FROM:&lt;from-address@poste.it&gt; OK
send&gt; rcpt to:&lt;to-address@other-host.it&gt;
recv&gt; 250 RCPT TO:&lt;to-address@other-host.it&gt; OK
send&gt; data
recv&gt; 354 Start mail input; end with &lt;CRLF&gt;.&lt;CRLF&gt;
send&gt; From: &lt;from-address@poste.it&gt;
send&gt; To: &lt;to-address@other-host.it&gt;
send&gt; Subject: interactive attempt
send&gt;
send&gt; Text for interactive attempt.
send&gt; --
send&gt; Marco
send&gt; .
recv&gt; 250 ... Mail accepted
send&gt; quit
recv&gt; 221 ... QUIT
recv&gt; - Peer has closed the GNUTLS connection
</pre></div>

<hr>
<a name="sendmail-gnutls-delay"></a>
<div class="header">
<p>
Previous: <a href="#sendmail-gnutls-now" accesskey="p" rel="prev">sendmail gnutls now</a>, Up: <a href="#sendmail-gnutls" accesskey="u" rel="up">sendmail gnutls</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Delayed-encrypted-bridge"></a>
<h4 class="appendixsubsec">A.4.2 Delayed encrypted bridge</h4>


<p>We use as example the server <code>smtp.gmail.com</code>, port <code>587</code>.
You have to have an account there to use it; do not bomb this server
with fake connections.  This server requests us to start an <code>ESMTP</code>
dialogue, then issue the <code>STARTTLS</code> command and build the encrypted
bridge; once the bridge is set up, we restart an <code>ESMTP</code> dialogue
and do the authentication and the message delivery.
</p>
<p>We start the connector like this:
</p>
<div class="example">
<pre class="example">$ gnutls-cli --starttls --port 587 smtp.gmail.com
</pre></div>

<p>if the connection succeeds: <code>gnutls-cli</code> prints message lines on
its standard output explaining what is going on; at last comes the line
of greetings from the server, which begins with code <code>220</code>.
</p>
<p>The <samp>--starttls</samp> option tells <code>gnutls-cli</code> <strong>not</strong>
to build the encrypted bridge immediately; rather, it waits for a
<code>SIGALRM</code> signal, which we must deliver to it when we are ready.
The quickest way to send such a signal, when there is only one
<code>gnutls-cli</code> process running, is:
</p>
<div class="example">
<pre class="example">$ kill -SIGALRM $(/sbin/pidof gnutls-cli)
</pre></div>

<p>beware that <code>pidof</code> may be installed in other places on your
system.
</p>
<p>The server supports the <code>AUTH PLAIN</code> authentication mechanism,
which requires the base64 encoding of the user name and password stored
in a special record; we can do it with the external program
<code>base64</code> (which comes with <acronym>GNU</acronym> Coreutils) like this:
</p>
<div class="example">
<pre class="example">SECRETS=$(printf &quot;\x00${LOGIN_NAME}\x00${PASSWORD}&quot; | base64)
</pre></div>

<p><acronym>GNU</acronym> Emacs users can do it with:
</p>
<div class="example">
<pre class="example">(setq my-auth (base64-encode-string
   (format &quot;%c%s%c%s&quot; 0 &quot;the-user-name&quot; 0 &quot;the-pass-word&quot;)))
</pre></div>

<p>The authentication dialogue goes like this:
</p>
<ol>
<li> We send <code>AUTH PLAIN</code> followed by the encoded credentials.

</li><li> It checks the user name and password and, if correct, it replies with
code <code>235</code>.
</li></ol>

<p>So, we can do the <acronym>SMTP</acronym> dialogue reported below by hand (which is an
edited log of a session under Emacs&rsquo; eshell); lines starting with
<code>recv&gt;</code> are the ones received from the server, lines starting with
<code>send&gt;</code> are the ones we send to the server, the ellipses <code>...</code>
are replacements for server text we are not interested in.
</p>
<div class="smallexample">
<pre class="smallexample">$ gnutls-cli --crlf --starttls --port 587 smtp.gmail.com

recv&gt; 220 ... ESMTP ...
send&gt; ehlo localhost.localdomain
recv&gt; 250-...
recv&gt; 250-SIZE 35651584
recv&gt; 250-8BITMIME
recv&gt; 250-STARTTLS
send&gt; 250-ENHANCEDSTATUSCODES
recv&gt; 250 PIPELINING
send&gt; starttls
recv&gt; 220 2.0.0 Ready to start TLS

=== here we deliver SIGALRM to the gnutls-cli process

recv&gt; *** Starting TLS handshake
recv&gt; - Certificate type: X.509
recv&gt;  - Got a certificate list of 1 certificates.
recv&gt;
recv&gt;  - Certificate[0] info:
recv&gt;  # The hostname in the certificate matches 'smtp.gmail.com'.
recv&gt;  # valid since: ..
recv&gt;  # expires at: ...
recv&gt;  # fingerprint: ...
recv&gt;  # Subject's DN: ...
recv&gt;  # Issuer's DN: ...
recv&gt;
recv&gt;
recv&gt; - Peer's certificate issuer is unknown
recv&gt; - Peer's certificate is NOT trusted
recv&gt; - Version: TLS1.0
recv&gt; - Key Exchange: RSA
recv&gt; - Cipher: ARCFOUR-128
recv&gt; - MAC: MD5
recv&gt; - Compression: NULL
send&gt; ehlo rapitore.luna
recv&gt; 250-...
recv&gt; 250-SIZE 35651584
recv&gt; 250-8BITMIME
recv&gt; 250-AUTH LOGIN PLAIN
recv&gt; 250-ENHANCEDSTATUSCODES
recv&gt; 250 PIPELINING
send&gt; auth plain &lt;the-encoded-auth-credentials&gt;
recv&gt; 235 2.7.0 Accepted
send&gt; mail from:&lt;from-address@gmail.com&gt;
recv&gt; 250 2.1.0 OK ...
send&gt; rcpt to:&lt;to-address@poste.it&gt;
recv&gt; 250 2.1.5 OK ...
send&gt; data
recv&gt; 354  Go ahead ...
send&gt; From: from-address@gmail.com
send&gt; To: to-address@poste.it
send&gt; Subject: interactive proof from gmail
send&gt;
send&gt; proof
send&gt; .
recv&gt; 250 2.0.0 OK ...
send&gt; quit
recv&gt; 221 2.0.0 closing connection ...
</pre></div>

<hr>
<a name="sendmail-openssl"></a>
<div class="header">
<p>
Next: <a href="#sendmail-script" accesskey="n" rel="next">sendmail script</a>, Previous: <a href="#sendmail-gnutls" accesskey="p" rel="prev">sendmail gnutls</a>, Up: <a href="#sendmail" accesskey="u" rel="up">sendmail</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Using-openssl-as-connector"></a>
<h3 class="appendixsec">A.5 Using <code>openssl</code> as connector</h3>


<p>OpenSSL is a library implementing the <acronym>SSL</acronym>/<acronym>TLS</acronym> protocol; it can be
used to establish encrypted and authenticated connections to a remote
host.
</p>
<p>An OpenSSL installation comes with a command line test program,
<code>openssl</code>, that can be used to establish an encrypted connection
by a shell script.  This command can be used as the &ldquo;connector&rdquo;
modeled in <a href="#sendmail-connector">Send email through a process in
background</a>.  It has a manual page, which we may want to read.
</p>
<p>Here we see how we can use the <code>openssl</code> program in place of the
<code>gnutls-cli</code> program described in <a href="#sendmail-gnutls">Using
<code>gnutls-cli</code> as connector</a>.  The two methods have a lot in
common (the <acronym>SMTP</acronym> protocol is the same), we only have to understand
the command line of the program.
</p>
<blockquote>
<p>Notice that <code>openssl</code> has a <samp>-crlf</samp> option that will
cause all the lines sent to the server to be terminated by a carriage
return/line feed sequence (<code>\r\n</code> or <code>\x0d\x0a</code>).  If we write
a script that terminates by itself the lines with this sequence, for
example:
</p>
<div class="example">
<pre class="example">printf 'ehlo localhost.localdomain\r\n'
</pre></div>

<p>we must <strong>avoid</strong> this option, else <acronym>SMTP</acronym> protocol violation
errors may occur.  However, if we try a hand&ndash;driven interactive
session, we want to use this option to send protocol&ndash;compliant lines.
</p></blockquote>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#sendmail-openssl-now" accesskey="1">sendmail openssl now</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Immediate encrypted bridge.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#sendmail-openssl-delay" accesskey="2">sendmail openssl delay</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Delayed encrypted bridge.
</td></tr>
</table>

<hr>
<a name="sendmail-openssl-now"></a>
<div class="header">
<p>
Next: <a href="#sendmail-openssl-delay" accesskey="n" rel="next">sendmail openssl delay</a>, Up: <a href="#sendmail-openssl" accesskey="u" rel="up">sendmail openssl</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Immediate-encrypted-bridge-1"></a>
<h4 class="appendixsubsec">A.5.1 Immediate encrypted bridge</h4>


<p>To build the encrypted bridge right after the connection, without
exchanging greetings with the server, we do:
</p>
<div class="example">
<pre class="example">$ openssl s_client -quiet -connect relay.poste.it:465
</pre></div>

<p>then we start the <acronym>SMTP</acronym> dialogue as outlined in <a href="#sendmail-gnutls-now">Immediate encrypted bridge</a>.
</p>
<hr>
<a name="sendmail-openssl-delay"></a>
<div class="header">
<p>
Previous: <a href="#sendmail-openssl-now" accesskey="p" rel="prev">sendmail openssl now</a>, Up: <a href="#sendmail-openssl" accesskey="u" rel="up">sendmail openssl</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Delayed-encrypted-bridge-1"></a>
<h4 class="appendixsubsec">A.5.2 Delayed encrypted bridge</h4>


<p>To first exchange greetings, then send <code>STARTTLS</code> and finally build
the encrypted bridge, we do:
</p>
<div class="example">
<pre class="example">$ openssl s_client -quiet -starttls smtp \
    -connect smtp.gmail.com:587
</pre></div>

<p>then we start the <acronym>SMTP</acronym> dialogue as outlined in <a href="#sendmail-gnutls-now">Immediate encrypted bridge</a>.  <code>openssl</code> knows how to start
an <acronym>SMTP</acronym> dialogue, and it does it automatically.
</p>
<hr>
<a name="sendmail-script"></a>
<div class="header">
<p>
Previous: <a href="#sendmail-openssl" accesskey="p" rel="prev">sendmail openssl</a>, Up: <a href="#sendmail" accesskey="u" rel="up">sendmail</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Sending-email"></a>
<h3 class="appendixsec">A.6 Sending email</h3>


<p>This section documents the example script
<samp>examples/sendmail-mbfl.sh</samp>, which makes use of <acronym>MBFL</acronym> to send an
email message.  The script sends already composed messages using plain
or <acronym>TLS</acronym> sessions, and it can use both OpenSSL and <acronym>GNU</acronym> <acronym>TLS</acronym>.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#sendmail-script-examples" accesskey="1">sendmail script examples</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Usage examples.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#sendmail-script-invoking" accesskey="2">sendmail script invoking</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Command line options.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#sendmail-script-hostinfo" accesskey="3">sendmail script hostinfo</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Reading host informations from file.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#sendmail-script-authinfo" accesskey="4">sendmail script authinfo</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Reading authentication credentials
                                from file.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#sendmail-script-emacs" accesskey="5">sendmail script emacs</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Interfacing with <acronym>GNU</acronym> Emacs.
</td></tr>
</table>

<hr>
<a name="sendmail-script-examples"></a>
<div class="header">
<p>
Next: <a href="#sendmail-script-invoking" accesskey="n" rel="next">sendmail script invoking</a>, Up: <a href="#sendmail-script" accesskey="u" rel="up">sendmail script</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Usage-examples"></a>
<h4 class="appendixsubsec">A.6.1 Usage examples</h4>


<p>Let&rsquo;s say we have a file named <samp>message.mail</samp> holding a fully
composed email message:
</p>
<div class="example">
<pre class="example">Sender: marco@localhost
From: marco@localhost
To: root@localhost
Subject: server on fire?

I noticed flames raising from the server room...
--
Marco
</pre></div>

<p>basically, to send it with <code>sendmail-mbfl.sh</code> we have to do:
</p>
<div class="example">
<pre class="example">$ sendmail-mbfl.sh \
    --envelope-from=marco@localhost  \
    --envelope-to=root@localhost     \
    --message=message.mail
</pre></div>

<p>by default the <acronym>SMTP</acronym> server name is set to <code>localhost</code> and the
<acronym>TCP</acronym> port to <code>25</code>.  The default session is plain, without <acronym>TLS</acronym>.
</p>
<p>Port number <code>25</code> is officially assigned to the <acronym>SMTP</acronym> protocol; if
the localhost uses a different <acronym>TCP</acronym> port, we can select it with the
<samp>--port</samp> option:
</p>
<div class="example">
<pre class="example">$ sendmail-mbfl.sh --port=587         \
    --envelope-from=marco@localhost   \
    --envelope-to=root@localhost      \
    --message=message.mail
</pre></div>

<p>To send mail to a remote <acronym>SMTP</acronym> server, we select its hostname with the
<samp>--host</samp> option:
</p>
<div class="example">
<pre class="example">$ sendmail-mbfl.sh \
    --host=smtp.gmail.com --port=587  \
    --envelope-from=marco@gmail.com   \
    --envelope-to=marco@spiffy.it     \
    --message=message.mail
</pre></div>

<p>Mail services may offer encrypted sessions to their <acronym>SMTP</acronym> servers.
Encryption with the <acronym>TLS</acronym> protocol is supported by
<code>sendmail-mbfl.sh</code> through external programs.  Whether a server
requires an encrypted session, can be specified using the
<samp>--plain</samp>, <samp>--tls</samp> or <samp>--starttls</samp> options.
</p>
<p>To establish an encrypted session, the script needs to acquire the
credentials of the user.  These can be stored in a configuration file
named <samp>~/.mbfl-authinfo</samp>, which looks like this:
</p>
<div class="smallexample">
<pre class="smallexample">machine smtp.gmail.com login marco@gmail.com password abcdefghilm
machine relay.poste.it login marco@poste.it  password 0123456789
</pre></div>

<p>so that a line/record can be uniquely identified with values of the
<samp>--host</samp> and <samp>--username</samp> options.
</p>
<p>So we can do:
</p>
<div class="example">
<pre class="example">$ sendmail-mbfl.sh --host=gmail       \
    --username=marco --starttls        \
    --envelope-from=marco@gmail.com   \
    --envelope-to=marco@spiffy.it     \
    --message=message.mail
</pre></div>

<hr>
<a name="sendmail-script-invoking"></a>
<div class="header">
<p>
Next: <a href="#sendmail-script-hostinfo" accesskey="n" rel="next">sendmail script hostinfo</a>, Previous: <a href="#sendmail-script-examples" accesskey="p" rel="prev">sendmail script examples</a>, Up: <a href="#sendmail-script" accesskey="u" rel="up">sendmail script</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Command-line-options"></a>
<h4 class="appendixsubsec">A.6.2 Command line options</h4>


<p>The synopsis is:
</p>
<div class="smallexample">
<pre class="smallexample">sendmail-mbfl.sh \
    --envelope-from=&lt;ADDRESS&gt;              \
    --envelope-to=&lt;ADDRESS&gt;                \
    [--message=&lt;SOURCE&gt; | --test-message]
    [options]
</pre></div>

<p>the script sends an email address, and it can do a plain session or use
a connector.  Options description follows.
</p>
<dl compact="compact">
<dt><code>-F<var>address</var></code></dt>
<dt><code>--envelope-from=<var>address</var></code></dt>
<dd><p>Select the <code>MAIL FROM</code> envelope address.  If this option is used
multiple times: the last one wins.
</p>
</dd>
<dt><code>-T<var>address</var></code></dt>
<dt><code>--envelope-to=<var>address</var></code></dt>
<dd><p>Select the <code>RCPT TO</code> envelope address.  This option can be used
multiple times: each <var>address</var> is appended to a list of recipients.
</p>
</dd>
<dt><code>-M<var>source</var></code></dt>
<dt><code>--message=<var>source</var></code></dt>
<dd><p>Select the source of the whole email message.  If <var>source</var> is a file
pathname, that file is read and used as data; if <var>source</var> is
<code>-</code>, the message is read from the standard input channel.  It
defaults to <code>-</code>.
</p>
</dd>
<dt><code>--test-message</code></dt>
<dd><p>Send a test message with a hard&ndash;coded body part.  This option
supersedes <samp>--message</samp>.
</p>
</dd>
<dt><code>--host=<var>host</var></code></dt>
<dd><p>Select the <acronym>SMTP</acronym> server host name.  It defaults to <code>localhost</code>.
</p>
</dd>
<dt><code>--host-info=<var>file</var></code></dt>
<dd><p>Select a file from which read host and port informations.
</p>
</dd>
<dt><code>-p<var>port</var></code></dt>
<dt><code>--port=<var>port</var></code></dt>
<dd><p>Select the <acronym>SMTP</acronym> server <acronym>TCP</acronym> port; this option supersedes
<samp>--host-info</samp>.  It defaults to <code>25</code>.
</p>
</dd>
<dt><code>--plain</code></dt>
<dt><code>--tls</code></dt>
<dt><code>--starttls</code></dt>
<dd><p>Establish a plain session, <acronym>TLS</acronym> session with immediate bridge
construction or <acronym>TLS</acronym> session with bridge construction after
<code>STARTTLS</code> command.
</p>
</dd>
<dt><code>--gnutls</code></dt>
<dd><p>Use <code>gnutls-cli</code> as connector for encrypted sessions.  This is
the default when <samp>--starttls</samp> or <samp>--delayed-starttls</samp> are
used.
</p>
</dd>
<dt><code>--openssl</code></dt>
<dd><p>Use <code>gnutls-cli</code> as connector for encrypted sessions.
</p>
</dd>
<dt><code>--auth-info=<var>file</var></code></dt>
<dd><p>Select the file, in <code>netrc</code> format, from which read the
authorisation credentials.  Defaults to <samp>~/.mbfl-authinfo</samp>.
</p>
</dd>
<dt><code>--username=<var>user</var></code></dt>
<dd><p>Specify a string used to select an account in the authorisation file.
</p>
</dd>
<dt><code>--auth-none</code></dt>
<dt><code>--auth-plain</code></dt>
<dt><code>--auth-login</code></dt>
<dd><p>Perform no authorisation, the <code>AUTH PLAIN</code> authorisation or the
<code>AUTH LOGIN</code> authorisation.
</p></dd>
</dl>

<hr>
<a name="sendmail-script-hostinfo"></a>
<div class="header">
<p>
Next: <a href="#sendmail-script-authinfo" accesskey="n" rel="next">sendmail script authinfo</a>, Previous: <a href="#sendmail-script-invoking" accesskey="p" rel="prev">sendmail script invoking</a>, Up: <a href="#sendmail-script" accesskey="u" rel="up">sendmail script</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Reading-host-informations-from-file"></a>
<h4 class="appendixsubsec">A.6.3 Reading host informations from file</h4>


<p>For each <acronym>SMTP</acronym> server we need the following informations: the
hostname, the port number, the session type, the authorisation method.
There are two ways to specify these:
</p>
<ul>
<li> Use the command line options as in:

<div class="example">
<pre class="example">$ sendmail-mbfl.sh \
    --host=smtp.gmail.org --port=587    \
    --tls --auth-login                  \
    ...
</pre></div>

</li><li> Use the hostinfo file and the option <samp>--host</samp> to select a record
into it, as in:

<div class="example">
<pre class="example">$ sendmail-mbfl.sh --host=smtp.gmail.org ...

$ sendmail-mbfl.sh --host=smtp.gmail.org \
    --host-info=~/.hostrc ...
</pre></div>
</li></ul>

<p>If <samp>--host</samp> is not used: the hostname defaults to
<code>localhost</code>.  If the selection of port, session type or
authorisation type is left unspecified: The script automatically looks
into the default hostinfo file.  Informations from command line options
supersede informations from the hostinfo file.
</p>
<p>The default pathname for the hostinfo file is <samp>$HOME/.mbfl-hostinfo</samp> and
can be overridden by the <samp>--host-info</samp> option.  The format of
this file is line oriented: Blank lines are ignored, lines starting with
a <code>#</code> character are comments, lines starting with <code>machine</code>
are host records.
</p>
<p>Each record line must have the format:
</p>
<div class="smallexample">
<pre class="smallexample">machine &lt;host&gt; service &lt;name&gt; port &lt;number&gt; session &lt;type&gt; auth &lt;type&gt;
</pre></div>

<p>for example:
</p>
<div class="smallexample">
<pre class="smallexample"># ~/.mbfl-hostinfo --
#

# SMTP servers
machine localhost service smtp port 25 session plain auth none
machine relay.poste.it service smtp port 465 session tls auth login
machine smtp.gmail.com service smtp port 587 session starttls auth plain

# POP3 servers
machine pop.tiscali.it service pop3 port 110 session plain auth userpass
machine relay.poste.it service pop3 port 995 session tls auth userpass
machine pop.googlemail.com service pop3 port 995  session tls auth userpass

### end of file
</pre></div>

<p>so that we can extract a record with the following script:
</p>
<div class="example">
<pre class="example">file=~/.mbfl-hostinfo
host=gmail
service=smtp

rex='^[ \t]*'
rex+='machine[ \t]\+.*%s.*[ \t]\+'
rex+='service[ \t]\+%s[ \t]\+'
rex+='port[ \t]\+[0-9]\+[ \t]\+'
rex+='session[ \t]\+\(plain\|tls\|starttls\)[ \t]\+'
rex+='auth[ \t]\+\(none\|plain\|login\)'
rex+='[ \t]*$'
rex=$(printf &quot;$rex&quot; $host $service)

set -- $(grep &quot;$rex&quot; &quot;$file&quot;)
echo machine $2
echo service $4
echo port    $6
echo session $8
shift 9
echo auth    $1
</pre></div>

<p>this is exactly what <code>sendmail-mbfl.sh</code> does with the file.
</p>
<p>Notice that when using the hostinfo file, the value of the
<samp>--host</samp> option can be a substring of the host name.
</p>
<hr>
<a name="sendmail-script-authinfo"></a>
<div class="header">
<p>
Next: <a href="#sendmail-script-emacs" accesskey="n" rel="next">sendmail script emacs</a>, Previous: <a href="#sendmail-script-hostinfo" accesskey="p" rel="prev">sendmail script hostinfo</a>, Up: <a href="#sendmail-script" accesskey="u" rel="up">sendmail script</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Reading-authentication-credentials-from-file"></a>
<h4 class="appendixsubsec">A.6.4 Reading authentication credentials from file</h4>


<p>The only way the script has to acquire the user name and password to log
into the remote server, is by reading the authinfo file.  By default,
its pathname is <samp>$HOME/.mbfl-authinfo</samp>, it can be overridden with the
<samp>--auth-info</samp> option.
</p>
<p>Its format is a simplified version of the <code>netrc</code> file format:
blank lines are ignored, lines starting with a <code>#</code> character are
comments, lines starting with <code>machine</code> are host records.
</p>
<p>Each record must have the format:
</p>
<div class="example">
<pre class="example">machine &lt;hostname&gt; login &lt;user-name&gt; password &lt;pass-word&gt;
</pre></div>

<p>for example:
</p>
<div class="example">
<pre class="example">machine smtp.gmail.com login one@gmail.com password abcdefghilm
machine relay.poste.it login two@poste.it  password 0123456789
</pre></div>

<p>so that we can extract a record with the following script:
</p>
<div class="example">
<pre class="example">file=~/.mbfl-authinfo
host=poste
username=marco

rex='^[ \t]*'
rex+='machine[ \t]\+.*%s.*[ \t]\+'
rex+='login[ \t]\+.*%s.*[ \t]\+'
rex+='password[ \t]\+.*'
rex+='[ \t]*$'
rex=$(printf &quot;$rex&quot; $host $username)

line=$(grep &quot;$rex&quot; $file)
set -- $line
echo machine  $2
echo username $4
echo password $6
</pre></div>

<p>and this is exactly what <code>sendmail-mbfl.sh</code> does.
</p>
<p>The host name and the user name are selected by the command line options
<samp>--host</samp> and <samp>--username</samp>.  Notice that the values for
these options can be substrings of the values in the authinfo file.
</p>
<hr>
<a name="sendmail-script-emacs"></a>
<div class="header">
<p>
Previous: <a href="#sendmail-script-authinfo" accesskey="p" rel="prev">sendmail script authinfo</a>, Up: <a href="#sendmail-script" accesskey="u" rel="up">sendmail script</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Interfacing-with-GNU-Emacs"></a>
<h4 class="appendixsubsec">A.6.5 Interfacing with <acronym>GNU</acronym> Emacs</h4>


<p>This section documents an Emacs interface to the
<code>sendmail-mbfl.sh</code> script that can be used to send mail.  It
consists of an Emacs Lisp library that allows us to send mail with all
the methods supported by the script.
</p>
<p>To use it we have to install the file <samp>examples/sendmail-mbfl.el</samp>
in one of the directories in the load path of Emacs, then load it with:
</p>
<div class="example">
<pre class="example">(require 'sendmail-mbfl)
</pre></div>

<p>The library assumes that <samp>message.el</samp> and <samp>sendmail.el</samp> are
available on the system; recent installations of Emacs should have them.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#sendmail-script-emacs-vars" accesskey="1">sendmail script emacs vars</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Customisable variables.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#sendmail-script-emacs-send" accesskey="2">sendmail script emacs send</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Sending and delivering functions.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#sendmail-script-emacs-insp" accesskey="3">sendmail script emacs insp</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Message inspection functions.
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#sendmail-script-emacs-misc" accesskey="4">sendmail script emacs misc</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Miscellaneous functions.
</td></tr>
</table>

<hr>
<a name="sendmail-script-emacs-vars"></a>
<div class="header">
<p>
Next: <a href="#sendmail-script-emacs-send" accesskey="n" rel="next">sendmail script emacs send</a>, Up: <a href="#sendmail-script-emacs" accesskey="u" rel="up">sendmail script emacs</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Customisable-variables"></a>
<h4 class="appendixsubsubsec">A.6.5.1 Customisable variables</h4>


<p>A customisation group called <code>sendmail-mbfl</code> is available to
configure the library.
</p>

<dl>
<dt><a name="index-sendmail_002dmbfl_002dprogram"></a>Customisable Variable: <strong>sendmail-mbfl-program</strong></dt>
<dd><p>A string representing the name of the <acronym>MBFL</acronym> shell script.  By default
set to <code>sendmail-mbfl.sh</code>.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dextra_002dargs"></a>Customisable Variable: <strong>sendmail-mbfl-extra-args</strong></dt>
<dd><p>A list of strings representing extra arguments for the command line of
<code>sendmail-mbfl.sh</code>.  By default set to:
</p>
<div class="example">
<pre class="example">(&quot;--verbose&quot; &quot;--debug&quot;)
</pre></div>
</dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002denvelope_002dfrom_002dfunction"></a>Customisable Variable: <strong>sendmail-mbfl-envelope-from-function</strong></dt>
<dd><p>Select a function to call to acquire, from the current buffer, the
envelope email address of the sender, to be used in the <code>MAIL FROM</code>
<acronym>SMTP</acronym> command.
</p>
<p>The function is invoked with no arguments and it must return a single
string representing the email address.  If no suitable address is found:
it must raise an error.  The function may be called multiple times for
the same message buffer.
</p>
<p>The selected function is used by <code>send-mail-with-mbfl</code>.  By default
it is set to <code>sendmail-mbfl-envelope-from</code>.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002denvelope_002dto_002dfunction"></a>Customisable Variable: <strong>sendmail-mbfl-envelope-to-function</strong></dt>
<dd><p>Select a function to call to acquire, from the current buffer, the
envelope email addresses of the receivers, to be used in the <code>RCPT
TO</code> <acronym>SMTP</acronym> command.
</p>
<p>The function is invoked with no arguments and it must return a list of
strings representing email addresses.  If no suitable address is found:
it must raise an error.  The function may be called multiple times for
the same message buffer.
</p>
<p>The selected function is used by <code>send-mail-with-mbfl</code>.  By default
it is set to <code>sendmail-mbfl-envelope-to</code>.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dextract_002daddresses_002dfunction"></a>Customisable Variable: <strong>sendmail-mbfl-extract-addresses-function</strong></dt>
<dd><p>Select a function to call to extract a list of email addresses from an
email header.  It is invoked with no arguments and the buffer narrowed
to the header to examine.
</p>
<p>The function is invoked with no arguments and it must return a list of
strings representing email addresses, or nil.
</p>
<p>The selected function is used by <code>sendmail-mbfl-envelope-from</code> and
<code>sendmail-mbfl-envelope-to</code>.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dhostname_002dfunction"></a>Customisable Variable: <strong>sendmail-mbfl-hostname-function</strong></dt>
<dd><p>Select a function to call to extract, from the current buffer, the
hostname of the <acronym>SMTP</acronym> server to be used to send the message.  The
result is used as search key in the selected hostinfo file.
</p>
<p>The function is invoked with no arguments and it must return a string
representing the hostname; if it is unable to determine the hostname: it
must raise an error.
</p>
<p>The selected function is used by <code>send-mail-with-mbfl</code>.  By default
it is set to <code>sendmail-mbfl-hostname</code>.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dusername_002dfunction"></a>Customisable Variable: <strong>sendmail-mbfl-username-function</strong></dt>
<dd><p>Select a function to call to extract, from the current buffer, the
username with which to login to the <acronym>SMTP</acronym> server.  The result is used
as search key in the selected authinfo file.
</p>
<p>The function is invoked with no arguments and it must return a string
representing the username; if it is unable to determine the username: it
must raise an error.
</p>
<p>The selected function is used by <code>send-mail-with-mbfl</code>.  By default
it is set to <code>sendmail-mbfl-username</code>.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dhost_002dinfo"></a>Customisable Variable: <strong>sendmail-mbfl-host-info</strong></dt>
<dd><p>The pathname of the file holding informations about known <acronym>SMTP</acronym>
servers.  <a href="#sendmail-script-hostinfo">Reading host informations from
file</a>.
</p>
<p>By default it is set to <samp>~/.mbfl-hostinfo</samp>.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dauth_002dinfo"></a>Customisable Variable: <strong>sendmail-mbfl-auth-info</strong></dt>
<dd><p>The pathname of the file holding informations about known accounts at
<acronym>SMTP</acronym> servers.  <a href="#sendmail-script-authinfo">Reading authentication
credentials from file</a>.
</p>
<p>By default it is set to <samp>~/.mbfl-authinfo</samp>.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dconnector"></a>Customisable Variable: <strong>sendmail-mbfl-connector</strong></dt>
<dd><p>Select the external program to use to establish the <acronym>TLS</acronym> transport
layer.  Valid values are the strings: <code>gnutls</code>, <code>openssl</code>.
The default is <code>openssl</code> because it is more likely to be installed
on any system.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dtimeout"></a>Customisable Variable: <strong>sendmail-mbfl-timeout</strong></dt>
<dd><p>Select the timeout in seconds for reading answers from the <acronym>SMTP</acronym>
server.  The default is 5.
</p></dd></dl>

<hr>
<a name="sendmail-script-emacs-send"></a>
<div class="header">
<p>
Next: <a href="#sendmail-script-emacs-insp" accesskey="n" rel="next">sendmail script emacs insp</a>, Previous: <a href="#sendmail-script-emacs-vars" accesskey="p" rel="prev">sendmail script emacs vars</a>, Up: <a href="#sendmail-script-emacs" accesskey="u" rel="up">sendmail script emacs</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Sending-and-delivering-functions"></a>
<h4 class="appendixsubsubsec">A.6.5.2 Sending and delivering functions</h4>


<dl>
<dt><a name="index-send_002dmail_002dwith_002dmbfl"></a>Function: <strong>send-mail-with-mbfl</strong></dt>
<dd><p>Send the email message in the current buffer.  This interactive function
can be invoked directly by the user, or, better, used as value for
<code>message-send-mail-function</code>.  Sending involves:
</p>
<ol>
<li> Normalising the message with <code>sendmail-mbfl-normalise-message</code>.

</li><li> Performing special deliveries with <code>sendmail-mbfl-delivery</code>.

</li><li> Posting the message to an <acronym>MTA</acronym> using <code>sendmail-mbfl-post</code>.
</li></ol>
</dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002ddelivery"></a>Function: <strong>sendmail-mbfl-delivery</strong></dt>
<dd><p>Perform special deliveries of the email message in the current buffer.
If the message has an <code>Fcc</code> header, deliver is performed relying on
<code>mail-do-fcc</code> from <samp>sendmail.el</samp>.
</p>
<p>It is to be called after <code>sendmail-mbfl-normalise-message</code> or an
equivalent normalisation has been applied to the message.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dpost"></a>Function: <strong>sendmail-mbfl-post</strong></dt>
<dd><p>Post the email message in the current buffer using an <acronym>MTA</acronym>.
Posting involves:
</p>
<ol>
<li> Preparing the message with <code>sendmail-mbfl-prepare-message-for-mta</code>.

</li><li> Saving the message into a temporary file.

</li><li> Sending the file using the program selected with the customisable
variable <code>sendmail-mbfl-program</code>.
</li></ol>

<p>It is to be called after <code>sendmail-mbfl-normalise-message</code> or an
equivalent normalisation has been applied to the message.
</p></dd></dl>

<hr>
<a name="sendmail-script-emacs-insp"></a>
<div class="header">
<p>
Next: <a href="#sendmail-script-emacs-misc" accesskey="n" rel="next">sendmail script emacs misc</a>, Previous: <a href="#sendmail-script-emacs-send" accesskey="p" rel="prev">sendmail script emacs send</a>, Up: <a href="#sendmail-script-emacs" accesskey="u" rel="up">sendmail script emacs</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Message-inspection-functions"></a>
<h4 class="appendixsubsubsec">A.6.5.3 Message inspection functions</h4>


<dl>
<dt><a name="index-sendmail_002dmbfl_002denvelope_002dfrom"></a>Function: <strong>sendmail-mbfl-envelope-from</strong></dt>
<dt><a name="index-sendmail_002dmbfl_002denvelope_002dfrom_002fmessage"></a>Function: <strong>sendmail-mbfl-envelope-from/message</strong></dt>
<dd><p><code>sendmail-mbfl-envelope-from</code> interprets the current buffer as an
email message and searches the contents for an email address to be used
as envelope sender.
</p>
<p>It examines the headers <code>From</code> and <code>Sender</code>, in this order and
it returns a single string representing the email address; if no
suitable address is found: it raises an error.  The address is extracted
from the headers using the function selected by the customisable
variable <code>sendmail-mbfl-extract-addresses-function</code>.
</p>
<p><code>sendmail-mbfl-envelope-from/message</code> is an interactive wrapper for
<code>sendmail-mbfl-envelope-from</code> that prints the result to the
<code>*Message*</code> buffer.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002denvelope_002dto"></a>Function: <strong>sendmail-mbfl-envelope-to</strong></dt>
<dt><a name="index-sendmail_002dmbfl_002denvelope_002dto_002fmessage"></a>Function: <strong>sendmail-mbfl-envelope-to/message</strong></dt>
<dd><p><code>sendmail-mbfl-envelope-to</code> interprets the current buffer as an
email message and searches the contents for email addresses to be used
as envelope receivers.
</p>
<p>It examines the headers <code>To</code>, <code>Cc</code> and <code>Bcc</code> and it
returns a list of strings representing email addresses; if no suitable
address is found: it raises an error.  The addresses are extracted from
the headers using the function selected by the customisable variable
<code>sendmail-mbfl-extract-addresses-function</code>.
</p>
<p><code>sendmail-mbfl-envelope-to/message</code> is an interactive wrapper for
<code>sendmail-mbfl-envelope-to</code> that prints the result to the
<code>*Message*</code> buffer.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dextract_002daddresses"></a>Function: <strong>sendmail-mbfl-extract-addresses</strong></dt>
<dd><p>Extract a list of email addresses from the current buffer.  It must be
invoked with the buffer narrowed to the header to examine.  Return a
list of email addresses as strings, or nil if no address is found.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dhostname"></a>Function: <strong>sendmail-mbfl-hostname</strong></dt>
<dt><a name="index-sendmail_002dmbfl_002dhostname_002fmessage"></a>Function: <strong>sendmail-mbfl-hostname/message</strong></dt>
<dd><p><code>sendmail-mbfl-hostname</code> extracts, from the current buffer, the
hostname of the <acronym>SMTP</acronym> server to be used to send the message.  The
result is used as search key in the selected hostinfo file.
</p>
<p>It returns a string representing the hostname else, if unable to
determine the hostname, it raises an error.  The hostname is the
hostname part of the value returned by
<code>sendmail-mbfl-envelope-from</code>.
</p>
<p><code>sendmail-mbfl-hostname/message</code> is an interactive wrapper for
<code>sendmail-mbfl-hostname</code> that prints the result to the
<code>*Message*</code> buffer.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dusername"></a>Function: <strong>sendmail-mbfl-username</strong></dt>
<dt><a name="index-sendmail_002dmbfl_002dusername_002fmessage"></a>Function: <strong>sendmail-mbfl-username/message</strong></dt>
<dd><p><code>sendmail-mbfl-username</code> extracts, from the current buffer, the
username with which login to the <acronym>SMTP</acronym> server.  The result is used as
search key in the selected authinfo file.
</p>
<p>It returns a string representing the username else, if unable to
determine the username, it raises an error.  The username is the
username part of the value returned by
<code>sendmail-mbfl-envelope-from</code>.
</p>
<p><code>sendmail-mbfl-username/message</code> is an interactive wrapper for
<code>sendmail-mbfl-username</code> that prints the result to the
<code>*Message*</code> buffer.
</p></dd></dl>

<hr>
<a name="sendmail-script-emacs-misc"></a>
<div class="header">
<p>
Previous: <a href="#sendmail-script-emacs-insp" accesskey="p" rel="prev">sendmail script emacs insp</a>, Up: <a href="#sendmail-script-emacs" accesskey="u" rel="up">sendmail script emacs</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Miscellaneous-functions-1"></a>
<h4 class="appendixsubsubsec">A.6.5.4 Miscellaneous functions</h4>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dactivate"></a>Function: <strong>sendmail-mbfl-activate</strong></dt>
<dd><p>Set <code>message-send-mail-function</code> so that functions from
<samp>message.el</samp> send mail using <code>send-mail-with-mbfl</code>.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dnormalise_002dmessage"></a>Function: <strong>sendmail-mbfl-normalise-message</strong></dt>
<dd><p>Normalise the email message in the current buffer so that it is ready to
be posted or delivered.  Scan the headers for invalid lines and try to
fix them.  Scan the message for mandatory headers and, if missing, add
them; this may require querying the user for informations.
</p>
<p>It is to be called <strong>before</strong> acquiring sender and receiver
addresses from the headers.  It is an interactive function: it can be
explicitly applied to a buffer by the user any number of times.
</p>
<p>This function does <strong>not</strong> remove the headers/body separator.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dprepare_002dmessage_002dfor_002dmta"></a>Function: <strong>sendmail-mbfl-prepare-message-for-mta</strong></dt>
<dd><p>Prepare the email message in the current buffer to be sent to a Mail
Transport Agent.  Headers like <code>Fcc</code> and <code>Bcc</code> are removed;
the headers/body separator line is removed.  It is to be called
<strong>after</strong> acquiring sender and receiver addresses from the headers.
</p></dd></dl>


<dl>
<dt><a name="index-sendmail_002dmbfl_002dcopy_002dmessage_002dbuffer"></a>Function: <strong>sendmail-mbfl-copy-message-buffer</strong> <em><var>dst-buffer</var> <var>src-buffer</var></em></dt>
<dd><p>Copy an email message from <var>src-buffer</var> to <var>dst-buffer</var>.  Set
encoding and text representation properties of the destination buffer to
be equal to the ones of the source buffer.
</p></dd></dl>


<hr>
<a name="Package-License"></a>
<div class="header">
<p>
Next: <a href="#Documentation-License" accesskey="n" rel="next">Documentation License</a>, Previous: <a href="#sendmail" accesskey="p" rel="prev">sendmail</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="GNU-LESSER-GENERAL-PUBLIC-LICENSE"></a>
<h2 class="appendix">Appendix B GNU LESSER GENERAL PUBLIC LICENSE</h2>

<a name="index-LGPL_002c-Lesser-General-Public-License"></a>
<div align="center">Version 3, 29 June 2007
</div>

<div class="display">
<pre class="display">Copyright &copy; 2007 Free Software Foundation, Inc. <a href="http://fsf.org/">http://fsf.org/</a>

Everyone is permitted to copy and distribute verbatim copies of this
license document, but changing it is not allowed.
</pre></div>

<p>This version of the GNU Lesser General Public License incorporates
the terms and conditions of version 3 of the GNU General Public
License, supplemented by the additional permissions listed below.
</p>
<ol start="0">
<li> Additional Definitions.

<p>As used herein, &ldquo;this License&rdquo; refers to version 3 of the GNU Lesser
General Public License, and the &ldquo;GNU GPL&rdquo; refers to version 3 of the GNU
General Public License.
</p>
<p>&ldquo;The Library&rdquo; refers to a covered work governed by this License,
other than an Application or a Combined Work as defined below.
</p>
<p>An &ldquo;Application&rdquo; is any work that makes use of an interface provided
by the Library, but which is not otherwise based on the Library.
Defining a subclass of a class defined by the Library is deemed a mode
of using an interface provided by the Library.
</p>
<p>A &ldquo;Combined Work&rdquo; is a work produced by combining or linking an
Application with the Library.  The particular version of the Library
with which the Combined Work was made is also called the &ldquo;Linked
Version&rdquo;.
</p>
<p>The &ldquo;Minimal Corresponding Source&rdquo; for a Combined Work means the
Corresponding Source for the Combined Work, excluding any source code
for portions of the Combined Work that, considered in isolation, are
based on the Application, and not on the Linked Version.
</p>
<p>The &ldquo;Corresponding Application Code&rdquo; for a Combined Work means the
object code and/or source code for the Application, including any data
and utility programs needed for reproducing the Combined Work from the
Application, but excluding the System Libraries of the Combined Work.
</p>
</li><li> Exception to Section 3 of the GNU GPL.

<p>You may convey a covered work under sections 3 and 4 of this License
without being bound by section 3 of the GNU GPL.
</p>
</li><li> Conveying Modified Versions.

<p>If you modify a copy of the Library, and, in your modifications, a
facility refers to a function or data to be supplied by an Application
that uses the facility (other than as an argument passed when the
facility is invoked), then you may convey a copy of the modified
version:
</p>
<ol type="a" start="1">
<li> under this License, provided that you make a good faith effort to
ensure that, in the event an Application does not supply the
function or data, the facility still operates, and performs
whatever part of its purpose remains meaningful, or

</li><li> under the GNU GPL, with none of the additional permissions of
this License applicable to that copy.
</li></ol>

</li><li> Object Code Incorporating Material from Library Header Files.

<p>The object code form of an Application may incorporate material from
a header file that is part of the Library.  You may convey such object
code under terms of your choice, provided that, if the incorporated
material is not limited to numerical parameters, data structure
layouts and accessors, or small macros, inline functions and templates
(ten or fewer lines in length), you do both of the following:
</p>
<ol type="a" start="1">
<li> Give prominent notice with each copy of the object code that the
Library is used in it and that the Library and its use are
covered by this License.
</li><li> Accompany the object code with a copy of the GNU GPL and this license
document.
</li></ol>

</li><li> Combined Works.

<p>You may convey a Combined Work under terms of your choice that,
taken together, effectively do not restrict modification of the
portions of the Library contained in the Combined Work and reverse
engineering for debugging such modifications, if you also do each of
the following:
</p>
<ol type="a" start="1">
<li> Give prominent notice with each copy of the Combined Work that
the Library is used in it and that the Library and its use are
covered by this License.
</li><li> Accompany the Combined Work with a copy of the GNU GPL and this license
document.
</li><li> For a Combined Work that displays copyright notices during
execution, include the copyright notice for the Library among
these notices, as well as a reference directing the user to the
copies of the GNU GPL and this license document.
</li><li> Do one of the following:

<ol start="0">
<li> Convey the Minimal Corresponding Source under the terms of this
License, and the Corresponding Application Code in a form
suitable for, and under terms that permit, the user to
recombine or relink the Application with a modified version of
the Linked Version to produce a modified Combined Work, in the
manner specified by section 6 of the GNU GPL for conveying
Corresponding Source.
</li><li> Use a suitable shared library mechanism for linking with the
Library.  A suitable mechanism is one that (a) uses at run time
a copy of the Library already present on the user&rsquo;s computer
system, and (b) will operate properly with a modified version
of the Library that is interface-compatible with the Linked
Version.
</li></ol>

</li><li> Provide Installation Information, but only if you would otherwise
be required to provide such information under section 6 of the
GNU GPL, and only to the extent that such information is
necessary to install and execute a modified version of the
Combined Work produced by recombining or relinking the
Application with a modified version of the Linked Version. (If
you use option 4d0, the Installation Information must accompany
the Minimal Corresponding Source and Corresponding Application
Code. If you use option 4d1, you must provide the Installation
Information in the manner specified by section 6 of the GNU GPL
for conveying Corresponding Source.)
</li></ol>

</li><li> Combined Libraries.

<p>You may place library facilities that are a work based on the
Library side by side in a single library together with other library
facilities that are not Applications and are not covered by this
License, and convey such a combined library under terms of your
choice, if you do both of the following:
</p>
<ol type="a" start="1">
<li> Accompany the combined library with a copy of the same work based
on the Library, uncombined with any other library facilities,
conveyed under the terms of this License.
</li><li> Give prominent notice with the combined library that part of it
is a work based on the Library, and explaining where to find the
accompanying uncombined form of the same work.
</li></ol>

</li><li> Revised Versions of the GNU Lesser General Public License.

<p>The Free Software Foundation may publish revised and/or new versions
of the GNU Lesser General Public License from time to time. Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.
</p>
<p>Each version is given a distinguishing version number. If the
Library as you received it specifies that a certain numbered version
of the GNU Lesser General Public License &ldquo;or any later version&rdquo;
applies to it, you have the option of following the terms and
conditions either of that published version or of any later version
published by the Free Software Foundation. If the Library as you
received it does not specify a version number of the GNU Lesser
General Public License, you may choose any version of the GNU Lesser
General Public License ever published by the Free Software Foundation.
</p>
<p>If the Library as you received it specifies that a proxy can decide
whether future versions of the GNU Lesser General Public License shall
apply, that proxy&rsquo;s public statement of acceptance of any version is
permanent authorization for you to choose that version for the
Library.
</p>
</li></ol>
<hr>
<a name="Documentation-License"></a>
<div class="header">
<p>
Next: <a href="#references" accesskey="n" rel="next">references</a>, Previous: <a href="#Package-License" accesskey="p" rel="prev">Package License</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="GNU-Free-Documentation-License"></a>
<h2 class="appendix">Appendix C GNU Free Documentation License</h2>

<a name="index-FDL_002c-GNU-Free-Documentation-License"></a>
<div align="center">Version 1.3, 3 November 2008
</div>

<div class="display">
<pre class="display">Copyright &copy; 2000, 2001, 2002, 2007, 2008 Free Software Foundation, Inc.
<a href="http://fsf.org/">http://fsf.org/</a>

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.
</pre></div>

<ol start="0">
<li> PREAMBLE

<p>The purpose of this License is to make a manual, textbook, or other
functional and useful document <em>free</em> in the sense of freedom: to
assure everyone the effective freedom to copy and redistribute it,
with or without modifying it, either commercially or noncommercially.
Secondarily, this License preserves for the author and publisher a way
to get credit for their work, while not being considered responsible
for modifications made by others.
</p>
<p>This License is a kind of &ldquo;copyleft&rdquo;, which means that derivative
works of the document must themselves be free in the same sense.  It
complements the GNU General Public License, which is a copyleft
license designed for free software.
</p>
<p>We have designed this License in order to use it for manuals for free
software, because free software needs free documentation: a free
program should come with manuals providing the same freedoms that the
software does.  But this License is not limited to software manuals;
it can be used for any textual work, regardless of subject matter or
whether it is published as a printed book.  We recommend this License
principally for works whose purpose is instruction or reference.
</p>
</li><li> APPLICABILITY AND DEFINITIONS

<p>This License applies to any manual or other work, in any medium, that
contains a notice placed by the copyright holder saying it can be
distributed under the terms of this License.  Such a notice grants a
world-wide, royalty-free license, unlimited in duration, to use that
work under the conditions stated herein.  The &ldquo;Document&rdquo;, below,
refers to any such manual or work.  Any member of the public is a
licensee, and is addressed as &ldquo;you&rdquo;.  You accept the license if you
copy, modify or distribute the work in a way requiring permission
under copyright law.
</p>
<p>A &ldquo;Modified Version&rdquo; of the Document means any work containing the
Document or a portion of it, either copied verbatim, or with
modifications and/or translated into another language.
</p>
<p>A &ldquo;Secondary Section&rdquo; is a named appendix or a front-matter section
of the Document that deals exclusively with the relationship of the
publishers or authors of the Document to the Document&rsquo;s overall
subject (or to related matters) and contains nothing that could fall
directly within that overall subject.  (Thus, if the Document is in
part a textbook of mathematics, a Secondary Section may not explain
any mathematics.)  The relationship could be a matter of historical
connection with the subject or with related matters, or of legal,
commercial, philosophical, ethical or political position regarding
them.
</p>
<p>The &ldquo;Invariant Sections&rdquo; are certain Secondary Sections whose titles
are designated, as being those of Invariant Sections, in the notice
that says that the Document is released under this License.  If a
section does not fit the above definition of Secondary then it is not
allowed to be designated as Invariant.  The Document may contain zero
Invariant Sections.  If the Document does not identify any Invariant
Sections then there are none.
</p>
<p>The &ldquo;Cover Texts&rdquo; are certain short passages of text that are listed,
as Front-Cover Texts or Back-Cover Texts, in the notice that says that
the Document is released under this License.  A Front-Cover Text may
be at most 5 words, and a Back-Cover Text may be at most 25 words.
</p>
<p>A &ldquo;Transparent&rdquo; copy of the Document means a machine-readable copy,
represented in a format whose specification is available to the
general public, that is suitable for revising the document
straightforwardly with generic text editors or (for images composed of
pixels) generic paint programs or (for drawings) some widely available
drawing editor, and that is suitable for input to text formatters or
for automatic translation to a variety of formats suitable for input
to text formatters.  A copy made in an otherwise Transparent file
format whose markup, or absence of markup, has been arranged to thwart
or discourage subsequent modification by readers is not Transparent.
An image format is not Transparent if used for any substantial amount
of text.  A copy that is not &ldquo;Transparent&rdquo; is called &ldquo;Opaque&rdquo;.
</p>
<p>Examples of suitable formats for Transparent copies include plain
<small>ASCII</small> without markup, Texinfo input format, LaTeX input
format, <acronym>SGML</acronym> or <acronym>XML</acronym> using a publicly available
<acronym>DTD</acronym>, and standard-conforming simple <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> designed for human modification.  Examples
of transparent image formats include <acronym>PNG</acronym>, <acronym>XCF</acronym> and
<acronym>JPG</acronym>.  Opaque formats include proprietary formats that can be
read and edited only by proprietary word processors, <acronym>SGML</acronym> or
<acronym>XML</acronym> for which the <acronym>DTD</acronym> and/or processing tools are
not generally available, and the machine-generated <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> produced by some word processors for
output purposes only.
</p>
<p>The &ldquo;Title Page&rdquo; means, for a printed book, the title page itself,
plus such following pages as are needed to hold, legibly, the material
this License requires to appear in the title page.  For works in
formats which do not have any title page as such, &ldquo;Title Page&rdquo; means
the text near the most prominent appearance of the work&rsquo;s title,
preceding the beginning of the body of the text.
</p>
<p>The &ldquo;publisher&rdquo; means any person or entity that distributes copies
of the Document to the public.
</p>
<p>A section &ldquo;Entitled XYZ&rdquo; means a named subunit of the Document whose
title either is precisely XYZ or contains XYZ in parentheses following
text that translates XYZ in another language.  (Here XYZ stands for a
specific section name mentioned below, such as &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, &ldquo;Endorsements&rdquo;, or &ldquo;History&rdquo;.)  To &ldquo;Preserve the Title&rdquo;
of such a section when you modify the Document means that it remains a
section &ldquo;Entitled XYZ&rdquo; according to this definition.
</p>
<p>The Document may include Warranty Disclaimers next to the notice which
states that this License applies to the Document.  These Warranty
Disclaimers are considered to be included by reference in this
License, but only as regards disclaiming warranties: any other
implication that these Warranty Disclaimers may have is void and has
no effect on the meaning of this License.
</p>
</li><li> VERBATIM COPYING

<p>You may copy and distribute the Document in any medium, either
commercially or noncommercially, provided that this License, the
copyright notices, and the license notice saying this License applies
to the Document are reproduced in all copies, and that you add no other
conditions whatsoever to those of this License.  You may not use
technical measures to obstruct or control the reading or further
copying of the copies you make or distribute.  However, you may accept
compensation in exchange for copies.  If you distribute a large enough
number of copies you must also follow the conditions in section 3.
</p>
<p>You may also lend copies, under the same conditions stated above, and
you may publicly display copies.
</p>
</li><li> COPYING IN QUANTITY

<p>If you publish printed copies (or copies in media that commonly have
printed covers) of the Document, numbering more than 100, and the
Document&rsquo;s license notice requires Cover Texts, you must enclose the
copies in covers that carry, clearly and legibly, all these Cover
Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on
the back cover.  Both covers must also clearly and legibly identify
you as the publisher of these copies.  The front cover must present
the full title with all words of the title equally prominent and
visible.  You may add other material on the covers in addition.
Copying with changes limited to the covers, as long as they preserve
the title of the Document and satisfy these conditions, can be treated
as verbatim copying in other respects.
</p>
<p>If the required texts for either cover are too voluminous to fit
legibly, you should put the first ones listed (as many as fit
reasonably) on the actual cover, and continue the rest onto adjacent
pages.
</p>
<p>If you publish or distribute Opaque copies of the Document numbering
more than 100, you must either include a machine-readable Transparent
copy along with each Opaque copy, or state in or with each Opaque copy
a computer-network location from which the general network-using
public has access to download using public-standard network protocols
a complete Transparent copy of the Document, free of added material.
If you use the latter option, you must take reasonably prudent steps,
when you begin distribution of Opaque copies in quantity, to ensure
that this Transparent copy will remain thus accessible at the stated
location until at least one year after the last time you distribute an
Opaque copy (directly or through your agents or retailers) of that
edition to the public.
</p>
<p>It is requested, but not required, that you contact the authors of the
Document well before redistributing any large number of copies, to give
them a chance to provide you with an updated version of the Document.
</p>
</li><li> MODIFICATIONS

<p>You may copy and distribute a Modified Version of the Document under
the conditions of sections 2 and 3 above, provided that you release
the Modified Version under precisely this License, with the Modified
Version filling the role of the Document, thus licensing distribution
and modification of the Modified Version to whoever possesses a copy
of it.  In addition, you must do these things in the Modified Version:
</p>
<ol type="A" start="1">
<li> Use in the Title Page (and on the covers, if any) a title distinct
from that of the Document, and from those of previous versions
(which should, if there were any, be listed in the History section
of the Document).  You may use the same title as a previous version
if the original publisher of that version gives permission.

</li><li> List on the Title Page, as authors, one or more persons or entities
responsible for authorship of the modifications in the Modified
Version, together with at least five of the principal authors of the
Document (all of its principal authors, if it has fewer than five),
unless they release you from this requirement.

</li><li> State on the Title page the name of the publisher of the
Modified Version, as the publisher.

</li><li> Preserve all the copyright notices of the Document.

</li><li> Add an appropriate copyright notice for your modifications
adjacent to the other copyright notices.

</li><li> Include, immediately after the copyright notices, a license notice
giving the public permission to use the Modified Version under the
terms of this License, in the form shown in the Addendum below.

</li><li> Preserve in that license notice the full lists of Invariant Sections
and required Cover Texts given in the Document&rsquo;s license notice.

</li><li> Include an unaltered copy of this License.

</li><li> Preserve the section Entitled &ldquo;History&rdquo;, Preserve its Title, and add
to it an item stating at least the title, year, new authors, and
publisher of the Modified Version as given on the Title Page.  If
there is no section Entitled &ldquo;History&rdquo; in the Document, create one
stating the title, year, authors, and publisher of the Document as
given on its Title Page, then add an item describing the Modified
Version as stated in the previous sentence.

</li><li> Preserve the network location, if any, given in the Document for
public access to a Transparent copy of the Document, and likewise
the network locations given in the Document for previous versions
it was based on.  These may be placed in the &ldquo;History&rdquo; section.
You may omit a network location for a work that was published at
least four years before the Document itself, or if the original
publisher of the version it refers to gives permission.

</li><li> For any section Entitled &ldquo;Acknowledgements&rdquo; or &ldquo;Dedications&rdquo;, Preserve
the Title of the section, and preserve in the section all the
substance and tone of each of the contributor acknowledgements and/or
dedications given therein.

</li><li> Preserve all the Invariant Sections of the Document,
unaltered in their text and in their titles.  Section numbers
or the equivalent are not considered part of the section titles.

</li><li> Delete any section Entitled &ldquo;Endorsements&rdquo;.  Such a section
may not be included in the Modified Version.

</li><li> Do not retitle any existing section to be Entitled &ldquo;Endorsements&rdquo; or
to conflict in title with any Invariant Section.

</li><li> Preserve any Warranty Disclaimers.
</li></ol>

<p>If the Modified Version includes new front-matter sections or
appendices that qualify as Secondary Sections and contain no material
copied from the Document, you may at your option designate some or all
of these sections as invariant.  To do this, add their titles to the
list of Invariant Sections in the Modified Version&rsquo;s license notice.
These titles must be distinct from any other section titles.
</p>
<p>You may add a section Entitled &ldquo;Endorsements&rdquo;, provided it contains
nothing but endorsements of your Modified Version by various
parties&mdash;for example, statements of peer review or that the text has
been approved by an organization as the authoritative definition of a
standard.
</p>
<p>You may add a passage of up to five words as a Front-Cover Text, and a
passage of up to 25 words as a Back-Cover Text, to the end of the list
of Cover Texts in the Modified Version.  Only one passage of
Front-Cover Text and one of Back-Cover Text may be added by (or
through arrangements made by) any one entity.  If the Document already
includes a cover text for the same cover, previously added by you or
by arrangement made by the same entity you are acting on behalf of,
you may not add another; but you may replace the old one, on explicit
permission from the previous publisher that added the old one.
</p>
<p>The author(s) and publisher(s) of the Document do not by this License
give permission to use their names for publicity for or to assert or
imply endorsement of any Modified Version.
</p>
</li><li> COMBINING DOCUMENTS

<p>You may combine the Document with other documents released under this
License, under the terms defined in section 4 above for modified
versions, provided that you include in the combination all of the
Invariant Sections of all of the original documents, unmodified, and
list them all as Invariant Sections of your combined work in its
license notice, and that you preserve all their Warranty Disclaimers.
</p>
<p>The combined work need only contain one copy of this License, and
multiple identical Invariant Sections may be replaced with a single
copy.  If there are multiple Invariant Sections with the same name but
different contents, make the title of each such section unique by
adding at the end of it, in parentheses, the name of the original
author or publisher of that section if known, or else a unique number.
Make the same adjustment to the section titles in the list of
Invariant Sections in the license notice of the combined work.
</p>
<p>In the combination, you must combine any sections Entitled &ldquo;History&rdquo;
in the various original documents, forming one section Entitled
&ldquo;History&rdquo;; likewise combine any sections Entitled &ldquo;Acknowledgements&rdquo;,
and any sections Entitled &ldquo;Dedications&rdquo;.  You must delete all
sections Entitled &ldquo;Endorsements.&rdquo;
</p>
</li><li> COLLECTIONS OF DOCUMENTS

<p>You may make a collection consisting of the Document and other documents
released under this License, and replace the individual copies of this
License in the various documents with a single copy that is included in
the collection, provided that you follow the rules of this License for
verbatim copying of each of the documents in all other respects.
</p>
<p>You may extract a single document from such a collection, and distribute
it individually under this License, provided you insert a copy of this
License into the extracted document, and follow this License in all
other respects regarding verbatim copying of that document.
</p>
</li><li> AGGREGATION WITH INDEPENDENT WORKS

<p>A compilation of the Document or its derivatives with other separate
and independent documents or works, in or on a volume of a storage or
distribution medium, is called an &ldquo;aggregate&rdquo; if the copyright
resulting from the compilation is not used to limit the legal rights
of the compilation&rsquo;s users beyond what the individual works permit.
When the Document is included in an aggregate, this License does not
apply to the other works in the aggregate which are not themselves
derivative works of the Document.
</p>
<p>If the Cover Text requirement of section 3 is applicable to these
copies of the Document, then if the Document is less than one half of
the entire aggregate, the Document&rsquo;s Cover Texts may be placed on
covers that bracket the Document within the aggregate, or the
electronic equivalent of covers if the Document is in electronic form.
Otherwise they must appear on printed covers that bracket the whole
aggregate.
</p>
</li><li> TRANSLATION

<p>Translation is considered a kind of modification, so you may
distribute translations of the Document under the terms of section 4.
Replacing Invariant Sections with translations requires special
permission from their copyright holders, but you may include
translations of some or all Invariant Sections in addition to the
original versions of these Invariant Sections.  You may include a
translation of this License, and all the license notices in the
Document, and any Warranty Disclaimers, provided that you also include
the original English version of this License and the original versions
of those notices and disclaimers.  In case of a disagreement between
the translation and the original version of this License or a notice
or disclaimer, the original version will prevail.
</p>
<p>If a section in the Document is Entitled &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, or &ldquo;History&rdquo;, the requirement (section 4) to Preserve
its Title (section 1) will typically require changing the actual
title.
</p>
</li><li> TERMINATION

<p>You may not copy, modify, sublicense, or distribute the Document
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense, or distribute it is void, and
will automatically terminate your rights under this License.
</p>
<p>However, if you cease all violation of this License, then your license
from a particular copyright holder is reinstated (a) provisionally,
unless and until the copyright holder explicitly and finally
terminates your license, and (b) permanently, if the copyright holder
fails to notify you of the violation by some reasonable means prior to
60 days after the cessation.
</p>
<p>Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.
</p>
<p>Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, receipt of a copy of some or all of the same material does
not give you any rights to use it.
</p>
</li><li> FUTURE REVISIONS OF THIS LICENSE

<p>The Free Software Foundation may publish new, revised versions
of the GNU Free Documentation License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.  See
<a href="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</a>.
</p>
<p>Each version of the License is given a distinguishing version number.
If the Document specifies that a particular numbered version of this
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that specified version or
of any later version that has been published (not as a draft) by the
Free Software Foundation.  If the Document does not specify a version
number of this License, you may choose any version ever published (not
as a draft) by the Free Software Foundation.  If the Document
specifies that a proxy can decide which future versions of this
License can be used, that proxy&rsquo;s public statement of acceptance of a
version permanently authorizes you to choose that version for the
Document.
</p>
</li><li> RELICENSING

<p>&ldquo;Massive Multiauthor Collaboration Site&rdquo; (or &ldquo;MMC Site&rdquo;) means any
World Wide Web server that publishes copyrightable works and also
provides prominent facilities for anybody to edit those works.  A
public wiki that anybody can edit is an example of such a server.  A
&ldquo;Massive Multiauthor Collaboration&rdquo; (or &ldquo;MMC&rdquo;) contained in the
site means any set of copyrightable works thus published on the MMC
site.
</p>
<p>&ldquo;CC-BY-SA&rdquo; means the Creative Commons Attribution-Share Alike 3.0
license published by Creative Commons Corporation, a not-for-profit
corporation with a principal place of business in San Francisco,
California, as well as future copyleft versions of that license
published by that same organization.
</p>
<p>&ldquo;Incorporate&rdquo; means to publish or republish a Document, in whole or
in part, as part of another Document.
</p>
<p>An MMC is &ldquo;eligible for relicensing&rdquo; if it is licensed under this
License, and if all works that were first published under this License
somewhere other than this MMC, and subsequently incorporated in whole
or in part into the MMC, (1) had no cover texts or invariant sections,
and (2) were thus incorporated prior to November 1, 2008.
</p>
<p>The operator of an MMC Site may republish an MMC contained in the site
under CC-BY-SA on the same site at any time before August 1, 2009,
provided the MMC is eligible for relicensing.
</p>
</li></ol>

<a name="ADDENDUM_003a-How-to-use-this-License-for-your-documents"></a>
<h3 class="heading">ADDENDUM: How to use this License for your documents</h3>

<p>To use this License in a document you have written, include a copy of
the License in the document and put the following copyright and
license notices just after the title page:
</p>
<div class="smallexample">
<pre class="smallexample">  Copyright (C)  <var>year</var>  <var>your name</var>.
  Permission is granted to copy, distribute and/or modify this document
  under the terms of the GNU Free Documentation License, Version 1.3
  or any later version published by the Free Software Foundation;
  with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
  Texts.  A copy of the license is included in the section entitled ``GNU
  Free Documentation License''.
</pre></div>

<p>If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts,
replace the &ldquo;with&hellip;Texts.&rdquo; line with this:
</p>
<div class="smallexample">
<pre class="smallexample">    with the Invariant Sections being <var>list their titles</var>, with
    the Front-Cover Texts being <var>list</var>, and with the Back-Cover Texts
    being <var>list</var>.
</pre></div>

<p>If you have Invariant Sections without Cover Texts, or some other
combination of the three, merge those two alternatives to suit the
situation.
</p>
<p>If your document contains nontrivial examples of program code, we
recommend releasing these examples in parallel under your choice of
free software license, such as the GNU General Public License,
to permit their use in free software.
</p>


<hr>
<a name="references"></a>
<div class="header">
<p>
Next: <a href="#concept-index" accesskey="n" rel="next">concept index</a>, Previous: <a href="#Documentation-License" accesskey="p" rel="prev">Documentation License</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Bibliography-and-references"></a>
<h2 class="appendix">Appendix D Bibliography and references</h2>


<p>See <a href="GNU Bash.html#Top">(GNU Bash)<acronym>GNU</acronym> Bash</a>.
</p>

<p>Lots of interesting stuff at the following site:
</p>
<div align="center"><a href="http://www.bash-hackers.org/wiki/">http://www.bash-hackers.org/wiki/</a>
</div>

<hr>
<a name="concept-index"></a>
<div class="header">
<p>
Next: <a href="#function-index" accesskey="n" rel="next">function index</a>, Previous: <a href="#references" accesskey="p" rel="prev">references</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="An-entry-for-each-concept"></a>
<h2 class="appendix">Appendix E An entry for each concept</h2>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#concept-index_cp_symbol-1"><b>-</b></a>
 &nbsp; 
<br>
<a class="summary-letter" href="#concept-index_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-W"><b>W</b></a>
 &nbsp; 
</td></tr></table>
<table class="index-cp" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_symbol-1">-</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbrief_002dhelp_002c-predefined-option"><samp>--brief-help</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dbrief_002dusage_002c-predefined-option"><samp>--brief-usage</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002ddebug_002c-predefined-option"><samp>--debug</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dencoded_002dargs_002c-predefined-option"><samp>--encoded-args</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dforce_002c-predefined-option"><samp>--force</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dhelp_002c-predefined-option"><samp>--help</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dinteractive_002c-predefined-option"><samp>--interactive</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlicense_002c-predefined-option"><samp>--license</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dlist_002dexit_002dcodes_002c-predefined-option"><samp>--list-exit-codes</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dnull_002c-predefined-option"><samp>--null</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprint_002dexit_002dcode_002c-predefined-option"><samp>--print-exit-code</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprint_002dexit_002dcode_002dnames_002c-predefined-option"><samp>--print-exit-code-names</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dprint_002doptions_002c-predefined-option"><samp>--print-options</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dshow_002dprogram_002c-predefined-option"><samp>--show-program</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dshow_002dprograms_002c-predefined-option"><samp>--show-programs</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dsilent_002c-predefined-option"><samp>--silent</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtest_002c-predefined-option"><samp>--test</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dtmpdir_002c-predefined-option"><samp>--tmpdir</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dusage_002c-predefined-option"><samp>--usage</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dvalidate_002dprograms_002c-predefined-option"><samp>--validate-programs</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dverbose_002c-predefined-option"><samp>--verbose</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dverbose_002dprogram_002c-predefined-option"><samp>--verbose-program</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dversion_002c-predefined-option"><samp>--version</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002d_002dversion_002donly_002c-predefined-option"><samp>--version-only</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002df_002c-predefined-option"><samp>-f</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dh_002c-predefined-option"><samp>-h</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dH_002c-predefined-option"><samp>-H</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002di_002c-predefined-option"><samp>-i</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002dv_002c-predefined-option"><samp>-v</samp>, predefined option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Archives_002c-tar">Archives, <code>tar</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-tar">file commands tar</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_letter-B">B</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-bzip2_002c-command"><code>bzip2</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Changing-directory">Changing directory</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-misc">file misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-chgrp_002c-command"><code>chgrp</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-owner">file commands owner</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-chmod_002c-command"><code>chmod</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-chmod_002c-command-1"><code>chmod</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-perms">file commands perms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-chown_002c-command"><code>chown</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-chown_002c-command-1"><code>chown</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-owner">file commands owner</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-bzip2">Command <code>bzip2</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-chgrp">Command <code>chgrp</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-owner">file commands owner</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-chmod">Command <code>chmod</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-chmod-1">Command <code>chmod</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-perms">file commands perms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-chown">Command <code>chown</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-chown-1">Command <code>chown</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-owner">file commands owner</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-cp">Command <code>cp</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-copy">file commands copy</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-gzip">Command <code>gzip</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-line-options_002c-parsing">Command line options, parsing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts">getopts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-ln">Command <code>ln</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-symlink">file commands symlink</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-ls">Command <code>ls</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-mkdir">Command <code>mkdir</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-mkdir">file commands mkdir</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-mv">Command <code>mv</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-move">file commands move</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-readlink">Command <code>readlink</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-rm">Command <code>rm</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-removing">file commands removing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-rmdir">Command <code>rmdir</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-removing">file commands removing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Command-tar">Command <code>tar</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-tar">file commands tar</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Compressing-files">Compressing files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Copying-files">Copying files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-copy">file commands copy</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cp_002c-command"><code>cp</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-copy">file commands copy</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Creating-directories">Creating directories</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-mkdir">file commands mkdir</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Creating-symbolic-links">Creating symbolic links</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-symlink">file commands symlink</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Creating-tar-archives">Creating tar archives</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-tar">file commands tar</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_letter-D">D</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Directories_002c-creating">Directories, creating</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-mkdir">file commands mkdir</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Directory_002c-changing">Directory, changing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-misc">file misc</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_letter-E">E</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-bzip2">Executing command <code>bzip2</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-chgrp">Executing command <code>chgrp</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-owner">file commands owner</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-chmod">Executing command <code>chmod</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-chmod-1">Executing command <code>chmod</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-perms">file commands perms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-chown">Executing command <code>chown</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-chown-1">Executing command <code>chown</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-owner">file commands owner</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-cp">Executing command <code>cp</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-copy">file commands copy</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-gzip">Executing command <code>gzip</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-ln">Executing command <code>ln</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-symlink">file commands symlink</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-ls">Executing command <code>ls</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-mkdir">Executing command <code>mkdir</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-mkdir">file commands mkdir</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-mv">Executing command <code>mv</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-move">file commands move</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-readlink">Executing command <code>readlink</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-rm">Executing command <code>rm</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-removing">file commands removing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-rmdir">Executing command <code>rmdir</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-removing">file commands removing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executing-command-tar">Executing command <code>tar</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-tar">file commands tar</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Existence-of-files">Existence of files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_letter-F">F</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-FDL_002c-GNU-Free-Documentation-License">FDL, GNU Free Documentation License</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Documentation-License">Documentation License</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Files_002c-changing-directory">Files, changing directory</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-misc">file misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Files_002c-compression">Files, compression</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Files_002c-copying">Files, copying</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-copy">file commands copy</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Files_002c-existence-and-permissions">Files, existence and permissions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Files_002c-group">Files, group</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Files_002c-listing">Files, listing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Files_002c-moving">Files, moving</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-move">file commands move</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Files_002c-owner">Files, owner</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Files_002c-owner-and-group">Files, owner and group</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-owner">file commands owner</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Files_002c-permissions">Files, permissions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-perms">file commands perms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Files_002c-reading-and-writing">Files, reading and writing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-read-and-write">file read and write</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Files_002c-removing">Files, removing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-removing">file commands removing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Files_002c-size">Files, size</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Files_002c-symbolic-links">Files, symbolic links</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-symlink">file commands symlink</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_letter-G">G</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Getting-file-permissions">Getting file permissions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-perms">file commands perms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Getting-group-of-files">Getting group of files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Getting-owner-of-files">Getting owner of files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Getting-size-of-files">Getting size of files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Group-of-files">Group of files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Group-of-of-files">Group of of files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-owner">file commands owner</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gzip_002c-command"><code>gzip</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_letter-L">L</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-LGPL_002c-Lesser-General-Public-License">LGPL, Lesser General Public License</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Package-License">Package License</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Listing-files">Listing files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ln_002c-command"><code>ln</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-symlink">file commands symlink</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ls_002c-command"><code>ls</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-mkdir_002c-command"><code>mkdir</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-mkdir">file commands mkdir</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Moving-files">Moving files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-move">file commands move</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mv_002c-command"><code>mv</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-move">file commands move</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_letter-O">O</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Owner-of-files">Owner of files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Owner-of-of-files">Owner of of files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-owner">file commands owner</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_letter-P">P</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Parsing-command-line-options">Parsing command line options</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts">getopts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Permissions-of-files">Permissions of files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-perms">file commands perms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dbrief_002dhelp">Predefined option <samp>--brief-help</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dbrief_002dusage">Predefined option <samp>--brief-usage</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002ddebug">Predefined option <samp>--debug</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dencoded_002dargs">Predefined option <samp>--encoded-args</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dforce">Predefined option <samp>--force</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dhelp">Predefined option <samp>--help</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dinteractive">Predefined option <samp>--interactive</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dlicense">Predefined option <samp>--license</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dlist_002dexit_002dcodes">Predefined option <samp>--list-exit-codes</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dnull">Predefined option <samp>--null</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dprint_002dexit_002dcode">Predefined option <samp>--print-exit-code</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dprint_002dexit_002dcode_002dnames">Predefined option <samp>--print-exit-code-names</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dprint_002doptions">Predefined option <samp>--print-options</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dshow_002dprogram">Predefined option <samp>--show-program</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dshow_002dprograms">Predefined option <samp>--show-programs</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dsilent">Predefined option <samp>--silent</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dtest">Predefined option <samp>--test</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dtmpdir">Predefined option <samp>--tmpdir</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dusage">Predefined option <samp>--usage</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dvalidate_002dprograms">Predefined option <samp>--validate-programs</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dverbose">Predefined option <samp>--verbose</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dverbose_002dprogram">Predefined option <samp>--verbose-program</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dversion">Predefined option <samp>--version</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002d_002dversion_002donly">Predefined option <samp>--version-only</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002df">Predefined option <samp>-f</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002dh">Predefined option <samp>-h</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002dH">Predefined option <samp>-H</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002di">Predefined option <samp>-i</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Predefined-option-_002dv">Predefined option <samp>-v</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Program-command-line-options_002c-parsing">Program command line options, parsing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts">getopts</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_letter-R">R</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Reading-and-writing-files">Reading and writing files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-read-and-write">file read and write</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-readlink_002c-command"><code>readlink</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Removing-files">Removing files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-removing">file commands removing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-rm_002c-command"><code>rm</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-removing">file commands removing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-rmdir_002c-command"><code>rmdir</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-removing">file commands removing</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Size-of-files">Size of files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Symbolic-links">Symbolic links</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-symlink">file commands symlink</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_letter-T">T</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-tar-archives"><code>tar</code> archives</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-tar">file commands tar</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tar_002c-command"><code>tar</code>, command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-tar">file commands tar</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="concept-index_cp_letter-W">W</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Writing-and-reading-files">Writing and reading files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-read-and-write">file read and write</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#concept-index_cp_symbol-1"><b>-</b></a>
 &nbsp; 
<br>
<a class="summary-letter" href="#concept-index_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#concept-index_cp_letter-W"><b>W</b></a>
 &nbsp; 
</td></tr></table>

<hr>
<a name="function-index"></a>
<div class="header">
<p>
Next: <a href="#variable-index" accesskey="n" rel="next">variable index</a>, Previous: <a href="#concept-index" accesskey="p" rel="prev">concept index</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="An-entry-for-each-function_002e"></a>
<h2 class="appendix">Appendix F An entry for each function.</h2>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#function-index_fn_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#function-index_fn_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#function-index_fn_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#function-index_fn_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#function-index_fn_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#function-index_fn_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#function-index_fn_letter-S"><b>S</b></a>
 &nbsp; 
</td></tr></table>
<table class="index-fn" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="function-index_fn_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-connector"><code>connector</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-connector">sendmail connector</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="function-index_fn_letter-D">D</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest"><code>dotest</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-running">testing running</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dassert_002dfile_002dexists"><code>dotest-assert-file-exists</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-files-files">testing files files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dassert_002dfile_002dunexists"><code>dotest-assert-file-unexists</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-files-files">testing files files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dcd"><code>dotest-cd</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-files-directories">testing files directories</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dcd_002dtmpdir"><code>dotest-cd-tmpdir</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-files-directories">testing files directories</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dclean_002dfiles"><code>dotest-clean-files</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-files-files">testing files files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002ddebug"><code>dotest-debug</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-messages">testing messages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002decho"><code>dotest-echo</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-messages">testing messages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002decho_002dtmpdir"><code>dotest-echo-tmpdir</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-files-directories">testing files directories</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dequal"><code>dotest-equal</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-compare">testing compare</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dfinal_002dreport"><code>dotest-final-report</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-running">testing running</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dmkdir"><code>dotest-mkdir</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-files-directories">testing files directories</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dmkdir-1"><code>dotest-mkdir</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-files-directories">testing files directories</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dmkfile"><code>dotest-mkfile</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-files-files">testing files files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dmkfile-1"><code>dotest-mkfile</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-files-files">testing files files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dmktmpdir"><code>dotest-mktmpdir</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-files-directories">testing files directories</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002doption_002dreport_002dstart"><code>dotest-option-report-start</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-config">testing config</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002doption_002dreport_002dsuccess"><code>dotest-option-report-success</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-config">testing config</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002doption_002dtest"><code>dotest-option-test</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-config">testing config</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002doption_002dverbose"><code>dotest-option-verbose</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-config">testing config</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002doutput"><code>dotest-output</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-output">testing output</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002doutput-1"><code>dotest-output</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-output">testing output</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dset_002dreport_002dstart"><code>dotest-set-report-start</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-config">testing config</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dset_002dreport_002dsuccess"><code>dotest-set-report-success</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-config">testing config</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dset_002dtest"><code>dotest-set-test</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-config">testing config</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dset_002dverbose"><code>dotest-set-verbose</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-config">testing config</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dunset_002dreport_002dstart"><code>dotest-unset-report-start</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-config">testing config</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dunset_002dreport_002dsuccess"><code>dotest-unset-report-success</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-config">testing config</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dunset_002dtest"><code>dotest-unset-test</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-config">testing config</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dotest_002dunset_002dverbose"><code>dotest-unset-verbose</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-config">testing config</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="function-index_fn_letter-E">E</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-exit_005fbecause_005ffailure"><code>exit_because_failure</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-exit">main exit</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-exit_005fbecause_005fprogram_005fnot_005ffound"><code>exit_because_program_not_found</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-declaring">program declaring</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-exit_005fbecause_005fsuccess"><code>exit_because_success</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-exit">main exit</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-exit_005fbecause_005fwrong_005fnum_005fargs"><code>exit_because_wrong_num_args</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-exit_005ffailure"><code>exit_failure</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-exit">main exit</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-exit_005fsuccess"><code>exit_success</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-exit">main exit</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="function-index_fn_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-main"><code>main</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-plain">sendmail plain</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005factions_005fdispatch"><code>mbfl_actions_dispatch</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#actions-dispatch">actions dispatch</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005factions_005ffake_005faction_005fset"><code>mbfl_actions_fake_action_set</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#actions-misc">actions misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005factions_005fprint_005fusage_005fscreen"><code>mbfl_actions_print_usage_screen</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#actions-misc">actions misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005factions_005fset_005fexists"><code>mbfl_actions_set_exists</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#actions-inspect">actions inspect</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005factions_005fset_005fexists_005for_005fnone"><code>mbfl_actions_set_exists_or_none</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#actions-inspect">actions inspect</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fargv_005fall_005ffiles"><code>mbfl_argv_all_files</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fargv_005ffrom_005fstdin"><code>mbfl_argv_from_stdin</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fat_005fdrop"><code>mbfl_at_drop</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#interfaces-at">interfaces at</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fat_005fenable"><code>mbfl_at_enable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#interfaces-at">interfaces at</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fat_005fprint_005fqueue"><code>mbfl_at_print_queue</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#interfaces-at">interfaces at</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fat_005fqueue_005fclean"><code>mbfl_at_queue_clean</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#interfaces-at">interfaces at</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fat_005fqueue_005fprint_005fidentifiers"><code>mbfl_at_queue_print_identifiers</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#interfaces-at">interfaces at</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fat_005fqueue_005fprint_005fjobs"><code>mbfl_at_queue_print_jobs</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#interfaces-at">interfaces at</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fat_005fqueue_005fprint_005fqueues"><code>mbfl_at_queue_print_queues</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#interfaces-at">interfaces at</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fat_005fschedule"><code>mbfl_at_schedule</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#interfaces-at">interfaces at</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fat_005fselect_005fqueue"><code>mbfl_at_select_queue</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#interfaces-at">interfaces at</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fat_005fvalidate_005fqueue_005fletter"><code>mbfl_at_validate_queue_letter</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#interfaces-at">interfaces at</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fat_005fvalidate_005fselected_005fqueue"><code>mbfl_at_validate_selected_queue</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#interfaces-at">interfaces at</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fcd"><code>mbfl_cd</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-misc">file misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fchange_005fdirectory"><code>mbfl_change_directory</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-misc">file misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fcommand_005fline_005fargument"><code>mbfl_command_line_argument</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#preprocessor-macros">preprocessor macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fdeclare_005faction"><code>mbfl_declare_action</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#actions-declare">actions declare</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fdeclare_005faction_005fset"><code>mbfl_declare_action_set</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#actions-declare">actions declare</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fdeclare_005foption"><code>mbfl_declare_option</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fdeclare_005fprogram"><code>mbfl_declare_program</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-declaring">program declaring</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fdecode_005fhex"><code>mbfl_decode_hex</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#encoding">encoding</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fdecode_005foct"><code>mbfl_decode_oct</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#encoding">encoding</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fdialog_005fask_005fpassword"><code>mbfl_dialog_ask_password</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#dialog">dialog</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fdialog_005fenable_005fprograms"><code>mbfl_dialog_enable_programs</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#dialog">dialog</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fdialog_005fyes_005for_005fno"><code>mbfl_dialog_yes_or_no</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#dialog">dialog</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fdialog_005fyes_005for_005fno-1"><code>mbfl_dialog_yes_or_no</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#dialog">dialog</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fappend"><code>mbfl_file_append</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-read-and-write">file read and write</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fcompress"><code>mbfl_file_compress</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fcompress_005fkeep"><code>mbfl_file_compress_keep</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fcompress_005fnokeep"><code>mbfl_file_compress_nokeep</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fcompress_005fselect_005fbzip"><code>mbfl_file_compress_select_bzip</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fcompress_005fselect_005fgzip"><code>mbfl_file_compress_select_gzip</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fcompress_005fselect_005fnostdout"><code>mbfl_file_compress_select_nostdout</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fcompress_005fselect_005fstdout"><code>mbfl_file_compress_select_stdout</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fcopy"><code>mbfl_file_copy</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-copy">file commands copy</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fcopy_005fto_005fdirectory"><code>mbfl_file_copy_to_directory</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-copy">file commands copy</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fdecompress"><code>mbfl_file_decompress</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fdirectory_005fis_005fexecutable"><code>mbfl_file_directory_is_executable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fdirectory_005fis_005fexecutable-1"><code>mbfl_file_directory_is_executable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fdirectory_005fis_005freadable"><code>mbfl_file_directory_is_readable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fdirectory_005fis_005freadable-1"><code>mbfl_file_directory_is_readable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fdirectory_005fis_005fwritable"><code>mbfl_file_directory_is_writable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fdirectory_005fis_005fwritable-1"><code>mbfl_file_directory_is_writable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fdirectory_005fvalidate_005fwritability"><code>mbfl_file_directory_validate_writability</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fdirname"><code>mbfl_file_dirname</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-name-parts">file name parts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fenable_005fcompress"><code>mbfl_file_enable_compress</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-compress">file commands compress</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fenable_005fcopy"><code>mbfl_file_enable_copy</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-copy">file commands copy</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fenable_005flisting"><code>mbfl_file_enable_listing</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fenable_005fmake_005fdirectory"><code>mbfl_file_enable_make_directory</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-mkdir">file commands mkdir</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fenable_005fmove"><code>mbfl_file_enable_move</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-move">file commands move</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fenable_005fowner_005fand_005fgroup"><code>mbfl_file_enable_owner_and_group</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-owner">file commands owner</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fenable_005fpermissions"><code>mbfl_file_enable_permissions</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-perms">file commands perms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fenable_005fremove"><code>mbfl_file_enable_remove</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-removing">file commands removing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fenable_005fstat"><code>mbfl_file_enable_stat</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-stat">file commands stat</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fenable_005fsymlink"><code>mbfl_file_enable_symlink</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-symlink">file commands symlink</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fenable_005ftar"><code>mbfl_file_enable_tar</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-tar">file commands tar</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fexists"><code>mbfl_file_exists</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fextension"><code>mbfl_file_extension</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-name-parts">file name parts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005ffind_005ftmpdir"><code>mbfl_file_find_tmpdir</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-name-system">file name system</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005ffind_005ftmpdir-1"><code>mbfl_file_find_tmpdir</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-name-system">file name system</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fget_005fgroup"><code>mbfl_file_get_group</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fget_005fowner"><code>mbfl_file_get_owner</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fget_005fpermissions"><code>mbfl_file_get_permissions</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-perms">file commands perms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fget_005fsize"><code>mbfl_file_get_size</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fis_005fabsolute"><code>mbfl_file_is_absolute</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-name-path">file name path</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fis_005fabsolute_005fdirname"><code>mbfl_file_is_absolute_dirname</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-name-path">file name path</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fis_005fabsolute_005ffilename"><code>mbfl_file_is_absolute_filename</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-name-path">file name path</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fis_005fdirectory"><code>mbfl_file_is_directory</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fis_005fdirectory-1"><code>mbfl_file_is_directory</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fis_005fexecutable"><code>mbfl_file_is_executable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fis_005fexecutable-1"><code>mbfl_file_is_executable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fis_005ffile"><code>mbfl_file_is_file</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fis_005ffile-1"><code>mbfl_file_is_file</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fis_005freadable"><code>mbfl_file_is_readable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fis_005freadable-1"><code>mbfl_file_is_readable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fis_005fsymlink"><code>mbfl_file_is_symlink</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fis_005fsymlink-1"><code>mbfl_file_is_symlink</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fis_005fwritable"><code>mbfl_file_is_writable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fis_005fwritable-1"><code>mbfl_file_is_writable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005flisting"><code>mbfl_file_listing</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005flong_005flisting"><code>mbfl_file_long_listing</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fmake_005fdirectory"><code>mbfl_file_make_directory</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-mkdir">file commands mkdir</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fmake_005fdirectory-1"><code>mbfl_file_make_directory</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-mkdir">file commands mkdir</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fmake_005fif_005fnot_005fdirectory"><code>mbfl_file_make_if_not_directory</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-mkdir">file commands mkdir</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fmake_005fif_005fnot_005fdirectory-1"><code>mbfl_file_make_if_not_directory</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-mkdir">file commands mkdir</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fmove"><code>mbfl_file_move</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-move">file commands move</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fmove_005fto_005fdirectory"><code>mbfl_file_move_to_directory</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-move">file commands move</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fnormalise"><code>mbfl_file_normalise</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-name-path">file name path</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fnormalise-1"><code>mbfl_file_normalise</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-name-path">file name path</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fnormalise_005flink"><code>mbfl_file_normalise_link</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fpathname_005fis_005fexecutable"><code>mbfl_file_pathname_is_executable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fpathname_005fis_005fexecutable-1"><code>mbfl_file_pathname_is_executable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fpathname_005fis_005freadable"><code>mbfl_file_pathname_is_readable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fpathname_005fis_005freadable-1"><code>mbfl_file_pathname_is_readable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fpathname_005fis_005fwritable"><code>mbfl_file_pathname_is_writable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fpathname_005fis_005fwritable-1"><code>mbfl_file_pathname_is_writable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-testing">file testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fread"><code>mbfl_file_read</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-read-and-write">file read and write</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fread_005flink"><code>mbfl_file_read_link</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-listing">file commands listing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fremove"><code>mbfl_file_remove</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-removing">file commands removing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fremove_005fdirectory"><code>mbfl_file_remove_directory</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-removing">file commands removing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fremove_005fdirectory_005fsilently"><code>mbfl_file_remove_directory_silently</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-removing">file commands removing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fremove_005ffile"><code>mbfl_file_remove_file</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-removing">file commands removing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fremove_005ffile_005for_005fsymlink"><code>mbfl_file_remove_file_or_symlink</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-removing">file commands removing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fremove_005fsymlink"><code>mbfl_file_remove_symlink</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-removing">file commands removing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005frootname"><code>mbfl_file_rootname</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-name-parts">file name parts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fset_005fgroup"><code>mbfl_file_set_group</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-owner">file commands owner</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fset_005fowner"><code>mbfl_file_set_owner</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-owner">file commands owner</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fset_005fpermissions"><code>mbfl_file_set_permissions</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-perms">file commands perms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fsplit"><code>mbfl_file_split</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-name-parts">file name parts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fstat"><code>mbfl_file_stat</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-stat">file commands stat</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fstrip_005ftrailing_005fslash"><code>mbfl_file_strip_trailing_slash</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-name-parts">file name parts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fsubpathname"><code>mbfl_file_subpathname</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-name-path">file name path</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fsymlink"><code>mbfl_file_symlink</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-symlink">file commands symlink</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005ftail"><code>mbfl_file_tail</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-name-parts">file name parts</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ffile_005fwrite"><code>mbfl_file_write</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-read-and-write">file read and write</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fgetopts_005fisbrief"><code>mbfl_getopts_isbrief</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fgetopts_005fisbrief-1"><code>mbfl_getopts_isbrief</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fgetopts_005fisbrief_005fwith"><code>mbfl_getopts_isbrief_with</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fgetopts_005fisbrief_005fwith-1"><code>mbfl_getopts_isbrief_with</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fgetopts_005fislong"><code>mbfl_getopts_islong</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fgetopts_005fislong-1"><code>mbfl_getopts_islong</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fgetopts_005fislong_005fwith"><code>mbfl_getopts_islong_with</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fgetopts_005fislong_005fwith-1"><code>mbfl_getopts_islong_with</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fgetopts_005fparse"><code>mbfl_getopts_parse</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fgetopts_005fprint_005flong_005fswitches"><code>mbfl_getopts_print_long_switches</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005finvoke_005fexistent_005fscript_005ffunction"><code>mbfl_invoke_existent_script_function</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-misc">main misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005finvoke_005fscript_005ffunction"><code>mbfl_invoke_script_function</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-misc">main misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmain"><code>mbfl_main</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-function">main function</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmain_005fcreate_005fexit_005ffunctions"><code>mbfl_main_create_exit_functions</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-exit">main exit</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmain_005fdeclare_005fexit_005fcode"><code>mbfl_main_declare_exit_code</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-exit">main exit</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmain_005fprint_005fexit_005fcode"><code>mbfl_main_print_exit_code</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-exit">main exit</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmain_005fprint_005fusage_005fscreen_005fbrief"><code>mbfl_main_print_usage_screen_brief</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-misc">main misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmain_005fprint_005fusage_005fscreen_005flong"><code>mbfl_main_print_usage_screen_long</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-misc">main misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmain_005fset_005fafter_005fparsing_005foptions"><code>mbfl_main_set_after_parsing_options</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-function">main function</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmain_005fset_005fbefore_005fparsing_005foptions"><code>mbfl_main_set_before_parsing_options</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-function">main function</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmain_005fset_005fmain"><code>mbfl_main_set_main</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-function">main function</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmandatory_005fparameter"><code>mbfl_mandatory_parameter</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#preprocessor-macros">preprocessor macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005fdebug"><code>mbfl_message_debug</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005fdebug_005fprintf"><code>mbfl_message_debug_printf</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005fdebug_005fprintf-1"><code>mbfl_message_debug_printf</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005ferror"><code>mbfl_message_error</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005ferror_005fprintf"><code>mbfl_message_error_printf</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005ferror_005fprintf-1"><code>mbfl_message_error_printf</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005fset_005fchannel"><code>mbfl_message_set_channel</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005fset_005fprogname"><code>mbfl_message_set_progname</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005fstring"><code>mbfl_message_string</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005fverbose"><code>mbfl_message_verbose</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005fverbose_005fend"><code>mbfl_message_verbose_end</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005fverbose_005fprintf"><code>mbfl_message_verbose_printf</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005fverbose_005fprintf-1"><code>mbfl_message_verbose_printf</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005fwarning"><code>mbfl_message_warning</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005fwarning_005fprintf"><code>mbfl_message_warning_printf</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmessage_005fwarning_005fprintf-1"><code>mbfl_message_warning_printf</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#message">message</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005foptional_005fparameter"><code>mbfl_optional_parameter</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#preprocessor-macros">preprocessor macros</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005foption_005fdebug"><code>mbfl_option_debug</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005foption_005fencoded_005fargs"><code>mbfl_option_encoded_args</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005foption_005finteractive"><code>mbfl_option_interactive</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005foption_005fnull"><code>mbfl_option_null</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005foption_005fshow_005fprogram"><code>mbfl_option_show_program</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005foption_005ftest"><code>mbfl_option_test</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005foption_005ftest-1"><code>mbfl_option_test</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-testing">program testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005foption_005ftest_005frestore"><code>mbfl_option_test_restore</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005foption_005ftest_005fsave"><code>mbfl_option_test_save</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005foption_005fverbose"><code>mbfl_option_verbose</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005foption_005fverbose_005fprogram"><code>mbfl_option_verbose_program</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005fbash"><code>mbfl_program_bash</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005fbash_005fcommand"><code>mbfl_program_bash_command</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005fdeclare_005fsudo_005foptions"><code>mbfl_program_declare_sudo_options</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005fdeclare_005fsudo_005fuser"><code>mbfl_program_declare_sudo_user</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005fenable_005fsudo"><code>mbfl_program_enable_sudo</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005fexec"><code>mbfl_program_exec</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005fexec-1"><code>mbfl_program_exec</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005fexecbg"><code>mbfl_program_execbg</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005fexecbg-1"><code>mbfl_program_execbg</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005ffind"><code>mbfl_program_find</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-checking">program checking</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005ffound"><code>mbfl_program_found</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-declaring">program declaring</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005fredirect_005fstderr_005fto_005fstdout"><code>mbfl_program_redirect_stderr_to_stdout</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005freplace"><code>mbfl_program_replace</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005freplace-1"><code>mbfl_program_replace</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005frequested_005fsudo"><code>mbfl_program_requested_sudo</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005freset_005fsudo_005foptions"><code>mbfl_program_reset_sudo_options</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005freset_005fsudo_005fuser"><code>mbfl_program_reset_sudo_user</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005fsudo_005fuser"><code>mbfl_program_sudo_user</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005fvalidate_005fdeclared"><code>mbfl_program_validate_declared</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-declaring">program declaring</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fread_005fmaybe_005fnull"><code>mbfl_read_maybe_null</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#base">base</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fset_005fmaybe"><code>mbfl_set_maybe</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#base">base</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fset_005foption_005fdebug"><code>mbfl_set_option_debug</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fset_005foption_005fencoded_005fargs"><code>mbfl_set_option_encoded_args</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fset_005foption_005finteractive"><code>mbfl_set_option_interactive</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fset_005foption_005fnull"><code>mbfl_set_option_null</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fset_005foption_005fshow_005fprogram"><code>mbfl_set_option_show_program</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fset_005foption_005ftest"><code>mbfl_set_option_test</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fset_005foption_005ftest-1"><code>mbfl_set_option_test</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-testing">program testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fset_005foption_005fverbose"><code>mbfl_set_option_verbose</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fset_005foption_005fverbose_005fprogram"><code>mbfl_set_option_verbose_program</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fsignal_005fattach"><code>mbfl_signal_attach</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#signal">signal</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fsignal_005finvoke_005fhandlers"><code>mbfl_signal_invoke_handlers</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#signal">signal</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fsignal_005fmap_005fsigname_005fto_005fsignum"><code>mbfl_signal_map_signame_to_signum</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#signal">signal</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fsprintf"><code>mbfl_sprintf</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-misc">string misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fchars"><code>mbfl_string_chars</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-splitting">string splitting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fequal_005fsubstring"><code>mbfl_string_equal_substring</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-inspection">string inspection</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005ffirst"><code>mbfl_string_first</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-inspection">string inspection</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005ffirst-1"><code>mbfl_string_first</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-inspection">string inspection</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005findex"><code>mbfl_string_index</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-inspection">string inspection</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005falnum"><code>mbfl_string_is_alnum</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-class">string class</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005falnum_005fchar"><code>mbfl_string_is_alnum_char</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-class">string class</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005falpha"><code>mbfl_string_is_alpha</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-class">string class</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005falpha_005fchar"><code>mbfl_string_is_alpha_char</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-class">string class</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005fdigit"><code>mbfl_string_is_digit</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-class">string class</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005fdigit_005fchar"><code>mbfl_string_is_digit_char</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-class">string class</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005fequal_005funquoted_005fchar"><code>mbfl_string_is_equal_unquoted_char</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-quote">string quote</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005fextended_005fidentifier"><code>mbfl_string_is_extended_identifier</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-class">string class</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005fextended_005fidentifier_005fchar"><code>mbfl_string_is_extended_identifier_char</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-class">string class</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005fidentifier"><code>mbfl_string_is_identifier</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-class">string class</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005fidentifier_005fchar"><code>mbfl_string_is_identifier_char</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-class">string class</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005fname"><code>mbfl_string_is_name</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-class">string class</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005fname_005fchar"><code>mbfl_string_is_name_char</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-class">string class</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005fnoblank"><code>mbfl_string_is_noblank</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-class">string class</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005fnoblank_005fchar"><code>mbfl_string_is_noblank_char</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-class">string class</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005fquoted_005fchar"><code>mbfl_string_is_quoted_char</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-quote">string quote</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fis_005fusername"><code>mbfl_string_is_username</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-class">string class</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005flast"><code>mbfl_string_last</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-inspection">string inspection</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005flast-1"><code>mbfl_string_last</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-inspection">string inspection</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fquote"><code>mbfl_string_quote</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-quote">string quote</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005frange"><code>mbfl_string_range</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-inspection">string inspection</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005freplace"><code>mbfl_string_replace</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-misc">string misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005freplace-1"><code>mbfl_string_replace</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-misc">string misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fskip"><code>mbfl_string_skip</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-misc">string misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005fsplit"><code>mbfl_string_split</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-splitting">string splitting</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005ftolower"><code>mbfl_string_tolower</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-case">string case</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fstring_005ftoupper"><code>mbfl_string_toupper</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#string-case">string case</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fsystem_005fenable_005fprograms"><code>mbfl_system_enable_programs</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#system">system</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fsystem_005fnumerical_005fuser_005fid_005fto_005fname"><code>mbfl_system_numerical_user_id_to_name</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#system-user-id">system user id</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fsystem_005fnumerical_005fuser_005fid_005fto_005fname-1"><code>mbfl_system_numerical_user_id_to_name</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#system-user-id">system user id</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fsystem_005foctal_005fto_005fsymbolic_005fpermissions"><code>mbfl_system_octal_to_symbolic_permissions</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#system-file-perms">system file perms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fsystem_005fsymbolic_005fto_005foctal_005fpermissions"><code>mbfl_system_symbolic_to_octal_permissions</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#system-file-perms">system file perms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ftar_005farchive_005fdirectory_005fto_005ffile"><code>mbfl_tar_archive_directory_to_file</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-tar">file commands tar</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ftar_005fcreate_005fto_005ffile"><code>mbfl_tar_create_to_file</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-tar">file commands tar</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ftar_005fcreate_005fto_005fstdout"><code>mbfl_tar_create_to_stdout</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-tar">file commands tar</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ftar_005fexec"><code>mbfl_tar_exec</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-tar">file commands tar</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ftar_005fextract_005ffrom_005ffile"><code>mbfl_tar_extract_from_file</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-tar">file commands tar</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ftar_005fextract_005ffrom_005fstdin"><code>mbfl_tar_extract_from_stdin</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-tar">file commands tar</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005ftar_005flist"><code>mbfl_tar_list</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#file-commands-tar">file commands tar</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005funset_005foption_005fdebug"><code>mbfl_unset_option_debug</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005funset_005foption_005fencoded_005fargs"><code>mbfl_unset_option_encoded_args</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005funset_005foption_005finteractive"><code>mbfl_unset_option_interactive</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005funset_005foption_005fnull"><code>mbfl_unset_option_null</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005funset_005foption_005fshow_005fprogram"><code>mbfl_unset_option_show_program</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005funset_005foption_005ftest"><code>mbfl_unset_option_test</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005funset_005foption_005ftest-1"><code>mbfl_unset_option_test</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-testing">program testing</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005funset_005foption_005fverbose"><code>mbfl_unset_option_verbose</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005funset_005foption_005fverbose_005fprogram"><code>mbfl_unset_option_verbose_program</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-options">getopts options</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fvariable_005farray_005fto_005fcolon_005fvariable"><code>mbfl_variable_array_to_colon_variable</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#variables-colon">variables colon</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fvariable_005fcolon_005fvariable_005fdrop_005fduplicate"><code>mbfl_variable_colon_variable_drop_duplicate</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#variables-colon">variables colon</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fvariable_005fcolon_005fvariable_005fto_005farray"><code>mbfl_variable_colon_variable_to_array</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#variables-colon">variables colon</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fvariable_005felement_005fis_005fin_005farray"><code>mbfl_variable_element_is_in_array</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#variables-arrays">variables arrays</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fvariable_005ffind_005fin_005farray"><code>mbfl_variable_find_in_array</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#variables-arrays">variables arrays</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fwrong_005fnum_005fargs"><code>mbfl_wrong_num_args</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fwrong_005fnum_005fargs_005frange"><code>mbfl_wrong_num_args_range</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#getopts-interface">getopts interface</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="function-index_fn_letter-O">O</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-open_005fsession"><code>open_session</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-plain">sendmail plain</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-open_005fsession-1"><code>open_session</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-connector">sendmail connector</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="function-index_fn_letter-R">R</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-read_005fand_005fsend_005fmessage"><code>read_and_send_message</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-plain">sendmail plain</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-recv"><code>recv</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-plain">sendmail plain</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="function-index_fn_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-script_005fafter_005fparsing_005foptions"><code>script_after_parsing_options</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-function">main function</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-script_005fbefore_005fparsing_005foptions"><code>script_before_parsing_options</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-function">main function</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-send"><code>send</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-plain">sendmail plain</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-send-1"><code>send</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-plain">sendmail plain</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-send_002dmail_002dwith_002dmbfl"><code>send-mail-with-mbfl</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-send">sendmail script emacs send</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dactivate"><code>sendmail-mbfl-activate</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-misc">sendmail script emacs misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dcopy_002dmessage_002dbuffer"><code>sendmail-mbfl-copy-message-buffer</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-misc">sendmail script emacs misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002ddelivery"><code>sendmail-mbfl-delivery</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-send">sendmail script emacs send</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002denvelope_002dfrom"><code>sendmail-mbfl-envelope-from</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-insp">sendmail script emacs insp</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002denvelope_002dfrom_002fmessage"><code>sendmail-mbfl-envelope-from/message</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-insp">sendmail script emacs insp</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002denvelope_002dto"><code>sendmail-mbfl-envelope-to</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-insp">sendmail script emacs insp</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002denvelope_002dto_002fmessage"><code>sendmail-mbfl-envelope-to/message</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-insp">sendmail script emacs insp</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dextract_002daddresses"><code>sendmail-mbfl-extract-addresses</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-insp">sendmail script emacs insp</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dhostname"><code>sendmail-mbfl-hostname</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-insp">sendmail script emacs insp</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dhostname_002fmessage"><code>sendmail-mbfl-hostname/message</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-insp">sendmail script emacs insp</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dnormalise_002dmessage"><code>sendmail-mbfl-normalise-message</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-misc">sendmail script emacs misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dpost"><code>sendmail-mbfl-post</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-send">sendmail script emacs send</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dprepare_002dmessage_002dfor_002dmta"><code>sendmail-mbfl-prepare-message-for-mta</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-misc">sendmail script emacs misc</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dusername"><code>sendmail-mbfl-username</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-insp">sendmail script emacs insp</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dusername_002fmessage"><code>sendmail-mbfl-username/message</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-insp">sendmail script emacs insp</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#function-index_fn_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#function-index_fn_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#function-index_fn_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#function-index_fn_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#function-index_fn_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#function-index_fn_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#function-index_fn_letter-S"><b>S</b></a>
 &nbsp; 
</td></tr></table>

<hr>
<a name="variable-index"></a>
<div class="header">
<p>
Previous: <a href="#function-index" accesskey="p" rel="prev">function index</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="An-entry-for-each-variable_002e"></a>
<h2 class="appendix">Appendix G An entry for each variable.</h2>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#variable-index_vr_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#variable-index_vr_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#variable-index_vr_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#variable-index_vr_letter-T"><b>T</b></a>
 &nbsp; 
</td></tr></table>
<table class="index-vr" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="variable-index_vr_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-ARG1ST"><code>ARG1ST</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-variables">main variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ARGC"><code>ARGC</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-variables">main variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ARGC1"><code>ARGC1</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-variables">main variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ARGV"><code>ARGV</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-variables">main variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ARGV1"><code>ARGV1</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-variables">main variables</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="variable-index_vr_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fmain_005fSCRIPT_005fFUNCTION"><code>mbfl_main_SCRIPT_FUNCTION</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#main-function">main function</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mbfl_005fprogram_005fBGPID"><code>mbfl_program_BGPID</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#program-executing">program executing</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="variable-index_vr_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-script_005fAUTHOR"><code>script_AUTHOR</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#service-variables">service variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-script_005fCOPYRIGHT_005fYEARS"><code>script_COPYRIGHT_YEARS</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#service-variables">service variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-script_005fDESCRIPTION"><code>script_DESCRIPTION</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#service-variables">service variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-script_005fEXAMPLES"><code>script_EXAMPLES</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#service-variables">service variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-script_005fLICENSE"><code>script_LICENSE</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#service-variables">service variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-script_005fPROGNAME"><code>script_PROGNAME</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#service-variables">service variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-script_005fUSAGE"><code>script_USAGE</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#service-variables">service variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-script_005fVERSION"><code>script_VERSION</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#service-variables">service variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dauth_002dinfo"><code>sendmail-mbfl-auth-info</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-vars">sendmail script emacs vars</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dconnector"><code>sendmail-mbfl-connector</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-vars">sendmail script emacs vars</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002denvelope_002dfrom_002dfunction"><code>sendmail-mbfl-envelope-from-function</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-vars">sendmail script emacs vars</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002denvelope_002dto_002dfunction"><code>sendmail-mbfl-envelope-to-function</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-vars">sendmail script emacs vars</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dextra_002dargs"><code>sendmail-mbfl-extra-args</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-vars">sendmail script emacs vars</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dextract_002daddresses_002dfunction"><code>sendmail-mbfl-extract-addresses-function</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-vars">sendmail script emacs vars</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dhost_002dinfo"><code>sendmail-mbfl-host-info</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-vars">sendmail script emacs vars</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dhostname_002dfunction"><code>sendmail-mbfl-hostname-function</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-vars">sendmail script emacs vars</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dprogram"><code>sendmail-mbfl-program</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-vars">sendmail script emacs vars</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dtimeout"><code>sendmail-mbfl-timeout</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-vars">sendmail script emacs vars</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sendmail_002dmbfl_002dusername_002dfunction"><code>sendmail-mbfl-username-function</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#sendmail-script-emacs-vars">sendmail script emacs vars</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="variable-index_vr_letter-T">T</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-TESTMATCH"><code>TESTMATCH</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-running">testing running</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TESTSTART"><code>TESTSTART</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-running">testing running</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TESTSUCCESS"><code>TESTSUCCESS</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#testing-running">testing running</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#variable-index_vr_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#variable-index_vr_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#variable-index_vr_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#variable-index_vr_letter-T"><b>T</b></a>
 &nbsp; 
</td></tr></table>



<a name="SEC_Contents"></a>
<h2 class="contents-heading">Table of Contents</h2>

<div class="contents">

<ul class="no-bullet">
  <li><a name="toc-Overview-of-the-package" href="#overview">1 Overview of the package</a>
  <ul class="no-bullet">
    <li><a name="toc-Quick-run_002d_002dtime-loading" href="#overview-quick">1.1 Quick run&ndash;time loading</a></li>
    <li><a name="toc-Reliable-run_002d_002dtime-loading" href="#overview-reliable">1.2 Reliable run&ndash;time loading</a></li>
    <li><a name="toc-Direct-inclusion" href="#overview-direct">1.3 Direct inclusion</a></li>
    <li><a name="toc-Notes" href="#overview-notes">1.4 Notes</a></li>
  </ul></li>
  <li><a name="toc-Using-the-script-preprocessor" href="#preprocessor">2 Using the script preprocessor</a>
  <ul class="no-bullet">
    <li><a name="toc-Invoking-the-preprocessor" href="#preprocessor-invoking">2.1 Invoking the preprocessor</a></li>
    <li><a name="toc-Macros-library" href="#preprocessor-macros">2.2 Macros library</a></li>
  </ul></li>
  <li><a name="toc-Required-user-defined-variables" href="#service-variables">3 Required user defined variables</a></li>
  <li><a name="toc-Some-base-functions" href="#base">4 Some base functions</a></li>
  <li><a name="toc-Encoding-and-decoding-strings" href="#encoding">5 Encoding and decoding strings</a></li>
  <li><a name="toc-Manipulating-files-and-pathnames" href="#file">6 Manipulating files and pathnames</a>
  <ul class="no-bullet">
    <li><a name="toc-File-names" href="#file-names">6.1 File names</a>
    <ul class="no-bullet">
      <li><a name="toc-Splitting-a-file-name-into-its-components" href="#file-name-parts">6.1.1 Splitting a file name into its components</a></li>
      <li><a name="toc-Handling-relative-pathnames" href="#file-name-path">6.1.2 Handling relative pathnames</a></li>
      <li><a name="toc-Finding-pathnames-on-the-system" href="#file-name-system">6.1.3 Finding pathnames on the system</a></li>
    </ul></li>
    <li><a name="toc-File-Commands" href="#file-commands">6.2 File Commands</a>
    <ul class="no-bullet">
      <li><a name="toc-Retrieving-informations" href="#file-commands-listing">6.2.1 Retrieving informations</a></li>
      <li><a name="toc-Creating-directories" href="#file-commands-mkdir">6.2.2 Creating directories</a></li>
      <li><a name="toc-Copying-files" href="#file-commands-copy">6.2.3 Copying files</a></li>
      <li><a name="toc-Moving-files" href="#file-commands-move">6.2.4 Moving files</a></li>
      <li><a name="toc-Removing-files-and-directories" href="#file-commands-removing">6.2.5 Removing files and directories</a></li>
      <li><a name="toc-Creating-symbolic-links" href="#file-commands-symlink">6.2.6 Creating symbolic links</a></li>
      <li><a name="toc-Manipulating-tar-archives" href="#file-commands-tar">6.2.7 Manipulating tar archives</a></li>
      <li><a name="toc-Set_002fget-file-permissions" href="#file-commands-perms">6.2.8 Set/get file permissions</a></li>
      <li><a name="toc-Setting-file-owner-and-group" href="#file-commands-owner">6.2.9 Setting file owner and group</a></li>
      <li><a name="toc-Compressing-files" href="#file-commands-compress">6.2.10 Compressing files</a></li>
      <li><a name="toc-Inspecting-files-and-directories" href="#file-commands-stat">6.2.11 Inspecting files and directories</a></li>
    </ul></li>
    <li><a name="toc-Testing-file-existence-and-the-like" href="#file-testing">6.3 Testing file existence and the like</a></li>
    <li><a name="toc-Reading-and-writing-files-with-privileges" href="#file-read-and-write">6.4 Reading and writing files with privileges</a></li>
    <li><a name="toc-Miscellaneous-commands" href="#file-misc">6.5 Miscellaneous commands</a></li>
  </ul></li>
  <li><a name="toc-Selecting-actions-to-perform" href="#actions">7 Selecting actions to perform</a>
  <ul class="no-bullet">
    <li><a name="toc-Introduction-to-action-trees" href="#actions-intro">7.1 Introduction to action trees</a></li>
    <li><a name="toc-Declaring-actions-and-action-sets" href="#actions-declare">7.2 Declaring actions and action sets</a></li>
    <li><a name="toc-Dispatching-action-arguments" href="#actions-dispatch">7.3 Dispatching action arguments</a></li>
    <li><a name="toc-Inspecting-action-trees" href="#actions-inspect">7.4 Inspecting action trees</a></li>
    <li><a name="toc-Other-functions" href="#actions-misc">7.5 Other functions</a></li>
  </ul></li>
  <li><a name="toc-Parsing-command-line-options" href="#getopts">8 Parsing command line options</a>
  <ul class="no-bullet">
    <li><a name="toc-Arguments" href="#getopts-arguments">8.1 Arguments</a></li>
    <li><a name="toc-Using-the-module" href="#getopts-usage">8.2 Using the module</a></li>
    <li><a name="toc-Predefined-options" href="#getopts-options">8.3 Predefined options</a></li>
    <li><a name="toc-Interface-functions" href="#getopts-interface">8.4 Interface functions</a></li>
  </ul></li>
  <li><a name="toc-Printing-messages-to-the-console" href="#message">9 Printing messages to the console</a></li>
  <li><a name="toc-Using-external-programs" href="#program">10 Using external programs</a>
  <ul class="no-bullet">
    <li><a name="toc-Testing-a-script-and-running-programs" href="#program-testing">10.1 Testing a script and running programs</a></li>
    <li><a name="toc-Checking-programs-existence" href="#program-checking">10.2 Checking programs existence</a></li>
    <li><a name="toc-Executing-a-program" href="#program-executing">10.3 Executing a program</a></li>
    <li><a name="toc-Declaring-the-intention-to-use-a-program" href="#program-declaring">10.4 Declaring the intention to use a program</a></li>
  </ul></li>
  <li><a name="toc-Interfaces-to-external-programs" href="#interfaces">11 Interfaces to external programs</a>
  <ul class="no-bullet">
    <li><a name="toc-Scheduling-jobs-for-later-execution" href="#interfaces-at">11.1 Scheduling jobs for later execution</a></li>
  </ul></li>
  <li><a name="toc-Catching-signals" href="#signal">12 Catching signals</a></li>
  <li><a name="toc-Manipulating-strings" href="#string">13 Manipulating strings</a>
  <ul class="no-bullet">
    <li><a name="toc-Quoted-characters" href="#string-quote">13.1 Quoted characters</a></li>
    <li><a name="toc-Inspecting-a-string" href="#string-inspection">13.2 Inspecting a string</a></li>
    <li><a name="toc-Splitting-a-string" href="#string-splitting">13.3 Splitting a string</a></li>
    <li><a name="toc-Converting-between-upper-and-lower-case" href="#string-case">13.4 Converting between upper and lower case</a></li>
    <li><a name="toc-Matching-a-string-with-a-class" href="#string-class">13.5 Matching a string with a class</a></li>
    <li><a name="toc-Miscellaneous-functions" href="#string-misc">13.6 Miscellaneous functions</a></li>
  </ul></li>
  <li><a name="toc-Interacting-with-the-user" href="#dialog">14 Interacting with the user</a></li>
  <li><a name="toc-Manipulating-variables" href="#variables">15 Manipulating variables</a>
  <ul class="no-bullet">
    <li><a name="toc-Manipulating-arrays" href="#variables-arrays">15.1 Manipulating arrays</a></li>
    <li><a name="toc-Manipulating-colon-variables" href="#variables-colon">15.2 Manipulating colon variables</a></li>
  </ul></li>
  <li><a name="toc-Interfacing-with-the-system" href="#system">16 Interfacing with the system</a>
  <ul class="no-bullet">
    <li><a name="toc-Converting-user-identifiers" href="#system-user-id">16.1 Converting user identifiers</a></li>
    <li><a name="toc-Converting-file-permissions" href="#system-file-perms">16.2 Converting file permissions</a></li>
  </ul></li>
  <li><a name="toc-Main-function" href="#main">17 Main function</a>
  <ul class="no-bullet">
    <li><a name="toc-Command-line-arguments-variables" href="#main-variables">17.1 Command line arguments variables</a></li>
    <li><a name="toc-Driving-script-execution" href="#main-function">17.2 Driving script execution</a></li>
    <li><a name="toc-Declaring-exit-codes" href="#main-exit">17.3 Declaring exit codes</a></li>
    <li><a name="toc-Other-functions-1" href="#main-misc">17.4 Other functions</a></li>
  </ul></li>
  <li><a name="toc-Building-test-suites" href="#testing">18 Building test suites</a>
  <ul class="no-bullet">
    <li><a name="toc-A-way-to-organise-a-test-suite" href="#testing-intro">18.1 A way to organise a test suite</a></li>
    <li><a name="toc-A-script-to-run-tests" href="#testing-shell">18.2 A script to run tests</a></li>
    <li><a name="toc-Configuring-the-package" href="#testing-config">18.3 Configuring the package</a></li>
    <li><a name="toc-Running-test-functions" href="#testing-running">18.4 Running test functions</a></li>
    <li><a name="toc-Validating-results-by-comparing" href="#testing-compare">18.5 Validating results by comparing</a></li>
    <li><a name="toc-Validating-results-by-output" href="#testing-output">18.6 Validating results by output</a></li>
    <li><a name="toc-Printing-messages-from-test-functions" href="#testing-messages">18.7 Printing messages from test functions</a></li>
    <li><a name="toc-Handling-files-in-tests" href="#testing-files">18.8 Handling files in tests</a>
    <ul class="no-bullet">
      <li><a name="toc-Directories" href="#testing-files-directories">18.8.1 Directories</a></li>
      <li><a name="toc-Files" href="#testing-files-files">18.8.2 Files</a></li>
      <li><a name="toc-Examples" href="#testing-files-examples">18.8.3 Examples</a></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Examples-for-sending-email" href="#sendmail">Appendix A Examples for sending email</a>
  <ul class="no-bullet">
    <li><a name="toc-How-to-compose-a-test-email-message" href="#sendmail-message">A.1 How to compose a test email message</a></li>
    <li><a name="toc-Just-send-an-email-message" href="#sendmail-plain">A.2 Just send an email message</a></li>
    <li><a name="toc-Send-email-through-a-process-in-background" href="#sendmail-connector">A.3 Send email through a process in background</a></li>
    <li><a name="toc-Using-gnutls_002dcli-as-connector" href="#sendmail-gnutls">A.4 Using <code>gnutls-cli</code> as connector</a>
    <ul class="no-bullet">
      <li><a name="toc-Immediate-encrypted-bridge" href="#sendmail-gnutls-now">A.4.1 Immediate encrypted bridge</a></li>
      <li><a name="toc-Delayed-encrypted-bridge" href="#sendmail-gnutls-delay">A.4.2 Delayed encrypted bridge</a></li>
    </ul></li>
    <li><a name="toc-Using-openssl-as-connector" href="#sendmail-openssl">A.5 Using <code>openssl</code> as connector</a>
    <ul class="no-bullet">
      <li><a name="toc-Immediate-encrypted-bridge-1" href="#sendmail-openssl-now">A.5.1 Immediate encrypted bridge</a></li>
      <li><a name="toc-Delayed-encrypted-bridge-1" href="#sendmail-openssl-delay">A.5.2 Delayed encrypted bridge</a></li>
    </ul></li>
    <li><a name="toc-Sending-email" href="#sendmail-script">A.6 Sending email</a>
    <ul class="no-bullet">
      <li><a name="toc-Usage-examples" href="#sendmail-script-examples">A.6.1 Usage examples</a></li>
      <li><a name="toc-Command-line-options" href="#sendmail-script-invoking">A.6.2 Command line options</a></li>
      <li><a name="toc-Reading-host-informations-from-file" href="#sendmail-script-hostinfo">A.6.3 Reading host informations from file</a></li>
      <li><a name="toc-Reading-authentication-credentials-from-file" href="#sendmail-script-authinfo">A.6.4 Reading authentication credentials from file</a></li>
      <li><a name="toc-Interfacing-with-GNU-Emacs" href="#sendmail-script-emacs">A.6.5 Interfacing with <acronym>GNU</acronym> Emacs</a>
      <ul class="no-bullet">
        <li><a name="toc-Customisable-variables" href="#sendmail-script-emacs-vars">A.6.5.1 Customisable variables</a></li>
        <li><a name="toc-Sending-and-delivering-functions" href="#sendmail-script-emacs-send">A.6.5.2 Sending and delivering functions</a></li>
        <li><a name="toc-Message-inspection-functions" href="#sendmail-script-emacs-insp">A.6.5.3 Message inspection functions</a></li>
        <li><a name="toc-Miscellaneous-functions-1" href="#sendmail-script-emacs-misc">A.6.5.4 Miscellaneous functions</a></li>
      </ul></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-GNU-LESSER-GENERAL-PUBLIC-LICENSE" href="#Package-License">Appendix B GNU LESSER GENERAL PUBLIC LICENSE</a></li>
  <li><a name="toc-GNU-Free-Documentation-License" href="#Documentation-License">Appendix C GNU Free Documentation License</a></li>
  <li><a name="toc-Bibliography-and-references" href="#references">Appendix D Bibliography and references</a></li>
  <li><a name="toc-An-entry-for-each-concept" href="#concept-index">Appendix E An entry for each concept</a></li>
  <li><a name="toc-An-entry-for-each-function_002e" href="#function-index">Appendix F An entry for each function.</a></li>
  <li><a name="toc-An-entry-for-each-variable_002e" href="#variable-index">Appendix G An entry for each variable.</a></li>
</ul>
</div>

<div class="footnote">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h3><a name="FOOT1" href="#DOCF1">(1)</a></h3>
<p><acronym>TCL</acronym>
stands for <em>Tool Command Language</em> and it is a scripting language
originally written by John Ousterhout, see: <a href="http://www.tcl.tk/">http://www.tcl.tk/</a>.</p>
</div>
<hr>



</body>
</html>
