<html lang="en">
<head>
<title>ssax sxml high - Nausicaa for Scheme</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Nausicaa for Scheme">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="ssax-sxml.html#ssax-sxml" title="ssax sxml">
<link rel="prev" href="ssax-sxml-mid.html#ssax-sxml-mid" title="ssax sxml mid">
<link rel="next" href="ssax-sxml-sxml.html#ssax-sxml-sxml" title="ssax sxml sxml">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This document describes version 0.2d8 of Nausicaa/Scheme, a set of
Scheme libraries defining a slightly modified R6RS Scheme language
and augmenting the features of the base and standard R6RS libraries.

The project home page of Nausicaa is at:

             `http://marcomaggi.github.com/nausicaa.html'


development of Nausicaa takes place at:

               `http://github.com/marcomaggi/nausicaa/'


Copyright (C) 2008-2011 by Marco Maggi.

Copyright (C) 1996, 1997, 2000, 2001, 2002, 2003, 2004, 2005
Free Software Foundation.

Copyright (C) 1996, 1999-2005 Dorai Sitaram.

Copyright (C) 1998 Oleg Kiselyov.

Copyright (C) 1998, 1999, 2000 Olin Shivers.

Copyright (C) 1999 John David Stone.

Copyright (C) 1999, 2002 Marc Feeley.

Copyright (C) 2001, 2009 Danny Dube'

Copyright (C) 2002 Dr. Mirko Luedde.

Copyright (C) 2002, 2003, 2005, 2006 Sebastian Egner.

Copyright (C) 2003 Ray Dillinger.

Copyright (C) 2003 Taylor Campbell.

Copyright (C) 2005 Jens Axel Soegaard.

Copyright (C) 2005-2009 Alex Shinn.

Copyright (C) 2008 Taro Minowa (Higepon).

Copyright (C) 2005-2008 Dominique Boucher.

Copyright (C) 2004, 2005 Tony Garnock-Jones

Copyright (C) 2005 LShift Ltd.

Copyright (C) 2007, 2008 Philip L. Bewig.

Copyright (C) 2000 Will Fitzgerald.

Copyright (C) 2000 Neodesic Corporation.

Copyright (C) 2000-2006 Joachim Henke.

Copyright (C) 2004-2009 Neil Van Dyke.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections being ``GNU Free
     Documentation License'' and ``GNU General Public License'', no
     Front--Cover Texts, and no Back--Cover Texts.  A copy of the
     license is included in the section entitled ``GNU Free
     Documentation License''.

This document embeds an unofficial assemblage of several documents
reformatted in Texinfo; the reformatting author and maintainer is
Marco Maggi <marco.maggi-ipsu@poste.it>.  See the appendix ``Credits'' for
the list of original documents and their authors.  See also the
`README' and `CREDITS' files for additional attributions.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="ssax-sxml-high"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="ssax-sxml-sxml.html#ssax-sxml-sxml">ssax sxml sxml</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="ssax-sxml-mid.html#ssax-sxml-mid">ssax sxml mid</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="ssax-sxml.html#ssax-sxml">ssax sxml</a>
<hr>
</div>

<h4 class="subsection">79.1.6 High&ndash;level parsers</h4>

<p>These procedures are to instantiate a <acronym>SSAX</acronym> parser.  A user can
instantiate the parser to do the full validation or no validation or any
particular validation.  The user specifies which <code>PI</code> he wants to
be notified about.  The user tells what to do with the parsed character
and element data.  The latter handlers determine if the parsing follows
a <acronym>SAX</acronym> or a <acronym>DOM</acronym> model.

<div class="defun">
&mdash; Function: <b>ssax.make-pi-parser</b><var> my-pi-handlers<a name="index-ssax_002emake_002dpi_002dparser-5832"></a></var><br>
<blockquote><p>Create a parser to parse and process one Processing Element (<code>PI</code>).

        <p><var>my-pi-handlers</var> is an association list of pairs:

     <pre class="example">          (<var>pi-tag</var> . <var>pi-handler</var>)
</pre>
        <p class="noindent">where <var>pi-tag</var> is a <code>NCName</code> symbol, the <code>PI</code> target; and
<var>pi-handler</var> is a procedure taking arguments <var>port</var>,
<var>pi-tag</var> and <var>seed</var>.

        <p><var>pi-handler</var> should read the rest of the <code>PI</code> up to and
including the combination &lsquo;<samp><span class="samp">?&gt;</span></samp>&rsquo; that terminates the <code>PI</code>.  The
handler should return a new seed.  One of the <var>pi-tag</var>s may be the
symbol <code>*DEFAULT*</code>.  The corresponding handler will handle
<code>PI</code>s that no other handler will.  If the <code>*DEFAULT*</code>
<var>pi-tag</var> is not specified, this function assumes the default handler
that skips the body of the <code>PI</code>.

        <p>Return a procedure of arguments <var>port</var>, <var>pi-tag</var> and <var>seed</var>;
that will parse the current <code>PI</code> according to <var>my-pi-handlers</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax.make-elem-parser</b><var> my-new-level-seed my-finish-element my-char-data-handler my-pi-handlers<a name="index-ssax_002emake_002delem_002dparser-5833"></a></var><br>
<blockquote><p>Create a parser to parse and process one element, including its
character content or children elements.  The parser is typically applied
to the root element of a document.

          <dl>
<dt><var>my-new-level-seed</var><dd>Is a procedure taking arguments: <var>elem-gi</var> <var>attributes</var>
<var>namespaces</var> <var>expected-content</var> <var>seed</var>, where <var>elem-gi</var>
is a <code>RES-NAME</code> of the element about to be processed.

          <p><var>my-new-level-seed</var> is to generate the seed to be passed to handlers
that process the content of the element.

          <br><dt><var>my-finish-element</var><dd>Is a procedure taking arguments: <var>elem-gi</var> <var>attributes</var>
<var>namespaces</var> <var>parent-seed</var> <var>seed</var>.

          <p><var>my-finish-element</var> is called when parsing of <var>elem-gi</var> is
finished.  The <var>seed</var> is the result from the last content parser (or
from <var>my-new-level-seed</var> if the element has the empty content). 
<var>parent-seed</var> is the same seed as was passed to
<var>my-new-level-seed</var>.  <var>my-finish-element</var> is to generate a seed
that will be the result of the element parser.

          <br><dt><var>my-char-data-handler</var><dd>Is a <code>STR-HANDLER</code> as described in <a href="ssax-sxml-typedefs.html#ssax-sxml-typedefs">ssax sxml typedefs</a>.

          <br><dt><var>my-pi-handlers</var><dd>Is as described for <code>ssax.make-pi-handler</code>. 
</dl>

        <p>The generated parser is a procedure taking arguments:
<var>start-tag-head</var> <var>port</var> <var>elems</var> <var>entities</var>
<var>namespaces</var> <var>preserve-ws?</var> <var>seed</var>.

        <p>The procedure must be called after the start tag token has been read. 
<var>start-tag-head</var> is an <code>UNRES-NAME</code> from the start-element tag. 
<var>ELEMS</var> is an instance of <code>ELEMS</code> slot of <code>XML-DECL</code>.

        <p>Faults detected:<br>
VC: XML-Spec.html#elementvalid<br>
WFC: XML-Spec.html#GIMatch
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ssax.make-parser</b><var> user-handler-tag user-handler <small class="dots">...</small><a name="index-ssax_002emake_002dparser-5834"></a></var><br>
<blockquote><p>Create an <acronym>XML</acronym> parser, an instance of the <acronym>XML</acronym> parsing framework. 
This will be a <acronym>SAX</acronym>, a <acronym>DOM</acronym> or a specialized parser depending on the
supplied user-handlers.

        <p>This function takes an even number of arguments; <var>user-handler-tag</var>
is a symbol that identifies a procedure (or association list for
<code>PROCESSING-INSTRUCTIONS</code>) <var>user-handler</var> that follows the tag. 
Given below are tags and signatures of the corresponding procedures. 
Not all tags have to be specified.  If some are omitted, reasonable
defaults will apply.

          <dl>
<dt>&lsquo;<samp><span class="samp">DOCTYPE</span></samp>&rsquo;<dd>The handler must accept the following arguments: <var>port</var>
<var>docname</var> <var>systemid</var> <var>internal-subset?</var> <var>seed</var>.

          <p>If <var>internal-subset?</var> is <code>#f</code>, the current position in the port
is right after we have read &lsquo;<samp><span class="samp">[</span></samp>&rsquo; that begins the internal <acronym>DTD</acronym>
subset.  We must finish reading of this subset before we return (or must
call <code>skip-internal-dtd</code> if we aren't interested in reading it). 
<var>port</var> at exit must be at the first symbol after the whole
<code>DOCTYPE</code> declaration.

          <p>The handler must generate four values:

          <pre class="example">               <var>elems</var> <var>entities</var> <var>namespaces</var> <var>seed</var>
</pre>
          <p class="noindent"><var>elems</var> is as defined for the <code>ELEMS</code> slot of <code>XML-DECL</code>. 
It may be <code>#f</code> to switch off validation.  <var>namespaces</var> will
typically contain <var>user-prefix</var>es for selected <var>uri-symb</var>s.  The
default handler skips the internal subset, if any, and returns
<code>(values #f '() '() seed)</code>.

          <br><dt>&lsquo;<samp><span class="samp">UNDECL-ROOT</span></samp>&rsquo;<dd>The handler must accept the following arguments: <var>elem-gi</var>
<var>seed</var>.

          <p>Where <var>elem-gi</var> is an <code>UNRES-NAME</code> of the root element.  This
procedure is called when an <acronym>XML</acronym> document under parsing contains
<strong>no</strong> <code>DOCTYPE</code> declaration.

          <p>The handler, as a <code>DOCTYPE</code> handler procedure above, must generate
four values:

          <pre class="example">               <var>elems</var> <var>entities</var> <var>namespaces</var> <var>seed</var>
</pre>
          <p>The default handler returns <code>(values #f '() '() seed)</code>.

          <br><dt>&lsquo;<samp><span class="samp">DECL-ROOT</span></samp>&rsquo;<dd>The handler must accept the following arguments: <var>elem-gi</var>
<var>seed</var>.

          <p>Where <var>elem-gi</var> is an <code>UNRES-NAME</code> of the root element.  This
procedure is called when an <acronym>XML</acronym> document under parsing does contains
the <code>DOCTYPE</code> declaration.  The handler must generate a new
<var>seed</var> (and verify that the name of the root element matches the
<code>DOCTYPE</code>, if the handler so wishes).  The default
handler is the identity function.

          <br><dt>&lsquo;<samp><span class="samp">NEW-LEVEL-SEED</span></samp>&rsquo;<dd>For the handler see <code>ssax.make-elem-parser</code>,
<var>my-new-level-seed</var>.

          <br><dt>&lsquo;<samp><span class="samp">FINISH-ELEMENT</span></samp>&rsquo;<dd>For the handler see <code>ssax.make-elem-parser</code>,
<var>my-finish-element</var>.

          <br><dt>&lsquo;<samp><span class="samp">CHAR-DATA-HANDLER</span></samp>&rsquo;<dd>For the handler see <code>ssax.make-elem-parser</code>,
<var>my-char-data-handler</var>.

          <br><dt>&lsquo;<samp><span class="samp">PROCESSING-INSTRUCTIONS</span></samp>&rsquo;<dd>Association list as is passed to <code>ssax.make-pi-parser</code>; the default
value is null. 
</dl>

        <p>The generated parser is a procedure of arguments <var>port</var> and
<var>seed</var>.

        <p>This procedure parses the document prolog and then exits to an element
parser (created by <code>ssax.make-elem-parser</code>) to handle the rest.

     <pre class="example">          [1]  document ::=  prolog element Misc*
          [22] prolog ::= XMLDecl? Misc* (doctypedec | Misc*)?
          [27] Misc ::= Comment | PI |  S
          [28] doctypedecl ::=  '&lt;!DOCTYPE' S Name (S ExternalID)? S?
                        ('[' (markupdecl | PEReference | S)* ']' S?)? '&gt;'
          [29] markupdecl ::= elementdecl | AttlistDecl
                               | EntityDecl
                               | NotationDecl | PI
                               | Comment
</pre>
        </blockquote></div>

<!-- page -->
   </body></html>

