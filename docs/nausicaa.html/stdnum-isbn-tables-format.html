<html lang="en">
<head>
<title>stdnum isbn tables format - Nausicaa for Scheme</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Nausicaa for Scheme">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="stdnum-isbn-tables.html#stdnum-isbn-tables" title="stdnum isbn tables">
<link rel="next" href="stdnum-isbn-tables-parm.html#stdnum-isbn-tables-parm" title="stdnum isbn tables parm">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This document describes version 0.2d7 of Nausicaa/Scheme, a set of
Scheme libraries defining a slightly modified R6RS Scheme language
and augmenting the features of the base and standard R6RS libraries.

The project home page of Nausicaa is at:

             `http://marcomaggi.github.com/nausicaa.html'


development of Nausicaa takes place at:

               `http://github.com/marcomaggi/nausicaa/'


Copyright (C) 2008, 2009, 2010 by Marco Maggi.

Copyright (C) 1996, 1997, 2000, 2001, 2002, 2003, 2004, 2005
Free Software Foundation.

Copyright (C) 1996, 1999-2005 Dorai Sitaram.

Copyright (C) 1998 Oleg Kiselyov.

Copyright (C) 1998, 1999, 2000 Olin Shivers.

Copyright (C) 1999 John David Stone.

Copyright (C) 1999, 2002 Marc Feeley.

Copyright (C) 2001, 2009 Danny Dube'

Copyright (C) 2002 Dr. Mirko Luedde.

Copyright (C) 2002, 2003, 2005, 2006 Sebastian Egner.

Copyright (C) 2003 Ray Dillinger.

Copyright (C) 2003 Taylor Campbell.

Copyright (C) 2005 Jens Axel Soegaard.

Copyright (C) 2005-2009 Alex Shinn.

Copyright (C) 2008 Taro Minowa (Higepon).

Copyright (C) 2005-2008 Dominique Boucher.

Copyright (C) 2004, 2005 Tony Garnock-Jones

Copyright (C) 2005 LShift Ltd.

Copyright (C) 2007, 2008 Philip L. Bewig.

Copyright (C) 2000 Will Fitzgerald.

Copyright (C) 2000 Neodesic Corporation.

Copyright (C) 2000-2006 Joachim Henke.

Copyright (C) 2004-2009 Neil Van Dyke.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections being ``GNU Free
     Documentation License'' and ``GNU General Public License'', no
     Front--Cover Texts, and no Back--Cover Texts.  A copy of the
     license is included in the section entitled ``GNU Free
     Documentation License''.

This document embeds an unofficial assemblage of several documents
reformatted in Texinfo; the reformatting author and maintainer is
Marco Maggi <marco.maggi-ipsu@poste.it>.  See the appendix ``Credits'' for
the list of original documents and their authors.  See also the
`README' and `CREDITS' files for additional attributions.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="stdnum-isbn-tables-format"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="stdnum-isbn-tables-parm.html#stdnum-isbn-tables-parm">stdnum isbn tables parm</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="stdnum-isbn-tables.html#stdnum-isbn-tables">stdnum isbn tables</a>
<hr>
</div>

<h5 class="subsubsection">76.4.4.1 Format of original <acronym>ISBN</acronym> tables</h5>

<blockquote>
<strong>This section was last updated on May 21, 2011; it describes the
<acronym>ISBN</acronym> tables document with serial number
&lsquo;</strong><samp><span class="samp">4419e9b8-f8b5-428b-9893-76580d5f2901</span></samp><strong>&rsquo; and date &lsquo;</strong><samp><span class="samp">Wed, 20 Apr
2011 16:54:22 GMT</span></samp><strong>&rsquo;.</strong>
</blockquote>

<p class="noindent">In this section we discuss the format of the file
<samp><span class="file">RangeMessage.xml</span></samp> which is available at:

<div align="center"><a href="http://www.isbn-international.org/page/ranges">http://www.isbn-international.org/page/ranges</a></div>

<p class="noindent">and holds the tables of registered languages and publishers.  The tables
describe 13 digits <acronym>ISBN</acronym>s.  The document has an internal
<acronym>DTD</acronym>.

   <p>When parsing the document to acquire informations on languages and
publishers we can safely ignore the elements:

<pre class="example">     &lt;MessageSource&gt;
     &lt;MessageSerialNumber&gt;
     &lt;MessageDate&gt;
</pre>
   <p class="noindent">which are important only to recognise up to date or stale documents.

<!--  -->
<h5 class="subsubheading">Language groups</h5>

<p>The element &lsquo;<samp><span class="samp">&lt;EAN.UCCPrefixes&gt;</span></samp>&rsquo; is a table listing the prefixes,
currently &lsquo;<samp><span class="samp">978</span></samp>&rsquo; and &lsquo;<samp><span class="samp">979</span></samp>&rsquo;, and the language groups.  Each
prefix is described by an element like:

<pre class="example">     &lt;EAN.UCC&gt;
       &lt;Prefix&gt;978&lt;/Prefix&gt;
       &lt;Agency&gt;International ISBN Agency&lt;/Agency&gt;
       &lt;Rules&gt; ... &lt;/Rules&gt;
     &lt;/EAN.UCC&gt;
</pre>
   <p class="noindent">we must extract the string &lsquo;<samp><span class="samp">978</span></samp>&rsquo; from the &lsquo;<samp><span class="samp">&lt;Prefix&gt;</span></samp>&rsquo; element
and we can ignore the &lsquo;<samp><span class="samp">&lt;Agency&gt;</span></samp>&rsquo; element.

   <p>The &lsquo;<samp><span class="samp">&lt;Rules&gt;</span></samp>&rsquo; element has a body composed of a list of
&lsquo;<samp><span class="samp">&lt;Rule&gt;</span></samp>&rsquo; elements like the following:

<pre class="example">     &lt;Rule&gt;
       &lt;Range&gt;0000000-5999999&lt;/Range&gt;
       &lt;Length&gt;1&lt;/Length&gt;
     &lt;/Rule&gt;
</pre>
   <p class="noindent">where the string &lsquo;<samp><span class="samp">0000000</span></samp>&rsquo; represents the left&ndash;inclusive limit and
the string &lsquo;<samp><span class="samp">5999999</span></samp>&rsquo; represents the right&ndash;inclusive limit; notice
that:

     <ul>
<li>Left limits are padded <strong>on the right</strong> with digits &lsquo;<samp><span class="samp">0</span></samp>&rsquo; so
that the string's length is 7.

     <li>Right limits are padded <strong>on the right</strong> with digits &lsquo;<samp><span class="samp">9</span></samp>&rsquo; so
that the string's length is 7. 
</ul>

<p class="noindent">the &lsquo;<samp><span class="samp">&lt;Length&gt;</span></samp>&rsquo; element tells us how many leftmost characters to
extract from the limits to acquire the actual numbers: in this case it
is &lsquo;<samp><span class="samp">1</span></samp>&rsquo;, so the left&ndash;inclusive limit is 0 and the
right&ndash;inclusive limit is 5.

   <p>Let's interpret another &lsquo;<samp><span class="samp">&lt;Rule&gt;</span></samp>&rsquo;:

<pre class="example">     &lt;Rule&gt;
       &lt;Range&gt;6000000-6499999&lt;/Range&gt;
       &lt;Length&gt;3&lt;/Length&gt;
     &lt;/Rule&gt;
</pre>
   <p class="noindent">extracting the 3 leftmost characters yields a left&ndash;inclusive
limit of 600 and a right&ndash;inclusive limit of 649.

   <p>Notice that a &lsquo;<samp><span class="samp">&lt;Rule&gt;</span></samp>&rsquo; like:

<pre class="example">     &lt;Rule&gt;
       &lt;Range&gt;6500000-6999999&lt;/Range&gt;
       &lt;Length&gt;0&lt;/Length&gt;
     &lt;/Rule&gt;
</pre>
   <p class="noindent">with length &lsquo;<samp><span class="samp">0</span></samp>&rsquo; means that this range of numbers is unused: we can
ignore it while building the tables.

   <p>At present the language group length and limits for prefix &lsquo;<samp><span class="samp">978</span></samp>&rsquo;
are:

<pre class="example">     length     left       right
     ---------------------------
       1           0           5
       3         600         649
       1           7           7
       2          80          94
       3         950         989
       4        9900        9989
       5       99900       99999
</pre>
   <p class="noindent">we use them as follows, let's say we need to split the <acronym>ISBN</acronym>
&lsquo;<samp><span class="samp">978-abcdefghil</span></samp>&rsquo;:

     <ol type=1 start=1>
<li>Extract a prefix of length &lsquo;<samp><span class="samp">1</span></samp>&rsquo;, &lsquo;<samp><span class="samp">a</span></samp>&rsquo;, and convert it to number:
if it is in the range [0, 5] then &lsquo;<samp><span class="samp">a</span></samp>&rsquo; is the language
number, else step on.

     <li>Extract a prefix of length &lsquo;<samp><span class="samp">3</span></samp>&rsquo;, &lsquo;<samp><span class="samp">abc</span></samp>&rsquo;, and convert it to
number: if it is in the range [600, 649] then &lsquo;<samp><span class="samp">abc</span></samp>&rsquo; is the
language number, else step on.

     <li>Extract a prefix of length &lsquo;<samp><span class="samp">1</span></samp>&rsquo;, &lsquo;<samp><span class="samp">a</span></samp>&rsquo;, and convert it to number:
if it is in the range [7, 7] then &lsquo;<samp><span class="samp">a</span></samp>&rsquo; is the language
number, else step on.

     <li>Extract a prefix of length &lsquo;<samp><span class="samp">2</span></samp>&rsquo;, &lsquo;<samp><span class="samp">ab</span></samp>&rsquo;, and convert it to
number: if it is in the range [80, 94] then &lsquo;<samp><span class="samp">ab</span></samp>&rsquo; is the
language number, else step on.

     <li>And so on.
        </ol>

<p class="noindent">if none of these tests succeeds  the <acronym>ISBN</acronym> is invalid because it
contains an invalid language number.

<!--  -->
<h5 class="subsubheading">Publishers</h5>

<p>The element &lsquo;<samp><span class="samp">&lt;RegistrationGroups&gt;</span></samp>&rsquo; is a table listing the allocated
ranges for publishers for each prefix and language group; its body is a
list of &lsquo;<samp><span class="samp">&lt;Group&gt;</span></samp>&rsquo; elements, each of which has the format:

<pre class="example">     &lt;Group&gt;
       &lt;Prefix&gt;978-0&lt;/Prefix&gt;
       &lt;Agency&gt;English language&lt;/Agency&gt;
       &lt;Rules&gt; ... &lt;/Rules&gt;
     &lt;/Group&gt;
</pre>
   <p class="noindent">we must extract the &lsquo;<samp><span class="samp">978-0</span></samp>&rsquo; string, representing the prefix and
language group always separated by an hyphen, and we can ignore the
&lsquo;<samp><span class="samp">&lt;Agency&gt;</span></samp>&rsquo; element.

   <p>The &lsquo;<samp><span class="samp">&lt;Rules&gt;</span></samp>&rsquo; element has a body composed of a list of
&lsquo;<samp><span class="samp">&lt;Rule&gt;</span></samp>&rsquo; elements like the following:

<pre class="example">     &lt;Rule&gt;
       &lt;Range&gt;0000000-1999999&lt;/Range&gt;
       &lt;Length&gt;2&lt;/Length&gt;
     &lt;/Rule&gt;
</pre>
   <p class="noindent">where the string &lsquo;<samp><span class="samp">0000000</span></samp>&rsquo; represents the left&ndash;inclusive limit and
the string &lsquo;<samp><span class="samp">1999999</span></samp>&rsquo; represents the right&ndash;inclusive limit; notice
that:

     <ul>
<li>Left limits are padded <strong>on the right</strong> with digits &lsquo;<samp><span class="samp">0</span></samp>&rsquo; so
that the string's length is 7.

     <li>Right limits are padded <strong>on the right</strong> with digits &lsquo;<samp><span class="samp">9</span></samp>&rsquo; so
that the string's length is 7. 
</ul>

<p class="noindent">the &lsquo;<samp><span class="samp">&lt;Length&gt;</span></samp>&rsquo; element tells us how many leftmost characters to
extract from the limits to acquire the actual numbers: in this case it
is &lsquo;<samp><span class="samp">2</span></samp>&rsquo;, so the left&ndash;inclusive limit is 0 and the
right&ndash;inclusive limit is 19.

   <p>It is the same format of the &lsquo;<samp><span class="samp">&lt;Rule&gt;</span></samp>&rsquo; element for language groups
and we use it in the same way to extract the publishers number from an
<acronym>ISBN</acronym> after having stripped the language group number.

<!--  -->
<h5 class="subsubheading">A concrete example</h5>

<p>Let's say we want to parse the <acronym>ISBN</acronym> &lsquo;<samp><span class="samp">88-86926-31-6</span></samp>&rsquo; (an italian
edition of Neal Stephenson's &ldquo;The Diamond Age&rdquo;) from its
no&ndash;separators format &lsquo;<samp><span class="samp">8886926316</span></samp>&rsquo;.

   <p>It is a 10 digits <acronym>ISBN</acronym> so we do not need to strip the
&lsquo;<samp><span class="samp">978</span></samp>&rsquo; or &lsquo;<samp><span class="samp">979</span></samp>&rsquo; prefix; we strip the check digit, which is the
last character, and we get &lsquo;<samp><span class="samp">888692631</span></samp>&rsquo;.

   <p>The first digits represent the language, but we do not now the length of
the field; by consulting the table built from the
&lsquo;<samp><span class="samp">&lt;EAN.UCCPrefixes&gt;</span></samp>&rsquo; element we see that the digits &lsquo;<samp><span class="samp">88</span></samp>&rsquo; are in
the range [80, 94], so &lsquo;<samp><span class="samp">88</span></samp>&rsquo; is the language group number.

   <p>Stripping the language number we get &lsquo;<samp><span class="samp">8692631</span></samp>&rsquo;, the first digits of
which represent the publisher's number.  We look in the table built from
the &lsquo;<samp><span class="samp">&lt;RegistrationGroups&gt;</span></samp>&rsquo; element and find the entry corresponding
to the &lsquo;<samp><span class="samp">&lt;Group&gt;</span></samp>&rsquo; element whose &lsquo;<samp><span class="samp">&lt;Prefix&gt;</span></samp>&rsquo; element is
&lsquo;<samp><span class="samp">978-88</span></samp>&rsquo;; the original element looks like this:

<pre class="example">     &lt;Group&gt;
       &lt;Prefix&gt;978-88&lt;/Prefix&gt;
       &lt;Agency&gt;Italy&lt;/Agency&gt;
       &lt;Rules&gt; ... &lt;/Rules&gt;
     &lt;/Group&gt;
</pre>
   <p class="noindent">now we search the table built from the &lsquo;<samp><span class="samp">&lt;Rules&gt;</span></samp>&rsquo; element whose
limits are:

<pre class="example">     length     left       right
     ---------------------------
        2          0          19
        3        200         599
        4       6000        8499
        5      85000       89999
        6     900000      909999
        3        910         929
        5      95000       99999
</pre>
   <p class="noindent">and find that the digits &lsquo;<samp><span class="samp">86926</span></samp>&rsquo; are in the range [85000,
89999], so &lsquo;<samp><span class="samp">86926</span></samp>&rsquo; is the publisher's number.

   <p>Stripping the publisher's number we get &lsquo;<samp><span class="samp">31</span></samp>&rsquo; which is the book
number.

<!-- page -->
   </body></html>

