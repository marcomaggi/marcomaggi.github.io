<html lang="en">
<head>
<title>silex input - Nausicaa for Scheme</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Nausicaa for Scheme">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="silex.html#silex" title="silex">
<link rel="prev" href="silex-tables.html#silex-tables" title="silex tables">
<link rel="next" href="silex-lexer.html#silex-lexer" title="silex lexer">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This document describes version 0.2d6 of Nausicaa/Scheme, a set of
Scheme libraries defining a slightly modified R6RS Scheme language
and augmenting the features of the base and standard R6RS libraries.

The project home page of Nausicaa is at:

             `http://marcomaggi.github.com/nausicaa.html'


development of Nausicaa takes place at:

               `http://github.com/marcomaggi/nausicaa/'


Copyright (C) 2008, 2009, 2010 by Marco Maggi.

Copyright (C) 1996, 1997, 2000, 2001, 2002, 2003, 2004, 2005
Free Software Foundation.

Copyright (C) 1996, 1999-2005 Dorai Sitaram.

Copyright (C) 1998 Oleg Kiselyov.

Copyright (C) 1998, 1999, 2000 Olin Shivers.

Copyright (C) 1999 John David Stone.

Copyright (C) 1999, 2002 Marc Feeley.

Copyright (C) 2001, 2009 Danny Dube'

Copyright (C) 2002 Dr. Mirko Luedde.

Copyright (C) 2002, 2003, 2005, 2006 Sebastian Egner.

Copyright (C) 2003 Ray Dillinger.

Copyright (C) 2003 Taylor Campbell.

Copyright (C) 2005 Jens Axel Soegaard.

Copyright (C) 2005-2009 Alex Shinn.

Copyright (C) 2008 Taro Minowa (Higepon).

Copyright (C) 2005-2008 Dominique Boucher.

Copyright (C) 2004, 2005 Tony Garnock-Jones

Copyright (C) 2005 LShift Ltd.

Copyright (C) 2007, 2008 Philip L. Bewig.

Copyright (C) 2000 Will Fitzgerald.

Copyright (C) 2000 Neodesic Corporation.

Copyright (C) 2000-2006 Joachim Henke.

Copyright (C) 2004-2009 Neil Van Dyke.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections being ``GNU Free
     Documentation License'' and ``GNU General Public License'', no
     Front--Cover Texts, and no Back--Cover Texts.  A copy of the
     license is included in the section entitled ``GNU Free
     Documentation License''.

This document embeds an unofficial assemblage of several documents
reformatted in Texinfo; the reformatting author and maintainer is
Marco Maggi <marco.maggi-ipsu@poste.it>.  See the appendix ``Credits'' for
the list of original documents and their authors.  See also the
`README' and `CREDITS' files for additional attributions.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="silex-input"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="silex-lexer.html#silex-lexer">silex lexer</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="silex-tables.html#silex-tables">silex tables</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="silex.html#silex">silex</a>
<hr>
</div>

<h3 class="section">59.3 Input systems</h3>

<p>An input system provides the buffering, the line counting and similar
low level services.  The following bindings are exported by the
<code>(nausicaa silex input-system)</code> library and reexported by the
<code>(nausicaa silex lexer)</code> library.

<div class="defun">
&mdash; Syntax: <b>make-IS</b><var> clauses ...<a name="index-make_002dIS-4524"></a></var><br>
<blockquote><p>Build and return a new input system.  The behaviour of this function is
configured with the given <var>clauses</var>; see below for the list of
supported options.

        <p>Input characters can come from a string, a port or the return value of a
procedure.  When an input port is used by an input system, the program
should avoid reading characters directly from the port.  This is because
the input system may have needed a look&ndash;ahead to do the analysis of the
preceding token.  The program would not find what it expects on the
port.  The input system provides safe functions to get characters from
the input. 
</p></blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>string:</b><var> string<a name="index-string_003a-4525"></a></var><br>
<blockquote><p>Instruct <code>make-IS</code> to build an input system that will take
characters from the supplied string.  When the input system is
initialized with a string, it takes a copy of it.  This way, eventual
mutations of the string do not affect the analysis.

        <p>When used together, this option supersedes &lsquo;<samp><span class="samp">port:</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">procedure:</span></samp>&rsquo;. 
</p></blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>port:</b><var> port<a name="index-port_003a-4526"></a></var><br>
<blockquote><p>Instruct <code>make-IS</code> to build an input system that will read
characters from the supplied textual input port.  The input system never
closes itself the port it has received, this task is left to the
program.

        <p>When used together, this option supersedes &lsquo;<samp><span class="samp">procedure:</span></samp>&rsquo;. 
</p></blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>procedure:</b><var> proc<a name="index-procedure_003a-4527"></a></var><br>
<blockquote><p>Instruct <code>make-IS</code> to build an input system that will read
characters invoking the supplied procedure.

        <p>The use of a function as character source allows the input system to
parse any character stream, no matter how it is obtained.  For example,
the characters may come from the decompression or decryption of a huge
file, the task being done lazily in order to save space.

        <p>The function must take no argument and return a character each time it
is called.  When the end of file (or its logical equivalent) is reached,
the function must return an object that is not a character (for example,
the symbol &lsquo;<samp><span class="samp">eof</span></samp>&rsquo;).  After the function has returned an end of file
indicator, it is not called again. 
</p></blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>counters:</b><var> which-ones<a name="index-counters_003a-4528"></a></var><br>
<blockquote><p>Instruct <code>make-IS</code> about which counters to make available to
the lexer.

        <p>Counters are managed by the input system, and can be used by the lexer. 
The following values for <var>which-ones</var> are available: &lsquo;<samp><span class="samp">all</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">line</span></samp>&rsquo;, &lsquo;<samp><span class="samp">none</span></samp>&rsquo;; &lsquo;<samp><span class="samp">all</span></samp>&rsquo; is the default.  The more counters
the input system maintains, the more it is slowed down.

        <p>Notice that the same &lsquo;<samp><span class="samp">counters:</span></samp>&rsquo; option must be given to <code>lex</code>
and to <code>make-IS</code>, a mismatch will result in undefined behaviour. 
This is because an input system is independent from a lexer table, and
it is more efficient to build tables for a specific set of counters
rather than to configure them at run time. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>lexer-get-func-line</b><var> input-system<a name="index-lexer_002dget_002dfunc_002dline-4529"></a></var><br>
<blockquote><p>Return a closure which, when invoked with no arguments, will return the
current line number in <var>input-system</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>lexer-get-func-column</b><var> input-system<a name="index-lexer_002dget_002dfunc_002dcolumn-4530"></a></var><br>
<blockquote><p>Return a closure which, when invoked with no arguments, will return the
current column number in <var>input-system</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>lexer-get-func-offset</b><var> input-system<a name="index-lexer_002dget_002dfunc_002doffset-4531"></a></var><br>
<blockquote><p>Return a closure which, when invoked with no arguments, will return the
current offset in <var>input-system</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>lexer-get-func-getc</b><var> input-system<a name="index-lexer_002dget_002dfunc_002dgetc-4532"></a></var><br>
<blockquote><p>Return a closure which, when invoked with no arguments, will return the
next character from <var>input-system</var>.  The closure allows client code
to perform a lookahead.

        <p>The returned character is not forgotten by the lexer, this function just
increments by 1 a pointer into the internal buffer.  Multiple
invocations of this function will return the sequence of characters
about to be analysed by the lexer.  When there are no more characters,
the return value is the &lsquo;<samp><span class="samp">(eof-object)</span></samp>&rsquo; value.

        <p>The returned characters are <strong>skipped</strong> by the lexer, unless we put
them back with the closure returned by <code>lexer-get-func-ungetc</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>lexer-get-func-ungetc</b><var> input-system<a name="index-lexer_002dget_002dfunc_002dungetc-4533"></a></var><br>
<blockquote><p>Return a closure which, when invoked with no arguments, will decrement a
pointer into the buffer of <var>input-system</var>.  This function puts back
a character previously read by a closure returned by
<code>lexer-get-func-getc</code>.

        <p>It is not possible to replace characters in the input system. 
</p></blockquote></div>

<!-- page -->
   </body></html>

