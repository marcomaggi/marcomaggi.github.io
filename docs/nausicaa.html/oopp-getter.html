<html lang="en">
<head>
<title>oopp getter - Nausicaa for Vicare Scheme</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Nausicaa for Vicare Scheme">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="oopp.html#oopp" title="oopp">
<link rel="prev" href="oopp-method.html#oopp-method" title="oopp method">
<link rel="next" href="oopp-setter.html#oopp-setter" title="oopp setter">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This document describes version 0.3d7 of Nausicaa, a
collection of libraries for Vicare Scheme implementing the language
`(nausicaa)' on top of `(vicare)'.

Copyright (C) 2012, 2013 by Marco Maggi <marco.maggi-ipsu@poste.it>

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with Invariant Sections being ``GNU Free Documentation
     License'' and ``GNU General Public License'', no Front--Cover
     Texts, and no Back--Cover Texts.  A copy of the license is
     included in the section entitled ``GNU Free Documentation
     License''.
-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="oopp-getter"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="oopp-setter.html#oopp-setter">oopp setter</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="oopp-method.html#oopp-method">oopp method</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="oopp.html#oopp">oopp</a>
<hr>
</div>

<h3 class="section">3.12 Getter syntaxes</h3>

<div class="defun">
&mdash; Auxiliary Syntax: <b>getter</b><var> ?transformer<a name="index-getter-46"></a></var><br>
<blockquote><p>Add a getter syntax to instances of the enclosing class, label or mixin
definition; this clause can be used only once.

        <p><var>?transformer</var> must be an expression evaluating to a syntax
transformer: a function accepting a syntax object as single argument and
returning a syntax object as single value.

        <p>There are 2 possible forms (lookout for the parentheses!):

          <ul>
<li>Whenever a tagged variable <var>?var</var> is used as follows:

          <pre class="example">               (<var>?var</var> (<var>?key0</var> ...) (<var>?key</var> ...) ...)
</pre>
          <p class="noindent">the getter transformer is applied to the syntax object:

          <pre class="example">               #'(<var>?var</var> ((<var>?key0</var> ...) (<var>?key</var> ...) ...))
</pre>
          <p class="noindent">and the return value of the transformer is the result of the expansion.

          <li>Whenever a tagged variable <var>?var</var> is used as follows:

          <pre class="example">               (<var>?var</var> (<var>?key0</var> ...) (<var>?key</var> ...) ...
                  =&gt; <var>?form0</var> <var>?form</var> ...)
</pre>
          <p class="noindent">the getter transformer is applied to the syntax object:

          <pre class="example">               #'(<var>?var</var> ((<var>?key0</var> ...) (<var>?key</var> ...) ...)
                  =&gt; <var>?form0</var> <var>?form</var> ...)
</pre>
          <p class="noindent">and the return value of the transformer is the result of the expansion. 
In this form <code>=&gt;</code> is the auxiliary syntax exported by both
<code>(nausicaa language oopp)</code> and <code>(nausicaa language
auxiliary-syntaxes)</code>, it is the same one exported by <code>(rnrs base (6))</code>.

          <p>The <var>?form</var> arguments are meant to be used as nested tag members
usage for the value returned by the getter. 
</ul>

        <p>Getter definition examples without member composition:

     <pre class="example">          (import (nausicaa))
          
          (define-label &lt;vector&gt;
            (getter (lambda (stx)
                      (syntax-case stx ()
                        ((?var ((?idx)))
                         #'(vector-ref ?var ?idx))))))
          
          (define-label &lt;matrix&gt;
            (getter (lambda (stx)
                      (syntax-case stx ()
                        ((?var ((?row) (?col)))
                         #'(vector-ref
                              (vector-ref ?var ?row)
                              ?col))))))
          
          (&lt;vector&gt; V '#(1 2 3))
          (&lt;matrix&gt; M '#(#(1 2 3)
                         #(4 5 6)))
          
          (V[0])                  &rArr; 1
          (V[1])                  &rArr; 2
          (V[2])                  &rArr; 3
          
          (M[0][2])               &rArr; 3
          (M[1][1])               &rArr; 5
</pre>
        <p>Getter definition examples with member composition:

     <pre class="example">          (import (nausicaa))
          
          (define-label &lt;fixnum-vector&gt;
            (parent &lt;vector&gt;)
            (getter
             (lambda (stx)
               (syntax-case stx (=&gt;)
                 ((?var ((?index)))
                  #'(vector-ref ?var ?index))
                 ((?var ((?index)) =&gt; ?form0 ?form ...)
                  #'(let (((fx &lt;fixnum&gt;) (?var[?index])))
                      (fx ?form0 ?form ...)))
                 ))))
          
          (let (((O &lt;fixnum-vector&gt;) '#(0 1 2 3)))
            (O[1] =&gt; string))
          &rArr; "1"
          
          (let (((O &lt;fixnum-vector&gt;) '#(0 1 2 3)))
            (O[1] =&gt; odd?))
          &rArr; #t
          
          (let (((O &lt;fixnum-vector&gt;) '#(0 1 2 3)))
            (O[2] =&gt; * 10))
          &rArr; 20
</pre>
        </blockquote></div>

<!-- page -->
   </body></html>

