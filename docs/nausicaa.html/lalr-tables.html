<html lang="en">
<head>
<title>lalr tables - Nausicaa for Scheme</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Nausicaa for Scheme">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="lalr.html#lalr" title="lalr">
<link rel="prev" href="lalr-intro.html#lalr-intro" title="lalr intro">
<link rel="next" href="lalr-lexer.html#lalr-lexer" title="lalr lexer">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This document describes version 0.2d5 of Nausicaa/Scheme, a set of
Scheme libraries defining a slightly modified R6RS Scheme language
and augmenting the features of the base and standard R6RS libraries.

The project home page of Nausicaa is at:

             `http://marcomaggi.github.com/nausicaa.html'


development of Nausicaa takes place at:

               `http://github.com/marcomaggi/nausicaa/'


Copyright (C) 2008, 2009, 2010 by Marco Maggi.

Copyright (C) 1996, 1997, 2000, 2001, 2002, 2003, 2004, 2005
Free Software Foundation.

Copyright (C) 1996, 1999-2005 Dorai Sitaram.

Copyright (C) 1998 Oleg Kiselyov.

Copyright (C) 1998, 1999, 2000 Olin Shivers.

Copyright (C) 1999 John David Stone.

Copyright (C) 1999, 2002 Marc Feeley.

Copyright (C) 2001, 2009 Danny Dube'

Copyright (C) 2002 Dr. Mirko Luedde.

Copyright (C) 2002, 2003, 2005, 2006 Sebastian Egner.

Copyright (C) 2003 Ray Dillinger.

Copyright (C) 2003 Taylor Campbell.

Copyright (C) 2005 Jens Axel Soegaard.

Copyright (C) 2005-2009 Alex Shinn.

Copyright (C) 2008 Taro Minowa (Higepon).

Copyright (C) 2005-2008 Dominique Boucher.

Copyright (C) 2004, 2005 Tony Garnock-Jones

Copyright (C) 2005 LShift Ltd.

Copyright (C) 2007, 2008 Philip L. Bewig.

Copyright (C) 2000 Will Fitzgerald.

Copyright (C) 2000 Neodesic Corporation.

Copyright (C) 2000-2006 Joachim Henke.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections being ``GNU Free
     Documentation License'' and ``GNU General Public License'', no
     Front--Cover Texts, and no Back--Cover Texts.  A copy of the
     license is included in the section entitled ``GNU Free
     Documentation License''.

This document embeds an unofficial assemblage of several documents
reformatted in Texinfo; the reformatting author and maintainer is
Marco Maggi <marco.maggi-ipsu@poste.it>.  See the appendix ``Credits'' for
the list of original documents and their authors.  See also the
`README' and `CREDITS' files for additional attributions.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="lalr-tables"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="lalr-lexer.html#lalr-lexer">lalr lexer</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="lalr-intro.html#lalr-intro">lalr intro</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="lalr.html#lalr">lalr</a>
<hr>
</div>

<h3 class="section">60.2 Creating parser tables</h3>

<p>The following bindings are exported by the <code>(nausicaa lalr)</code>
library.

<div class="defun">
&mdash; Syntax: <b>lalr-parser</b><var> &lt;clause&gt; ...<a name="index-lalr_002dparser-4552"></a></var><br>
&mdash; Syntax: <b>make-lalr-parser</b><var> &lt;clause&gt; ...<a name="index-make_002dlalr_002dparser-4553"></a></var><br>
<blockquote><p>Generate a parser table to be used by the LR or GLR drivers.  The
behaviour of this function is configured with the <var>&lt;clause&gt;</var>
arguments; see below for the list of supported options.  For example,
this is a simple expression grammar:

     <pre class="example">          (lalr-parser
          
            (terminals: '(ID
                          (left: + -)
                          (left: * /)
                          (nonassoc: uminus)))
          
            (rules: '((e (e + e)              : (+ $1 $3)
                         (e - e)              : (- $1 $3)
                         (e * e)              : (* $1 $3)
                         (e / e)              : (/ $1 $3)
                         (- e (prec: uminus)) : (- $2)
                         (ID)                 : $1)))
          
            ---) ;other options
</pre>
        <p><a href="lalr-grammar.html#lalr-grammar">Defining the parser</a>, for the definition of the
grammar and the meaning of the &lsquo;<samp><span class="samp">:terminals</span></samp>&rsquo; and &lsquo;<samp><span class="samp">:rules</span></samp>&rsquo;
options.

        <p>The core of the output is a set of parser &ldquo;tables&rdquo;: Scheme vectors
representing the automaton.  There are three of them: action, goto,
reduction.  The tables are used as arguments for a call to
<code>lr-driver</code> or <code>glr-driver</code>: Their return value is a closure
implementing an instance of the parser. 
</p></blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>terminals:</b><var> sexpr<a name="index-terminals_003a-4554"></a></var><br>
<blockquote><p>Specifies a list representing the terminal symbols, their precedence and
their associativity. 
</p></blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>rules:</b><var> sexpr<a name="index-rules_003a-4555"></a></var><br>
<blockquote><p>Specifies a list representing the grammar production rules. 
</p></blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>expect:</b><var> number-of-conflicts<a name="index-expect_003a-4556"></a></var><br>
<blockquote><p>Specifies the number of rule conflicts we expect in the parser
definition.  The default is zero.

        <p>When more than <var>number-of-conflicts</var> are detected, warning messages
are printed to the current error port.  If <var>number-of-conflicts</var> is
<code>#f</code>, rather than an exact non-negative integer, no message is ever
displayed on the error port. 
</p></blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>parser-type:</b><var> driver<a name="index-parser_002dtype_003a-4557"></a></var><br>
<blockquote><p>Select the type of tables to generate.  Available drivers are selected
with a symbol among: &lsquo;<samp><span class="samp">lr</span></samp>&rsquo;, &lsquo;<samp><span class="samp">glr</span></samp>&rsquo;.  The default is &lsquo;<samp><span class="samp">lr</span></samp>&rsquo;. 
</p></blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>output-value:</b><var> #t|#f<a name="index-output_002dvalue_003a-4558"></a></var><br>
<blockquote><p>If the value is true, instruct <code>lalr-parser</code> to evaluate the output
with <code>eval</code> and return a proper Scheme function implementing a
parser maker.  <a href="../nausicaa/stdlib-eval.html#stdlib-eval">Evaluation</a>

        <p>With this option, in the case of the &lsquo;<samp><span class="samp">lr</span></samp>&rsquo; driver, the generated
code has the form:

     <pre class="example">          (lambda ()
            (lr-driver &lt;action-table&gt; &lt;goto-table&gt; &lt;reduction-table&gt;))
</pre>
        <p class="noindent">so the value returned by <code>lalr-parser</code> is a closure which, when
evaluated with no arguments, returns a new parser closure.  See
&lsquo;<samp><span class="samp">library-imports:</span></samp>&rsquo; to add libraries to the evaluation environment.

        <p>When used together, this option supersedes &lsquo;<samp><span class="samp">output-port:</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">output-file:</span></samp>&rsquo;. 
</p></blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>output-port:</b><var> port<a name="index-output_002dport_003a-4559"></a></var><br>
<blockquote><p>Instruct <code>lalr-parser</code> to print the generated code to the specified
port.  When used together, this option supersedes &lsquo;<samp><span class="samp">output-file:</span></samp>&rsquo;.

        <p>When neither &lsquo;<samp><span class="samp">library-spec:</span></samp>&rsquo; nor &lsquo;<samp><span class="samp">parser-name:</span></samp>&rsquo; are used, the
output is the same as the one generated by &lsquo;<samp><span class="samp">output-value:</span></samp>&rsquo;: A
lambda function returning new parser closures.  See &lsquo;<samp><span class="samp">library-spec:</span></samp>&rsquo;
and &lsquo;<samp><span class="samp">parser-name:</span></samp>&rsquo; for details on the other output types. 
</p></blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>output-file:</b><var> pathname<a name="index-output_002dfile_003a-4560"></a></var><br>
<blockquote><p>Instruct <code>lalr-parser</code> to save the generated code to the specified
file; the file will be overwritten if it already exists.  <var>pathname</var>
must be a Scheme string representing a file pathname.

        <p>When neither &lsquo;<samp><span class="samp">library-spec:</span></samp>&rsquo; nor &lsquo;<samp><span class="samp">parser-name:</span></samp>&rsquo; are used, the
output is the same as the one generated by &lsquo;<samp><span class="samp">output-value:</span></samp>&rsquo;: a
lambda function returning new parser closures.  See &lsquo;<samp><span class="samp">library-spec:</span></samp>&rsquo;
and &lsquo;<samp><span class="samp">parser-name:</span></samp>&rsquo; for details on the other output types. 
</p></blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>dump-table:</b><var> pathname<a name="index-dump_002dtable_003a-4561"></a></var><br>
<blockquote><p>Instruct <code>lalr-parser</code> to save a human readable dump of the
generated parser in the specified file.  The file will be overwritten if
it already exists.  This is useful for debugging purposes (if we know
how the parser works). 
</p></blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>parser-name:</b><var> name<a name="index-parser_002dname_003a-4562"></a></var><br>
<blockquote><p>Instruct <code>lalr-parser</code> to use the symbol <var>name</var> as identifier
to which bind the parser maker function.  It is mandatory to use this
option when generating a library.

        <p>If this option is used, but &lsquo;<samp><span class="samp">library-spec:</span></samp>&rsquo; is not: The output is a
<code>define</code> form which, when evaluated, binds the parser maker to
<var>name</var>.  Example output for the &lsquo;<samp><span class="samp">lr</span></samp>&rsquo; driver:

     <pre class="example">          (define (<var>name</var>)
            (lr-driver &lt;action-table&gt; &lt;goto-table&gt; &lt;reduction-table&gt;))
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>library-spec:</b><var> spec<a name="index-library_002dspec_003a-4563"></a></var><br>
<blockquote><p>Instruct <code>lalr-parser</code> to generate a proper Scheme library, holding
the parser definition and exporting a binding to the parser maker
function.  <var>spec</var> must be a proper <var>&lt;library name&gt;</var> as defined by
<acronym>R6RS</acronym>.  <a href="../nausicaa/scheme-library-form.html#scheme-library-form">Libary form</a>

        <p>This option is especially useful in conjunction with &lsquo;<samp><span class="samp">output-file</span></samp>&rsquo;. 
It is mandatory to use the option &lsquo;<samp><span class="samp">parser-name:</span></samp>&rsquo; along with
&lsquo;<samp><span class="samp">library-spec:</span></samp>&rsquo;.

        <p>Example output for the &lsquo;<samp><span class="samp">lr</span></samp>&rsquo; driver assuming <var>name</var> is the value
used for the &lsquo;<samp><span class="samp">parser-name:</span></samp>&rsquo; option:

     <pre class="example">          (library <var>spec</var>
            (export <var>name</var>)
            (import (rnrs)
              (nausicaa lalr lr-driver)
              (nausicaa parser-tools source-location)
              (nausicaa parser-tools lexical-token)
              (nausicaa language sentinel))
            (define (<var>name</var>)
              (lr-driver &lt;action-table&gt; &lt;goto-table&gt;
                         &lt;reduction-table&gt;)))
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>library-language:</b><var> lang<a name="index-library_002dlanguage_003a-4564"></a></var><br>
<blockquote><p>Instruct <code>lalr-parser</code> to use <var>lang</var> as language for the
library; the language is the first import specification after
<code>import</code> in the <code>library</code> form.  By default the language is
<code>(rnrs)</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Auxiliary Syntax: <b>library-imports:</b><var> imports<a name="index-library_002dimports_003a-4565"></a></var><br>
<blockquote><p>Instruct <code>lalr-parser</code> to add <var>imports</var> to the list of Scheme
libraries required by the parser definition.  <var>imports</var> must be a
list of library specifications; for example, if the parser definition
(meaning the semantic actions) requires the <code>(alpha)</code> and
<code>(beta)</code> libraries, we must use:

     <pre class="example">          (library-imports: '((alpha) (beta)))
</pre>
        <p>The selected imports will be added to the import list of the generated
library (if &lsquo;<samp><span class="samp">library-spec:</span></samp>&rsquo; is used), or to the <code>eval</code>
environment argument (if &lsquo;<samp><span class="samp">output-value:</span></samp>&rsquo; is used).  The imports are
ignored when the output is a <code>define</code> form.

        <p>By default, the import list always includes &lsquo;<samp><span class="samp">(rnrs)</span></samp>&rsquo;, the selected
driver's library <code>(nausicaa lalr lr-driver)</code> or <code>(nausicaa
lalr glr-driver)</code> and the following libraries:

     <pre class="example">          (nausicaa parser-tools source-location)
          (nausicaa parser-tools lexical-token)
          (nausicaa sentinel)
</pre>
        </blockquote></div>

<!-- page -->
   </body></html>

