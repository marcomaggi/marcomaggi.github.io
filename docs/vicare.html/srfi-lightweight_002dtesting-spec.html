<html lang="en">
<head>
<title>srfi lightweight-testing spec - Vicare Scheme</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Vicare Scheme">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="srfi-lightweight_002dtesting.html#srfi-lightweight_002dtesting" title="srfi lightweight-testing">
<link rel="prev" href="srfi-lightweight_002dtesting-rationale.html#srfi-lightweight_002dtesting-rationale" title="srfi lightweight-testing rationale">
<link rel="next" href="srfi-lightweight_002dtesting-references.html#srfi-lightweight_002dtesting-references" title="srfi lightweight-testing references">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This document describes version 0.3d1 of Vicare Scheme, an
R6RS compliant native compiler for the Scheme language, producing
single threaded programs running on Intel x86 32-bit processors, with
experimental support for 64-bit machines.  _Vicare_ is pronounced
the etruscan way.

The package, including its documentation, is distributed under the terms
of the GNU General Public License (GPL) and can be downloaded
from:

        `http://sourceforge.net/projects/vicare-scheme/files/'


the home page of the project is at:

              `http://marcomaggi.github.com/vicare.html'


development takes place at:

                `http://github.com/marcomaggi/vicare/'


and, as a backup, at:

                     `http://gitorious.org/vicare'


and at:

           `http://sourceforge.net/projects/vicare-scheme/'


this project has a mailing list:

             `http://groups.google.com/group/vicare-users'


Copyright (C) 2010-2013 by Marco Maggi.

Copyright (C) 2006-2010 by Abdulaziz Ghuloum.

Copyright (C) Michael Sperber, R. Kent Dybvig, Matthew Flatt and Anton Van Straaten.

This document is derived from the original Ikarus documentation by the
Vicare Scheme contributors, see the ``History'' appendix for details.

     This program is free software: you can redistribute it and/or
     modify it under the terms of the GNU General Public License
     version 3 as published by the Free Software Foundation.

     This program is distributed in the hope that it will be useful, but
     WITHOUT ANY WARRANTY; without even the implied warranty of
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
     General Public License for more details.

     You should have received a copy of the GNU General Public License
     along with this program.  If not, see
     `http://www.gnu.org/licenses/'.

Trademarks used herein are the property of their respective owners.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="srfi-lightweight-testing-spec"></a>
<a name="srfi-lightweight_002dtesting-spec"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="srfi-lightweight_002dtesting-references.html#srfi-lightweight_002dtesting-references">srfi lightweight-testing references</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="srfi-lightweight_002dtesting-rationale.html#srfi-lightweight_002dtesting-rationale">srfi lightweight-testing rationale</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="srfi-lightweight_002dtesting.html#srfi-lightweight_002dtesting">srfi lightweight-testing</a>
<hr>
</div>

<h4 class="subsection">14.30.4 Specification</h4>

<div class="defun">
&mdash; Syntax: <b>check</b><var> expr </var>(<var>=&gt; equal</var>)<var> expected<a name="index-check-5058"></a></var><br>
&mdash; Syntax: <b>check</b><var> expr =&gt; expected<a name="index-check-5059"></a></var><br>
<blockquote><p>Evaluate <var>expr</var> and compare the value to the value of <var>expected</var>
using the predicate <var>equal</var>, which is <code>equal?</code> when omitted. 
Then a report is printed according to the current mode setting (see
below) and the outcome is recorded in a global state to be used in
<code>check-report</code>.

        <p>The precise order of evaluation is that first <var>equal</var> and
<var>expected</var> are evaluated (in unspecified order) and then <var>expr</var>
is evaluated.  Example: <code>(check (+ 1 1) =&gt; 2)</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Syntax: <b>check-ec</b><var> qualifier* expr </var>(<var>=&gt; equal</var>)<var> expected </var>(<var>argument*</var>))<var><a name="index-check_002dec-5060"></a></var><br>
&mdash; Syntax: <b>check-ec</b><var> qualifier* expr =&gt; expected </var>(<var>argument*</var>)<var><a name="index-check_002dec-5061"></a></var><br>
&mdash; Syntax: <b>check-ec</b><var> qualifier* expr </var>(<var>=&gt; equal</var>)<var> expected<a name="index-check_002dec-5062"></a></var><br>
&mdash; Syntax: <b>check-ec</b><var> qualifier* expr =&gt; expected<a name="index-check_002dec-5063"></a></var><br>
<blockquote><p>An eager comprehension for executing a parametric sequence of checks.

        <p>Enumerate the sequence of bindings specified by <var>qualifier*</var>.  For
each binding evaluate <var>equal</var> and <var>expected</var> in unspecified
order. Then evaluate <var>expr</var> and compare the value obtained to the
value of <var>expected</var> using the value of <var>equal</var> as predicate,
which is <code>equal?</code> when omitted.

        <p>The comprehension stops after the first failed check, if there is any. 
Then a report is printed according to the current mode setting (see
below) and the outcome is recorded in a global state to be used in
<code>check-report</code>.  The entire <code>check-ec</code> counts as a single
check.

        <p>In case the check fails <var>argument*</var> is used for constructing an
informative message with the argument values.  Use <var>argument*</var> to
list the relevant free variables of <var>expr</var> (see examples) that you
want to have printed.

        <p>A <var>qualifier</var> is any qualifier of an eager comprehension as
specified in <acronym>SRFI</acronym>-42.

        <p>Examples:

     <pre class="example">          (check-ec (: e 100)
                    (positive? (expt 2 e))
                    =&gt; #t (e)) ; fails on fixnums
          
          (check-ec (: e 100)
                    (:let x (expt 2.0 e))
                    (= (+ x 1) x)
                    =&gt; #f (x)) ; fails
          
          (check-ec (: x 10)
                    (: y 10)
                    (: z 10)
                    (* x (+ y z))
                    =&gt; (+ (* x y) (* x z))
                       (x y z)) ; passes with 10^3 cases checked
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>check-report</b><var><a name="index-check_002dreport-5064"></a></var><br>
<blockquote><p>Print a summary and the first failed check, if there is any, depending
on the current mode settings. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>check-set-mode!</b><var> mode<a name="index-check_002dset_002dmode_0021-5065"></a></var><br>
<blockquote><p>Set the current mode to <var>mode</var>, which must be a symbol among:
<code>off</code>, <code>summary</code>, <code>report-failed</code>, <code>report</code>; the
default is <code>report</code>.  Note that you can change the mode at any
time, and that <code>check</code>, <code>check-ec</code> and <code>check-report</code> use
the current value.

        <p>The mode symbols have the following meaning:

          <dl>
<dt><code>off</code><dd>do not execute any of the checks;

          <br><dt><code>summary</code><dd>print only summary in <code>check-report</code> and nothing else;

          <br><dt><code>report-failed</code><dd>report failed checks when they happen, and in summary;

          <br><dt><code>report</code><dd>report every example executed. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>check-reset!</b><var><a name="index-check_002dreset_0021-5066"></a></var><br>
<blockquote><p>Reset the global state (counters of correct/failed examples) to the
state immediately after loading the module for the first time, i.e. no
checks have been executed. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>check-passed?</b><var> expected-total-count<a name="index-check_002dpassed_003f-5067"></a></var><br>
<blockquote><p>Return <code>#t</code> if there were no failed checks and
<var>expected-total-count</var> correct checks, <code>#f</code> otherwise.

        <p>Rationale: This procedure can be used in automatized tests by
terminating a test program with the statement:

     <pre class="example">          (exit (if (check-passed? n) 0 1))
</pre>
        </blockquote></div>

<!-- page -->
   </body></html>

