<html lang="en">
<head>
<title>Vicare Scheme User's Guide</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Vicare Scheme User's Guide">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This document describes version 0.2d0 of Vicare Scheme, an almost
R6RS compliant implementation of the Scheme programming language.
Vicare (pronounced the etruscan way) is an experimental fork of Ikarus
Scheme which aims at fixing bugs, full R6RS compliance with a
pragmatic eye, enhancing some features like the POSIX interface.

The Vicarus Scheme package is distributed under the terms of the GNU
General Public License (GPL) and can be downloaded from:

            `http://github.com/marcomaggi/vicare/downloads'


the home page of the project is at:

              `http://marcomaggi.github.com/vicare.html'


development takes place at:

                `http://github.com/marcomaggi/vicare/'


Copyright (C) 2006-2011 by Abdulaziz Ghuloum.

This document was modified by the Vicare Scheme contributors.

     This program is free software: you can redistribute it and/or
     modify it under the terms of the GNU General Public License
     version 3 as published by the Free Software Foundation.

     This program is distributed in the hope that it will be useful, but
     WITHOUT ANY WARRANTY; without even the implied warranty of
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
     General Public License for more details.

     You should have received a copy of the GNU General Public License
     along with this program.  If not, see
     `http://www.gnu.org/licenses/'.

Trademarks used herein are the property of their respective owners.

This document is derived from the original Ikarus documentation,
reformatted in Texinfo; the reformatting author and maintainer is Marco
Maggi <marco.maggi-ipsu@poste.it> with contributions by other
people.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<h1 class="settitle">Vicare Scheme User's Guide</h1>
   <div class="shortcontents">
<h2>Short Contents</h2>
<ul>
<li><a href="#toc_Top">Vicare Scheme User's Guide</a></li>
<li><a href="#toc_overview">1 Overview of Vicare Scheme</a></li>
<li><a href="#toc_using">2 Using Vicare</a></li>
<li><a href="#toc_iklib">3 Extensions library</a></li>
<li><a href="#toc_posix">4 The <acronym>POSIX</acronym> interface</a></li>
<li><a href="#toc_syslib">5 Low level, fast, unsafe operations</a></li>
<li><a href="#toc_objects-int">6 Internals: builtin objects</a></li>
<li><a href="#toc_debug-int">7 Internals: debug mode</a></li>
<li><a href="#toc_compiler">8 Wild notes on the compiler internals</a></li>
<li><a href="#toc_missing">Appendix A Missing Features</a></li>
<li><a href="#toc_building">Appendix B Building infrastructure</a></li>
<li><a href="#toc_credits">Appendix C Credits for this document</a></li>
<li><a href="#toc_package-license">Appendix D <acronym>GNU</acronym> General Public License</a></li>
<li><a href="#toc_references">Appendix E Bibliography and references</a></li>
<li><a href="#toc_concept-index">Appendix F An entry for each concept</a></li>
<li><a href="#toc_function-index">Appendix G An entry for each function.</a></li>
<li><a href="#toc_variable-index">Appendix H An entry for each variable.</a></li>
<li><a href="#toc_type-index">Appendix I An entry for each type.</a></li>
</ul>
</div>



   <div class="contents">
<h2>Table of Contents</h2>
<ul>
<li><a name="toc_Top" href="#Top">Vicare Scheme User's Guide</a>
<li><a name="toc_overview" href="#overview">1 Overview of Vicare Scheme</a>
<ul>
<li><a href="#overview-original">1.1 Original Ikarus Scheme</a>
<li><a href="#overview-tech">1.2 Technology overview</a>
<li><a href="#overview-resources">1.3 Resources</a>
<li><a href="#overview-system">1.4 System requirements</a>
<ul>
<li><a href="#overview-system-hardware">1.4.1 Hardware requirements</a>
<li><a href="#overview-system-software">1.4.2 Software requirements</a>
</li></ul>
<li><a href="#overview-install">1.5 Installation and uninstallation</a>
<ul>
<li><a href="#overview-install-quick">1.5.1 Quick installation guide</a>
<li><a href="#overview-install-prerequisites">1.5.2 Installing the prerequisites</a>
<li><a href="#overview-install-details">1.5.3 Installation details</a>
<li><a href="#overview-install-uninstall">1.5.4 Uninstalling Vicare</a>
</li></ul>
<li><a href="#overview-restrictions">1.6 Implementation restrictions</a>
</li></ul>
<li><a name="toc_using" href="#using">2 Using Vicare</a>
<ul>
<li><a href="#using-interactive">2.1 Interactive sessions</a>
<li><a href="#using-invoking">2.2 Command line arguments</a>
<li><a href="#using-script">2.3 Using <samp><span class="command">scheme-script</span></samp></a>
<li><a href="#using-libraries">2.4 <acronym>R6RS</acronym> libraries</a>
<ul>
<li><a href="#using-libraries-intro">2.4.1 Introduction to libraries</a>
<li><a href="#using-libraries-searching">2.4.2 How Vicare finds libraries</a>
<li><a href="#using-libraries-summary">2.4.3 Library search algorithm summary</a>
<li><a href="#using-libraries-examples">2.4.4 Examples of library usage</a>
</li></ul>
</li></ul>
<li><a name="toc_iklib" href="#iklib">3 Extensions library</a>
<ul>
<li><a href="#iklib-conditions">3.1 Additional condition types</a>
<ul>
<li><a href="#iklib-conditions-spos">3.1.1 Scheme source code position</a>
<li><a href="#iklib-conditions-eagain">3.1.2 Reporting <code>EAGAIN</code> exceptions</a>
</li></ul>
<li><a href="#iklib-reader">3.2 Reader</a>
<ul>
<li><a href="#iklib-reader-mode">3.2.1 Textual input port modes</a>
<li><a href="#iklib-reader-bv">3.2.2 Additional bytevector syntaxes</a>
<li><a href="#iklib-reader-stx">3.2.3 Miscellaneous additional syntaxes</a>
<li><a href="#iklib-reader-fun">3.2.4 Additional reader functions</a>
</li></ul>
<li><a href="#iklib-expander">3.3 Interface to the expander</a>
<li><a href="#iklib-environment">3.4 Environments</a>
<li><a href="#iklib-cafe">3.5 Cafe</a>
<li><a href="#iklib-structs">3.6 Structures and type descriptors</a>
<ul>
<li><a href="#iklib-structs-rtd">3.6.1 Structure type descriptors</a>
<li><a href="#iklib-structs-using">3.6.2 Using data structures</a>
<li><a href="#iklib-structs-inspect">3.6.3 Inspecting data structures</a>
</li></ul>
<li><a href="#iklib-bytevectors">3.7 Additional bytevector functions</a>
<ul>
<li><a href="#iklib-bytevectors-sub">3.7.1 Building subbytevectors</a>
<li><a href="#iklib-bytevectors-conv">3.7.2 Converting bytevectors</a>
<li><a href="#iklib-bytevectors-generic">3.7.3 Generic bytevectors operations</a>
</li></ul>
<li><a href="#iklib-strings">3.8 Additional string functions</a>
<li><a href="#iklib-symbols">3.9 Additional symbol functions</a>
<ul>
<li><a href="#iklib-symbols-plists">3.9.1 Property lists</a>
</li></ul>
<li><a href="#iklib-numerics">3.10 Additional functions on numbers</a>
<ul>
<li><a href="#iklib-numerics-preds">3.10.1 Additional numeric predicates</a>
</li></ul>
<li><a href="#iklib-load">3.11 Loading source files</a>
<li><a href="#iklib-import">3.12 Local library imports</a>
<li><a href="#iklib-modules">3.13 Local modules</a>
<ul>
<li><a href="#iklib-modules-examples">3.13.1 Usage example for modules</a>
<ul>
<li><a href="#iklib-modules-examples-anonymous">3.13.1.1 Anonymous modules</a>
<li><a href="#iklib-modules-examples-named">3.13.1.2 Named modules</a>
<li><a href="#iklib-modules-examples-utils">3.13.1.3 Utilities examples</a>
</li></ul>
<li><a href="#iklib-modules-api">3.13.2 Modules programming interface</a>
</li></ul>
<li><a href="#iklib-parameters">3.14 Parameters</a>
<li><a href="#iklib-gensym">3.15 Gensyms</a>
<ul>
<li><a href="#iklib-gensym">3.15.1 An example</a>
</li></ul>
<li><a href="#iklib-printing">3.16 Printing</a>
<li><a href="#iklib-tracing">3.17 Tracing</a>
<li><a href="#iklib-timing">3.18 Timing</a>
<li><a href="#iklib-guardians">3.19 Guardians and garbage collection</a>
<ul>
<li><a href="#iklib-guardians-examples">3.19.1 Usage examples for guardians</a>
<li><a href="#iklib-guardians-api">3.19.2 Guardians programming interface</a>
</li></ul>
<li><a href="#iklib-io">3.20 Input/output library</a>
<ul>
<li><a href="#iklib-io-filename">3.20.1 File pathname handling</a>
<li><a href="#iklib-io-codecs">3.20.2 Transcoders and additional codecs</a>
<li><a href="#iklib-io-binary">3.20.3 Additional binary port features</a>
<li><a href="#iklib-io-textual">3.20.4 Additional textual port features</a>
<li><a href="#iklib-io-buffer">3.20.5 Buffer size customisation</a>
<li><a href="#iklib-io-process">3.20.6 Spawning processes</a>
<li><a href="#iklib-io-socket">3.20.7 Using network sockets</a>
<ul>
<li><a href="#iklib-io-socket-client">3.20.7.1 Establishing client network connections</a>
<li><a href="#iklib-io-socket-server">3.20.7.2 Opening server network services</a>
</li></ul>
<li><a href="#iklib-io-non_002dblock">3.20.8 Non&ndash;blocking mode for ports</a>
<li><a href="#iklib-io-misc">3.20.9 Miscellaneous port functions</a>
</li></ul>
<li><a href="#iklib-foreign">3.21 The <code>(vicare foreign)</code> library</a>
<ul>
<li><a href="#iklib-foreign-overview">3.21.1 Overview of the foreign functions interface</a>
<li><a href="#iklib-foreign-memory">3.21.2 Memory management</a>
<li><a href="#iklib-foreign-memops">3.21.3 Memory operations</a>
<ul>
<li><a href="#iklib-foreign-memops-alloc">3.21.3.1 Allocating and freeing memory</a>
<li><a href="#iklib-foreign-memops-pointer">3.21.3.2 Handling pointer values</a>
<li><a href="#iklib-foreign-memops-poke">3.21.3.3 Poking values</a>
<li><a href="#iklib-foreign-memops-peek">3.21.3.4 Peeking values</a>
</li></ul>
<li><a href="#iklib-foreign-dl">3.21.4 Accessing foreign objects from Scheme</a>
<li><a href="#iklib-foreign-call-out">3.21.5 Calling out to foreign procedures</a>
<ul>
<li><a href="#iklib-foreign-call-out-api">3.21.5.1 Interface to foreign functions</a>
<li><a href="#iklib-foreign-call-out-types">3.21.5.2 Type specifiers</a>
<li><a href="#iklib-foreign-call-out-example">3.21.5.3 C language call out example</a>
</li></ul>
<li><a href="#iklib-foreign-call-back">3.21.6 Calling back to Scheme</a>
</li></ul>
<li><a href="#iklib-misc">3.22 Miscellaneous functions</a>
</li></ul>
<li><a name="toc_posix" href="#posix">4 The <acronym>POSIX</acronym> interface</a>
<ul>
<li><a href="#posix-pid">4.1 Process identifier functions</a>
<li><a href="#posix-process">4.2 Spawning processes and the like</a>
<li><a href="#posix-waitpid">4.3 Waiting for terminated children</a>
<li><a href="#posix-signal">4.4 Delivering signals to processes</a>
<li><a href="#posix-file">4.5 Interfacing with the file system</a>
<li><a href="#posix-dir">4.6 File system directory inspection</a>
<li><a href="#posix-env">4.7 Interfacing with the execution environment</a>
<li><a href="#posix-misc">4.8 Miscellaneous functions</a>
<li><a href="#posix-int-intro">4.9 Internals: introduction to the <acronym>POSIX</acronym> <acronym>API</acronym></a>
<li><a href="#posix-int-errno">4.10 Internals: handling <code>errno</code> codes</a>
<li><a href="#posix-int-fd">4.11 Internals: file descriptors</a>
<ul>
<li><a href="#posix-int-fd-open">4.11.1 Opening and closing file descriptors</a>
<li><a href="#posix-int-fd-seek">4.11.2 Handling file descriptor cursor</a>
<li><a href="#posix-int-fd-rw">4.11.3 Reading and writing</a>
<li><a href="#posix-int-fd-event">4.11.4 Handling file descriptor events</a>
<li><a href="#posix-int-fd-net">4.11.5 Handling sockets</a>
</li></ul>
<li><a href="#posix-int-pid">4.12 Internals: process identifier functions</a>
<li><a href="#posix-int-files">4.13 Internals: file system interface</a>
<ul>
<li><a href="#posix-int-files-stat">4.13.1 Status and access permissions</a>
<li><a href="#posix-int-files-dir">4.13.2 Handling directories</a>
<li><a href="#posix-int-files-link">4.13.3 Handling links and symbolic links</a>
</li></ul>
<li><a href="#posix-int-exec">4.14 Internals: executing processes</a>
<li><a href="#posix-int-time">4.15 Internals: time and date</a>
<li><a href="#posix-int-env">4.16 Internals: environment variables</a>
</li></ul>
<li><a name="toc_syslib" href="#syslib">5 Low level, fast, unsafe operations</a>
<ul>
<li><a href="#syslib-symbols">5.1 Low level symbol operations</a>
<li><a href="#syslib-fixnums">5.2 Low level fixnum operations</a>
<li><a href="#syslib-bignums">5.3 Low level bignum operations</a>
<li><a href="#syslib-flonums">5.4 Low level flonum operations</a>
<li><a href="#syslib-ratnums">5.5 Low level ratnum operations</a>
<li><a href="#syslib-compnums">5.6 Low level compnum operations</a>
<li><a href="#syslib-cflonums">5.7 Low level cflonum operations</a>
<li><a href="#syslib-chars">5.8 Low level character operations</a>
<li><a href="#syslib-pairs">5.9 Low level pair operations</a>
<li><a href="#syslib-structs">5.10 Low level structure operations</a>
<li><a href="#syslib-vectors">5.11 Low level vector operations</a>
<li><a href="#syslib-bytevectors">5.12 Low level bytevector operations</a>
<li><a href="#syslib-strings">5.13 Low level string operations</a>
<li><a href="#syslib-ports">5.14 Low level port structures</a>
<li><a href="#syslib-transcoders">5.15 Low level transcoder operations</a>
</li></ul>
<li><a name="toc_objects-int" href="#objects-int">6 Internals: builtin objects</a>
<ul>
<li><a href="#objects-int-intro">6.1 Introduction to buitin objects</a>
<li><a href="#objects-int-refs">6.2 Builtin object references</a>
<li><a href="#objects-int-const">6.3 Constant values</a>
<li><a href="#objects-int-alloc">6.4 Allocating memory for builtin objects</a>
<li><a href="#objects-int-fixnum">6.5 Fixnum objects</a>
<li><a href="#objects-int-bytevector">6.6 Bytevector objects</a>
<li><a href="#objects-int-vector">6.7 Vector objects</a>
</li></ul>
<li><a name="toc_debug-int" href="#debug-int">7 Internals: debug mode</a>
<ul>
<li><a href="#debug-int-intro">7.1 Introduction to debug mode</a>
</li></ul>
<li><a name="toc_compiler" href="#compiler">8 Wild notes on the compiler internals</a>
<ul>
<li><a href="#compiler-intro">8.1 Introduction to the compiler</a>
<li><a href="#compiler-conventions">8.2 Coding conventions in the compiler code</a>
<li><a href="#compiler-cogen">8.3 Stuff in <samp><span class="file">ikarus.compiler.altcogen.ss</span></samp></a>
</li></ul>
<li><a name="toc_missing" href="#missing">Appendix A Missing Features</a>
<li><a name="toc_building" href="#building">Appendix B Building infrastructure</a>
<ul>
<li><a href="#building-revision">B.1 Package revision in the banner</a>
</li></ul>
<li><a name="toc_credits" href="#credits">Appendix C Credits for this document</a>
<li><a name="toc_package-license" href="#package-license">Appendix D <acronym>GNU</acronym> General Public License</a>
<li><a name="toc_references" href="#references">Appendix E Bibliography and references</a>
<li><a name="toc_concept-index" href="#concept-index">Appendix F An entry for each concept</a>
<li><a name="toc_function-index" href="#function-index">Appendix G An entry for each function.</a>
<li><a name="toc_variable-index" href="#variable-index">Appendix H An entry for each variable.</a>
<li><a name="toc_type-index" href="#type-index">Appendix I An entry for each type.</a>
</li></ul>
</div>

<!--  -->
<!--  -->
<!-- page -->
<div class="node">
<a name="Top"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview">overview</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dir">(dir)</a>

</div>

<h2 class="unnumbered">Vicare Scheme User's Guide</h2>

<p class="noindent">This document describes version 0.2d0 of Vicare Scheme, an almost
<acronym>R6RS</acronym> compliant implementation of the Scheme programming language. 
Vicare (pronounced the etruscan way) is an experimental fork of Ikarus
Scheme which aims at fixing bugs, full <acronym>R6RS</acronym> compliance with a
pragmatic eye, enhancing some features like the <acronym>POSIX</acronym> interface.

   <p>The Vicarus Scheme package is distributed under the terms of the <acronym>GNU</acronym>
General Public License (<acronym>GPL</acronym>) and can be downloaded from:

<div align="center"><a href="http://github.com/marcomaggi/vicare/downloads">http://github.com/marcomaggi/vicare/downloads</a></div>

<p class="noindent">the home page of the project is at:

<div align="center"><a href="http://marcomaggi.github.com/vicare.html">http://marcomaggi.github.com/vicare.html</a></div>

<p class="noindent">development takes place at:

<div align="center"><a href="http://github.com/marcomaggi/vicare/">http://github.com/marcomaggi/vicare/</a></div>

<p class="noindent">Copyright &copy; 2006-2011 by Abdulaziz Ghuloum.<br>
This document was modified by the Vicare Scheme contributors.

   <blockquote>
This program is free software: you can redistribute it and/or modify it
under the terms of the <acronym>GNU</acronym> General Public License version 3 as
published by the Free Software Foundation.

   <p>This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
General Public License for more details.

   <p>You should have received a copy of the <acronym>GNU</acronym> General Public License
along with this program.  If not, see
<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. 
</blockquote>

   <p>Trademarks used herein are the property of their respective owners.

   <p>This document is derived from the original Ikarus documentation,
reformatted in Texinfo; the reformatting author and maintainer is Marco
Maggi <a href="mailto:marco.maggi-ipsu@poste.it">marco.maggi-ipsu@poste.it</a> with contributions by other
people.

<ul class="menu">
<li><a accesskey="1" href="#overview">overview</a>:                     Overview of Vicare Scheme. 
<li><a accesskey="2" href="#using">using</a>:                        Using the program. 
<li><a accesskey="3" href="#iklib">iklib</a>:                        Extensions library. 
<li><a accesskey="4" href="#posix">posix</a>:                        The <acronym>POSIX</acronym> interface. 
<li><a accesskey="5" href="#syslib">syslib</a>:                       Low level, fast, unsafe operations.

</li></ul>
<p>Internals

</p>
<ul class="menu">
<li><a accesskey="6" href="#objects-int">objects int</a>:                  Builtin objects. 
<li><a accesskey="7" href="#debug-int">debug int</a>:                    Debug mode. 
<li><a accesskey="8" href="#compiler">compiler</a>:                     Wild notes on the compiler internals.

</li></ul>
<p>Appendices

</p>
<ul class="menu">
<li><a accesskey="9" href="#missing">missing</a>:                      Missing Features. 
<li><a href="#building">building</a>:                     Building infrastructure. 
<li><a href="#credits">credits</a>:                      Credits for this document. 
<li><a href="#package-license">package license</a>:              <acronym>GNU</acronym> General Public License. 
<li><a href="#references">references</a>:                   Bibliography and references.

</li></ul>
<p>Indexes

</p>
<ul class="menu">
<li><a href="#concept-index">concept index</a>:                An entry for each concept. 
<li><a href="#function-index">function index</a>:               An entry for each function. 
<li><a href="#variable-index">variable index</a>:               An entry for each variable. 
<li><a href="#type-index">type index</a>:                   An entry for each type.

</li></ul>
<p>External documents

</p>
<ul class="menu">
<li><a href="#g_t_0028libffi_0029">libffi</a>:              Libffi documentation.

   </ul>

<!-- page -->
<div class="node">
<a name="overview"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#using">using</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">1 Overview of Vicare Scheme</h2>

<p>Scheme is a statically scoped and properly tail&ndash;recursive dialect of
the Lisp programming language invented by Guy Lewis Steele Jr.  and
Gerald Jay Sussman.  It was designed to have an exceptionally clear and
simple semantics and few different ways to form expressions.

   <p>The &ldquo;Revised^6 Report on the Algorithmic Language Scheme&rdquo; (<acronym>R6RS</acronym>)
gives a defining description of the programming language Scheme.  The
report is the work of many people in the course of many years; revision
6 was edited by Michael Sperber, R. Kent Dybvig, Matthew Flatt and Anton
Van Straaten.

   <p>Ikarus Scheme is an almost <acronym>R6RS</acronym> compliant implementation of the
Scheme programming language; it is the creation of Abdulaziz Ghuloum.

   <p>Vicare Scheme is an experimental fork of Ikarus Scheme which aims at
fixing bugs, pushing compliance with <acronym>R6RS</acronym>, enhancing some features
like the <acronym>POSIX</acronym> interface.  Vicare is pronounced the etruscan way.

<ul class="menu">
<li><a accesskey="1" href="#overview-original">overview original</a>:            Original Ikarus Scheme. 
<li><a accesskey="2" href="#overview-tech">overview tech</a>:                Technology overview. 
<li><a accesskey="3" href="#overview-resources">overview resources</a>:           Resources. 
<li><a accesskey="4" href="#overview-system">overview system</a>:              System requirements. 
<li><a accesskey="5" href="#overview-install">overview install</a>:             Installation and uninstallation. 
<li><a accesskey="6" href="#overview-restrictions">overview restrictions</a>:        Implementation restrictions. 
</ul>

<!-- page -->
<div class="node">
<a name="overview-original"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-tech">overview tech</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview">overview</a>

</div>

<h3 class="section">1.1 Original Ikarus Scheme</h3>

<p>The original Ikarus Scheme package is distributed under the terms of the
<acronym>GNU</acronym> General Public License (<acronym>GPL</acronym>) and can be downloaded from:

<div align="center"><a href="http://www.ikarus-scheme.org/">http://www.ikarus-scheme.org/</a></div>

<p class="noindent">or:

<div align="center"><a href="https://launchpad.net/ikarus">https://launchpad.net/ikarus</a></div>

   <p>It was developed by Abdulaziz Ghuloum until the beginning of year 2010;
at that time the Vicare fork was started.

<!-- page -->
<div class="node">
<a name="overview-tech"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-resources">overview resources</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-original">overview original</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview">overview</a>

</div>

<h3 class="section">1.2 Technology overview</h3>

<p>Vicare Scheme provides the programmer with many advantages:

     <dl>
<dt><strong>Optimizing code generator</strong><dd>The compiler's backend employs state of the art technologies in code
generation that produce fast, efficient, machine code.  When developing
computationally intensive programs, one is not constrained by using a
slow interpreter.

     <br><dt><strong>Fast incremental compilation</strong><dd>Every library and script is quickly compiled to native machine code. 
When developing large software, one is not constrained by how slow the
batch compiler runs.

     <br><dt><strong>Robust and fine&ndash;tuned standard libraries</strong><dd>The standard libraries are written such that they perform as much error
checking as required to provide a safe and fast runtime environment.

     <br><dt><strong>Multi&ndash;generational garbage collector</strong><dd>The BiBOP based garbage collector used in Vicare allows the runtime
system to expand its memory footprint as needed.  The entire 32-bit
virtual address space could be used and unneeded memory is released back
to the operating system.

     <br><dt><strong>Supports many operating systems</strong><dd>Vicare runs on the most popular and widely used operating systems for
servers and personal computers.  The supported systems include Mac OS X,
<acronym>GNU</acronym>+Linux, FreeBSD, NetBSD, and Microsoft Windows (under Cygwin). 
</dl>

<!-- page -->
<div class="node">
<a name="overview-resources"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-system">overview system</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-tech">overview tech</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview">overview</a>

</div>

<h3 class="section">1.3 Resources</h3>

<p>The Vicare Scheme package is distributed under the terms of the <acronym>GNU</acronym>
General Public License (<acronym>GPL</acronym>) and can be downloaded from:

<div align="center"><a href="http://github.com/marcomaggi/vicare/downloads">http://github.com/marcomaggi/vicare/downloads</a></div>

<p class="noindent">the home page of the project is at:

<div align="center"><a href="http://marcomaggi.github.com/vicare.html">http://marcomaggi.github.com/vicare.html</a></div>

<p class="noindent">development takes place at:

<div align="center"><a href="http://github.com/marcomaggi/vicare/">http://github.com/marcomaggi/vicare/</a></div>

   <p>Newcomers to Scheme should refer to <a href="http://www.schemers.org">http://www.schemers.org</a>,
which contains listings of tutorials and books that are helpful in
learning the language.

   <p>This document is a supplement to the <em>Revised^6 Report on the
Algorithmic Language Scheme</em>, found at <a href="http://www.r6rs.org">http://www.r6rs.org</a>. 
Kent Dybvig's <em>The Scheme Programming Language</em>, Fourth Edition, is
an excellent tutorial and reference for <acronym>R6RS</acronym>.  Some extended
features of Vicare have been inspired by similar features in
<em>Chez Scheme</em>; the <em>Chez Scheme User's Guide</em> can be found at
the same site.

<!-- page -->
<div class="node">
<a name="overview-system"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-install">overview install</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-resources">overview resources</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview">overview</a>

</div>

<h3 class="section">1.4 System requirements</h3>

<p>To run Vicare Scheme, we will need a system with a relatively recent
Intel <em>x86</em> processor; Vicare requires a Unix/Linux
operating system (or emulation), and some prerequisite libraries.

<ul class="menu">
<li><a accesskey="1" href="#overview-system-hardware">overview system hardware</a>:     Hardware requirements. 
<li><a accesskey="2" href="#overview-system-software">overview system software</a>:     Software requirements. 
</ul>

<!-- page -->
<div class="node">
<a name="overview-system-hardware"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-system-software">overview system software</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview-system">overview system</a>

</div>

<h4 class="subsection">1.4.1 Hardware requirements</h4>

<p>Vicare Scheme runs on the IA-32 (<em>x86</em>) architecture supporting
<acronym>SSE2</acronym> extensions.  This includes the Athlon 64, Sempron 64, and
Turion 64 processors from <acronym>AMD</acronym> and the Pentium 4, Xeon,
Celeron, Pentium M, Core, and Core2 processors from Intel.  The system
does not run on Intel Pentium III or earlier processors.

   <p>The Vicare compiler generates <acronym>SSE2</acronym> instructions to
handle Scheme's <acronym>IEEE</acronym> floating point representation
(<em>flonums</em>) for inexact numbers.

<h5 class="subsubheading">Operating systems</h5>

<p>Vicare is tested under the following operating systems; in
general, any later version of one of these systems should be usable:

     <ul>
<li>Mac OS X version 10.4 and 10.5.

     <li>Linux 2.6.18 (Debian, Fedora, Gentoo, and Ubuntu).

     <li>FreeBSD version 6.2.

     <li>NetBSD version 3.1.

     <li>Microsoft Windows XP, using Cygwin 1.5.24 (<a href="http://cygwin.org">http://cygwin.org</a>). 
</ul>

<!-- page -->
<div class="node">
<a name="overview-system-software"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-system-hardware">overview system hardware</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview-system">overview system</a>

</div>

<h4 class="subsection">1.4.2 Software requirements</h4>

<p>We will need some additional libraries and tools to build
Vicare Scheme.

     <dl>
<dt><strong>GMP</strong><dd>Vicare uses the <acronym>GNU</acronym> Multiple Precision Arithmetic Library
(<acronym>GMP</acronym>) for some bignum arithmetic operations.  To build
Vicare from scratch, <acronym>GMP</acronym> version 4.2 or better must be
installed along with the required header files.  Pre&ndash;built <acronym>GMP</acronym>
packages are available for most operating systems.  Alternatively,
<acronym>GMP</acronym> can be downloaded from <a href="http://gmplib.org/">http://gmplib.org/</a>.

     <p>The <acronym>GMP</acronym> web page points out that <acronym>GMP</acronym> has revealed subtle bugs in
many C compilers.  Although the <acronym>GMP</acronym> build process includes a
comprehensive self&ndash;test (which we absolutely must run if building it
ourselves), we may still prefer to obtain a prebuilt binary version for
our system, if one is available.

     <blockquote>
<strong>NOTE</strong> Vicare runs in 32-bit mode only.  To run it in
64-bit environments, we will have to obtain the 32-bit version of
<acronym>GMP</acronym>, or compile it ourselves after adding <code>ABI=32</code> to its
configuration options. 
</blockquote>

     <br><dt><strong>libffi</strong><dd>We will probably need <code>libffi</code>, a C library that simplifies
run&ndash;time calls to arbitrary C functions.  Vicare will operate
without <code>libffi</code>, but will not be able to call foreign procedures
(those written in C).  <code>libffi</code> can be downloaded from
<a href="http://sourceware.org/libffi">http://sourceware.org/libffi</a>.

     <br><dt><strong>GCC</strong><dd>The <acronym>GNU</acronym> C Compiler is required to build the Vicare
executable (e.g. the garbage collector, loader, and OS&ndash;related
runtime).  <acronym>GCC</acronym> versions 4.1 and 4.2 were successfully used to build
Vicare.  It may be possible to build Vicare using
other C compilers.

     <br><dt><strong>Autoconf and Automake</strong><dd>The <acronym>GNU</acronym> Autoconf (version 2.61) and <acronym>GNU</acronym> Automake (version 1.10)
tools are required if one wishes to modify the Vicare source
base.  They are not required to build the official release of
Vicare.

     <p>Prebuilt packages for these tools have been created for most Unix/Linux
systems; if we prefer, we can download the source code from
<a href="http://www.gnu.org/software/autoconf">http://www.gnu.org/software/autoconf</a> and
<a href="http://www.gnu.org/software/automake">http://www.gnu.org/software/automake</a> respectively, and build
them ourselves.

     <br><dt><strong>Texinfo</strong><dd>This document is provided in Texinfo format.  Texinfo is available as an
installable package for most Unix/Linux systems.  Alternatively, we can
download the source package
<a href="http://www.gnu.org/software/texinfo">http://www.gnu.org/software/texinfo</a>. 
</dl>

<!-- page -->
<div class="node">
<a name="overview-install"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-restrictions">overview restrictions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-system">overview system</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview">overview</a>

</div>

<h3 class="section">1.5 Installation and uninstallation</h3>

<p><a name="index-Installing-_0040value_007bPRJNAME_007d-1"></a><a name="index-Uninstalling-_0040value_007bPRJNAME_007d-2"></a><a name="index-Disinstalling-_0040value_007bPRJNAME_007d-3"></a><a name="index-g_t_0040value_007bPRJNAME_007d_002c-installing-4"></a><a name="index-g_t_0040value_007bPRJNAME_007d_002c-uninstalling-5"></a><a name="index-g_t_0040value_007bPRJNAME_007d_002c-disinstalling-6"></a>

   <p>There are two ways to install Vicare Scheme on our system: we can
either install a prebuilt package, if one is available for our operating
system, or we can build it from source.  There are two reasons to prefer
the &ldquo;build from source&rdquo; approach: first, not all Unix/Linux package
repositories have an Vicare Scheme package at all; second, prebuilt
packages often lag current revisions to the system by a considerable
amount.  Therefore, the version we install from a package repository
might not even have some of the features documented in this manual.

   <p>We will assume in this section that we are building Vicare Scheme
ourselves.  Vicare uses the standard installation method found
in most other Unix software.  Thus we will follow the usual steps.

     <ol type=1 start=1>
<li>Download the software.

     <li>Set configuration options.

     <li>Build and install
        </ol>

<ul class="menu">
<li><a accesskey="1" href="#overview-install-quick">overview install quick</a>:               Quick installation guide. 
<li><a accesskey="2" href="#overview-install-prerequisites">overview install prerequisites</a>:       Installing the prerequisites. 
<li><a accesskey="3" href="#overview-install-details">overview install details</a>:             Installation details. 
<li><a accesskey="4" href="#overview-install-uninstall">overview install uninstall</a>:           Uninstalling Vicare. 
</ul>

<!-- page -->
<div class="node">
<a name="overview-install-quick"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-install-prerequisites">overview install prerequisites</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview-install">overview install</a>

</div>

<h4 class="subsection">1.5.1 Quick installation guide</h4>

<p>If familiar with installing Unix software on our system, then all we
need to know is that Vicare uses the standard installation
method found in most other Unix software.  Simply run the following
commands from the shell:

<pre class="example">     $ tar -xvzf vicare-n.n.n.tar.gz
     $ cd vicare-n.n.n
     $ ./configure [--prefix=path] [CFLAGS=-I/dir] [LDFLAGS=-L/dir]
     $ make
     $ make install
</pre>
   <p class="noindent"><a href="#overview-install-details">overview install details</a> for how to enable the foreign functions
interface.

   <p>To uninstall Vicare Scheme, use the following steps:

<pre class="example">     $ cd path/to/vicare-n.n.n
     $ make uninstall
</pre>
   <p>The rest of this section gives more detail on building, installing, and
uninstalling Vicare Scheme.

<!-- page -->
<div class="node">
<a name="overview-install-prerequisites"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-install-details">overview install details</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-install-quick">overview install quick</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview-install">overview install</a>

</div>

<h4 class="subsection">1.5.2 Installing the prerequisites</h4>

<p>The first step is to ensure that we have <acronym>GMP</acronym> and Libffi installed; we
should generally use our system's package manager for these.  Note where
the include (<code>.h</code>) and library (<code>.a</code>) files for each of these
packages are installed.  (Typically this will be in either
<samp><span class="file">/usr/include</span></samp> and <samp><span class="file">/usr/lib</span></samp>, or
<samp><span class="file">/usr/local/include</span></samp> and <samp><span class="file">/usr/local/lib</span></samp>.)

   <p>If we choose to download these as source and build them ourselves, refer
to the installation instructions found in each package.  If we are
installing <acronym>GMP</acronym> from source, it is <em>essential</em> that we run the
self&ndash;tests after building, and verify that no errors were detected.  We
do this by issuing the command <samp><span class="command">make check</span></samp>; see the
documentation for details.

<!-- page -->
<div class="node">
<a name="overview-install-details"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-install-uninstall">overview install uninstall</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-install-prerequisites">overview install prerequisites</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview-install">overview install</a>

</div>

<h4 class="subsection">1.5.3 Installation details</h4>

<p>We have two choices for downloading the Vicare Scheme source: we can
either download a distribution from:

<div align="center"><a href="http://github.com/marcomaggi/vicare/downloads">http://github.com/marcomaggi/vicare/downloads</a></div>

<p class="noindent">or we can checkout a revision from the GitHub repository:

<div align="center"><a href="http://github.com/marcomaggi/vicare/">http://github.com/marcomaggi/vicare/</a></div>

     <ul>
<li>Vicare Scheme source distributions are tarballs named
<samp><span class="file">vicare-</span><var>n.n.n</var><span class="file">.tar.gz</span></samp>, where <samp><var>n.n.n</var></samp> is a
3&ndash;component ID indicating the current revision.

     <p>If we downloaded a distribution, unpack it.  From the shell prompt:

     <pre class="example">          $ tar -xvzf vicare-<var>n.n.n</var>.tar.gz
</pre>
     <p class="noindent">this creates the base directory <samp><span class="file">vicare-</span><var>n.n.n</var></samp>.

     <li>If we downloaded a bleeding&ndash;edge snapshot, no unpacking is needed. 
</ul>

   <p>We configure the build system by running the <samp><span class="command">configure</span></samp> script
located in the base directory.  To do this, type the following commands:

<pre class="example">     $ cd vicare-<var>n.n.n</var>
     $ ./configure
     checking build system type... i386-apple-darwin8.10.1
     checking host system type... i386-apple-darwin8.10.1
     ...
     configure: creating ./config.status
     config.status: creating Makefile
     config.status: creating src/Makefile
     config.status: creating scheme/Makefile
     config.status: creating doc/Makefile
     config.status: executing depfiles commands
</pre>
   <p>This configures the system to be built then installed in the
system&ndash;wide location (binaries are normally installed in
<samp><span class="file">/usr/local/bin</span></samp>).  To install it in another location (e.g. in
your home directory), provide a <samp><span class="option">--prefix</span></samp> location to
<samp><span class="command">configure</span></samp> as follows:

<pre class="example">     $ ./configure --prefix=/opt/sw
</pre>
   <p class="noindent">this will install the executable in <samp><span class="file">/opt/sw/bin</span></samp>, libraries in
<samp><span class="file">/opt/sw/lib/ikarus</span></samp>, and documentation in
<samp><span class="file">/opt/sw/share/doc/ikarus</span></samp>.

   <p>To install Vicare Scheme for personal use (thus not requiring root
permissions to install), specify <code>--prefix=$HOME/local</code>, which
installs everything in a <samp><span class="file">local</span></samp> directory of our home directory.

   <p><samp><span class="command">configure</span></samp> allows us to fine&ndash;tune where things are installed,
though this is rarely necessary or useful.  Do
<code>./configure&nbsp;--help</code> for a full list of options.

   <p>The most common <samp><span class="command">configure</span></samp> options are as follows.

     <dl>
<dt><samp><span class="option">--prefix</span></samp><dd>Specify the location in the file system where Vicare Scheme will be
installed.

     <br><dt><samp><span class="option">--enable-ffi</span></samp><dd>Include Vicare Scheme's Foreign Function Interface, so that
Vicare code can invoke C code, and vice versa; requires Libffi.

     <br><dt><samp><span class="env">CFLAGS</span></samp><dd>Specify options to be used while compiling Vicare's C code.

     <br><dt><samp><span class="env">CPPFLAGS</span></samp><dd>Specify options to be used while preprocessing Vicare's C code.

     <br><dt><samp><span class="env">LDFLAGS</span></samp><dd>Specify options to be used while linking Vicare. 
</dl>

   <p><samp><span class="command">configure</span></samp> will fail if it cannot find the location where
<acronym>GMP</acronym> is installed.  The script will also fail if we have specified
<samp><span class="option">--enable-ffi</span></samp> and it can't find Libffi.  If running
<samp><span class="command">configure</span></samp> fails to locate either of these libraries, we will
need to provide their locations.  Use the <samp><span class="env">CPPFLAGS</span></samp> and
<samp><span class="env">LDFLAGS</span></samp> options to specify the locations of the header and library
files.

   <p>For example, assume that we have installed <acronym>GMP</acronym> and Libffi in
subdirectories of <samp><span class="file">/opt/sw</span></samp>, and we wish to support foreign
functions.<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a>

<pre class="example">     ./configure                                                  \
       --prefix=$HOME/local                                       \
       --enable-ffi                                               \
       CPPFLAGS="-I/opt/sw/gmp/include -I/opt/sw/libffi/include"  \
       LDFLAGS="-L/opt/sw/gmp/lib -L/opt/sw/libffi/lib"
</pre>
   <p>We can use the <samp><span class="env">CFLAGS</span></samp> and <samp><span class="env">LDFLAGS</span></samp> variables to select more
specialized compilation and linking options; refer to the compiler
documentation for more details.

   <p>We can now build the system by running the command <samp><span class="command">make</span></samp>, with
no arguments; this performs two tasks:

     <ol type=1 start=1>
<li>It builds the <samp><span class="command">vicare</span></samp> executable from the C files located in
the <samp><span class="file">src</span></samp> directory.

     <li>It uses the <samp><span class="command">vicare</span></samp> executable and the pre&ndash;built
<samp><span class="file">ikarus.boot.orig</span></samp> boot file to rebuild the Scheme boot image file
<samp><span class="file">vicare.boot</span></samp> from the Scheme sources located in the <samp><span class="file">scheme</span></samp>
directory.
        </ol>

   <p>The final stage is to install Vicare via the command
<samp><span class="command">make install</span></samp>.  If we're installing Vicare in a
system&ndash;wide location, we probably need to have administrator privileges
(use the <samp><span class="command">sudo</span></samp> or <samp><span class="command">su</span></samp> commands); if that's not
feasible, then we need to reconfigure to install within a directory tree
under our home directory.

   <p>Finally, try a small session, to verify that everything installed
properly.

<pre class="example">     $ vicare
     Vicare Scheme version 0.1d0+ \
       (revision master/d844c006eb9ada1a047be3893d0dd40f8ae6204a, \
       build 2010-05-02)
     Copyright (c) 2006-2010 Abdulaziz Ghuloum and contributors
     
     &gt; (display "hello, world!\n")
     hello, world!
     &gt; (define twice (lambda (f) (lambda (x) (f (f x)))))
     &gt; ((twice add1) 3)
     5
</pre>
   <p>If we get the first <code>&gt;</code> prompt, then Vicare was
successfully installed on the system.  We may need to update the
<samp><span class="env">PATH</span></samp> variable in environment to contain the directory in which the
<samp><span class="command">vicare</span></samp> executable was installed.

   <p>Finally, do <samp><span class="command">make clean</span></samp> to get rid of executables, object
files, and other build products in the <samp><span class="file">vicare-</span><var>n.n.n</var></samp>
directory.  Do not delete the directory itself: it will be needed if we
ever want to uninstall Vicare.

<!-- page -->
<div class="node">
<a name="overview-install-uninstall"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-install-details">overview install details</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview-install">overview install</a>

</div>

<h4 class="subsection">1.5.4 Uninstalling Vicare</h4>

<p><a name="index-g_t_0040value_007bPRJNAME_007d_002c-uninstalling-7"></a><a name="index-g_t_0040value_007bPRJNAME_007d_002c-disinstalling-8"></a><a name="index-Disinstalling-_0040value_007bPRJNAME_007d-9"></a><a name="index-Uninstalling-_0040value_007bPRJNAME_007d-10"></a>

   <p>To uninstall Vicare Scheme, go to the directory we built
Vicare in (not the directory where you installed it), and do
<samp><span class="command">make uninstall</span></samp>.

<pre class="example">     $ cd path/to/vicare-<var>n.n.n</var>
     $ make uninstall
</pre>
   <!-- page -->
<div class="node">
<a name="overview-restrictions"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-install">overview install</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview">overview</a>

</div>

<h3 class="section">1.6 Implementation restrictions</h3>

<p>Here is a list of implementations constraints which may be
non&ndash;compliant with <acronym>R6RS</acronym>.

     <ol type=1 start=1>
<li>Scheme strings can hold at most <code>(greatest-fixnum)</code> characters; the
length of a string and all the valid indexes into strings are
representable as fixnums.

     <li>Scheme bytevectors can hold at most <code>(greatest-fixnum)</code> bytes; the
length of a bytevector and all the valid indexes into bytevectors are
representable as fixnums.
        </ol>

<!-- page -->
<div class="node">
<a name="using"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib">iklib</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview">overview</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">2 Using Vicare</h2>

<p>Once Vicare Scheme is properly installed, we can invoke it either in
an interactive terminal session or as the interpreter for invoking a
script.

   <p><a name="index-Command-line-11"></a><a name="index-Invoking-_0040value_007bPRJNAME_007d-12"></a>

<ul class="menu">
<li><a accesskey="1" href="#using-interactive">using interactive</a>:            Interactive sessions. 
<li><a accesskey="2" href="#using-invoking">using invoking</a>:               Command line arguments. 
<li><a accesskey="3" href="#using-script">using script</a>:                 Using <samp><span class="command">scheme-script</span></samp>. 
<li><a accesskey="4" href="#using-libraries">using libraries</a>:              <acronym>R6RS</acronym> libraries. 
</ul>

<!-- page -->
<div class="node">
<a name="using-interactive"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#using-invoking">using invoking</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using">using</a>

</div>

<h3 class="section">2.1 Interactive sessions</h3>

<p>If we want an interactive session, use a bare <samp><span class="command">vicare</span></samp>
command, with no options.

<pre class="example">     $ vicare
     Vicare Scheme version 0.1d0+ \
       (revision master/d844c006eb9ada1a047be3893d0dd40f8ae6204a, \
        build 2010-05-02)
     Copyright (c) 2006-2010 Abdulaziz Ghuloum and contributors
     
     &gt; (+ 2 2)
     4
</pre>
   <p class="noindent">end&ndash;of&ndash;file (&lt;Ctrl-D&gt; in a typical terminal window) will terminate
the session.

<!-- page -->
<div class="node">
<a name="using-invoking"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#using-script">using script</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#using-interactive">using interactive</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using">using</a>

</div>

<h3 class="section">2.2 Command line arguments</h3>

<p>The <samp><span class="command">vicare</span></samp> executable recognizes a few command line switches
that influence how Vicare Scheme starts.  The following are the main
options, driving the execution mode.

     <dl>
<dt><code>vicare -h</code><dd>The presence of the <samp><span class="option">-h</span></samp> flag causes <samp><span class="command">vicare</span></samp> to
display a help message then to exit; the help message summarizes the
command line switches.  No further action is performed.

     <br><dt><code>vicare -b path/to/boot/file.boot</code><dt><code>vicare --boot path/to/boot/file.boot</code><dd>The <samp><span class="option">-b</span></samp> flag (which requires an extra argument) directs
<samp><span class="command">vicare</span></samp> to use the specified boot file as the initial system
boot file.  The boot file is a binary file that contains all the code
and data of the Scheme system.  In the absence of the <samp><span class="option">-b</span></samp> flag,
the executable will use the default boot file.  Running
<samp><span class="command">vicare -h</span></samp> shows the location where the default
boot file was installed.

     <p>The rest of the command line arguments are recognized by the standard
Scheme run time system.  They are processed after the boot file is
loaded.

     <br><dt><code>vicare --r6rs-script script-file-name [arguments ...]</code><dd>The <samp><span class="option">--r6rs-script</span></samp> option instructs Vicare that the
supplied file is an <acronym>R6RS</acronym> script.  The script file name and any
additional optional <code>arguments</code> can be obtained by calling the
<code>command-line</code> procedure.

     <pre class="example">          $ cat test.sps
          (import (rnrs))
          (write (command-line))
          (newline)
          
          $ vicare --r6rs-script test.sps hi there
          ("test.sps" "hi" "there")
</pre>
     <br><dt><code>vicare --script script-file-name [arguments ...]</code><dd>The <samp><span class="option">--script</span></samp> option instructs Vicare that the supplied
file is a Scheme script.  The script file name and any additional
optional <code>arguments</code> can be obtained by calling the
<code>command-line</code> procedure.

     <pre class="example">          $ cat test.sps
          (write (command-line))
          (newline)
          
          $ vicare --script test.sps hi there
          ("test.sps" "hi" "there")
</pre>
     <p>When <samp><span class="option">--script</span></samp> is used: all the scripts loaded are accepted as
Scheme scripts without the <code>import</code> or <code>library</code> forms.

     <br><dt><code>vicare --r6rs-repl &lt;FILE&gt; ... [-- arguments ...]</code><dd>Start interactive mode, but load and evaluate <samp><span class="file">FILE</span></samp> first.

     <br><dt><code>vicare --compile-dependencies &lt;FILE&gt; ... [-- arguments ...]</code><dd>Load the program or library <samp><span class="file">FILE</span></samp> and compile all the libraries on
which it depends.

     <br><dt><code>vicare &lt;file&gt; ... [-- arguments ...]</code><dd>The lack of an <samp><span class="option">--r6rs-script</span></samp> argument causes Vicare to
start in interactive mode.  Each <code>file</code> is first loaded in the
interaction environment.  The interaction environment initially contains
all the bindings exported from the <code>(ikarus)</code> library.

     <p>The optional <code>arguments</code> following the <code>--</code> marker can be
obtained by calling the <code>command-line</code> procedure.  In interactive
mode, the first element of the returned list will be the string
<code>*interactive*</code>, corresponding to the script name in
<acronym>R6RS</acronym>&ndash;script mode.

     <blockquote>
<strong>NOTE</strong> <acronym>R6RS</acronym> lives in a somewhat uneasy tension with a
standard Scheme <acronym>REPL</acronym> (read&ndash;eval&ndash;print loop), which the
Report effectively does not define.  In particular, the effect of
reimporting a module, as you might do when reloading and rerunning a
program, isn't well&ndash;defined by <acronym>R6RS</acronym>.

     <p>This is a limitation caused by the particular design choices made in
<acronym>R6RS</acronym>; it's hoped that a future revision to the language will repair
this particular problem.  Even so, we hope to achieve better interaction
between loading and libraries in the future.

     <p>Accordingly, the interactive mode is intended for quick experimenting
with the built&ndash;in features.  It is intended neither for developing
applications nor for writing any substantial piece of code. 
</blockquote>
     </dl>

   <p>The following are additional options turning on/off auxiliary behaviour.

     <dl>
<dt><code>-d</code><dt><code>--debug</code><dd>Turn on debugging mode.  With this unhandled exceptions in the program
will result in starting the debugger, which allows stack trace
inspection.

     <br><dt><code>-nd</code><dt><code>--no-debug</code><dd>Turn off debugging mode.

     <br><dt><code>-O0</code><dt><code>-O1</code><dt><code>-O2</code><dd>Turn on various levels of compile optimisations.

     <br><dt><code>--no-rcfile</code><dd>Disable loading of run&ndash;command files.

     <br><dt><code>--rcfile &lt;FILE&gt;</code><dd>Load and evaluate <samp><span class="file">file</span></samp> at startup, before running the script. 
The file must hold a proper <acronym>R6RS</acronym> program, beginning with the
<code>import</code> clause. 
</dl>

<!-- page -->
<div class="node">
<a name="using-script"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#using-libraries">using libraries</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#using-invoking">using invoking</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using">using</a>

</div>

<h3 class="section">2.3 Using <samp><span class="command">scheme-script</span></samp></h3>

<p>Scheme scripts can be executed using the following command:

<pre class="example">     vicare --r6rs-script <var>script-name</var>
</pre>
   <p class="noindent">Vicare Scheme does <strong>not</strong> follow the <acronym>R6RS</acronym> recommendations
and does not install a wrapper program called <samp><span class="command">scheme-script</span></samp> to
avoid conflicts with other Scheme implementations.

   <p>Here is a sample script (Pig Latin&mdash;&ldquo;Igpay Atinlay&rdquo;&mdash;is a code that
was at one time popular among very young North American children).

<pre class="example">     (import (rnrs))
     
     ;;; Convert a string to its Pig Latin equivalent.
     ;;;
     ;;; If the first character is a vowel, append "yay".
     ;;; "egg" -&gt; "eggyay"
     ;;;
     ;;; If the first character is a consonant, remove it,
     ;;; and append it plus "ay" to the string.
     ;;; "foo" -&gt; "oofay"
     
     (define pig-latin
       (lambda (str)
         (let ((first (string-ref str 0)))
           (if (memv first '(#\a #\e #\i #\o #\u))
     	  (string-append str "yay")
     	  (string-append
      	    (substring str 1 (string-length str))
     	    (string first) "ay")))))
     
     (display
      (map pig-latin
          (cdr (command-line))))
     (newline)
</pre>
   <p>Assuming we have stored the script in the file <samp><span class="file">demo.sps</span></samp>, we can
invoke this script via <samp><span class="command">vicare</span></samp>:

<pre class="example">     $ vicare --r6rs-script demo.sps ice cream after dinner
     (iceyay reamcay afteryay innerday)
</pre>
   <p>On Unix/Linux systems, scripts generally start with a &ldquo;shebang&rdquo; line
(<em>sh</em>arp plus <em>bang</em>) which names an interpreter for the
script.  All modern systems have the <samp><span class="command">env</span></samp> command which
searches for a command in the user's path.

<pre class="example">     #!/usr/bin/env vicare --r6rs-script
     (import (rnrs))
     
     ...
</pre>
   <p>Now we can make the file executable, and use it directly.

<pre class="example">     $ chmod +x demo.sps
     $ ./demo.sps ice cream after dinner
     (iceyay reamcay afteryay innerday)
</pre>
   <p>There are a few fine points.

     <ul>
<li>If the first two bytes of a script represent the sequence &lsquo;<samp><span class="samp">#!</span></samp>&rsquo; in
<acronym>ASCII</acronym> encoding: the first line is discarded and not parsed as Scheme
code.  This allows scripts on Unix systems to start with the command
line needed to use them; notice that this will discard valid sharp&ndash;bang
comments (like <code>#!r6rs</code>) if the are at the very beginning of a
file.

     <li>Under Mac OS X, if a script name ends with the <code>.command</code>
extension, then it can be executed from the Finder by double&ndash;clicking
on it.  This brings up a terminal window in which the script is
executed.  The <code>.command</code> extension can be hidden from the
<em>Get Info</em> item from the Finder's File menu. 
</ul>

<!-- page -->
<div class="node">
<a name="using-libraries"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#using-script">using script</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using">using</a>

</div>

<h3 class="section">2.4 <acronym>R6RS</acronym> libraries</h3>

<p>A library exports features that can be imported into programs; a library
is named by a list, e.g., <code>(yoyodyne
block-transfer-computations)</code>.  The core features of the language is
provided in the library <code>(rnrs)</code>.

<ul class="menu">
<li><a accesskey="1" href="#using-libraries-intro">using libraries intro</a>:        Introduction to Vicare libraries. 
<li><a accesskey="2" href="#using-libraries-searching">using libraries searching</a>:    How Vicare finds libraries. 
<li><a accesskey="3" href="#using-libraries-summary">using libraries summary</a>:      Library search summary. 
<li><a accesskey="4" href="#using-libraries-examples">using libraries examples</a>:     Examples of libraries usage. 
</ul>

<!-- page -->
<div class="node">
<a name="using-libraries-intro"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#using-libraries-searching">using libraries searching</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using-libraries">using libraries</a>

</div>

<h4 class="subsection">2.4.1 Introduction to libraries</h4>

<p>A library consists of a &ldquo;file&rdquo; (some assemblage of text) that contains
a library form, which might look like this:

<pre class="example">     (library (sample)
       (export cube)
       (import (rnrs))
       (define cube
         (lambda (x)
           (* x x x))))
</pre>
   <p class="noindent">notice the <code>import</code> clause; libraries have no predefined namespace,
and therefore at least <code>(rnrs)</code> must be imported.

   <p>We can import <code>(sample)</code> into another library, a script, or a
Vicare top&ndash;level session:

<pre class="example">     &gt; (import (sample))
     &gt; (cube 3)
     27
</pre>
   <p>Library names are lists, thus allowing the writer of one or more
libraries to group related libraries together.  For example, as well as
<code>(yoyodyne block-transfer-computations)</code>, we might also have
<code>(yoyodyne tardis navigation)</code> and <code>(yoyodyne tardis
diagnostics)</code>.  Leaving the parentheses off a single&ndash;component library
name is a common error.

<!-- page -->
<div class="node">
<a name="using-libraries-searching"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#using-libraries-summary">using libraries summary</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#using-libraries-intro">using libraries intro</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using-libraries">using libraries</a>

</div>

<h4 class="subsection">2.4.2 How Vicare finds libraries</h4>

<p>In Vicare, a library is a file with the same name as the last
component of the library name.  For example, the library
<code>(sample)</code> will correspond to a file named <samp><span class="file">sample.sls</span></samp>
somewhere in the file system.  The file extension <code>sls</code> stands for
&ldquo;Scheme library source&rdquo;; although Vicare will also accept the
extensions <code>ss</code> and <code>scm</code>, these really indicate scripts,
rather than libraries.

   <p>Vicare has a search algorithm for libraries that is similar to
those used in other languages.  Its search path comprises a series of
directories.  When we try to import a library whose name contains just
one component, Vicare will examine each directory in the search
path for a file with a matching name.  Importing a library whose name is
a list of components causes Vicare to match to a series of
subdirectories with matching names.

   <p>Here is an example of each case:

     <ul>
<li>Importing <code>(sample)</code> causes Vicare to look in each
directory on the path for a file named <samp><span class="file">sample.sls</span></samp>.

     <li>Importing <code>(yoyodyne sample)</code> causes Vicare to look in
each directory on the path for a directory named <samp><span class="file">yoyodyne</span></samp>, and
within that a file named <samp><span class="file">sample.sls</span></samp>.  (The <code>library</code> form
for this library must still specify the library name as
<code>(yoyodyne sample)</code>, not <code>(sample)</code>.) 
</ul>

   <p>Vicare always places its own libraries at the end of the search
path.  Other library directories can be added to the search path in two
ways: by modifying an environment variable, or by setting
Vicare's <code>library-path</code> parameter.  Vicare
consults the environment variable <samp><span class="env">VICARE_LIBRARY_PATH</span></samp> at the
beginning of execution, and places each of the directories there into
its search path.  The search path is then set to the value of the
parameter <code>library-path</code>, which can be updated as necessary.

<pre class="example">     $ export VICARE_LIBRARY_PATH=$HOME/scheme:/tmp/library
     $ echo $VICARE_LIBRARY_PATH
     /home/someuser/scheme:/tmp/library
     $ vicare
     ...
     
     &gt; (library-path)
     ("/home/someuser/scheme" "/tmp/library"
       "/home/someuser/local/lib/vicare")
     &gt; (library-path (cons "/opt/sw/extra-libraries" (library-path)))
     &gt; (library-path)
     ("/opt/sw/extra-libraries" "/home/someuser/scheme"
       "/tmp/library" "/home/someuser/local/lib/vicare")
</pre>
   <p class="noindent">In this example, the user sets <samp><span class="env">VICARE_LIBRARY_PATH</span></samp> before the
session; the settings are reflected in the value of
<code>(library-path)</code>.  A further directory is then set during the
session.

   <p>In programs intended to be distributed, you should resist the urge to
set <code>(library-path)</code>, as the user's file hierarchies might not
match yours.  For most libraries, simply telling the user to install the
library in one of the libraries on the search path is good enough.

   <p>There are two refinements of the library search algorithm.

     <ul>
<li>A common pattern is to distribute a main library along with a number of
additional extensions: we might have a main library named <code>(lib)</code>,
and additional optional extensions named <code>(lib extras)</code> and
<code>(lib frills)</code>.  Although the previous packaging method can be
used, Vicare allows you to use a simpler technique where the
main library is stored in <samp><span class="file">lib/main.sls</span></samp>, and the extensions are
stored in <samp><span class="file">lib/extras.sls</span></samp> and <samp><span class="file">lib/frills.sls</span></samp>, respectively.

     <li>Vicare will also look in <samp><span class="file">lib/main.vicare.sls</span></samp> before
trying <samp><span class="file">lib/main.sls</span></samp>.  This allows you to provide an
Vicare&ndash;specific implementation as well as a generic
implementation. 
</ul>

<!-- page -->
<div class="node">
<a name="using-libraries-summary"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#using-libraries-examples">using libraries examples</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#using-libraries-searching">using libraries searching</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using-libraries">using libraries</a>

</div>

<h4 class="subsection">2.4.3 Library search algorithm summary</h4>

<p>Vicare attempts to import the library <code>(a b c)</code> as
follows, for each directory in the search path:

     <ol type=1 start=1>
<li>Build the rootname <samp><span class="file">a/b/c</span></samp>.

     <li>Append each of the following strings to the rootname, in order, until a
matching file is found:

     <pre class="example">          /main.ikarus.sls
          /main.ikarus.ss
          /main.ikarus.scm
          /main.sls
          /main.ss
          /main.scm
          .vicare.sls
          .vicare.ss
          .vicare.scm
          .sls
          .ss
          .scm
</pre>
     </ol>

   <p>If there is no match, then the import is in error.

<!-- page -->
<div class="node">
<a name="using-libraries-examples"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#using-libraries-summary">using libraries summary</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using-libraries">using libraries</a>

</div>

<h4 class="subsection">2.4.4 Examples of library usage</h4>

<p>Consider a program using <code>pretty-print</code> procedure to format some
code, and suppose further that pretty printing is just a nice add&ndash;on
(e.g. using <samp><span class="file">write</span></samp> suffices, but pretty&ndash;printing is <em>just
prettier</em>).

   <p>Vicare exports a good pretty&ndash;printing facility in its
<code>(ikarus)</code> library.  However, since <code>pretty-print</code> is not a
standard procedure, a program that uses it would be rendered unportable
to other <acronym>R6RS</acronym> Scheme implementations.

   <p>The programmer can put the <code>.vicare.*</code> extensions to use in this
situation, by writing two versions of a <code>(pretty-printing)</code>
library: one for use by Vicare, and one portable for other
implementations.

<pre class="example">     ;; pretty-printing.vicare.ss --
     ;;
     ;; Can be used only by Vicare Scheme.
     
     (library (pretty-printing)
       (export pretty-print)
       (import (only (ikarus) pretty-print)))
     
     ;;; end of file
</pre>
   <pre class="example">     ;; pretty-printing.sls --
     ;;
     ;; For any other Scheme implementation, portable though
     ;; not very pretty.
     
     (library (pretty-printing)
       (export pretty-print)
       (import (rnrs))
       (define (pretty-print x port)
         (write x port)
         (newline port)))
     
     ;;; end of file
</pre>
   <!-- page -->
<div class="node">
<a name="iklib"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix">posix</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#using">using</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">3 Extensions library</h2>

<p>In addition to the libraries listed in the <acronym>R6RS</acronym> standard,
Vicare offers the <code>(ikarus)</code> library which provides
additional features; <code>(ikarus)</code> is a composite library, it exports
a superset of all the supported bindings of <acronym>R6RS</acronym>.

<ul class="menu">
<li><a accesskey="1" href="#iklib-conditions">iklib conditions</a>:             Additional condition types. 
<li><a accesskey="2" href="#iklib-reader">iklib reader</a>:                 Extensions to the reader. 
<li><a accesskey="3" href="#iklib-expander">iklib expander</a>:               Interface to the expander. 
<li><a accesskey="4" href="#iklib-environment">iklib environment</a>:            Environments. 
<li><a accesskey="5" href="#iklib-cafe">iklib cafe</a>:                   Cafe. 
<li><a accesskey="6" href="#iklib-structs">iklib structs</a>:                Structures and type descriptors. 
<li><a accesskey="7" href="#iklib-bytevectors">iklib bytevectors</a>:            Additional bytevector functions. 
<li><a accesskey="8" href="#iklib-strings">iklib strings</a>:                Additional string functions. 
<li><a accesskey="9" href="#iklib-symbols">iklib symbols</a>:                Additional symbol functions. 
<li><a href="#iklib-numerics">iklib numerics</a>:               Additional functions on numbers. 
<li><a href="#iklib-load">iklib load</a>:                   Loading source files. 
<li><a href="#iklib-import">iklib import</a>:                 Local library imports. 
<li><a href="#iklib-modules">iklib modules</a>:                Local modules. 
<li><a href="#iklib-parameters">iklib parameters</a>:             Parameters. 
<li><a href="#iklib-gensym">iklib gensym</a>:                 Gensyms. 
<li><a href="#iklib-printing">iklib printing</a>:               Printing. 
<li><a href="#iklib-tracing">iklib tracing</a>:                Tracing. 
<li><a href="#iklib-timing">iklib timing</a>:                 Timing. 
<li><a href="#iklib-guardians">iklib guardians</a>:              Guardians and garbage collection. 
<li><a href="#iklib-io">iklib io</a>:                     Input/output library. 
<li><a href="#iklib-foreign">iklib foreign</a>:                Foreign interface library. 
<li><a href="#iklib-misc">iklib misc</a>:                   Miscellaneous functions. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-conditions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-reader">iklib reader</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.1 Additional condition types</h3>

<ul class="menu">
<li><a accesskey="1" href="#iklib-conditions-spos">iklib conditions spos</a>:        Scheme source code position. 
<li><a accesskey="2" href="#iklib-conditions-eagain">iklib conditions eagain</a>:      Reporting <code>EAGAIN</code> exceptions. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-conditions-spos"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-conditions-eagain">iklib conditions eagain</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-conditions">iklib conditions</a>

</div>

<h4 class="subsection">3.1.1 Scheme source code position</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Condition Type: <b>&amp;source-position</b><var><a name="index-g_t_0026source_002dposition-13"></a></var><br>
<blockquote><p>Condition type used to represent a position in Scheme source code read
from a textual input port; it is derived from <code>&amp;condition</code>.  It
has the following fields:

          <dl>
<dt><code>port-id</code><dd>A Scheme string representing the port identifier, for example the file
name.

          <br><dt><code>byte</code><dd>An exact non&ndash;negative zero&ndash;based integer representing the byte offset
of the position in the source.

          <br><dt><code>character</code><dd>An exact non&ndash;negative zero&ndash;based integer representing the character
offset of the position in the source.

          <br><dt><code>line</code><dd>An exact non&ndash;negative one&ndash;based integer representing the line offset
of the position in the source.

          <br><dt><code>column</code><dd>An exact non&ndash;negative one&ndash;based integer representing the column offset
of the position in the source. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-source-position-condition</b><var> port-id character<a name="index-make_002dsource_002dposition_002dcondition-14"></a></var><br>
<blockquote><p>Build and return a new condition object of type
<code>&amp;source-position</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>source-position-condition?</b><var> obj<a name="index-source_002dposition_002dcondition_003f-15"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a condition object with type
<code>&amp;source-position</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>source-position-port-id</b><var> spos<a name="index-source_002dposition_002dport_002did-16"></a></var><br>
&mdash; Function: <b>source-position-character</b><var> spos<a name="index-source_002dposition_002dcharacter-17"></a></var><br>
<blockquote><p>Accessors for the fields of condition objects of type
<code>&amp;source-position</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-conditions-eagain"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-conditions-spos">iklib conditions spos</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-conditions">iklib conditions</a>

</div>

<h4 class="subsection">3.1.2 Reporting <code>EAGAIN</code> exceptions</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Condition Type: <b>&amp;i/o-eagain</b><var><a name="index-g_t_0026i_002fo_002deagain-18"></a></var><br>
<blockquote><p>Used to signal that a system call returned with <code>errno</code> set to
<code>EAGAIN</code>.  It is derived from <code>&amp;i/o</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-i/o-eagain</b><var><a name="index-make_002di_002fo_002deagain-19"></a></var><br>
<blockquote><p>Return a new condition object of type <code>&amp;i/o-eagain</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>i/o-again-error?</b><var> obj<a name="index-i_002fo_002dagain_002derror_003f-20"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>obj</var> is a condition object of type
<code>&amp;i/o-eagain</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-reader"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-expander">iklib expander</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-conditions">iklib conditions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.2 Reader</h3>

<ul class="menu">
<li><a accesskey="1" href="#iklib-reader-mode">iklib reader mode</a>:            Textual input port modes. 
<li><a accesskey="2" href="#iklib-reader-bv">iklib reader bv</a>:              Additional bytevector syntaxes. 
<li><a accesskey="3" href="#iklib-reader-stx">iklib reader stx</a>:             Miscellaneous additional syntaxes. 
<li><a accesskey="4" href="#iklib-reader-fun">iklib reader fun</a>:             Additional reader functions. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-reader-mode"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-reader-bv">iklib reader bv</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-reader">iklib reader</a>

</div>

<h4 class="subsection">3.2.1 Textual input port modes</h4>

<div class="defun">
&mdash; Reader Syntax: <b>#!vicare</b><var><a name="index-g_t_0023_0021vicare-21"></a></var><br>
&mdash; Reader Syntax: <b>#!ikarus</b><var><a name="index-g_t_0023_0021ikarus-22"></a></var><br>
<blockquote><p>Vicare extends Scheme's lexical syntax (<acronym>R6RS</acronym> Chapter 4) in
a variety of ways including:

          <ul>
<li>End&ndash;of&ndash;file marker, <code>#!eof</code>.

          <li>Gensym syntax, <code>#{gensym}</code>.

          <li>Graph syntax: <code>#nn=</code>, <code>#nn#</code>. 
</ul>

        <p>The syntax extensions are made available by default on all input ports,
until the <code>#!r6rs</code> token is read.  Thus, reading the <code>#!r6rs</code>
token disables all extensions to the lexical syntax on the specific
port, and the <code>#!vicare</code> enables them again.

        <p>When writing code that is intended to be portable across different
Scheme implementations, we should add the <code>#!r6rs</code> token to the top
of every script and library that we write; this allows Vicare
to alert us when using non&ndash;portable features.  When writing code that's
intended to be Vicare&ndash;specific, we should add the
<code>#!vicare</code> token in order to get an immediate error when the code
is run under other implementations.

        <p>The comment <code>#!ikarus</code> is accepted for backwards compatibility with
Ikarus Scheme. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>port-mode</b><var> input-port<a name="index-port_002dmode-23"></a></var><br>
<blockquote><p>Accept an input port as argument and return a symbol among: <code>r6rs</code>,
<code>vicare</code>.  All input ports start under <code>vicare</code> mode and thus
accept Vicare&ndash;specific reader extensions.  When the
<code>#!r6rs</code> token is read from a port, its mode changes to
<code>r6rs</code>.

     <pre class="example">          &gt; (port-mode (current-input-port))
          vicare
          &gt; #!r6rs (port-mode (current-input-port))
          r6rs
          &gt; #!vicare (port-mode (current-input-port))
          vicare
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>set-port-mode!</b><var> input-port mode<a name="index-set_002dport_002dmode_0021-24"></a></var><br>
<blockquote><p>Modifiy the lexical syntax accepted by subsequent calls to <code>read</code>
on the input port.  The mode is a symbol among <code>r6rs</code> and
<code>vicare</code>.  The effect of setting the port mode is similar to
that of reading the <code>#!r6rs</code> or <code>#!vicare</code> token from that
port.

     <pre class="example">          &gt; (set-port-mode! (current-input-port) 'r6rs)
          &gt; (port-mode (current-input-port))
          r6rs
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-reader-bv"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-reader-stx">iklib reader stx</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-reader-mode">iklib reader mode</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-reader">iklib reader</a>

</div>

<h4 class="subsection">3.2.2 Additional bytevector syntaxes</h4>

<p>The following syntaxes are available only when the input port mode is
set to <code>vicare</code>.

<div class="defun">
&mdash; Reader Syntax: <b>#vs8(</b><var>byte</var><b> ...)</b><var><a name="index-g_t_0023vs8_0028_0040var_007bbyte_007d-_002e_002e_002e_0029-25"></a></var><br>
<blockquote><p>Read a bytevector as <code>#vu8(</code><var>octect</var><code> ...)</code> would do, but allow
<var>byte</var> to be in the range [-128, 127]. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vu16l(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu16l_0028_0040var_007bword_007d-_002e_002e_002e_0029-26"></a></var><br>
&mdash; Reader Syntax: <b>#vu16b(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu16b_0028_0040var_007bword_007d-_002e_002e_002e_0029-27"></a></var><br>
&mdash; Reader Syntax: <b>#vu16n(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu16n_0028_0040var_007bword_007d-_002e_002e_002e_0029-28"></a></var><br>
<blockquote><p>Read a bytevector of 16-bit unsigned words stored in little, big and
native endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vs16l(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs16l_0028_0040var_007bword_007d-_002e_002e_002e_0029-29"></a></var><br>
&mdash; Reader Syntax: <b>#vs16b(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs16b_0028_0040var_007bword_007d-_002e_002e_002e_0029-30"></a></var><br>
&mdash; Reader Syntax: <b>#vs16n(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs16n_0028_0040var_007bword_007d-_002e_002e_002e_0029-31"></a></var><br>
<blockquote><p>Read a bytevector of 16-bit signed words stored in little, big and
native endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vu32l(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu32l_0028_0040var_007bword_007d-_002e_002e_002e_0029-32"></a></var><br>
&mdash; Reader Syntax: <b>#vu32b(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu32b_0028_0040var_007bword_007d-_002e_002e_002e_0029-33"></a></var><br>
&mdash; Reader Syntax: <b>#vu32n(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu32n_0028_0040var_007bword_007d-_002e_002e_002e_0029-34"></a></var><br>
<blockquote><p>Read a bytevector of 32-bit unsigned words stored in little, big and
native endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vs32l(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs32l_0028_0040var_007bword_007d-_002e_002e_002e_0029-35"></a></var><br>
&mdash; Reader Syntax: <b>#vs32b(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs32b_0028_0040var_007bword_007d-_002e_002e_002e_0029-36"></a></var><br>
&mdash; Reader Syntax: <b>#vs32n(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs32n_0028_0040var_007bword_007d-_002e_002e_002e_0029-37"></a></var><br>
<blockquote><p>Read a bytevector of 32-bit signed words stored in little, big and
native endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vu64l(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu64l_0028_0040var_007bword_007d-_002e_002e_002e_0029-38"></a></var><br>
&mdash; Reader Syntax: <b>#vu64b(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu64b_0028_0040var_007bword_007d-_002e_002e_002e_0029-39"></a></var><br>
&mdash; Reader Syntax: <b>#vu64n(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu64n_0028_0040var_007bword_007d-_002e_002e_002e_0029-40"></a></var><br>
<blockquote><p>Read a bytevector of 64-bit unsigned words stored in little, big and
native endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vs64l(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs64l_0028_0040var_007bword_007d-_002e_002e_002e_0029-41"></a></var><br>
&mdash; Reader Syntax: <b>#vs64b(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs64b_0028_0040var_007bword_007d-_002e_002e_002e_0029-42"></a></var><br>
&mdash; Reader Syntax: <b>#vs64n(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs64n_0028_0040var_007bword_007d-_002e_002e_002e_0029-43"></a></var><br>
<blockquote><p>Read a bytevector of 64-bit signed words stored in little, big and
native endianness. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-reader-stx"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-reader-fun">iklib reader fun</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-reader-bv">iklib reader bv</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-reader">iklib reader</a>

</div>

<h4 class="subsection">3.2.3 Miscellaneous additional syntaxes</h4>

<p>The following syntaxes are available only when the input port mode is
set to <code>vicare</code>.

<div class="defun">
&mdash; Reader Syntax: <b>|</b><var>symbol</var><b>|</b><var><a name="index-g_t_007c_0040var_007bsymbol_007d_007c-44"></a></var><br>
<blockquote><p>The vertical bars can be used to specify symbols whose name do not
comply with the <acronym>R6RS</acronym> specifications; this syntax is available only
when the port mode is <code>#!vicare</code>.  Examples:

     <pre class="example">          (define port (open-string-input-port "|123|"))
          (set-port-mode! port 'vicare)
          (define sym (read port))
          
          (symbol? sym)           &rArr; #t
          (symbol-&gt;string sym)    &rArr; "123"
</pre>
        <p class="noindent">backslash sequences are allowed in bar symbols:

     <pre class="example">          (define port (open-string-input-port "|123-\x41;\x42;\x43;|"))
          (set-port-mode! port 'vicare)
          (define sym (read port))
          
          (symbol? sym)           &rArr; #t
          (symbol-&gt;string sym)    &rArr; "123-\x41;\x42;\x43;"
</pre>
        <p class="noindent">notice that the sequence of characters <code>|ciao|hello|</code> is split into
<code>ciao</code>, <code>hello</code>, <code>|</code> and the ending vertical bar would
cause an error if read:

     <pre class="example">          (define port (open-string-input-port "|ciao|hello|"))
          (set-port-mode! port 'vicare)
          
          (read port)             &rArr; ciao
          (read port)             &rArr; hello
          (port-eof? port)        &rArr; #f
          (get-char port)         &rArr; #\|
          (port-eof? port)        &rArr; #t
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#!eof</b><var><a name="index-g_t_0023_0021eof-45"></a></var><br>
<blockquote><p>The end&ndash;of&ndash;file marker, <code>#!eof</code>, is an extension to the <acronym>R6RS</acronym>
syntax.  The primary utility of the <code>#!eof</code> marker is to stop the
reader (e.g. <code>read</code> and <code>get-datum</code>) from reading the rest of
the file.

     <pre class="example">          (import (ikarus))
          &lt;some code&gt;
          (display "goodbye\n")
          
          #!eof
          &lt;some junk&gt;
</pre>
        <p>The <code>#!eof</code> marker also serves as a datum in Vicare, much
like <code>#t</code> and <code>#f</code>, when it is found inside other expressions.

     <pre class="example">          &gt; (eof-object)
          #!eof
          &gt; (read (open-input-string ""))
          #!eof
          &gt; (read (open-input-string "#!eof"))
          #!eof
          &gt; (quote #!eof)
          #!eof
          &gt; (eof-object? '#!eof)
          #t
          &gt; #!r6rs #!eof
          Unhandled exception
          Condition components:
            1. &amp;error
            2. &amp;who: tokenize
            3. &amp;message: "invalid syntax: #!e"
          &gt; #!vicare #!eof
          $
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-reader-fun"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-reader-stx">iklib reader stx</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-reader">iklib reader</a>

</div>

<h4 class="subsection">3.2.4 Additional reader functions</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>get-annotated-datum</b><var> port<a name="index-get_002dannotated_002ddatum-46"></a></var><br>
<blockquote><p>Like <code>get-datum</code>, but rather than returning a datum return a
hierarchy of <code>annotation</code> objects with the same hierarchy of the
datum and embedding the datum itself. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-expander"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-environment">iklib environment</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-reader">iklib reader</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.3 Interface to the expander</h3>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>expand</b><var><a name="index-expand-47"></a></var><br>
<blockquote><p>Undocumented. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>core-expand</b><var><a name="index-core_002dexpand-48"></a></var><br>
<blockquote><p>Undocumented. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>expand/optimize</b><var><a name="index-expand_002foptimize-49"></a></var><br>
<blockquote><p>Undocumented. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>expand/scc-letrec</b><var><a name="index-expand_002fscc_002dletrec-50"></a></var><br>
<blockquote><p>Undocumented. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-environment"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-cafe">iklib cafe</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-expander">iklib expander</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.4 Environments</h3>

<p><a name="index-Environment_002c-interaction-51"></a>

   <p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>environment?</b><var><a name="index-environment_003f-52"></a></var><br>
<blockquote><p>Undocumented. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>interaction-environment</b><var><a name="index-interaction_002denvironment-53"></a></var><br>
<blockquote><p>Return an environment object representing the environment active at the
<acronym>REPL</acronym>.  To be used as argument for <code>eval</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>new-interaction-environment</b><var><a name="index-new_002dinteraction_002denvironment-54"></a></var><br>
<blockquote><p>Undocumented. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>environment-symbols</b><var><a name="index-environment_002dsymbols-55"></a></var><br>
<blockquote><p>Undocumented. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-cafe"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-structs">iklib structs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-environment">iklib environment</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.5 Cafe</h3>

<div class="defun">
&mdash; Function: <b>new-cafe</b><var> eval<a name="index-new_002dcafe-56"></a></var><br>
<blockquote><p>The procedure <code>new-cafe</code> starts a new read&ndash;eval&ndash;print loop inside
the current cafe (if one exists).  It prompts the user for an
expression, evaluates it, prints the result back, and repeats the
process.  If <code>new-cafe</code> is called with an argument, <var>eval</var>,
then that argument must be a procedure that takes a single argument. 
The <var>eval</var> procedure will be used to evaluate the expressions.

        <p>Every time a new cafe is started, the prompt is changed to reflect the
depth of the current cafe (i.e. how many eof objects is takes to exit
the outermost cafe).

        <p>Input and output performed by the cafe can be changed by the
<code>console-input-port</code> and <code>console-output-port</code> parameters.

        <p>If a <code>die</code> occurs during reading, evaluating, or printing an
expression, then the die is printed to the error&ndash;port and the
operations of the cafe resume as normal.

        <p>To exit from a cafe we can write the <code>#!eof</code> object. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-structs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-bytevectors">iklib bytevectors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-cafe">iklib cafe</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.6 Structures and type descriptors</h3>

<p>A data structure is like a lightweight record as defined by <acronym>R6RS</acronym>. 
<a href="#syslib-structs">syslib structs</a> for more informations on the internals of data
structures.

<ul class="menu">
<li><a accesskey="1" href="#iklib-structs-rtd">iklib structs rtd</a>:            Structure type descriptors. 
<li><a accesskey="2" href="#iklib-structs-using">iklib structs using</a>:          Using data structures. 
<li><a accesskey="3" href="#iklib-structs-inspect">iklib structs inspect</a>:        Inspecting data structures. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-structs-rtd"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-structs-using">iklib structs using</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-structs">iklib structs</a>

</div>

<h4 class="subsection">3.6.1 Structure type descriptors</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Syntax: <b>define-struct</b><var> &lt;name&gt; </var>(<var>&lt;field&gt; ...</var>)<var><a name="index-define_002dstruct-57"></a></var><br>
<blockquote><p>Define a new data structure type.  This macro is embedded in the
expander.

        <p>&lt;name&gt; must be a symbol representing the name of the structure; it
is used to build names for the constructor, predicate, field accessors
and mutators.  The &lt;field&gt; values must be symbols representing the
names of the fields; they are used to build names for the accessors and
mutators.

        <p>The following definition:

     <pre class="example">          (define-struct color
            (red green blue))
</pre>
        <p class="noindent">expands to the definition of the following bindings:

          <dl>
<dt><code>color</code><dd>An identifier syntax bound to a pair whose car is the symbol &lsquo;<samp><span class="samp">$rtd</span></samp>&rsquo;
and whose cdr is the return value of <code>make-struct-type</code> applied to
the name of the structure and the list of fields.

          <br><dt><code>make-color </code><var>red</var> <var>green</var> <var>blue</var><dd>A structure constructor accepting as much arguments as there are fields. 
The constructor makes use of the <code>$struct</code> low level operation.

          <br><dt><code>color? </code><var>obj</var><dd>A predicate to distinguish between references to <code>color</code> structures
and other values.  This predicate makes use of the <code>$struct/rtd?</code>
low level operation.

          <br><dt><code>color-red </code><var>stru</var><dt><code>color-green </code><var>stru</var><dt><code>color-blue </code><var>stru</var><dd>Accessors for the fields of the structure.  These accessors make use of
the <code>$struct/rtd?</code> low level operation to validate the argument and
if successful they use <code>$struct-ref</code> to extract the value; if the
argument is of invalid type: an assertion violation is raised.

          <br><dt><code>set-color-red! </code><var>stru</var> <var>red</var><dt><code>set-color-green! </code><var>stru</var> <var>green</var><dt><code>set-color-blue! </code><var>stru</var> <var>blue</var><dd>Mutators for the fields of the structure.  These mutators make use of
the <code>$struct/rtd?</code> low level operation to validate the argument and
if successful they use <code>$struct-set!</code> to extract the value; if the
argument is of invalid type: an assertion violation is raised. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-struct-type</b><var> name fields<a name="index-make_002dstruct_002dtype-58"></a></var><br>
&mdash; Function: <b>make-struct-type</b><var> name fields uid<a name="index-make_002dstruct_002dtype-59"></a></var><br>
<blockquote><p>Build and return a new structure type descriptor.  <var>name</var> must be a
string representing the type name.  <var>fields</var> must be a list of
symbols representing the field names.  The optional <var>uid</var> argument
must be a symbol uniquely identifying this type; when not supplied, a
symbol is automatically generated. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-type-name</b><var> rtd<a name="index-struct_002dtype_002dname-60"></a></var><br>
<blockquote><p>Return a string represnting the name of structures of type <var>rtd</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-type-symbol</b><var> rtd<a name="index-struct_002dtype_002dsymbol-61"></a></var><br>
<blockquote><p>Return a symbol uniquely identifying the data structure type <var>RTD</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-type-field-names</b><var> rtd<a name="index-struct_002dtype_002dfield_002dnames-62"></a></var><br>
<blockquote><p>Return a list of symbols representing the names of fields in structures
of type <var>rtd</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>set-rtd-printer!</b><var> rtd printer<a name="index-set_002drtd_002dprinter_0021-63"></a></var><br>
<blockquote><p>Select the procedure <var>printer</var> as printer for data structures of
type <var>rtd</var>.  The printer accepts as 3 arguments: the
structure to be printed, the port to which write a string represention
of the structure with <code>display</code>, a function to be optionally
applied to the field values to print them. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-structs-using"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-structs-inspect">iklib structs inspect</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-structs-rtd">iklib structs rtd</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-structs">iklib structs</a>

</div>

<h4 class="subsection">3.6.2 Using data structures</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>struct-constructor</b><var> rtd<a name="index-struct_002dconstructor-64"></a></var><br>
<blockquote><p>Return a constructor function for data structures of type <var>rtd</var>. 
The constructor accepts as many arguments as fields defined by <var>rtd</var>
and returns a new structure instance. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-predicate</b><var> rtd<a name="index-struct_002dpredicate-65"></a></var><br>
<blockquote><p>Return a predicate function for structures of type <var>rtd</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-field-accessor</b><var> rtd index<a name="index-struct_002dfield_002daccessor-66"></a></var><br>
<blockquote><p>Return an accessor function for the field at <var>index</var> of data
structures of type <var>rtd</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-field-mutator</b><var> rtd index<a name="index-struct_002dfield_002dmutator-67"></a></var><br>
<blockquote><p>Return a mutator function for the field at <var>index</var> of data
structures of type <var>rtd</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-structs-inspect"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-structs-using">iklib structs using</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-structs">iklib structs</a>

</div>

<h4 class="subsection">3.6.3 Inspecting data structures</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>struct?</b><var> stru<a name="index-struct_003f-68"></a></var><br>
&mdash; Function: <b>struct?</b><var> stru rtd<a name="index-struct_003f-69"></a></var><br>
<blockquote><p>When no <var>rtd</var> argument is given return true if <var>stru</var> is a data
structure.  When <var>rtd</var> is given: return true if <var>stru</var> is a data
structure and it is of type <var>rtd</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-rtd</b><var> stru<a name="index-struct_002drtd-70"></a></var><br>
<blockquote><p>Return the <var>rtd</var> of the data structure <var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-length</b><var> stru<a name="index-struct_002dlength-71"></a></var><br>
<blockquote><p>Return the number of fields in the data structure <var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-name</b><var> stru<a name="index-struct_002dname-72"></a></var><br>
<blockquote><p>Return a string representing the name of the data structure <var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-printer</b><var> stru<a name="index-struct_002dprinter-73"></a></var><br>
<blockquote><p>Return the procedure being the printer function for the data structure
<var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-ref</b><var> stru index<a name="index-struct_002dref-74"></a></var><br>
<blockquote><p>Return the value of field at <var>index</var> in the data structure
<var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-set!</b><var> stru index value<a name="index-struct_002dset_0021-75"></a></var><br>
<blockquote><p>Store <var>value</var> in the field at <var>index</var> in the data structure
<var>stru</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-bytevectors"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-strings">iklib strings</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-structs">iklib structs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.7 Additional bytevector functions</h3>

<p>The description of bytevectors uses the term <em>byte</em> for an exact
integer object in the interval (-128, <small class="dots">...</small>, 127) and the term
<em>octet</em> for an exact integer object in the interval (0,
<small class="dots">...</small>, 255).  A byte corresponds to its two's complement
representation as an octet.

<ul class="menu">
<li><a accesskey="1" href="#iklib-bytevectors-sub">iklib bytevectors sub</a>:        Building subbytevectors. 
<li><a accesskey="2" href="#iklib-bytevectors-conv">iklib bytevectors conv</a>:       Converting bytevectors. 
<li><a accesskey="3" href="#iklib-bytevectors-generic">iklib bytevectors generic</a>:    Generic bytevectors operations. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-bytevectors-sub"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-bytevectors-conv">iklib bytevectors conv</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-bytevectors">iklib bytevectors</a>

</div>

<h4 class="subsection">3.7.1 Building subbytevectors</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>subbytevector-u8</b><var> bv start<a name="index-subbytevector_002du8-76"></a></var><br>
&mdash; Function: <b>subbytevector-u8</b><var> bv start end<a name="index-subbytevector_002du8-77"></a></var><br>
<blockquote><p>Build and return a new bytevector holding the bytes in <var>bv</var> from
index <var>start</var> (inclusive) to index <var>end</var> (exclusive).  The start
and end indexes must be such that:

     <pre class="example">          0 &lt;= <var>start</var> &lt;= <var>end</var> &lt;= (bytevector-length <var>bv</var>)
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>subbytevector-u8/count</b><var> bv start count<a name="index-subbytevector_002du8_002fcount-78"></a></var><br>
<blockquote><p>Build and return a new bytevector holding <var>count</var> bytes in <var>bv</var>
from index <var>start</var> (inclusive).  The start index and the byte count
must be such that:

     <pre class="example">          0 &lt;= <var>start</var> &lt;= <var>start</var> + <var>count</var> &lt;= (bytevector-length <var>bv</var>)
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>subbytevector-s8</b><var> bv start<a name="index-subbytevector_002ds8-79"></a></var><br>
&mdash; Function: <b>subbytevector-s8</b><var> bv start end<a name="index-subbytevector_002ds8-80"></a></var><br>
<blockquote><p>Build and return a new bytevector holding the bytes in <var>bv</var> from
index <var>start</var> (inclusive) to index <var>end</var> (exclusive).  The start
and end indexes must be such that:

     <pre class="example">          0 &lt;= <var>start</var> &lt;= <var>end</var> &lt;= (bytevector-length <var>bv</var>)
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>subbytevector-s8/count</b><var> bv start count<a name="index-subbytevector_002ds8_002fcount-81"></a></var><br>
<blockquote><p>Build and return a new bytevector holding <var>count</var> bytes in <var>bv</var>
from index <var>start</var> (inclusive).  The start index and the byte count
must be such that:

     <pre class="example">          0 &lt;= <var>start</var> &lt;= <var>start</var> + <var>count</var> &lt;= (bytevector-length <var>bv</var>)
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-bytevectors-conv"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-bytevectors-generic">iklib bytevectors generic</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-bytevectors-sub">iklib bytevectors sub</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-bytevectors">iklib bytevectors</a>

</div>

<h4 class="subsection">3.7.2 Converting bytevectors</h4>

<p>These conversion functions work like <code>bytevector-&gt;u8-list</code> and
<code>u8-list-&gt;bytevector</code>.  The following bindings are exported by the
<code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>bytevector-&gt;s8-list</b><var> bytevector<a name="index-bytevector_002d_003es8_002dlist-82"></a></var><br>
&mdash; Function: <b>s8-list-&gt;bytevector</b><var> list<a name="index-s8_002dlist_002d_003ebytevector-83"></a></var><br>
<blockquote><p>Convert between a list of signed bytes and a bytevector. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>s16l-list-&gt;bytevector</b><var> list<a name="index-s16l_002dlist_002d_003ebytevector-84"></a></var><br>
&mdash; Function: <b>s16b-list-&gt;bytevector</b><var> list<a name="index-s16b_002dlist_002d_003ebytevector-85"></a></var><br>
&mdash; Function: <b>s16n-list-&gt;bytevector</b><var> list<a name="index-s16n_002dlist_002d_003ebytevector-86"></a></var><br>
&mdash; Function: <b>u16l-list-&gt;bytevector</b><var> list<a name="index-u16l_002dlist_002d_003ebytevector-87"></a></var><br>
&mdash; Function: <b>u16b-list-&gt;bytevector</b><var> list<a name="index-u16b_002dlist_002d_003ebytevector-88"></a></var><br>
&mdash; Function: <b>u16n-list-&gt;bytevector</b><var> list<a name="index-u16n_002dlist_002d_003ebytevector-89"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s16l-list</b><var> bytevector<a name="index-bytevector_002d_003es16l_002dlist-90"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s16b-list</b><var> bytevector<a name="index-bytevector_002d_003es16b_002dlist-91"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s16n-list</b><var> bytevector<a name="index-bytevector_002d_003es16n_002dlist-92"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u16l-list</b><var> bytevector<a name="index-bytevector_002d_003eu16l_002dlist-93"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u16b-list</b><var> bytevector<a name="index-bytevector_002d_003eu16b_002dlist-94"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u16n-list</b><var> bytevector<a name="index-bytevector_002d_003eu16n_002dlist-95"></a></var><br>
<blockquote><p>Convert between a list of signed or unsigned 16-bit words and a
bytevector in which the words are stored in little, big or native
endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>s32l-list-&gt;bytevector</b><var> list<a name="index-s32l_002dlist_002d_003ebytevector-96"></a></var><br>
&mdash; Function: <b>s32b-list-&gt;bytevector</b><var> list<a name="index-s32b_002dlist_002d_003ebytevector-97"></a></var><br>
&mdash; Function: <b>s32n-list-&gt;bytevector</b><var> list<a name="index-s32n_002dlist_002d_003ebytevector-98"></a></var><br>
&mdash; Function: <b>u32l-list-&gt;bytevector</b><var> list<a name="index-u32l_002dlist_002d_003ebytevector-99"></a></var><br>
&mdash; Function: <b>u32b-list-&gt;bytevector</b><var> list<a name="index-u32b_002dlist_002d_003ebytevector-100"></a></var><br>
&mdash; Function: <b>u32n-list-&gt;bytevector</b><var> list<a name="index-u32n_002dlist_002d_003ebytevector-101"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s32l-list</b><var> bytevector<a name="index-bytevector_002d_003es32l_002dlist-102"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s32b-list</b><var> bytevector<a name="index-bytevector_002d_003es32b_002dlist-103"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s32n-list</b><var> bytevector<a name="index-bytevector_002d_003es32n_002dlist-104"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u32l-list</b><var> bytevector<a name="index-bytevector_002d_003eu32l_002dlist-105"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u32b-list</b><var> bytevector<a name="index-bytevector_002d_003eu32b_002dlist-106"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u32n-list</b><var> bytevector<a name="index-bytevector_002d_003eu32n_002dlist-107"></a></var><br>
<blockquote><p>Convert between a list of signed or unsigned 32-bit words and a
bytevector in which the words are stored in little, big or native
endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>s64l-list-&gt;bytevector</b><var> list<a name="index-s64l_002dlist_002d_003ebytevector-108"></a></var><br>
&mdash; Function: <b>s64b-list-&gt;bytevector</b><var> list<a name="index-s64b_002dlist_002d_003ebytevector-109"></a></var><br>
&mdash; Function: <b>s64n-list-&gt;bytevector</b><var> list<a name="index-s64n_002dlist_002d_003ebytevector-110"></a></var><br>
&mdash; Function: <b>u64l-list-&gt;bytevector</b><var> list<a name="index-u64l_002dlist_002d_003ebytevector-111"></a></var><br>
&mdash; Function: <b>u64b-list-&gt;bytevector</b><var> list<a name="index-u64b_002dlist_002d_003ebytevector-112"></a></var><br>
&mdash; Function: <b>u64n-list-&gt;bytevector</b><var> list<a name="index-u64n_002dlist_002d_003ebytevector-113"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s64l-list</b><var> bytevector<a name="index-bytevector_002d_003es64l_002dlist-114"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s64b-list</b><var> bytevector<a name="index-bytevector_002d_003es64b_002dlist-115"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s64n-list</b><var> bytevector<a name="index-bytevector_002d_003es64n_002dlist-116"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u64l-list</b><var> bytevector<a name="index-bytevector_002d_003eu64l_002dlist-117"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u64b-list</b><var> bytevector<a name="index-bytevector_002d_003eu64b_002dlist-118"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u64n-list</b><var> bytevector<a name="index-bytevector_002d_003eu64n_002dlist-119"></a></var><br>
<blockquote><p>Convert between a list of signed or unsigned 64-bit words and a
bytevector in which the words are stored in little, big or native
endianness. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-bytevectors-generic"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-bytevectors-conv">iklib bytevectors conv</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-bytevectors">iklib bytevectors</a>

</div>

<h4 class="subsection">3.7.3 Generic bytevectors operations</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>bytevector-append</b><var> bytevector ...<a name="index-bytevector_002dappend-120"></a></var><br>
<blockquote><p>Concatenate the bytevector arguments and return the result.  If no
arguments are given: return the empty bytevector. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-strings"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-symbols">iklib symbols</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-bytevectors">iklib bytevectors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.8 Additional string functions</h3>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>string-&gt;latin1</b><var> string<a name="index-string_002d_003elatin1-121"></a></var><br>
&mdash; Function: <b>latin1-&gt;string</b><var> bytevevctor<a name="index-latin1_002d_003estring-122"></a></var><br>
<blockquote><p>Convert to and from a Scheme string and a Scheme bytevector holding the
Latin-1 encoding of the characters. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>string-&gt;utf16le</b><var> string<a name="index-string_002d_003eutf16le-123"></a></var><br>
&mdash; Function: <b>string-&gt;utf16be</b><var> string<a name="index-string_002d_003eutf16be-124"></a></var><br>
&mdash; Function: <b>string-&gt;utf16n</b><var> string<a name="index-string_002d_003eutf16n-125"></a></var><br>
&mdash; Function: <b>utf16le-&gt;string</b><var> bytevector<a name="index-utf16le_002d_003estring-126"></a></var><br>
&mdash; Function: <b>utf16be-&gt;string</b><var> bytevector<a name="index-utf16be_002d_003estring-127"></a></var><br>
&mdash; Function: <b>utf16n-&gt;string</b><var> bytevector<a name="index-utf16n_002d_003estring-128"></a></var><br>
<blockquote><p>Convert to and from a Scheme string and a Scheme bytevector holding the
<acronym>UTF</acronym>-16 encoding of the characters under little, big or native
endianness respectively. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-symbols"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-numerics">iklib numerics</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-strings">iklib strings</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.9 Additional symbol functions</h3>

<ul class="menu">
<li><a accesskey="1" href="#iklib-symbols-plists">iklib symbols plists</a>:         Property lists. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-symbols-plists"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-symbols">iklib symbols</a>

</div>

<h4 class="subsection">3.9.1 Property lists</h4>

<p>Property lists are associations key/value that can be attached to any
Scheme symbol.  The following bindings are exported by the
<code>(ikarus)</code> and the <code>(ikarus symbols)</code> libraries.

<pre class="example">     #!ikarus
     (import (ikarus))
     
     (putprop 'ciao 'british 'hello)
     (putprop 'ciao 'spanish 'hola)
     
     (getprop 'ciao 'british)        &rArr; hello
     (getprop 'ciao 'spanish)        &rArr; hola
     
     (remprop 'ciao 'british)
     (getprop 'ciao 'british)        &rArr; #f
     
     (property-list 'ciao)           &rArr; ((spanish . hola))
</pre>
   <div class="defun">
&mdash; Function: <b>putprop</b><var> symbol key value<a name="index-putprop-129"></a></var><br>
<blockquote><p>Add a new property <var>key</var> with <var>value</var> to the property list of
<var>symbol</var>.  <var>key</var> must be a symbol, <var>value</var> can be any value.

        <p>If <var>key</var> is already set: the old entry is mutated to reference the
new <var>value</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getprop</b><var> symbol key<a name="index-getprop-130"></a></var><br>
<blockquote><p>Return the value of the property <var>key</var> in the property list of
<var>symbol</var>; if <var>key</var> is not set return false.  <var>key</var> must be a
symbol. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>remprop</b><var> symbol key<a name="index-remprop-131"></a></var><br>
<blockquote><p>Remove property <var>key</var> from the list associated to <var>symbol</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>property-list</b><var> symbol<a name="index-property_002dlist-132"></a></var><br>
<blockquote><p>Return a new association list representing the property list of
<var>symbol</var>.  The order of the entries is the same as the property
creation order. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-numerics"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-load">iklib load</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-symbols">iklib symbols</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.10 Additional functions on numbers</h3>

<ul class="menu">
<li><a accesskey="1" href="#iklib-numerics-preds">iklib numerics preds</a>:         Additional numeric predicates. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-numerics-preds"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-numerics">iklib numerics</a>

</div>

<h4 class="subsection">3.10.1 Additional numeric predicates</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>bignum?</b><var> obj<a name="index-bignum_003f-133"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is an exact integer represented by a big
number. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ratnum?</b><var> obj<a name="index-ratnum_003f-134"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is an exact rational number. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>cflonum?</b><var> obj<a name="index-cflonum_003f-135"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a complex number having flonums as both real
and imaginary parts. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>compnum?</b><var> obj<a name="index-compnum_003f-136"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a complex number having any possible
combination of number representations as real and imaginary parts, but
not both flonums. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-load"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-import">iklib import</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-numerics">iklib numerics</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.11 Loading source files</h3>

<p>Loading of source files can be done explicitly or by requesting a
library with the <code>import</code> form.  Here we see how to load files by
specifying their pathname on the file system.

<div class="defun">
&mdash; Function: <b>load</b><var> pathname<a name="index-load-137"></a></var><br>
&mdash; Function: <b>load</b><var> pathname eval-proc<a name="index-load-138"></a></var><br>
<blockquote><p>Read and evaluate the file selected by the string <var>pathname</var>.

        <p>If <var>eval-proc</var> is given: it must be a procedure that takes a single
argument, an annotated form, and evaluates it.  The default
<var>eval-proc</var> looks like this:

     <pre class="example">          (define (load-handler x)
            (eval x (interaction-environment)))
</pre>
        <p>The format of the annotated source is the one which is comprehensible by
<code>eval</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-import"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-modules">iklib modules</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-load">iklib load</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.12 Local library imports</h3>

<div class="defun">
&mdash; Syntax: <b>import</b><var> import-spec* ...<a name="index-import-139"></a></var><br>
<blockquote><p>The <code>import</code> keyword which is exported from the <code>(ikarus)</code>
library can be used anywhere definitions can occur: at a script body,
library's top&ndash;level, or in internal definitions context.  The syntax of
the local <code>import</code> form is similar to the <code>import</code> that
appears at the top of a library or a script form, and carries with it
the same restrictions: no identifier name may be imported twice unless
it denotes the same identifier; no identifier may be both imported and
defined; and imported identifiers are immutable.

        <p>Local <code>import</code> forms are useful for two reasons: (1) they minimize
the namespace clutter that usually occurs when many libraries are
imported at the top level, and (2) they limit the scope of the import
and thus help modularize a library's dependencies.

        <p>Suppose you are constructing a large library and at some point you
realize that one of your procedures needs to make use of some other
library for performing a specific task.  Importing that library at top
level makes it available for the entire library.  Consequently, even if
that library is no longer used anywhere in the code (say when the code
that uses it is deleted), it becomes very hard to delete the import
without first examiniming the entire library body for potential usage
leaks.  By locally importing a library into the appropriate scope, we
gain the ability to delete the <code>import</code> form when the procedure
that was using it is deleted. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-modules"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-parameters">iklib parameters</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-import">iklib import</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.13 Local modules</h3>

<p>Modules are somewhat like libraries in that they define a set of
bindings in a &ldquo;private namespace&rdquo;; bindings can be exported from a
module and imported into other modules and libraries.  The main
difference between modules and <acronym>R6RS</acronym> libraries is that modules are
defined in a single form nested into a library; so, in a way, they are
sub&ndash;libraries.

   <blockquote>
<strong>NOTE</strong> In the official documentation of Vicare 0.0.3+
(revision 1648) modules are yet not documented.  Please refer to Section
10.5 of Chez Scheme User's Guide, Chapter 3 of Oscar Waddel's Ph.D
Thesis, and its POPL99 paper for details on using the <code>module</code> and
<code>import</code> keywords.  Vicare's internal module system is
similar in spirit to that of Chez Scheme. 
</blockquote>

<ul class="menu">
<li><a accesskey="1" href="#iklib-modules-examples">iklib modules examples</a>:       Usage example for modules. 
<li><a accesskey="2" href="#iklib-modules-api">iklib modules api</a>:            Modules programming interface. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-modules-examples"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-modules-api">iklib modules api</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-modules">iklib modules</a>

</div>

<h4 class="subsection">3.13.1 Usage example for modules</h4>

<ul class="menu">
<li><a accesskey="1" href="#iklib-modules-examples-anonymous">iklib modules examples anonymous</a>:  Anonymous modules. 
<li><a accesskey="2" href="#iklib-modules-examples-named">iklib modules examples named</a>:      Named modules. 
<li><a accesskey="3" href="#iklib-modules-examples-utils">iklib modules examples utils</a>:      Utilities examples. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-modules-examples-anonymous"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-modules-examples-named">iklib modules examples named</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-modules-examples">iklib modules examples</a>

</div>

<h5 class="subsubsection">3.13.1.1 Anonymous modules</h5>

<p>The following example defines an anonymous module, without expressions,
and invokes its functions from the enclosing environment (which is the
top level):

<pre class="example">     (import (ikarus))
     
     (module (one two three)
         (define (one)       'one)
         (define (two)       'two)
         (define (three)     (cons 'three (hidden)))
         (define (hidden)    'hidden))
     
     (printf "calling anonymous: ~s ~s ~s~%" (one) (two) (three))
</pre>
   <p class="noindent">notice that the <code>hidden</code> function is visible inside the module but
not in the enclosing environment.

   <p>The following example defines a module, with expressions, and invokes
its functions from the enclosing environment (which is the top level):

<pre class="example">     (import (ikarus))
     
     (module (one two three)
         (define (one)       'one)
         (define (two)       'two)
         (define (three)     (cons 'three (hidden)))
         (define (hidden)    'hidden)
     
         (printf "defining an anonymous module~%"))
     
     (printf "calling anonymous: ~s ~s ~s~%" (one) (two) (three))
</pre>
   <p class="noindent">notice that when the enclosing environment is the top level: the
expressions at the end of a module are evaluated <strong>after</strong> the
expressions at the top level; so the output from the example is:

<pre class="example">     calling anonymous: one two (three . hidden)
     defining an anonymous module
</pre>
   <p class="noindent">this can lead to undesired results if the module's expressions are meant
to initialise the state of the module, and the expressions at the top
level invoke the module's functions (before initialisation).  On the
other hand: this behaviour allows the module to access definitions from
the enclosing environment and the top level environment despite their
placement in the file; see below for an example.  The same behaviour is
shown by named modules.

   <p>The following example defines a module, with expressions, and invokes
its functions from the enclosing environment (which is a <code>let</code>
form):

<pre class="example">     (import (ikarus))
     
     (let ()
       (module (one two three)
           (define (one)       'one)
           (define (two)       'two)
           (define (three)     (cons 'three (hidden)))
           (define (hidden)    'hidden)
     
           (printf "defining an anonymous module~%"))
     
       (printf "calling anonymous: ~s ~s ~s~%" (one) (two) (three)))
</pre>
   <p class="noindent">notice that when the enclosing environment is <strong>not</strong> the top
level: the expressions at the end of a module are evaluated
<strong>before</strong> the expressions in the body of the enclosing
environment; so the output from the example is:

<pre class="example">     defining an anonymous module
     calling anonymous: one two (three . hidden)
</pre>
   <p class="noindent">so the state of the module can be correctly initialised before its
functions are invoked.  The same behaviour is shown by named modules.

   <p>The following example shows that bindings from the enclosing environment
and the top level environment are accessible from the modules:

<pre class="example">     (import (ikarus))
     
     (define (top-level-before) 'top-level-before)
     
     (let ()
     
       (define (outer-before) 'outer-before)
     
       (module (one two three)
         (define (one)       'one)
         (define (two)       'two)
         (define (three)     (list 'three
                                   (outer-before)
                                   (outer-after)
                                   (top-level-before)
                                   (top-level-after))))
     
       (define (outer-after) 'outer-after)
     
       (printf "calling anonymous: ~s ~s ~s~%" (one) (two) (three)))
     
     (define (top-level-after) 'top-level-after)
</pre>
   <p class="noindent">this happens both when the enclosing environment is the top level and
when the enclosing environment is not the top level.  The same behaviour
is shown by named modules.

<!-- page -->
<div class="node">
<a name="iklib-modules-examples-named"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-modules-examples-utils">iklib modules examples utils</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-modules-examples-anonymous">iklib modules examples anonymous</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-modules-examples">iklib modules examples</a>

</div>

<h5 class="subsubsection">3.13.1.2 Named modules</h5>

<p>The following example defines a module named <code>blue</code> and invokes
functions from it in the top level environment:

<pre class="example">     (import (ikarus))
     
     [module blue (blue-one blue-two blue-three)
         (define (blue-one)          'blue-one)
         (define (blue-two)          'blue-two)
         (define (blue-three)        (cons 'blue-three (hidden)))
         (define (hidden)            'blue-hidden)]
     
     (import blue)
     (printf "calling blue: ~s ~s ~s~%"
             (blue-one) (blue-two) (blue-three))
</pre>
   <p class="noindent">notice that bindings from a named module are accessible only if imported
in the enclosing environment.

   <p>The following example defines two modules named <code>green</code> and
<code>red</code>, then it imports their bindings in different environments:

<pre class="example">     (import (ikarus))
     
     (let ()
     
       [module green (one two three)
         (define (one)       'green-one)
         (define (two)       'green-two)
         (define (three)     (cons 'green-three (hidden)))
         (define (hidden)    'green-hidden)]
     
       [module red (one two three)
         (define (one)       'red-one)
         (define (two)       'red-two)
         (define (three)     (cons 'red-three (hidden)))
         (define (hidden)    'red-hidden)]
     
       (import green)
     
       [let ()
         (import red)
         (printf "calling red: ~s ~s ~s~%" (one) (two) (three))]
     
       (printf "calling green: ~s ~s ~s~%" (one) (two) (three)))
</pre>
   <p>The following example shows that modules in the same enclosing
environment can import their bindings:

<pre class="example">     (import (ikarus))
     
     (let ()
     
       [module green (one two)
         (define (one)       'one)
         (define (two)       'two)]
     
       [module red (f g)
         (import green)
         (define (f)         (cons 'f (one)))
         (define (g)         (cons 'g (two)))]
     
       (import red)
       (printf "calling red: ~s ~s~%" (f) (g)))
</pre>
   <p class="noindent">while the following example shows that bindings from an anonymous module
are automatically available in modules defined in the same enclosing
environment:

<pre class="example">     (import (ikarus))
     
     (let ()
     
       [module (one two)
         (define (one)       'one)
         (define (two)       'two)]
     
       [module red (f g)
         (define (f)         (cons 'f (one)))
         (define (g)         (cons 'g (two)))]
     
       (import red)
       (printf "calling red: ~s ~s~%" (f) (g)))
</pre>
   <p class="noindent">and the following example shows that the order of module definitions
does not matter in determining visibility of bindings from
<strong>anonymous</strong> modules:

<pre class="example">     (import (ikarus))
     
     (let ()
     
       [module red (f g)
         (define (f)         (cons 'f (one)))
         (define (g)         (cons 'g (two)))]
     
       [module (one two)
         (define (one)       'one)
         (define (two)       'two)]
     
       (import red)
       (printf "calling red: ~s ~s~%" (f) (g)))
</pre>
   <p class="noindent">the following is an <strong>error</strong> because it tries to import bindings
from a <strong>named</strong> module before its definition:

<pre class="example">     (import (ikarus))
     
     (let ()
     
       [module red (f g)
         (import green)
         (define (f)         (cons 'f (one)))
         (define (g)         (cons 'g (two)))]
     
       [module green (one two)
         (define (one)       'one)
         (define (two)       'two)]
     
       (import red)
       (printf "calling red: ~s ~s~%" (f) (g)))
</pre>
   <!-- page -->
<div class="node">
<a name="iklib-modules-examples-utils"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-modules-examples-named">iklib modules examples named</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-modules-examples">iklib modules examples</a>

</div>

<h5 class="subsubsection">3.13.1.3 Utilities examples</h5>

<p>The following example shows how syntactic abstractions can be used to
access definitions in a module without using the <code>import</code> form:

<pre class="example">     (import (ikarus))
     
     (let ()
     
       (define-syntax in-module
         (syntax-rules ()
           [(_ ?module ?expr ...)
            (let () (import ?module) ?expr ...)]))
     
       [module red (one two)
         (define (one arg)   (cons 'red-one arg))
         (define (two arg)   (cons 'red-two arg))]
     
       [module green (one two)
         (define (one arg)   (cons 'green-one arg))
         (define (two arg)   (cons 'green-two arg))]
     
       (printf "calling ones: ~s ~s~%"
               [(in-module red one)   123]
               [(in-module green one) 456]))
</pre>
   <!-- page -->
<div class="node">
<a name="iklib-modules-api"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-modules-examples">iklib modules examples</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-modules">iklib modules</a>

</div>

<h4 class="subsection">3.13.2 Modules programming interface</h4>

<div class="defun">
&mdash; Syntax: <b>module</b><var> interface definitions ... expressions ...<a name="index-module-140"></a></var><br>
&mdash; Syntax: <b>module</b><var> name interface definitions ... expressions ...<a name="index-module-141"></a></var><br>
<blockquote><p>Define a new local module.  The first form defines an <em>anonymous</em>
module, while the second form defines a <em>named</em> module called
<var>name</var>, which must be a symbol.

        <p><var>interface</var> is a list of symbols that select bindings from this
module to be exported.  Every listed symbol must be bound in this
module's <var>definitions</var>, otherwise an error is raised.

        <p><var>definitions</var> is a set of bindings like the one that may appear at
the beginning of a <code>let</code> body, with the addition of <code>import</code>
forms that may import bindings from libraries and other modules.

        <p><var>expressions</var> is a set of expressions that is evaluated at module's
definition time.

        <p>Modules &ldquo;exist&rdquo; only in the enclosing region, bindings exported from a
module are not accessible outside of the enclosing region.  Modules can
be nested and import/export relations are possible according to the
regions nesting hierarchy.

        <p>Bindings in the <var>interface</var> declared by anonymous modules are
imported by default in the enclosing region: there is no need to use
<code>import</code>.  Bindings in the <var>interface</var> declared by named
modules are visible only in regions that <code>import</code> the module.

        <p><var>definitions</var> and <var>expressions</var> have no default access to the
bindings in the enclosing region; only imported bindings are visible
from the module. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-parameters"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-gensym">iklib gensym</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-modules">iklib modules</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.14 Parameters</h3>

<p>Parameters in Vicare<a rel="footnote" href="#fn-2" name="fnd-2"><sup>2</sup></a> are intended for
customizing the behavior of a procedure during the dynamic execution of
some piece of code.  Parameters are first class entities (represented as
procedures) that hold the parameter value.  A parameter procedure
accepts either zero or one argument.  If given no arguments, it returns
the current value of the parameter.  If given a single argument, it must
set the state to the value of the argument.

   <p>Parameters replace the older concept of using starred <code>*global*</code>
customization variables.  For example, instead of writing:

<pre class="example">     (define *screen-width* 72)
</pre>
   <p class="noindent">and then mutating the variable <code>*screen-width*</code> with <code>set!</code>,
we could wrap the variable <code>*screen-width*</code> with a
<code>screen-width</code> parameter as follows:

<pre class="example">     (define *screen-width* 72)
     (define screen-width
        (case-lambda
          [()  *screen-width*]
          [(x) (set! *screen-width* x)]))
</pre>
   <p>The value of <code>screen-width</code> can now be passed as argument, returned
as a value, and exported from libraries.

<div class="defun">
&mdash; Procedure: <b>make-parameter</b><var> x<a name="index-make_002dparameter-142"></a></var><br>
&mdash; Procedure: <b>make-parameter</b><var> x f<a name="index-make_002dparameter-143"></a></var><br>
<blockquote><p>As parameters are common in Vicare, the procedure <code>make-parameter</code>
is defined to model the common usage pattern of parameter construction.

        <p><code>(make-parameter x)</code> constructs a parameter with <var>x</var> as the
initial value.  For example, the code above could be written succinctly
as:

     <pre class="example">          (define screen-width (make-parameter 72))
</pre>
        <p><code>(make-parameter x f)</code> constructs a parameter which filters the
assigned values through the procedure <var>f</var>.  The initial value of the
parameter is the result of calling <code>(f x)</code>.  Typical uses of the
filter procedure include checking some constraints on the passed
argument or converting it to a different data type.  The
<code>screen-width</code> parameter may be constructed more robustly as:

     <pre class="example">          (define screen-width
            (make-parameter 72
              (lambda (w)
                (assert (and (integer? w) (exact? w)))
                (max w 1))))
</pre>
        <p>This definition ensures, through <code>assert</code>, that the argument passed
is an exact integer.  It also ensures, through <code>max</code> that the
assigned value is always positive. 
</p></blockquote></div>

<div class="defun">
&mdash; Syntax: <b>parameterize</b> ([<var>lhs* rhs*</var>]<var> ...</var>)<var> body body* ...<a name="index-parameterize-144"></a></var><br>
<blockquote><p>Parameters can be assigned to by simply calling the parameter procedure
with a single argument.  The <code>parameterize</code> syntax is used to set
the value of a parameter within the dynamic extent of the <code>body
body* ...</code> expressions.

        <p>The <code>lhs* ...</code> are expressions, each of which must evaluate to a
parameter.  Such parameters are not necessarily constructed by
<code>make-parameter</code>&mdash;any procedure that follows the parameters
protocol works.

        <p>The advantage of using <code>parameterize</code> over explicitly assigning to
parameters (same argument applies to global variables) is that you're
guaranteed that whenever control exits the body of a <code>parameterize</code>
expression, the value of the parameter is reset back to what it was
before the body expressions were entered.  This is true even in the
presence of <code>call/cc</code>, errors, and exceptions.

        <p>The following example shows how to set the text property of a terminal
window.  The parameter <code>terminal-property</code> sends an <acronym>ANSI</acronym> escape
sequence to the terminal whenever the parameter value is changed.  The
use of <code>terminal-property</code> within <code>parameterize</code> changes the
property before <code>(display "RED!")</code> is called and resets it back to
normal when the body returns.

     <pre class="example">          (define terminal-property
            (make-parameter "0"
              (lambda (x)
                (display "\x1b;[")
                (display x)
                (display "m")
                x)))
          
          (display "Normal and ")
          (parameterize ([terminal-property "41;37"])
            (display "RED!"))
          (newline)
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-gensym"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-printing">iklib printing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-parameters">iklib parameters</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.15 Gensyms</h3>

<p>Gensym stands for <em>generated symbol</em>&mdash;a fresh symbol that is
generated at run time and is guaranteed to be <em>not</em> <code>eq?</code> to
any other symbol present in the system.  Gensyms are useful in many
applications including expanders, compilers, and interpreters when
generating an arbitrary number of unique names is needed.

   <p>Vicare is similar to Chez Scheme in that the readers (including the
<code>read</code> procedure) and writers (including <code>write</code> and
<code>pretty-print</code>) maintain the read/write invariance on gensyms. 
When a gensym is written to an output port, the system automatically
generates a random unique identifier for the gensym.  When the gensym is
read back though the <code>#{gensym}</code> read syntax, a new gensym is
<em>not</em> regenerated, but instead, it is looked up in the global
symbol table.

   <p>A gensym's name is composed of two parts: a <em>pretty</em> string and a
<em>unique</em> string.  The Scheme procedure <code>symbol-&gt;string</code>
returns the pretty string of the gensym and not its unique string. 
Gensyms are printed by default as <code>#{pretty-string unique-string}</code>.

<div class="defun">
&mdash; Procedure: <b>gensym</b><var><a name="index-gensym-145"></a></var><br>
&mdash; Procedure: <b>gensym</b><var> string<a name="index-gensym-146"></a></var><br>
&mdash; Procedure: <b>gensym</b><var> symbol<a name="index-gensym-147"></a></var><br>
<blockquote><p>Construct a new gensym.  If passed no arguments, construct a gensym with
no pretty name.  The pretty name is constructed when and if the pretty
name of the resulting gensym is needed.  If <code>gensym</code> is passed a
string, that string is used as the pretty name.  If <code>gensym</code> is
passed a symbol, the pretty name of the symbol is used as the pretty
name of the returned gensym.  See <code>gensym-prefix</code> and
<code>gensym-count</code> for details.

     <pre class="example">          &gt; (gensym)
          #{g0 |y0zf&gt;GlFvcTJE0xw|}
          &gt; (gensym)
          #{g1 |U%X&amp;sF6kX!YC8LW=|}
          &gt; (eq? (gensym) (gensym))
          #f
</pre>
        <p><code>(gensym string)</code> constructs a new gensym with <var>string</var> as its
pretty name.  Similarly, <code>(gensym symbol)</code> constructs a new gensym
with the pretty name of <var>symbol</var>, if it has one, as its pretty name.

     <pre class="example">          &gt; (gensym "foo")
          #{foo |&gt;VgOllCM&amp;$dSvRN=|}
          &gt; (gensym 'foo)
          #{foo |!TqQLmtw2hoEYfU&gt;|}
          &gt; (gensym (gensym 'foo))
          #{foo |N2C&gt;5O0&gt;C?OROUBU|}
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>gensym?</b><var> x<a name="index-gensym_003f-148"></a></var><br>
<blockquote><p>Return <code>#t</code> if its argument is a gensym, return <code>#f</code> otherwise.

     <pre class="example">          &gt; (gensym? (gensym))
          #t
          &gt; (gensym? 'foo)
          #f
          &gt; (gensym? 12)
          #f
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>gensym-&gt;unique-string</b><var> gensym<a name="index-gensym_002d_003eunique_002dstring-149"></a></var><br>
<blockquote><p>Return the unique name associated with the gensym argument.

     <pre class="example">          &gt; (gensym-&gt;unique-string (gensym))
          "YukrolLMgP?%ElcR"
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#{gensym}</b><var><a name="index-g_t_0023_0040_007bgensym_0040_007d-150"></a></var><br>
&mdash; Reader Syntax: <b>#{unique-name}</b><var><a name="index-g_t_0023_0040_007bunique_002dname_0040_007d-151"></a></var><br>
&mdash; Reader Syntax: <b>#{pretty-name unique-name}</b><var><a name="index-g_t_0023_0040_007bpretty_002dname-unique_002dname_0040_007d-152"></a></var><br>
&mdash; Reader Syntax: <b>#:pretty-name</b><var><a name="index-g_t_0023_003apretty_002dname-153"></a></var><br>
<blockquote><p>Vicare's <code>read</code> and <code>write</code> procedures extend the lexical
syntax of Scheme by the ability to read and write gensyms using one of
these three forms.

        <p><code>#{unique-name}</code> constructs, at read time, a gensym whose unique
name is the one specified.  If a gensym with the same unique name
already exists in the system's symbol table, that gensym is returned.

     <pre class="example">          &gt; '#{some-long-name}
          #{g0 |some-long-name|}
          &gt; (gensym? '#{some-long-unique-name})
          #t
          &gt; (eq? '#{another-unique-name} '#{another-unique-name})
          #t
</pre>
        <p>The two&ndash;part <code>#{pretty-name unique-name}</code> gensym syntax is
similar to the syntax shown above with the exception that if a new
gensym is constructed (that is, if the gensym did not already exist in
the symbol table), the pretty name of the constructed gensym is set to
<code>pretty-name</code>.

     <pre class="example">          &gt; '#{foo unique-identifier}
          #{foo |unique-identifier|}
          &gt; '#{unique-identifier}
          #{foo |unique-identifier|}
          &gt; '#{bar unique-identifier}
          #{foo |unique-identifier|}
</pre>
        <p>The <code>#:pretty-name</code> form constructs, at read time, a gensym whose
pretty name is <code>pretty-name</code> and whose unique name is fresh.  This
form guarantees that the resulting gensym is not <code>eq?</code> to any other
symbol in the system.

     <pre class="example">          &gt; '#:foo
          #{foo |j=qTGlEwS/Zlp2Dj|}
          &gt; (eq? '#:foo '#:foo)
          #f
</pre>
        </blockquote></div>

<!--  -->
<h4 class="subsection">3.15.1 An example</h4>

<p class="noindent">The <code>(rnrs syntax-case)</code> library provides a
<code>generate-temporaries</code> procedure, which takes a syntax object
(representing a list of things) and returns a list of fresh identifiers. 
Using <code>gensym</code>, that procedure can be defined as follows:

<pre class="example">     (define (generate-temporaries* stx)
       (syntax-case stx ()
         [(x* ...)
          (map (lambda (x)
                 (datum-&gt;syntax #'unimportant
                   (gensym
                     (if (identifier? x)
                         (syntax-&gt;datum x)
                         't))))
               #'(x* ...))]))
</pre>
   <p>The above definition works by taking the input <var>stx</var> and
destructuring it into the list of syntax objects <code>x* ...</code>.  The
inner procedure maps each <var>x</var> into a new syntax object (constructed
with <code>datum-&gt;syntax</code>).  The datum is a gensym, whose name is the
same name as <var>x</var> if <var>x</var> is an identifier, or the symbol <code>t</code>
if <var>x</var> is not an identifier.  The output of
<code>generate-temporaries*</code> generates names similar to their input
counterpart:

<pre class="example">     &gt; (print-gensym #f)
     &gt; (generate-temporaries* #'(x y z 1 2))
     (#&lt;syntax x&gt; #&lt;syntax y&gt; #&lt;syntax z&gt; #&lt;syntax t&gt; #&lt;syntax t&gt;)
</pre>
   <!-- page -->
<div class="node">
<a name="iklib-printing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-tracing">iklib tracing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-gensym">iklib gensym</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.16 Printing</h3>

<div class="defun">
&mdash; Procedure: <b>pretty-print</b><var> datum<a name="index-pretty_002dprint-154"></a></var><br>
&mdash; Procedure: <b>pretty-print</b><var> datum output-port<a name="index-pretty_002dprint-155"></a></var><br>
<blockquote><p>The procedure <code>pretty-print</code> is intended for printing Scheme data,
typically Scheme programs, in a format close to how a Scheme programmer
would write it.  Unlike <code>write</code>, which writes its input all in one
line, <code>pretty-print</code> inserts spaces and new lines in order to
produce more pleasant output.

     <pre class="example">          (define fact-code
            '(letrec ([fact (lambda (n)
                              (if (zero? n)
                                  1
                                (* n (fact (- n 1)))))])
               (fact 5)))
          
          &gt; (pretty-print fact-code)
          (letrec ((fact
                    (lambda (n) (if (zero? n) 1 (* n (fact (- n 1)))))))
            (fact 5))
</pre>
        <p>The second argument to <code>pretty-print</code>, if supplied, must be an
output port.  If not supplied, the <code>current-output-port</code> is used.

        <blockquote>
<em>Limitations:</em> As shown in the output above, the current
implementation of <code>pretty-print</code> does not handle printing of square
brackets properly. 
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>pretty-width</b><var><a name="index-pretty_002dwidth-156"></a></var><br>
&mdash; Parameter: <b>pretty-width</b><var> n<a name="index-pretty_002dwidth-157"></a></var><br>
<blockquote><p>The parameter <code>pretty-width</code> controls the number of characters
after which the <code>pretty-print</code> starts breaking long lines into
multiple lines.  The initial value of <code>pretty-width</code> is set to 60
characters, which is suitable for most terminals and printed material.

     <pre class="example">          &gt; (parameterize ([pretty-width 40])
               (pretty-print fact-code))
          (letrec ((fact
                    (lambda (n)
                      (if (zero? n)
                          1
                          (* n (fact (- n 1)))))))
            (fact 5))
</pre>
        <p>Note that <code>pretty-width</code> does not guarantee that the output will
not extend beyond the specified number.  Very long symbols, for
examples, cannot be split into multiple lines and may force the printer
to go beyond the value of <code>pretty-width</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>format</b><var> fmt-string args ...<a name="index-format-158"></a></var><br>
<blockquote><p>The procedure <code>format</code> produces a string formatted according to
<code>fmt-string</code> and the supplied arguments.  The format string
contains markers in which the string representation of each argument is
placed.  The markers include:

          <dl>
<dt><code>~s</code><dd>instructs the formatter to place the next argument as if the procedure
<code>write</code> has printed it; if the argument contains a string, the
string will be quoted and all quotes and backslashes in the string will
be escaped; similarly, characters will be printed using the <code>#\x</code>
notation;

          <br><dt><code>~a</code><dd>instructs the formatter to place the next argument as if the procedure
<code>display</code> has printed it; strings and characters are placed as they
are in the output;

          <br><dt><code>~b</code><dd>instructs the formatter to convert the next argument to its binary (base
2) representation; the argument must be an exact number;

          <br><dt><code>~o</code><dd>is similar to <code>~b</code> except that the number is printed in octal (base
8);

          <br><dt><code>~x</code><dd>is similar to <code>~b</code> except that the number is printed in hexadecimal
(base 16);

          <br><dt><code>~d</code><dd>outputs the next argument, which can be an exact or inexact number, in
its decimal (base 10) representation;

          <br><dt><code>~~</code><dd>instructs the formatter to place a tilde character, <code>~</code>, in the
output without consuming an argument;

          <br><dt><code>~%</code><dd>instructs the formatter to place a newline character in the output
without consuming an argument. 
</dl>

        <p>Note that the <code>#b</code>, <code>#o</code>, and <code>#x</code> numeric prefixes are
not added to the output when <code>~b</code>, <code>~o</code>, and <code>~x</code> are
used.

     <pre class="example">          &gt; (format "message: ~s, ~s, and ~s" 'symbol "string" #\c)
          "message: symbol, \"string\", and #\\c"
          
          &gt; (format "message: ~a, ~a, and ~a" 'symbol "string" #\c)
          "message: symbol, string, and c"
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>printf</b><var> fmt-string args ...<a name="index-printf-159"></a></var><br>
<blockquote><p>The procedure <code>printf</code> is similar to <code>format</code> except that the
output is sent to the <code>current-output-port</code> instead of being
collected in a string.

     <pre class="example">          &gt; (let ([n (+ (expt 2 32) #b11001)])
              (printf "~d = #b~b = #x~x\n" n n n))
          4294967321 = #b100000000000000000000000000011001 = #x100000019
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>fprintf</b><var> output-port fmt-string args ...<a name="index-fprintf-160"></a></var><br>
<blockquote><p>The procedure <code>fprintf</code> is similar to <code>printf</code> except that the
output port to which the output is sent is specified as the first
argument. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>print-graph</b><var><a name="index-print_002dgraph-161"></a></var><br>
&mdash; Parameter: <b>print-graph</b><var> #t<a name="index-print_002dgraph-162"></a></var><br>
&mdash; Parameter: <b>print-graph</b><var> #f<a name="index-print_002dgraph-163"></a></var><br>
<blockquote><p>The graph notation is a way of marking and referencing parts of a data
structure and, consequently, creating shared and cyclic data structures
at read time instead of resorting to explicit mutation at run time.  The
<code>#n=</code> marks the following data structure with mark <var>n</var>, where
<var>n</var> is a nonnegative integer.  The <code>#n#</code> references the data
structure marked <var>n</var>.  Marks can be assigned and referenced in any
order but each mark must be assigned to exactly once in an expression.

     <pre class="example">          &gt; (let ([x '#0=(1 2 3)])
              (eq? x '#0#))
          #t
          &gt; (let ([x '#0#] [y '#0=(1 2 3)])
              (eq? x y))
          #t
          &gt; (eq? (cdr '(12 . #1#)) '#1=(1 2 3))
          #t
          &gt; (let ([x '#1=(#1# . #1#)])
              (and (eq? x (car x))
                   (eq? x (cdr x))))
          #t
</pre>
        <p>The <code>print-graph</code> parameter controls how the writers (e.g. 
<code>pretty-print</code> and <code>write</code>) handle shared and cyclic data
structures.  In Vicare, all writers detect cyclic data structures and
they all terminate on all input, cyclic or otherwise.

        <p>If the value of <code>print-graph</code> is set to <code>#f</code> (the default),
then the writers do not attempt to detect shared data structures.  Any
part of the input that is shared is printed as if no sharing is present. 
If the value of <code>print-graph</code> is set to <code>#t</code>, all sharing of
data structures is marked using the <code>#n=</code> and <code>#n#</code> notation.

     <pre class="example">          &gt; (parameterize ([print-graph #f])
              (let ([x (list 1 2 3 4)])
                (pretty-print (list x x x))))
          ((1 2 3 4) (1 2 3 4) (1 2 3 4))
          
          &gt; (parameterize ([print-graph #t])
              (let ([x (list 1 2 3 4)])
                (pretty-print (list x x x))))
          (#0=(1 2 3 4) #0# #0#)
          
          &gt; (parameterize ([print-graph #f])
              (let ([x (list 1 2)])
                (let ([y (list x x x x)])
                  (set-car! (last-pair y) y)
                  (pretty-print (list y y)))))
          (#0=((1 2) (1 2) (1 2) #0#) #0#)
          
          &gt; (parameterize ([print-graph #t])
              (let ([x (list 1 2)])
                (let ([y (list x x x x)])
                  (set-car! (last-pair y) y)
                  (pretty-print (list y y)))))
          (#0=(#1=(1 2) #1# #1# #0#) #0#)
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Parameter: <b>print-unicode</b><var><a name="index-print_002dunicode-164"></a></var><br>
&mdash; Parameter: <b>print-unicode</b><var> #t<a name="index-print_002dunicode-165"></a></var><br>
&mdash; Parameter: <b>print-unicode</b><var> #f<a name="index-print_002dunicode-166"></a></var><br>
<blockquote><p>If set to true: print Scheme Unicode characters outside of the printable
<acronym>ASCII</acronym> range in hex format, else print them using the encoding of the
output port.  The default is false. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>print-gensym</b><var><a name="index-print_002dgensym-167"></a></var><br>
&mdash; Parameter: <b>print-gensym</b><var> #t<a name="index-print_002dgensym-168"></a></var><br>
&mdash; Parameter: <b>print-gensym</b><var> #f<a name="index-print_002dgensym-169"></a></var><br>
&mdash; Parameter: <b>print-gensym</b><var> 'pretty<a name="index-print_002dgensym-170"></a></var><br>
<blockquote><p>The parameter <code>print-gensym</code> controls how gensyms are printed by
the various writers.

        <p>If the value of <code>print-gensym</code> is <code>#f</code>, then gensym syntax is
suppressed by the writers and only the gensyms' pretty names are
printed.  If the value of <code>print-gensym</code> is <code>#t</code>, then the full
<code>#{pretty unique}</code> syntax is printed.  Finally, if the value of
<code>print-gensym</code> is the symbol <code>pretty</code>, then gensyms are
printed using the <code>#:pretty</code> notation.

     <pre class="example">          &gt; (parameterize ([print-gensym #f])
              (pretty-print (list (gensym) (gensym))))
          (g0 g1)
          
          &gt; (parameterize ([print-gensym #t])
              (pretty-print (list (gensym) (gensym))))
          (#{g2 |KR1M2&amp;CTt1&lt;B0n/m|} #{g3 |FBAb&amp;7NC6&amp;=c82!O|})
          
          &gt; (parameterize ([print-gensym 'pretty])
              (pretty-print (list (gensym) (gensym))))
          (#:g4 #:g5)
</pre>
        <p>The initial value of <code>print-gensym</code> is <code>#t</code>.

        </blockquote></div>

<div class="defun">
&mdash; Parameter: <b>gensym-prefix</b><var><a name="index-gensym_002dprefix-171"></a></var><br>
&mdash; Parameter: <b>gensym-prefix</b><var> string<a name="index-gensym_002dprefix-172"></a></var><br>
<blockquote><p>The parameter <code>gensym-prefix</code> specifies the string to be used as
the prefix to generated pretty names.  The default value of
<code>gensym-prefix</code> is the string <code>g</code>, which causes generated
strings to have pretty names in the sequence <code>g0</code>, <code>g1</code>,
<code>g2</code>, etc.

     <pre class="example">          &gt; (parameterize ([gensym-prefix "var"]
                           [print-gensym #f])
               (pretty-print (list (gensym) (gensym) (gensym))))
          (var0 var1 var2)
</pre>
        <p>Beware that the <code>gensym-prefix</code> controls how pretty names are
generated, and has nothing to do with how <code>gensym</code> constructs a new
gensym.  In particular, notice the difference between the output in the
first example with the output of the examples below:

     <pre class="example">          &gt; (pretty-print
              (parameterize ([gensym-prefix "var"] [print-gensym #f])
                (list (gensym) (gensym) (gensym))))
          (g3 g4 g5)
          
          &gt; (let ([ls (list (gensym) (gensym) (gensym))])
              (parameterize ([gensym-prefix "var"] [print-gensym #f])
                (pretty-print ls)))
          (var5 var6 var7)
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Parameter: <b>gensym-count</b><var><a name="index-gensym_002dcount-173"></a></var><br>
&mdash; Parameter: <b>gensym-count</b><var> n<a name="index-gensym_002dcount-174"></a></var><br>
<blockquote><p>The parameter <code>gensym-count</code> determines the number which is
attached to the <code>gensym-prefix</code> when gensyms' pretty names are
generated.  The initial value of <code>gensym-count</code> is 0 and is
incremented every time a pretty name is generated.  It might be set to
any non-negative integer value.

     <pre class="example">          &gt; (let ([x (gensym)])
              (parameterize ([gensym-count 100] [print-gensym #f])
                (pretty-print (list (gensym) x (gensym)))))
          (g100 g101 g102)
</pre>
        </blockquote></div>

   <p>Notice from all the examples so far that pretty names are generated in
the order at which the gensyms are printed, not in the order in which
gensyms were created.

<!-- page -->
<div class="node">
<a name="iklib-tracing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-timing">iklib timing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-printing">iklib printing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.17 Tracing</h3>

<div class="defun">
&mdash; Syntax: <b>trace-define</b> (<var>name . args</var>)<var> body body* ...<a name="index-trace_002ddefine-175"></a></var><br>
&mdash; Syntax: <b>trace-define</b><var> name expression<a name="index-trace_002ddefine-176"></a></var><br>
<blockquote><p>The <code>trace-define</code> syntax is similar to <code>define</code> except that
the bound value, which must be a procedure, becomes a traced procedure. 
A traced procedure prints its arguments when it is called and prints its
values when it returns.

     <pre class="example">          &gt; (trace-define (fact n)
              (if (zero? n) 1 (* n (fact (- n 1)))))
          &gt; (fact 5)
          |(fact 5)
          | (fact 4)
          | |(fact 3)
          | | (fact 2)
          | | |(fact 1)
          | | | (fact 0)
          | | | 1
          | | |1
          | | 2
          | |6
          | 24
          |120
          120
</pre>
        <p>The tracing facility in Vicare preserves and shows tail recursion and
distinguishes it from non&ndash;tail recursion by showing tail calls starting
at the same line in which their parent was called.

     <pre class="example">          &gt; (trace-define (fact n)
              (trace-define (fact-aux n m)
                (if (zero? n) m (fact-aux (- n 1) (* n m))))
              (fact-aux n 1))
          &gt; (fact 5)
          |(fact 5)
          |(fact-aux 5 1)
          |(fact-aux 4 5)
          |(fact-aux 3 20)
          |(fact-aux 2 60)
          |(fact-aux 1 120)
          |(fact-aux 0 120)
          |120
          120
</pre>
        <p>Moreover, the tracing facility interacts well with continuations and
exceptions.

     <pre class="example">          &gt; (call/cc
              (lambda (k)
                (trace-define (loop n)
                  (if (zero? n)
                      (k 'done)
                      (+ (loop (- n 1)) 1)))
                (loop 5)))
          |(loop 5)
          | (loop 4)
          | |(loop 3)
          | | (loop 2)
          | | |(loop 1)
          | | | (loop 0)
          done
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Syntax: <b>trace-lambda</b><var> name args body body* ...<a name="index-trace_002dlambda-177"></a></var><br>
<blockquote><p>The <code>trace-lambda</code> macro is similar to <code>lambda</code> except that
the resulting procedure is traced: it prints the arguments it receives
and the results it returns. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>make-traced-procedure</b><var> name proc<a name="index-make_002dtraced_002dprocedure-178"></a></var><br>
<blockquote><p>The procedure <code>make-traced-procedure</code> takes a name (typically a
symbol) and a procedure.  It returns a procedure similar to <var>proc</var>
except that it traces its arguments and values.

     <pre class="example">          &gt; (define (fact n)
              (if (zero? n)
                  (lambda (k) (k 1))
                  (lambda (k)
                    ((fact (- n 1))
                     (make-traced-procedure `(k ,n)
                       (lambda (v)
                         (k (* v n))))))))
          &gt; (call/cc
              (lambda (k)
                ((fact 5) (make-traced-procedure 'K k))))
          |((k 1) 1)
          |((k 2) 1)
          |((k 3) 2)
          |((k 4) 6)
          |((k 5) 24)
          |(K 120)
          120
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-timing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-guardians">iklib guardians</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-tracing">iklib tracing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.18 Timing</h3>

<p>This section describes some of Vicare's timing facilities which may be
useful for benchmarking and performance tuning.

<div class="defun">
&mdash; Syntax: <b>time</b><var> expression<a name="index-time-179"></a></var><br>
<blockquote><p>The <code>time</code> macro performs the following: it evaluates
<var>expression</var>, then prints a summary of the run time statistics, then
returns the values returned by <var>expression</var>.  The run&ndash;time summary
includes the number of bytes allocated, the number of garbage collection
runs, and the time spent in both the mutator and the collector.

     <pre class="example">          &gt; (let ()                                   ;;; 10 million
              (define ls (time (vector-&gt;list (make-vector 10000000))))
              (time (append ls ls))
              (values))
          running stats for (vector-&gt;list (make-vector 10000000)):
              3 collections
              672 ms elapsed cpu time, including 547 ms collecting
              674 ms elapsed real time, including 549 ms collecting
              120012328 bytes allocated
          running stats for (append ls ls):
              4 collections
              1536 ms elapsed cpu time, including 1336 ms collecting
              1538 ms elapsed real time, including 1337 ms collecting
              160000040 bytes allocated
</pre>
        <blockquote>
<em>Note:</em> The output listed above is <em>just a sample</em> that was
taken at some point on some machine.  The output on your machine at the
time you read this may vary. 
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>time-it</b><var> who thunk<a name="index-time_002dit-180"></a></var><br>
<blockquote><p>The procedure <code>time-it</code> takes a datum denoting the name of the
computation and a thunk (i.e. a procedure with no arguments), invokes
the thunk, prints the stats, and returns the values obtained from
invoking the thunk.  If the value of <var>who</var> is non&ndash;false, <var>who</var>
is used when displaying the run&ndash;time statistics.  If the value of
<var>who</var> is <code>#f</code>, then no name for the computation is displayed.

     <pre class="example">          &gt; (time-it "a very fast computation"
              (lambda () (values 1 2 3)))
          running stats for a very fast computation:
              no collections
              0 ms elapsed cpu time, including 0 ms collecting
              0 ms elapsed real time, including 0 ms collecting
              24 bytes allocated
          1
          2
          3
          
          &gt; (time-it #f (lambda () 12))
          running stats:
              no collections
              0 ms elapsed cpu time, including 0 ms collecting
              0 ms elapsed real time, including 0 ms collecting
              0 bytes allocated
          12
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>time-and-gather</b><var> gather thunk<a name="index-time_002dand_002dgather-181"></a></var><br>
<blockquote><p>Like <code>time-it</code> evaluate the procedure <var>thunk</var> timing its
execution; return the return values of <var>thunk</var>.  Build two objects
of type <code>stats</code> and apply the procedure <var>gather</var> to them: the
first represents the statistics before <var>thunk</var> evaluation, the
second represents the statistics after <var>thunk</var> evaluation. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats?</b><var> obj<a name="index-stats_003f-182"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is an object of type <code>stats</code>. 
</p></blockquote></div>

   <p>All the fields of a <code>stats</code> object hold fixnums.

<div class="defun">
&mdash; Function: <b>stats-user-secs</b><var> stats<a name="index-stats_002duser_002dsecs-183"></a></var><br>
<blockquote><p>Return the user seconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-user-usecs</b><var> stats<a name="index-stats_002duser_002dusecs-184"></a></var><br>
<blockquote><p>Return the user microseconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-sys-secs</b><var> stats<a name="index-stats_002dsys_002dsecs-185"></a></var><br>
<blockquote><p>Return the system seconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-sys-usecs</b><var> stats<a name="index-stats_002dsys_002dusecs-186"></a></var><br>
<blockquote><p>Return the system microseconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-real-secs</b><var> stats<a name="index-stats_002dreal_002dsecs-187"></a></var><br>
<blockquote><p>Return the real seconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-real-usecs</b><var> stats<a name="index-stats_002dreal_002dusecs-188"></a></var><br>
<blockquote><p>Return the real microseconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-collection-id</b><var> stats<a name="index-stats_002dcollection_002did-189"></a></var><br>
<blockquote><p>Return the collection identifier field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-gc-user-secs</b><var> stats<a name="index-stats_002dgc_002duser_002dsecs-190"></a></var><br>
<blockquote><p>Return the garbage collection user seconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-gc-user-usecs</b><var> stats<a name="index-stats_002dgc_002duser_002dusecs-191"></a></var><br>
<blockquote><p>Return the garbage collection user microseconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-gc-sys-secs</b><var> stats<a name="index-stats_002dgc_002dsys_002dsecs-192"></a></var><br>
<blockquote><p>Return the garbage collection system seconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-gc-sys-usecs</b><var> stats<a name="index-stats_002dgc_002dsys_002dusecs-193"></a></var><br>
<blockquote><p>Return the garbage collection system microseconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-gc-real-secs</b><var> stats<a name="index-stats_002dgc_002dreal_002dsecs-194"></a></var><br>
<blockquote><p>Return the garbage collection real seconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-gc-real-usecs</b><var> stats<a name="index-stats_002dgc_002dreal_002dusecs-195"></a></var><br>
<blockquote><p>Return the garbage collection real microseconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-bytes-minor</b><var> stats<a name="index-stats_002dbytes_002dminor-196"></a></var><br>
<blockquote><p>Return the garbage collection bytes minor field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-bytes-major</b><var> stats<a name="index-stats_002dbytes_002dmajor-197"></a></var><br>
<blockquote><p>Return the garbage collection bytes major field of <var>stats</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-guardians"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io">iklib io</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-timing">iklib timing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.19 Guardians and garbage collection</h3>

<p>Guardians are available in the <code>(ikarus)</code> library; quoting
<code>[DYBGUA]</code>:

   <blockquote>
Guardians provide a means to protect objects from destruction by the
garbage collector.  A guardian is an object with which objects can be
registered for preservation and from which objects actually saved from
destruction can be retrieved, one at a time, at the convenience of the
program. 
</blockquote>

<div class="defun">
&mdash; Function: <b>collect</b><var><a name="index-collect-198"></a></var><br>
<blockquote><p>Run the garbage collector.  If post&ndash;garbage collection hooks are
registered, they are run.  This binding is exported by the
<code>(ikarus)</code> library. 
</p></blockquote></div>

<ul class="menu">
<li><a accesskey="1" href="#iklib-guardians-examples">iklib guardians examples</a>:     Usage examples for guardians. 
<li><a accesskey="2" href="#iklib-guardians-api">iklib guardians api</a>:          Guardians programming interface. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-guardians-examples"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-guardians-api">iklib guardians api</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-guardians">iklib guardians</a>

</div>

<h4 class="subsection">3.19.1 Usage examples for guardians</h4>

<p>Let's say that we use the Vicare <acronym>FFI</acronym> to handle some memory
block (<a href="#iklib-foreign">iklib foreign</a> for details on the <acronym>FFI</acronym>); memory blocks
allocated with <code>malloc</code> are not released by the Vicare
garbage collector: we have to explicitly apply <code>free</code> to the
pointer value referencing them.

   <p>If we use the blocks synchronously with the evaluation of forms, we do
(assuming we do not use continuations, so this use of
<code>dynamic-wind</code> is fine):

<pre class="example">     (import (ikarus)
       (ikarus foreign))
     
     (define (do-something-with . args)
       (display args)
       (newline))
     
     (let ((p        #f)
           (size     4096))
       (dynamic-wind
           (lambda ()
             (set! p (malloc size))
             (unless p (error #f "memory allocation")))
           (lambda ()
             (do-something-with p))
           (lambda ()
             (free p))))
</pre>
   <p class="noindent">and we can define a syntax for it:

<pre class="example">     (import (ikarus)
       (ikarus foreign))
     
     (define (do-something-with . args)
       (display args)
       (newline))
     
     (define-syntax with-block
       (syntax-rules ()
         ((_ ?pointer ?size ?body ...)
          (let ((?pointer    #f))
            (dynamic-wind
                (lambda ()
                  (set! ?pointer (malloc ?size))
                  (unless ?pointer (error #f "memory allocation")))
                (lambda ()
                  ?body ...)
                (lambda ()
                  (free ?pointer)))))))
     
     (with-block p 2048
       (do-something-with p))
     
     (with-block p 4096
       (do-something-with p))
     
     (with-block p 8192
       (do-something-with p))
</pre>
   <p>If we need the block in an event driven program: we will probably need
to use it asynchronously with the evaluation of forms.  For example, we
store the pointer value that references a block in a thunk (a closure
that takes no arguments):

<pre class="example">     (import (ikarus)
       (ikarus foreign))
     
     (define *event-source* '())
     
     (define (enqueue-event event)
       (set! *event-source*
             (reverse (cons event (reverse *event-source*)))))
     
     (define (pop-event)
       (if (null? *event-source*)
           #f
         (let ((event (car *event-source*)))
           (set! *event-source* (cdr *event-source*))
           event)))
     
     ;; Usage:
     
     (define (do-something-with . args)
       (display args)
       (newline))
     
     (let ((p (malloc 4096)))
       (unless p (error #f "memory allocation"))
       (enqueue-event (lambda ()
                        (do-something-with p)))
       (enqueue-event (lambda ()
                        (do-something-with 123)))
       (enqueue-event (lambda ()
                        (do-something-with p))))
     
     (do ((event (pop-event) (pop-event)))
         ((not event))
       (event))
</pre>
   <p class="noindent">once the thunks have been evaluated, the pointer value is garbage
collected, but the allocated memory block becomes leaked memory.  We
need a way to be notified of the pointer value garbage collection, so
that we can apply <code>free</code> to it; this is the job for guardians.

   <p>The following script shows the usage of a guardian to free a memory
block:

<pre class="example">     (import (ikarus)
       (ikarus foreign))
     
     (define g (make-guardian))
     
     (let ((a (malloc (expt 2 20))))
       (unless p (error #f "memory allocation"))
       (g a)
       (printf "value ~s~%" a))
     
     (printf "value from guardian ~s~%" (g))
     
     ;; This triggers a garbage collection.
     (collect)
     
     (let ((p (g)))
       (printf "value from guardian ~s~%" p)
       (free p))
</pre>
   <p>In an event driven program what we have to do is to register the pointer
into the guardian, and then periodically enqueue as event a call to the
guardian:

<pre class="example">     (import (ikarus)
       (ikarus foreign))
     
     ;; Event source handling.
     
     (define *event-source* '())
     
     (define (enqueue-event event)
       (set! *event-source*
             (reverse (cons event (reverse *event-source*)))))
     
     (define (pop-event)
       (if (null? *event-source*)
           #f
         (let ((event (car *event-source*)))
           (set! *event-source* (cdr *event-source*))
           event)))
     
     ;; Block guardian.
     
     (define block-guardian (make-guardian))
     
     (define (run-block-guardian)
       (do ((p (block-guardian) (block-guardian)))
           ((not p))
         (printf "collecting ~s~%" p)
         (free p)))
     
     ;; Application follows.
     
     (define (do-something-with . args)
       (display args)
       (newline))
     
     (let ((p (malloc (expt 2 20))))
       (unless p (error #f "memory allocation"))
       (block-guardian p)
       (enqueue-event (lambda () (do-something-with p)))
       (enqueue-event (lambda () (do-something-with 123)))
       (enqueue-event (lambda () (do-something-with p)))
       (enqueue-event (lambda () (do-something-with 456))))
     
     (do ((event (pop-event) (pop-event))
          (i 1 (+ i 1)))
         ((= i 20))
       (when event
         (event))
       (when (= 0 (modulo i 10))
         (collect)
         (enqueue-event run-block-guardian)))
</pre>
   <!-- page -->
<div class="node">
<a name="iklib-guardians-api"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-guardians-examples">iklib guardians examples</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-guardians">iklib guardians</a>

</div>

<h4 class="subsection">3.19.2 Guardians programming interface</h4>

<div class="defun">
&mdash; Function: <b>make-guardian</b><var><a name="index-make_002dguardian-199"></a></var><br>
<blockquote><p>Build and return a new guardian object: a closure that can be called
with one or zero arguments, and that is interfaced with the garbage
collector of the Scheme implementation (in a non&ndash;portable way).

        <p>The guardian works like this:

          <ul>
<li>when the closure is called with one argument: it adds the argument to an
internal set of &ldquo;guarded values&rdquo;, accessible to the garbage collector;

          <li>when the garbage collector detects no other references to a value in the
set of guarded values: the guardian removes it from the set and appends
it to an internal queue (<acronym>FIFO</acronym>);

          <li>when the closure is called with zero arguments: it removes the first
value from the internal queue and returns it; if no values are in the
queue it returns <code>#f</code>. 
</ul>

        <p>After an object has been returned by the guardian, it is no more
&ldquo;guarded&rdquo; so it will be garbage collected when it will become
inaccessible (unsless it is registered in a guardian).

        <blockquote>
<em>Note:</em> it is possible to register an object in more than one
guardian, when the object is found inaccessible all the guardian
closures that have it will return it to the caller.  This may lead to
invalid finalisation operations, it is the responsibility of the
programmer to avoid this. 
</blockquote>

        <blockquote>
<em>Note:</em> it is possible to register an object multiple times in the
same guardian, when the object is found inaccessible the guardian
closure that has it will return it to the caller multiple times.  This
may lead to invalid finalisation operations, it is the responsibility of
the programmer to avoid this. 
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>post-gc-hooks</b><var><a name="index-post_002dgc_002dhooks-200"></a></var><br>
<blockquote><p>Hold a list of thunks evaluated after each garbage collection run.  It
can be used to run a guardian cleanup function like this (using the
example in the previous section):

     <pre class="example">          (define (run-block-guardian)
            (do ((p (block-guardian) (block-guardian)))
                ((not p))
              (free p)))
          
          (post-gc-hooks
           (cons run-block-guardian
            (post-gc-hooks)))
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-foreign">iklib foreign</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-guardians">iklib guardians</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.20 Input/output library</h3>

<ul class="menu">
<li><a accesskey="1" href="#iklib-io-filename">iklib io filename</a>:            File pathname handling. 
<li><a accesskey="2" href="#iklib-io-codecs">iklib io codecs</a>:              Transcoders and additional codecs. 
<li><a accesskey="3" href="#iklib-io-binary">iklib io binary</a>:              Additional binary port features. 
<li><a accesskey="4" href="#iklib-io-textual">iklib io textual</a>:             Additional textual port features. 
<li><a accesskey="5" href="#iklib-io-buffer">iklib io buffer</a>:              Buffer size customisation. 
<li><a accesskey="6" href="#iklib-io-process">iklib io process</a>:             Spawning processes. 
<li><a accesskey="7" href="#iklib-io-socket">iklib io socket</a>:              Using network sockets. 
<li><a accesskey="8" href="#iklib-io-non_002dblock">iklib io non-block</a>:           Non--blocking mode for ports. 
<li><a accesskey="9" href="#iklib-io-misc">iklib io misc</a>:                Miscellaneous port functions. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-io-filename"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-codecs">iklib io codecs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.20.1 File pathname handling</h4>

<p>All the file&ndash;related functions defined by <acronym>R6RS</acronym> accept a Scheme
string as representing a file pathname; internally such string is
converted to a bytevector to be handed to the underlying operative
system.  The following bindings are exported by the <code>(ikarus)</code>
library.

<div class="defun">
&mdash; Parameter: <b>string-&gt;filename-func</b><var><a name="index-string_002d_003efilename_002dfunc-201"></a></var><br>
<blockquote><p>In Vicare the string&ndash;to&ndash;filename conversion is performed by
the function returned by <code>string-&gt;filename-func</code>, which defaults to
<code>string-&gt;utf8</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>filename-&gt;string-func</b><var><a name="index-filename_002d_003estring_002dfunc-202"></a></var><br>
<blockquote><p>In Vicare the filename&ndash;to&ndash;string conversion is performed by
the function returned by <code>filename-&gt;string-func</code>, which defaults to
<code>utf8-&gt;string</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io-codecs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-binary">iklib io binary</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-filename">iklib io filename</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.20.2 Transcoders and additional codecs</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Parameter: <b>native-transcoder</b><var><a name="index-native_002dtranscoder-203"></a></var><br>
<blockquote><p><a name="index-open_002dinput_002dfile-204"></a><a name="index-with_002dinput_002dfrom_002dfile-205"></a><a name="index-call_002dwith_002dinput_002dfile-206"></a><a name="index-open_002doutput_002dfile-207"></a><a name="index-with_002doutput_002dto_002dfile-208"></a><a name="index-call_002dwith_002doutput_002dfile-209"></a>The function <code>native-transcoder</code> defined by <acronym>R6RS</acronym> returns a
transcoder representing acceptable defaults for the platform on which
the Scheme implementation is running.  Under Vicare such
default is:

     <pre class="example">          (make-transcoder (utf-8-codec) 'none 'replace)
</pre>
        <p class="noindent">and additionally the function is a parameter, so the default can be
configured.  Notice that the following functions create Scheme ports
using the transcoder returned by <code>native-transcoder</code>:

     <pre class="example">          open-input-file         open-output-file
          with-input-from-file    with-output-to-file
          call-with-input-file    call-with-output-file
</pre>
        </blockquote></div>

   <p>The codec returned by <code>utf-16-codec</code>, defined by <acronym>R6RS</acronym>, has
different semantics depending upon the type of the port:

     <ul>
<li>For output and input/output ports it defaults to <acronym>UTF</acronym>-16 big endian
(which seems mandated by the Unicode Consortium).

     <li>For input ports the endianness is left unspecified until the first bytes
are read: such bytes must be a valid <acronym>UTF</acronym>-16 Byte Order Mark which
dynamically configures the port.<a rel="footnote" href="#fn-3" name="fnd-3"><sup>3</sup></a>
</ul>

<div class="defun">
&mdash; Procedure: <b>utf-16le-codec</b><var><a name="index-utf_002d16le_002dcodec-210"></a></var><br>
&mdash; Procedure: <b>utf-16be-codec</b><var><a name="index-utf_002d16be_002dcodec-211"></a></var><br>
<blockquote><p>Codecs for the <acronym>UTF</acronym>-16 encoding schemes, little endian and big endian. 
A call to any of these procedures returns a value that is equal in the
sense of <code>eqv?</code> to the result of any other call to the same
procedure. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>utf-16n-codec</b><var><a name="index-utf_002d16n_002dcodec-212"></a></var><br>
<blockquote><p>Return a codec for the <acronym>UTF</acronym>-16 encoding scheme, with endianness equal
to the one returned by <code>(native-endianness)</code>.  A call to this
procedure returns a value that is equal in the sense of <code>eqv?</code> to
the result of any other call to the same procedure. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>utf-bom-codec</b><var><a name="index-utf_002dbom_002dcodec-213"></a></var><br>
<blockquote><p>Codec for <acronym>UTF</acronym> encoding schemes whose data open with a Byte Order
Mark.  A call to this procedure returns a value that is equal in the
sense of <code>eqv?</code> to the result of any other call to the same
procedure. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io-binary"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-textual">iklib io textual</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-codecs">iklib io codecs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.20.3 Additional binary port features</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>lookahead-two-u8</b><var> port<a name="index-lookahead_002dtwo_002du8-214"></a></var><br>
<blockquote><p>Like <code>lookahead-u8</code> but peeks at 2 octets and return two
values: the <acronym>EOF</acronym> object or a fixnum representing first octet, the
<acronym>EOF</acronym> object or a fixnum representing the second octet. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>console-input-port</b><var><a name="index-console_002dinput_002dport-215"></a></var><br>
<blockquote><p>Return the default value of the <code>current-input-port</code> parameter. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>console-output-port</b><var><a name="index-console_002doutput_002dport-216"></a></var><br>
<blockquote><p>Return the default value of the <code>current-outptu-port</code> parameter. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>console-error-port</b><var><a name="index-console_002derror_002dport-217"></a></var><br>
<blockquote><p>Return the default value of the <code>current-error-port</code> parameter. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io-textual"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-buffer">iklib io buffer</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-binary">iklib io binary</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.20.4 Additional textual port features</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>open-string-input-port</b><var> string<a name="index-open_002dstring_002dinput_002dport-218"></a></var><br>
&mdash; Function: <b>open-string-input-port</b><var> string eol-style<a name="index-open_002dstring_002dinput_002dport-219"></a></var><br>
<blockquote><p>As defined by <acronym>R6RS</acronym>: return a textual input port whose characters are
drawn from <var>string</var>.  When <var>eol-style</var> is given: it must be a
symbol selecting an end&ndash;of&ndash;line style conversion, as accepted by
<code>eol-style</code>; such conversion is applied to the characters drawn
from <var>string</var>.

        <p>If <var>string</var> is modified after <code>open-string-input-port</code> has been
called, the effect on the returned port is unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>open-string-input-port/id</b><var> string id<a name="index-open_002dstring_002dinput_002dport_002fid-220"></a></var><br>
&mdash; Function: <b>open-string-input-port/id</b><var> string id eol-style<a name="index-open_002dstring_002dinput_002dport_002fid-221"></a></var><br>
<blockquote><p>Like <code>open-string-input-port</code> but allows the specification of a
customised port identifier <var>id</var>, which must be a Scheme string. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>open-string-output-port</b><var><a name="index-open_002dstring_002doutput_002dport-222"></a></var><br>
&mdash; Function: <b>open-string-output-port</b><var> eol-style<a name="index-open_002dstring_002doutput_002dport-223"></a></var><br>
<blockquote><p>As defined by <acronym>R6RS</acronym>, return two values: a textual output port and an
extraction procedure; the output port accumulates the characters written
to it for later extraction by the procedure.

        <p>As a Vicare extension, when <var>eol-style</var> is given: it must
be a symbol selecting an end&ndash;of&ndash;line style conversion, as accepted by
<code>eol-style</code>; such conversion is applied to the characters written
to the port. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>get-char-and-track-textual-position</b><var> port<a name="index-get_002dchar_002dand_002dtrack_002dtextual_002dposition-224"></a></var><br>
<blockquote><p>Like <code>get-char</code> but track the textual position.  Recognise only
linefeed characters as line-ending. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>port-textual-position</b><var> port<a name="index-port_002dtextual_002dposition-225"></a></var><br>
<blockquote><p>Given a textual port, return the current textual position as a condition
object of type <code>&amp;source-position</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io-buffer"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-process">iklib io process</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-textual">iklib io textual</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.20.5 Buffer size customisation</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Parameter: <b>bytevector-port-buffer-size</b><var><a name="index-bytevector_002dport_002dbuffer_002dsize-226"></a></var><br>
&mdash; Parameter: <b>bytevector-port-buffer-size</b><var> fixnum<a name="index-bytevector_002dport_002dbuffer_002dsize-227"></a></var><br>
<blockquote><p>Hold the buffer size for bytevector ports, like the one returned by
<code>open-bytevector-output-port</code>.  It is initialised to 16384. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>string-port-buffer-size</b><var><a name="index-string_002dport_002dbuffer_002dsize-228"></a></var><br>
&mdash; Parameter: <b>string-port-buffer-size</b><var> fixnum<a name="index-string_002dport_002dbuffer_002dsize-229"></a></var><br>
<blockquote><p>Hold the buffer size for string ports, like the one returned by
<code>open-string-output-port</code>.  It is initialised to 256. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>input-file-buffer-size</b><var><a name="index-input_002dfile_002dbuffer_002dsize-230"></a></var><br>
&mdash; Parameter: <b>input-file-buffer-size</b><var> fixnum<a name="index-input_002dfile_002dbuffer_002dsize-231"></a></var><br>
<blockquote><p>Hold the buffer size for input file ports, like the one returned by
<code>open-input-file</code>.  It is initialised to 16384. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>output-file-buffer-size</b><var><a name="index-output_002dfile_002dbuffer_002dsize-232"></a></var><br>
&mdash; Parameter: <b>output-file-buffer-size</b><var> fixnum<a name="index-output_002dfile_002dbuffer_002dsize-233"></a></var><br>
<blockquote><p>Hold the buffer size for output file ports, like the one returned by
<code>open-output-file</code>.  It is initialised to 16384. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>input/output-file-buffer-size</b><var><a name="index-input_002foutput_002dfile_002dbuffer_002dsize-234"></a></var><br>
&mdash; Parameter: <b>input/output-file-buffer-size</b><var> fixnum<a name="index-input_002foutput_002dfile_002dbuffer_002dsize-235"></a></var><br>
<blockquote><p>Hold the buffer size for input/output file ports, like the one returned
by <code>open-file-input/output-prot</code>.  It is initialised to
16384. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>input-socket-buffer-size</b><var><a name="index-input_002dsocket_002dbuffer_002dsize-236"></a></var><br>
&mdash; Parameter: <b>input-socket-buffer-size</b><var> fixnum<a name="index-input_002dsocket_002dbuffer_002dsize-237"></a></var><br>
<blockquote><p>Hold the buffer size for input socket ports.  It is initialised to
16384. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>output-socket-buffer-size</b><var><a name="index-output_002dsocket_002dbuffer_002dsize-238"></a></var><br>
&mdash; Parameter: <b>output-socket-buffer-size</b><var> fixnum<a name="index-output_002dsocket_002dbuffer_002dsize-239"></a></var><br>
<blockquote><p>Hold the buffer size for output socket ports.  It is initialised to
16384. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io-process"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-socket">iklib io socket</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-buffer">iklib io buffer</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.20.6 Spawning processes</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>process</b><var> command . options<a name="index-process-240"></a></var><br>
<blockquote><p>Run a subprocess with a set of command line options.  <var>command</var> is a
string selecting the executable pathname.  <var>options</var> is a list of
strings interpreted as command line options.

        <p>If <var>command</var> does not not contain a <code>/</code> character, the command
is searched in the directories listed in the <samp><span class="env">PATH</span></samp> environment
variable.

        <p>Return multiple values:

          <ol type=1 start=1>
<li>The subprocess pid.

          <li>An output port that writes to the subprocess' standard input channel.

          <li>An input port that reads from the subprocess' standard output channel.

          <li>An input port that reads from the subprocess' standard error channel.
             </ol>

        <p>If an error occurs: an exception is raised.

        <p>Example:

     <pre class="example">          (let-values
              (((pid stdin-output-port stdout-input-port stderr-input-port)
                (process "ls" "-l")))
            (do-something))
</pre>
        <blockquote>
<strong>Unix:</strong> <code>process</code> makes use of the <code>fork()</code> and
<code>execvp()</code> system functions.<br>

        <p><a href="libc.html#Creating-a-Process">Creating a Process</a><br> <a href="libc.html#Executing-a-File">Executing a File</a><br> <a href="libc.html#Standard-Environment">Standard Environment Variables</a>
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>process-nonblocking</b><var> command . options<a name="index-process_002dnonblocking-241"></a></var><br>
<blockquote><p>Like <code>process</code> but the returned ports have their underlying file
descriptors configured to non&ndash;blocking mode; <a href="#iklib-io-non_002dblock">iklib io non-block</a>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io-socket"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-non_002dblock">iklib io non-block</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-process">iklib io process</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.20.7 Using network sockets</h4>

<ul class="menu">
<li><a accesskey="1" href="#iklib-io-socket-client">iklib io socket client</a>:       Establishing client network
                                connections. 
<li><a accesskey="2" href="#iklib-io-socket-server">iklib io socket server</a>:       Opening server network services. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-io-socket-client"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-socket-server">iklib io socket server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io-socket">iklib io socket</a>

</div>

<h5 class="subsubsection">3.20.7.1 Establishing client network connections</h5>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>tcp-connect</b><var> hostname service<a name="index-tcp_002dconnect-242"></a></var><br>
&mdash; Function: <b>udp-connect</b><var> hostname service<a name="index-udp_002dconnect-243"></a></var><br>
&mdash; Function: <b>tcp-connect-nonblocking</b><var> hostname service<a name="index-tcp_002dconnect_002dnonblocking-244"></a></var><br>
&mdash; Function: <b>udp-connect-nonblocking</b><var> hostname service<a name="index-udp_002dconnect_002dnonblocking-245"></a></var><br>
<blockquote><p>Establish a network connection using the <acronym>TCP</acronym> or <acronym>UDP</acronym> protocol, to
the host selected by the string <var>hostname</var>, port/service selected by
the string <var>service</var>.  The <code>-nonblocking</code> version sets the
underlying socket descriptor to non&ndash;blocking mode (<a href="#iklib-io-non_002dblock">iklib io non-block</a>).  Upon success, return a port; if an error occurs an
exception is raised.

        <p><var>hostname</var> can be a dotted decimal address for IPv4, or a
hexadecimal string for IPv6, or a network address.

        <p><var>service</var> can be a numerical string representing the port, or the
&ldquo;official&rdquo; name of a service, like <code>smtp</code> or <code>pop3</code>.

        <blockquote>
<strong>Unix:</strong> These functions use of the <code>socket()</code>, <code>connect()</code>
and <code>getaddrinfo()</code> system functions.

        <p><a href="libc.html#Creating-a-Socket">Creating a Socket</a><br>
<a href="libc.html#Connecting">Making a Connection</a><br>
See the <code>getaddrinfo()</code> manual page.<br>
See the <samp><span class="file">/etc/services</span></samp> configuration file. 
</blockquote>
        </p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io-socket-server"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-socket-client">iklib io socket client</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io-socket">iklib io socket</a>

</div>

<h5 class="subsubsection">3.20.7.2 Opening server network services</h5>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>tcp-server-socket</b><var> server-port-number<a name="index-tcp_002dserver_002dsocket-246"></a></var><br>
&mdash; Function: <b>tcp-server-socket-nonblocking</b><var> server-port-number<a name="index-tcp_002dserver_002dsocket_002dnonblocking-247"></a></var><br>
<blockquote><p>Build a new <acronym>TCP</acronym> server object for the selected port number (which
must be an exact integer).  The <code>-nonblocking</code> versions set the
underlying socket descriptor to non&ndash;blocking mode (<a href="#iklib-io-non_002dblock">iklib io non-block</a>).  Upon success, return a server&ndash;object; if an error occurs
an exception is raised.

        <blockquote>
<strong>Unix:</strong> These functions make use of the <code>socket()</code>,
<code>setsockopt()</code>, <code>bind()</code> and <code>listen()</code> system functions. 
The socket is configured with the <code>AF_INET</code>, <code>INADDR_ANY</code>,
<code>SO_REUSEADDR</code> values and options (Vicare version 0.0.3+, checkout
1468).

        <p><a href="libc.html#Creating-a-Socket">Creating a Socket</a><br>
<a href="libc.html#Socket-Option-Functions">Socket Option Functions</a><br>
<a href="libc.html#Setting-Address">Setting the Address of a Socket</a><br>
<a href="libc.html#Listening">Listening for Connections</a>
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>accept-connection</b><var> server-object<a name="index-accept_002dconnection-248"></a></var><br>
&mdash; Function: <b>accept-connection-nonblocking</b><var> server-object<a name="index-accept_002dconnection_002dnonblocking-249"></a></var><br>
<blockquote><p>Accept the next incoming connection to the selected server.  If success
return two values:

          <ol type=1 start=1>
<li>an output port to be used to send data;

          <li>an input port to be used to receive data;
             </ol>

     <p class="noindent">if an error occurs: an exception is raised.  The <code>-nonblocking</code>
versions set the underlying socket descriptor to non&ndash;blocking mode
(<a href="#iklib-io-non_002dblock">iklib io non-block</a>).

        <p>If the server socket was configured as blocking: this function suspends
the process waiting for an incoming connection.

        <blockquote>
<strong>FIXME: What happens when the server socket is configured as
non&ndash;blocking?</strong>
</blockquote>

        <blockquote>
<strong>Unix:</strong> These functions make use of the <code>accept()</code> system call.

        <p><a href="libc.html#Accepting-Connections">Accepting Connections</a>
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>close-tcp-server-socket</b><var> server-object<a name="index-close_002dtcp_002dserver_002dsocket-250"></a></var><br>
<blockquote><p>Close a server socket causing it to stop listening.

        <blockquote>
<strong>Unix:</strong> this function makes use of the <code>shutdown()</code> system
function.

        <p><a href="libc.html#Closing-a-Socket">Closing a Socket</a>
See also the <code>shutdown()</code> manual page. 
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>register-callback</b><var> server-object proc<a name="index-register_002dcallback-251"></a></var><br>
<blockquote><p>Register a callback function to be invoked whenever a new incoming
connection request happens on <var>server-object</var>.  The callback will be
invoked by the Vicare event loop.

        <blockquote>
<strong>FIXME: What are the parameters that get passed to </strong><var>proc</var><strong>?  Look for
</strong><code>make-t</code><strong> and </strong><code>t-proc</code><strong> in </strong><samp><span class="file">ikarus.io.ss</span></samp><strong>.</strong>
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>input-socket-buffer-size</b><var><a name="index-input_002dsocket_002dbuffer_002dsize-252"></a></var><br>
<blockquote><p>Select the size in bytes of the input buffer for server sockets.  The
value must be a fixnum greater or equal to 128. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>output-socket-buffer-size</b><var><a name="index-output_002dsocket_002dbuffer_002dsize-253"></a></var><br>
<blockquote><p>Select the size in bytes of the output buffer for server sockets.  The
value must be a fixnum greater than zero. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io-non-block"></a>
<a name="iklib-io-non_002dblock"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-misc">iklib io misc</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-socket">iklib io socket</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.20.8 Non&ndash;blocking mode for ports</h4>

<p><strong>Unix:</strong> Non&ndash;blocking mode is setup with a call like:

<pre class="example">     fcntl(fd, F_SETFL, O_NONBLOCK);
</pre>
   <p class="noindent"><a href="libc.html#Control-Operations">Control Operations</a><br>
<a href="libc.html#Open_002dtime-Flags">Open-time Flags</a>

<!-- page -->
<div class="node">
<a name="iklib-io-misc"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-non_002dblock">iklib io non-block</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.20.9 Miscellaneous port functions</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>port-id</b><var> port<a name="index-port_002did-254"></a></var><br>
<blockquote><p>Return a Scheme string representing the identifier of <var>port</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-foreign"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-misc">iklib misc</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io">iklib io</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.21 The <code>(vicare foreign)</code> library</h3>

<p>This chapter describes the facilities through which Vicare
interfaces with the host operating system and other external libraries. 
The facilities of the <code>(vicare foreign)</code> library give the Scheme
program unrestricted access to the computer memory, allowing one to
allocate, access, modify, and free memory as needed.  The facilities
also allow the Scheme program to <em>call out</em> to system procedures as
well as allow the native procedures to <em>call back</em> into Scheme.

   <blockquote>
<em>Note:</em> Vicare version <code>0.0.4</code> is the first version
of Vicare to support the described foreign interfaces. 
</blockquote>

   <blockquote>
<em>Caveat emptor:</em> Preparing each call out and call back procedure
leaks a small amount of memory.  This is because the system cannot track
such pointers that go into native code (which may retain such pointers
indefinitely).  Use judiciously. 
</blockquote>

<ul class="menu">
<li><a accesskey="1" href="#iklib-foreign-overview">iklib foreign overview</a>:   Overview of the foreign functions
                                interface. 
<li><a accesskey="2" href="#iklib-foreign-memory">iklib foreign memory</a>:     Memory management. 
<li><a accesskey="3" href="#iklib-foreign-memops">iklib foreign memops</a>:     Memory operations. 
<li><a accesskey="4" href="#iklib-foreign-dl">iklib foreign dl</a>:         Accessing foreign objects from Scheme. 
<li><a accesskey="5" href="#iklib-foreign-call-out">iklib foreign call out</a>:   Calling out to foreign procedures. 
<li><a accesskey="6" href="#iklib-foreign-call-back">iklib foreign call back</a>:  Calling back to Scheme. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-foreign-overview"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-foreign-memory">iklib foreign memory</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-foreign">iklib foreign</a>

</div>

<h4 class="subsection">3.21.1 Overview of the foreign functions interface</h4>

<p>In order to make full use of the computer, it is important for a
programming environment (e.g., Vicare Scheme) to facilitate
access to the underlying architecture on which it runs.  The underlying
architecture includes the <acronym>API</acronym> provided by the host operating system
kernel (e.g., Linux), the system libraries (e.g., <code>libc</code>), and
other site&ndash;installed libraries (e.g., <code>sqlite3</code>).

   <p>Providing direct access to such <acronym>API</acronym> from within Scheme allows the
programmer to write Scheme libraries that have few or no dependencies on
external programs (such as <code>C</code> development toolchain).  When
dealing with system libraries, the programmer must have a thorough
understanding of many aspects of the targeted system.  This section
attempts to provide answers to many questions that are frequently
encountered when interfacing to external libraries.

<!--  -->
<h5 class="subsubheading">Libffi</h5>

<p>Currently (Sat May 1, 2010) Vicare implements the foreign
functions interface (<acronym>FFI</acronym>) using an extenal library: Libffi,
originally by Anthony Green.  Libffi can be found at:

<div align="center"><a href="http://sourceware.org/libffi/">http://sourceware.org/libffi/</a></div>

<p class="noindent">and it is distributed under a liberal license (look for it at the site,
basically we can do everything but remove the original copyright
notice).

   <p>On Unix&ndash;like systems, we can install Libffi with the traditional
sequence:

<pre class="example">     $ ./configure [options]
     $ make
     $ make install
</pre>
   <p class="noindent">and the makefile supports the <samp><span class="env">DESTDIR</span></samp> environment variable for
installation under a different directory prefix.

   <blockquote>
<em>Note:</em> Libffi version 3.0.6 installs its header files under:

<pre class="example">     ${prefix}/lib/libffi-3.0.6/include
</pre>
   <p class="noindent">and trying to use the <samp><span class="option">--includedir</span></samp> option to
<samp><span class="command">configure</span></samp> will <strong>not</strong> work in changing this.  It means
that when configuring Vicare for installation we have to specify where
the Libffi headers are to be found; <a href="#overview-install">overview install</a> for details. 
</blockquote>

<!-- page -->
<div class="node">
<a name="iklib-foreign-memory"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-foreign-memops">iklib foreign memops</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-foreign-overview">iklib foreign overview</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-foreign">iklib foreign</a>

</div>

<h4 class="subsection">3.21.2 Memory management</h4>

<p>Vicare Scheme is a managed environment.  Like in many
programming environments, Vicare manages its own memory. 
Scheme objects are allocated in a special memory region (the Scheme
heap) and have type&ndash;specific object layouts; this allows the run time
system to distinguish object types and the garbage collector to locate
all potentially live objects, and reclaim the memory of dead objects. 
Scheme objects are also <em>opaque</em> in the sense that the data
structures used to represent Scheme objects (e.g., pairs) are not
exposed to the programmer, who can only interact with objects through an
interface (e.g., <code>car</code>, <code>cdr</code>).

   <p>Unmanaged environments, such as the operating system on which
Vicare runs, require that the programmer manages the allocation
and deallocation of system resources herself.  Memory regions, file
handles, external devices, the screen, etc., are all examples of
resources whose management must be coordinated among the different parts
of the system, and this becomes the responsibility of the programmer who
is wiring the different subsystems together.

   <p>Memory, from a system's point of view, is <em>transparent</em>.  A pointer
is an integer denoting an address of memory.  This memory address may
contain a value that requires interpretation.  At the lowest&ndash;level,
each byte of memory contains eight bits, each of which may be toggled on
or off.  A level higher, contiguous sequences of bytes are grouped
together and are interpreted as integers, floating point numbers, or
pointers to other memory addresses.  These are the basic data types that
are often interpreted atomically.  Yet a level higher, groups of basic
types form data structures such as arrays, linked lists, trees, and so
on.  Objects, as found in object&ndash;oriented programming languages, are at
an even higher level of abstraction since they are treated as opaque
references that retain state and know how to respond to messages.

   <p>The procedures in the <code>(vicare foreign)</code> library are meant to
provide a way to interface with the low level memory operations such as
setting and getting bytes from specific locations in memory.  Although
they do not provide high&ndash;level operations, the basic procedures make
implementing high&ndash;level operations (such as the Objective&ndash;C system)
possible.  Programmers are encouraged to define their own abstractions
that are most suitable for the specific target library rather than using
the low&ndash;level operations directly.  This results in writing more robust
and more easily maintainable libraries.  To put it more boldly:
<strong>Do not sprinkle your code with low&ndash;level memory operations</strong>.

<!-- page -->
<div class="node">
<a name="iklib-foreign-memops"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-foreign-dl">iklib foreign dl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-foreign-memory">iklib foreign memory</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-foreign">iklib foreign</a>

</div>

<h4 class="subsection">3.21.3 Memory operations</h4>

<ul class="menu">
<li><a accesskey="1" href="#iklib-foreign-memops-alloc">iklib foreign memops alloc</a>:     Allocating and freeing memory. 
<li><a accesskey="2" href="#iklib-foreign-memops-pointer">iklib foreign memops pointer</a>:   Handling pointer values. 
<li><a accesskey="3" href="#iklib-foreign-memops-poke">iklib foreign memops poke</a>:      Poking values. 
<li><a accesskey="4" href="#iklib-foreign-memops-peek">iklib foreign memops peek</a>:      Peeking values. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-foreign-memops-alloc"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-foreign-memops-pointer">iklib foreign memops pointer</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-foreign-memops">iklib foreign memops</a>

</div>

<h5 class="subsubsection">3.21.3.1 Allocating and freeing memory</h5>

<div class="defun">
&mdash; Procedure: <b>malloc</b><var> number-of-bytes<a name="index-malloc-255"></a></var><br>
<blockquote><p>Allocate a block of memory and return a pointer to it.  The
<code>malloc</code> Scheme procedure is implemented using the host&ndash;provided
<code>malloc()</code> system procedure (often found in <code>libc</code>).  The
number of bytes must be a positive exact integer.

     <pre class="example">          &gt; (malloc 10)
          #&lt;pointer #x00300320&gt;
          &gt; (malloc 10000)
          #&lt;pointer #x01800400&gt;
</pre>
        <p>In case of failure allocating memory: the return value is <code>#f</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>free</b><var> pointer-to-memory-block<a name="index-free-256"></a></var><br>
<blockquote><p>Release the memory region at the given address.  The memory region must
have been allocated with <code>malloc()</code>, <code>calloc()</code>, or a similar
system procedure.  Once freed, memory operations on the given address
are invalid and may cause the system to crash at unpredictable times. 
Vicare cannot check for such errors since the memory may be freed by
procedures that are external to Vicare. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-foreign-memops-pointer"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-foreign-memops-poke">iklib foreign memops poke</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-foreign-memops-alloc">iklib foreign memops alloc</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-foreign-memops">iklib foreign memops</a>

</div>

<h5 class="subsubsection">3.21.3.2 Handling pointer values</h5>

<p>The result of calling the procedures <code>eq?</code>, <code>eqv?</code> and
<code>equal?</code> on pointer values is unspecified.

<div class="defun">
&mdash; Procedure: <b>pointer-&gt;integer</b><var> pointer<a name="index-pointer_002d_003einteger-257"></a></var><br>
<blockquote><p>Convert the value of <var>pointer</var> to an exact integer value.  The
result may be a fixnum or a bignum depending on the pointer. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>integer-&gt;pointer</b><var> exact-integer<a name="index-integer_002d_003epointer-258"></a></var><br>
<blockquote><p>Convert <var>exact-integer</var> to a pointer value.  The lower 32 bits (or
64 bits on 64-bit systems) of the argument are significant in computing
the pointer value.  It is guaranteed that <code>(integer-&gt;pointer
(pointer-&gt;integer p))</code> points to the same address as <var>p</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer?</b><var> x<a name="index-pointer_003f-259"></a></var><br>
<blockquote><p>Return <code>#t</code> if the value of <var>x</var> is a pointer, return <code>#f</code>
otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer-size</b><var><a name="index-pointer_002dsize-260"></a></var><br>
<blockquote><p>Return the number of bytes required to hold a pointer on the underlying
platform. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-foreign-memops-poke"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-foreign-memops-peek">iklib foreign memops peek</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-foreign-memops-pointer">iklib foreign memops pointer</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-foreign-memops">iklib foreign memops</a>

</div>

<h5 class="subsubsection">3.21.3.3 Poking values</h5>

<p>With all the following functions: the <var>pointer</var> argument must be a
valid pointer; the <var>offset</var> and <var>value</var> arguments must be exact
integers.  When adding an offset to a pointer: all the following
functions <strong>do not</strong> scale the offset to the size of the poked
value.  Pointer arithmetics is performed with byte offsets.

<!--  -->
<h5 class="subsubheading">Poking exact integers</h5>

<div class="defun">
&mdash; Procedure: <b>pointer-set-c-char!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dchar_0021-261"></a></var><br>
<blockquote><p>Set to <var>value</var> the single byte of memory located at <var>offset</var> from
<var>pointer</var>.  Only the 8 lowermost bits of <var>value</var> are used
in the operation and the remaining bits are ignored. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer-set-c-short!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dshort_0021-262"></a></var><br>
<blockquote><p>Set to <var>value</var> the two bytes of memory located at <var>offset</var> from
<var>pointer</var>.  Only the 16 lowermost bits of <var>value</var> are used
in the operation and the remaining bits are ignored. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer-set-c-int!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dint_0021-263"></a></var><br>
<blockquote><p>Set to <var>value</var> the four bytes of memory located at <var>offset</var> from
<var>pointer</var>.  Only the 32 lowermost bits of <var>value</var> are used
in the operation and the remaining bits are ignored. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer-set-c-long!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dlong_0021-264"></a></var><br>
<blockquote><p>On 64-bit systems: Set to <var>value</var> the eight bytes of memory located at <var>offset</var> from
<var>pointer</var>.  Only the 64 lowermost bits of <var>value</var> are used
in the operation and the remaining bits are ignored.

        <p>On 32-bit systems: perform the same task as <code>pointer-set-c-int!</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer-set-c-long-long!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dlong_002dlong_0021-265"></a></var><br>
<blockquote><p>Set to <var>value</var> a number of bytes corresponding to the <code>long
long</code> type located at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Poking floating point numbers</h5>

<div class="defun">
&mdash; Procedure: <b>pointer-set-c-float!</b><var> pointer offset flonum<a name="index-pointer_002dset_002dc_002dfloat_0021-266"></a></var><br>
<blockquote><p>Convert the Scheme floating point number <var>flonum</var> (represented in
Vicare as an <acronym>IEEE</acronym> 754 double precision floating point number) to a
float (an <acronym>IEEE</acronym> 754 single precision floating point number) and store
the result in the four bytes at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer-set-c-double!</b><var> pointer offset flonum<a name="index-pointer_002dset_002dc_002ddouble_0021-267"></a></var><br>
<blockquote><p>Store the double precision <acronym>IEEE</acronym> 754 floating point value of the
Scheme <var>flonum</var> in the eight bytes at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Poking pointers</h5>

<div class="defun">
&mdash; Procedure: <b>pointer-set-c-pointer!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dpointer_0021-268"></a></var><br>
<blockquote><p>On 64-bit systems: set the eight bytes at <var>offset</var> from
<var>pointer</var> to the 64-bit pointer <var>value</var>.

        <p>On 32-bit systems: set the four bytes at <var>offset</var> from <var>pointer</var>
to the 32-bit pointer <var>value</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-foreign-memops-peek"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-foreign-memops-poke">iklib foreign memops poke</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-foreign-memops">iklib foreign memops</a>

</div>

<h5 class="subsubsection">3.21.3.4 Peeking values</h5>

<p>With all the following functions: the <var>pointer</var> argument must be a
valid pointer; the <var>offset</var> argument must be an exact integer.  When
adding an offset to a pointer: all the following functions <strong>do
not</strong> scale the offset to the size of the poked value.  Pointer
arithmetics is performed with byte offsets.

<!--  -->
<h5 class="subsubheading">Peeking exact integers</h5>

<div class="defun">
&mdash; Procedure: <b>pointer-ref-c-signed-char</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dsigned_002dchar-269"></a></var><br>
<blockquote><p>Peek the single byte located at <var>offset</var> from <var>pointer</var> and
return an exact integer representing the sign&ndash;extended integer value of
that byte. The resulting value is in the inclusive range <code>[-128,
127]</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer-ref-c-unsigned-char</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dunsigned_002dchar-270"></a></var><br>
<blockquote><p>Peek the single byte located at <var>offset</var> from <var>pointer</var> and
return an exact integer representing the unsigned integer value of that
byte.  The resulting value is in the inclusive range <code>[0, 255]</code>. 
</p></blockquote></div>

   <p>The following example shows the difference between the two functions
above:

<pre class="example">     &gt; (let ([p (malloc 3)])
         (pointer-set-c-char! p 0 #b01111111)
         (pointer-set-c-char! p 1 #b10000000)
         (pointer-set-c-char! p 2 #b11111111)
         (let ([result
                (list (pointer-ref-c-signed-char p 0)
                      (pointer-ref-c-signed-char p 1)
                      (pointer-ref-c-signed-char p 2)
                      (pointer-ref-c-unsigned-char p 0)
                      (pointer-ref-c-unsigned-char p 1)
                      (pointer-ref-c-unsigned-char p 2))])
           (free p)
           result))
     (127 -128 -1 127 128 255)
</pre>
   <div class="defun">
&mdash; Procedure: <b>pointer-ref-c-signed-short</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dsigned_002dshort-271"></a></var><br>
<blockquote><p>Peek two bytes at <var>offset</var> from <var>pointer</var> and return an exact
integer representing the sign&ndash;extended integer value of the sequence. 
The resulting value is in the inclusive range <code>[-32768, 32767]</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer-ref-c-unsigned-short</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dunsigned_002dshort-272"></a></var><br>
<blockquote><p>Peek two bytes at <var>offset</var> from <var>pointer</var> and return an exact
integer representing the unsigned integer value of the sequence.  The
resulting value is in the inclusive range <code>[0, 65535]</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer-ref-c-signed-int</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dsigned_002dint-273"></a></var><br>
<blockquote><p>Peek four bytes at <var>offset</var> from <var>pointer</var> and return an exact
integer in the inclusive range <code>[-2^31, 2^31-1]</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer-ref-c-unsigned-int</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dunsigned_002dint-274"></a></var><br>
<blockquote><p>Peek four bytes at <var>offset</var> from <var>pointer</var> and return an exact
integer in the inclusive range <code>[0, 2^32-1]</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer-ref-c-signed-long</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dsigned_002dlong-275"></a></var><br>
<blockquote><p>On 64-bit systems: peek eight bytes at <var>offset</var> from <var>pointer</var>
and return an integer in the inclusive range <code>[-2^63, 2^63-1]</code>.

        <p>On 32-bit systems, perform the same task as
<code>pointer-ref-c-signed-int</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer-ref-c-unsigned-long</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dunsigned_002dlong-276"></a></var><br>
<blockquote><p>On 64-bit systems: peek eight bytes at <var>offset</var> from <var>pointer</var>
and return an integer in the inclusive range <code>[0, 2^64-1]</code>.

        <p>On 32-bit systems: perform the same task as
<code>pointer-ref-c-unsigned-int</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer-ref-c-signed-long-long</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dsigned_002dlong_002dlong-277"></a></var><br>
<blockquote><p>Peek a number of bytes corresponding to the native <code>long long</code> type
at <var>offset</var> from <var>pointer</var> and return an integer. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer-ref-c-unsigned-long-long</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dunsigned_002dlong_002dlong-278"></a></var><br>
<blockquote><p>Peek a number of bytes corresponding to the native <code>unsigned long
long</code> type at <var>offset</var> from <var>pointer</var> and return an integer. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Peeking floating point numbers</h5>

<div class="defun">
&mdash; Procedure: <b>pointer-ref-c-float</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dfloat-279"></a></var><br>
<blockquote><p>Return the four&ndash;byte float (represented as <acronym>IEEE</acronym> 754 single precision
floating point number) stored at <var>offset</var> from <var>pointer</var>.  The
value is extended to an <acronym>IEEE</acronym> 754 double precision floating point
number that Vicare uses to represent inexact numbers. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>pointer-ref-c-double</b><var> pointer offset<a name="index-pointer_002dref_002dc_002ddouble-280"></a></var><br>
<blockquote><p>Return the eight&ndash;byte float (represented as <acronym>IEEE</acronym> 754 double
precision floating point number) stored at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Peeking pointers</h5>

<div class="defun">
&mdash; Procedure: <b>pointer-ref-c-pointer</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dpointer-281"></a></var><br>
<blockquote><p>Return the pointer stored at <var>offset</var> from <var>pointer</var>.  The size
of the pointer (also the number of bytes loaded) depends on the
architecture: it is 4 bytes on 32-bit systems and 8 bytes on 64-bit
systems. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-foreign-dl"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-foreign-call-out">iklib foreign call out</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-foreign-memops">iklib foreign memops</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-foreign">iklib foreign</a>

</div>

<h4 class="subsection">3.21.4 Accessing foreign objects from Scheme</h4>

<div class="defun">
&mdash; Procedure: <b>dlopen</b><var><a name="index-dlopen-282"></a></var><br>
&mdash; Procedure: <b>dlopen</b><var> library-name<a name="index-dlopen-283"></a></var><br>
&mdash; Procedure: <b>dlopen</b><var> library-name lazy? global?<a name="index-dlopen-284"></a></var><br>
<blockquote><p>Take the string <var>library-name</var> representing a system library and
call the system procedure <code>dlopen()</code> which dynamically loads the
given library into the running process.

        <p>The name of the library is system&ndash;dependent and must include the
appropriate suffix (e.g. <code>*.so</code> on Linux, <code>*.dylib</code> on Darwin
and <code>*.dll</code> on Cygwin).  <var>library-name</var> may include a full path
which identifies the location of the library, or it may just be the name
of the library in which case the system will lookup the library name
using the <samp><span class="env">LD_LIBRARY_PATH</span></samp> environment variable.

        <p>The argument <var>lazy?</var> specifies how library dependencies are loaded. 
If true, <code>dlopen</code> delays the resolution and loading of dependent
libraries until they are actually used.  If false, all library
dependencies are loaded before the call to <code>dlopen</code> returns.

        <p>The argument <code>global?</code> specifies the scope of the symbols exported
from the loaded library.  If true, all exported symbols become part of
the running image, and subsequent <code>dlsym</code> calls may not need to
specify the library from which the symbol is loaded.  If false, the
exported symbols are not global and the library pointer needs to be
specified for <code>dlsym</code>.

        <p>Calling <code>(dlopen library-name)</code> is equivalent to <code>(dlopen
library-name #f #f)</code>.  Calling <code>(dlopen)</code> without arguments returns
a pointer to the current process.

        <p>If succesful, <code>dlopen</code> returns a pointer to the external library
which can be used subsequently by <code>dlsym</code> and <code>dlclose</code>.  If
the library cannot be loaded, <code>dlopen</code> returns <code>#f</code> and the
procedure <code>dlerror</code> can be used to obtain the cause of the failure.

        <p>Consult the <code>dlopen(3)</code> page in your system manual for further
details. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>dlclose</b><var> library-pointer<a name="index-dlclose-285"></a></var><br>
<blockquote><p>A wrapper for the system procedure of the same name.  It receives a
library pointer (e.g. one obtained from <code>dlopen</code>) and releases the
resources loaded from that library.  Closing a library renders all
symbols and static data structures that the library exports invalid and
the program may crash or corrupt its memory if such symbols are used
after a library is closed.

        <p>Most system implementations of dynamic loading employ reference counting
for <code>dlopen</code> and <code>dlclose</code> in that library resources are not
freed until the number of calls to <code>dlclose</code> matches the number of
calls to <code>dlopen</code>.

        <p>The procedure <code>dlclose</code> returns a boolean value indicating whether
the success status of the operation.  If <code>dlclose</code> returns
<code>#f</code>, the procedure <code>dlerror</code> can be used to obtain the cause
of the error.

        <p>Consult the <code>dlclose(3)</code> page in your system manual for further
details. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>dlsym</b><var> library-pointer string<a name="index-dlsym-286"></a></var><br>
<blockquote><p>Take a library pointer (e.g. one obtained by a call to <code>dlopen</code>)
and a string representing the name of a symbol that the library exports
and return a pointer to the location of that symbol in memory.  If
<code>dlsym</code> fails, it returns <code>#f</code> and the cause of the error can
be obtained using the procedure <code>dlerror</code>.

        <p>Consult the <code>dlsym(3)</code> page in your system manual for further
details. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>dlerror</b><var><a name="index-dlerror-287"></a></var><br>
<blockquote><p>If any of the dynamic loading operations (i.e., <code>dlopen</code>,
<code>dlclose</code>, <code>dlsym</code>) fails, the cause of the error can be
obtained by calling <code>dlerror</code> which returns a string describing the
error.  The procedure <code>dlerror</code> returns <code>#f</code> if there was no
dynamic loading error.

        <p>Consult the <code>dlerror(3)</code> page in your system manual for further
details. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-foreign-call-out"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-foreign-call-back">iklib foreign call back</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-foreign-dl">iklib foreign dl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-foreign">iklib foreign</a>

</div>

<h4 class="subsection">3.21.5 Calling out to foreign procedures</h4>

<p>Vicare provides the means to call out from Scheme to foreign
procedures.  This allows the programmers to extend Vicare to
access system&ndash;specific facilities that are available on the host
machine.

<ul class="menu">
<li><a accesskey="1" href="#iklib-foreign-call-out-api">iklib foreign call out api</a>:       Interface to foreign functions. 
<li><a accesskey="2" href="#iklib-foreign-call-out-types">iklib foreign call out types</a>:     Type specifiers. 
<li><a accesskey="3" href="#iklib-foreign-call-out-example">iklib foreign call out example</a>:   C language call out example. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-foreign-call-out-api"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-foreign-call-out-types">iklib foreign call out types</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-foreign-call-out">iklib foreign call out</a>

</div>

<h5 class="subsubsection">3.21.5.1 Interface to foreign functions</h5>

<p>In order to call out to a foreign procedure, one must provide two pieces
of information: the signature of the foreign procedure (e.g. its type
declaration if it is a C language procedure) and the address of the
procedure in memory.  The address of the procedure can be easily
obtained using <code>dlsym</code> if the name of the procedure and its
exporting library are known.  The signature of the procedure cannot, in
general, be obtained dynamically, and therefore must be hard coded into
the program.

   <p>The signature of the foreign procedure is required for proper linkage
between the Scheme system and the foreign system.  Using the signature,
Vicare determines how Scheme values are converted into native values,
and where (e.g. in which registers and stack slots) to put these
arguments.  The signature also determines where the returned values are
placed and how they are converted from the system data types to the
corresponding Scheme data types.

   <p>A procedure's signature is composed of two parts: the return type and
the parameter types:

     <ul>
<li>the return type is a symbol that can be any one of the type specifiers
listed in <a href="#iklib-foreign-call-out-types">iklib foreign call out types</a>;

     <li>the parameter types is a list of type specifier symbols; if the foreign
function takes no arguments: the parameter types must be the empty list;
</ul>

<p class="noindent">the symbol <code>void</code> can appear as a return type but cannot appear as
a parameter type.

<div class="defun">
&mdash; Procedure: <b>make-c-callout</b><var> return-type parameter-types<a name="index-make_002dc_002dcallout-288"></a></var><br>
<blockquote><p>The procedure <code>make-c-callout</code> is the primary facility for making
foreign procedures callable from Scheme.  It works as follows:

          <ol type=1 start=1>
<li><code>make-c-callout</code> receives two arguments denoting the signature of
the procedure to be called; it prepares a bridge that converts from
Scheme's calling conventions and data structures to their foreign
counterparts; it returns a procedure <code>p1</code>;

          <li>the procedure <code>p1</code> accepts a pointer to a foreign procedure
(e.g. one obtained from <code>dlsym</code>) and returns a Scheme procedure
<code>p2</code> that encapsulates the foreign procedure;

          <li>the final procedure <code>p2</code> can be called with as many arguments as
the ones specified in the <var>parameter-types</var>; the parameters supplied
to <code>p2</code> must match the types supplied as the <var>parameter-types</var>
according to the &ldquo;Valid Scheme types&rdquo; column in the table in
<a href="#iklib-foreign-call-out-types">iklib foreign call out types</a>;

          <li>the procedure <code>p2</code> converts the parameters from Scheme types to
native types, calls the foreign procedure, obtains the result, and
converts it to the appropriate Scheme value (depending on the
<var>return-type</var>).
             </ol>

        <p>The interface of <code>make-c-callout</code> is broken down into three stages
in order to accomodate common usage patterns.  Often a function
signature can be used by many foreign procedures and therefore,
<code>make-c-callout</code> can be called once per signature and each
signature can be used multiple times.  Similarly, separating the foreign
procedure preparation from parameter passing allows for preparing the
foreign procedure once and calling it many times.

        <p>The list of types in the table in <a href="#iklib-foreign-call-out-types">iklib foreign call out types</a> is
restricted to basics and provides no automatic conversion from composite
Scheme data structures (such as strings, symbols, vectors, and lists) to
native types.  The restriction is intentional in order for
Vicare to avoid making invalid assumptions about the memory
management of the target library.

        <blockquote>
For example, while Vicare <em>can</em> convert a Scheme string to a native
byte array (e.g. use <code>string-&gt;bytevector</code> to decode the string,
then use <code>malloc</code> to allocate a temporary buffer, then copy the
bytes from the bytevector to the allocated memory), it cannot decide
when this allocated byte array is no longer needed and should be freed. 
This knowledge is library&ndash;dependent and is often procedure&ndash;dependent. 
Therefore, Vicare leaves it to the programmer to manage all memory
related issues. 
</blockquote>

        <p>Outgoing parameters to foreign procedures are checked against the
declared types.  For example, if a callback is prepared to expect a
parameter of type <code>signed-int</code>, only exact integers are allowed to
be passed out.  For integer types, only a fixed number of bits is used
and the remaining bits are ignored.  For floating point types, the
argument is checked to be a Scheme flonum.  No implicit conversion
between exact and inexact numbers is performed. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-foreign-call-out-types"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-foreign-call-out-example">iklib foreign call out example</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-foreign-call-out-api">iklib foreign call out api</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-foreign-call-out">iklib foreign call out</a>

</div>

<h5 class="subsubsection">3.21.5.2 Type specifiers</h5>

<p>The following table lists valid type specifiers that can be used in
callout and callback signatures.  Specifiers with &ldquo;4/8 bytes&rdquo; have
size that depends on the system: it is 4 bytes on 32-bit systems and 8
bytes on 64-bit systems.  The <code>void</code> specifier can only be used as
a return value specifier to mean &ldquo;no useful value is returned&rdquo;.

   <p><table summary=""><tr align="left"><th valign="top">Type specifier </th><th valign="top">Size </th><th valign="top">Valid Scheme types </th><th valign="top">Corresponding C types
<br></th></tr><tr align="left"><td valign="top"><code>signed-char</code> </td><td valign="top">1 byte </td><td valign="top">exact integer </td><td valign="top"><code>char</code>
<br></td></tr><tr align="left"><td valign="top"><code>unsigned-char</code> </td><td valign="top">1 byte </td><td valign="top">exact integer </td><td valign="top"><code>unsigned char</code>
<br></td></tr><tr align="left"><td valign="top"><code>signed-short</code> </td><td valign="top">2 bytes </td><td valign="top">exact integer </td><td valign="top"><code>short</code>
<br></td></tr><tr align="left"><td valign="top"><code>unsigned-short</code> </td><td valign="top">2 bytes </td><td valign="top">exact integer </td><td valign="top"><code>unsigned short</code>
<br></td></tr><tr align="left"><td valign="top"><code>signed-int</code> </td><td valign="top">4 bytes </td><td valign="top">exact integer </td><td valign="top"><code>int</code>
<br></td></tr><tr align="left"><td valign="top"><code>unsigned-int</code> </td><td valign="top">4 bytes </td><td valign="top">exact integer </td><td valign="top"><code>unsigned int</code>
<br></td></tr><tr align="left"><td valign="top"><code>signed-long</code> </td><td valign="top">4/8 bytes </td><td valign="top">exact integer </td><td valign="top"><code>long</code>
<br></td></tr><tr align="left"><td valign="top"><code>unsigned-long</code> </td><td valign="top">4/8 bytes </td><td valign="top">exact integer </td><td valign="top"><code>unsigned long</code>
<br></td></tr><tr align="left"><td valign="top"><code>float</code> </td><td valign="top">4 bytes </td><td valign="top">flonum </td><td valign="top"><code>float</code>
<br></td></tr><tr align="left"><td valign="top"><code>double</code> </td><td valign="top">8 bytes </td><td valign="top">flonum </td><td valign="top"><code>double</code>
<br></td></tr><tr align="left"><td valign="top"><code>pointer</code> </td><td valign="top">4/8 bytes </td><td valign="top">pointer </td><td valign="top"><code>void*</code>, <code>char*</code>, <code>int*</code>, <code>int**</code>, etc
<br></td></tr><tr align="left"><td valign="top"><code>void</code> </td><td valign="top">&mdash; </td><td valign="top">&mdash; </td><td valign="top"><code>void</code>
   <br></td></tr></table>

<!-- page -->
<div class="node">
<a name="iklib-foreign-call-out-example"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-foreign-call-out-types">iklib foreign call out types</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-foreign-call-out">iklib foreign call out</a>

</div>

<h5 class="subsubsection">3.21.5.3 C language call out example</h5>

<p>The following example illustrates the use of the <code>make-c-callout</code>
procedure in combination with <code>dlopen</code> and <code>dlsym</code>; the
session was run on a 32-bit Vicare running under Mac OS X 10.4:

     <ol type=1 start=1>
<li>the <samp><span class="file">libc.dylib</span></samp> foreign library is loaded and is bound to the
variable <code>libc</code>;

     <li>we obtain a pointer to the <code>atan()</code> foreign procedure that is
defined in <code>libc</code>; the native procedure <code>atan()</code> takes a
<code>double</code> as an argument and returns a <code>double</code> and that's the
signature that we use for <code>make-c-callout</code>;

     <li>we call the foreign procedure interface with one argument, <code>1.0</code>,
which is a flonum and thus matches the required parameter type; the
native procedure returns a <code>double</code> value which is converted to the
Scheme flonum with value <code>0.7853981633974483</code>.
        </ol>

<pre class="example">     &gt; (import (ikarus foreign))
     &gt; (define libc (dlopen "libc.dylib"))
     &gt; libc
     #&lt;pointer #x00100770&gt;
     &gt; (define libc-atan-ptr (dlsym libc "atan"))
     &gt; libc-atan-ptr
     #&lt;pointer #x9006CB1F&gt;
     &gt; (define libc-atan
         ((make-c-callout 'double '(double)) libc-atan-ptr))
     &gt; libc-atan
     #&lt;procedure&gt;
     &gt; (libc-atan 1.0)
     0.7853981633974483
     &gt; (libc-atan 1)
     Unhandled exception
      Condition components:
         1. &amp;assertion
         2. &amp;who: callout-procedure
         3. &amp;message: "argument does not match type double"
         4. &amp;irritants: (1)
</pre>
   <!-- page -->
<div class="node">
<a name="iklib-foreign-call-back"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-foreign-call-out">iklib foreign call out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-foreign">iklib foreign</a>

</div>

<h4 class="subsection">3.21.6 Calling back to Scheme</h4>

<p>In order to provide full interoperability with native procedures,
Vicare allows native procedures to call back into Scheme just
as it allows Scheme to call out to native procedures.  This is important
for many system libraries that provide graphical user interfaces with
event handling (e.g. Cocoa, GTK+, GLUT, etc.), database engines
(e.g. libsqlite, libmysql, etc.), among others.

   <p>The native calling site for the call back is compiled with a specific
callback signature encoding the expected parameter types and return
type.  Therefore, a Scheme procedure used for a call back must be
wrapped with a proper adapter that converts the incoming parameters from
native format to Scheme values as well as convert the value that the
Scheme procedure returns back to native format.  The signature format is
similar to the one used for call outs (<a href="#iklib-foreign-call-out-types">iklib foreign call out types</a> for details).

<div class="defun">
&mdash; Procedure: <b>make-c-callback</b><var> return-type parameter-types<a name="index-make_002dc_002dcallback-289"></a></var><br>
<blockquote><p>The procedure <code>make-c-callback</code> is similar to the procedure
<code>make-c-callout</code> except that it provides a bridge from native
procedures back into Scheme.  While the procedure <code>make-c-callout</code>
takes a native pointer and returns a Scheme procedure,
<code>make-c-callback</code> takes a Scheme procedure and returns a native
pointer.  The native pointer can be called by foreign procedures.  The
native parameters are converted to Scheme data (according to
<var>parameter-types</var>), the Scheme procedure is called with these
parameters, and the returned value is converted back into native format
(according to <var>return-type</var>) before control returns to the native
call site.

        <p>Note that the native procedure pointer obtained from
<code>make-c-callback</code> is indistinguishable from other native procedures
that are obtained using <code>dlsym</code> or similar means.  In particular,
such native pointers can be passed to <code>make-c-callout</code> resulting in
a Scheme procedure that calls out to the native procedure that in turn
calls back into Scheme.  The following segment illustrates a very
inefficient way of extracting the lowermost 32 bits from an exact
integer.

     <pre class="example">          &gt; (format "~x"
              (((make-c-callout 'unsigned-int '(unsigned-int))
                ((make-c-callback 'unsigned-int '(unsigned-int))
                 values))
               #xfedcba09876543210fedcba09876543210))
          "76543210"
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-misc"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-foreign">iklib foreign</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.22 Miscellaneous functions</h3>

<div class="defun">
&mdash; Function: <b>void</b><var><a name="index-void-290"></a></var><br>
<blockquote><p>Return the void value.  It is the value returned by forms that do not
return a meaningful value. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib">syslib</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib">iklib</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">4 The <acronym>POSIX</acronym> interface</h2>

<p>The <acronym>POSIX</acronym> functions are exported by the <code>(ikarus)</code> library.

<ul class="menu">
<li><a accesskey="1" href="#posix-pid">posix pid</a>:                    Process identifier functions. 
<li><a accesskey="2" href="#posix-process">posix process</a>:                Spawning processes and the like. 
<li><a accesskey="3" href="#posix-waitpid">posix waitpid</a>:                Waiting for terminated children. 
<li><a accesskey="4" href="#posix-signal">posix signal</a>:                 Delivering signals to processes. 
<li><a accesskey="5" href="#posix-file">posix file</a>:                   Interfacing with the file system. 
<li><a accesskey="6" href="#posix-dir">posix dir</a>:                    File system directory inspection. 
<li><a accesskey="7" href="#posix-env">posix env</a>:                    Interfacing with the execution
                                environment. 
<li><a accesskey="8" href="#posix-misc">posix misc</a>:                   Miscellaneous functions.

</li></ul>
<p>Internals

</p>
<ul class="menu">
<li><a accesskey="9" href="#posix-int-intro">posix int intro</a>:              Internals: introduction to the <acronym>POSIX</acronym>
                                <acronym>API</acronym>. 
<li><a href="#posix-int-errno">posix int errno</a>:              Internals: handling <code>errno</code> codes. 
<li><a href="#posix-int-fd">posix int fd</a>:                 Internals: file descriptors. 
<li><a href="#posix-int-pid">posix int pid</a>:                Internals: process identifier functions. 
<li><a href="#posix-int-files">posix int files</a>:              Internals: file system interface. 
<li><a href="#posix-int-exec">posix int exec</a>:               Internals: executing processes. 
<li><a href="#posix-int-time">posix int time</a>:               Internals: time and date. 
<li><a href="#posix-int-env">posix int env</a>:                Internals: environment variables. 
</ul>

<!-- page -->
<div class="node">
<a name="posix-pid"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-process">posix process</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.1 Process identifier functions</h3>

<div class="defun">
&mdash; Function: <b>getpid</b><var><a name="index-getpid-291"></a></var><br>
<blockquote><p>Return the process identifier as a fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getppid</b><var><a name="index-getppid-292"></a></var><br>
<blockquote><p>Return the process identifier of the parent as a fixnum. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-process"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-waitpid">posix waitpid</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-pid">posix pid</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.2 Spawning processes and the like</h3>

<div class="defun">
&mdash; Function: <b>fork</b><var> parent-proc child-thunk<a name="index-fork-293"></a></var><br>
<blockquote><p>Fork a new process using the system <code>fork()</code> function.

        <p>If the operation is successful: in the parent process <var>parent-proc</var>
is evaluated by applying it to an exact integer representing the child
pid; in the child process <var>child-thunk</var> is evaluated.

        <p>If an error occurs: an exception is raised.

        <p>Example:

     <pre class="example">          (fork
            (lambda (child-pid)
              (printf "in parent, child pid = ~s\n" child-pid))
            (lambda ()
              (printf "in child\n")
              (exit)))
          
          (printf "here we are in the parent\n")
</pre>
        <p><a href="libc.html#Creating-a-Process">Creating a Process</a>
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>system</b><var> command-string<a name="index-system-294"></a></var><br>
<blockquote><p>Executes a command using the <code>system()</code> function, which uses the
system shell.  If success: return the exit code of the process.  If
error: raise an exception.

        <p>Example:

     <pre class="example">          (system "ls -l")
</pre>
        <p><a href="libc.html#Running-a-Command">Running a Command</a>
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-waitpid"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-signal">posix signal</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-process">posix process</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.3 Waiting for terminated children</h3>

<div class="defun">
&mdash; Function: <b>waitpid</b> [<var>pid </var>[<var>block? </var>[<var>want-error?</var>]]]<var><a name="index-waitpid-295"></a></var><br>
<blockquote><p>Wait for another process termination using the system <code>waitpid()</code>
function and return informations about its status.

        <p>If successful and there is a child waiting to be noticed: the returned
value is a record of type <code>wstatus</code>, whose interface is described
below.  If successful but no child is waiting to be noticed: the
returned value is <code>#f</code>.

        <p>If an error occurs and <var>want-error?</var> is <code>#t</code>, an exception is
raised.  If an error occurs and <var>want-error?</var> is <code>#f</code>: the
return value is <code>#f</code>.  <var>want-error?</var> defaults to <code>#t</code>.

        <p><var>pid</var> is the id of the process to wait for; it defaults to
<code>-1</code>.  If it is:

          <dl>
<dt><em>a positive integer</em><dd>return informations about the process having that pid;

          <br><dt><code>0</code><dd>return informations about a process in the set of terminated children in
the same group of the calling process; if more eligible children exists,
one is selected at random;

          <br><dt><code>-1</code><dd>return informations about a process in the set of terminated children;
if more eligible children exists, one is selected at random;

          <br><dt><em>a negative integer other than </em><code>-1</code><dd>wait for a process in the set of terminated children whose process group
id is equal to the absolute value of <var>pid</var>. 
</dl>

        <p>If <var>block?</var> is <code>#t</code> (the default), then the process is suspended
waiting for an eligible child; if <var>block?</var> is <code>#f</code> the process
is not suspended and the return value is <code>#f</code>.

        <p><a href="libc.html#Process-Completion">Process Completion</a>
</p></blockquote></div>

   <p>The following example tests <code>waitpid</code>:

<pre class="example">     (fork
        (lambda (child-pid)
          (printf "in parent, child pid = ~s\n" child-pid)
          (let ([status (waitpid child-pid)])
            (printf "in parent, child status: ~s\n" status)))
        (lambda ()
          (printf "in child\n")
          (exit 1)))
</pre>
   <p class="noindent">the following example test killing with a signal:

<pre class="example">     (fork
        (lambda (child-pid)
          (printf "in parent, child pid = ~s\n" child-pid)
          (kill child-pid 'SIGKILL)
          (let ([status (waitpid child-pid)])
            (printf "in parent, child status: ~s\n" status)))
        (lambda ()
          (printf "in child\n")
          (nanosleep 5 0)))
</pre>
   <!--  -->
<h5 class="subsubheading">Status record interface</h5>

<div class="defun">
&mdash; Function: <b>wstatus-pid</b><var> status<a name="index-wstatus_002dpid-296"></a></var><br>
<blockquote><p>Return the pid of the process extracting it from <var>status</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>wstatus-exit-status</b><var> status<a name="index-wstatus_002dexit_002dstatus-297"></a></var><br>
<blockquote><p>Return the exit code of the process extracting it from <var>status</var>.  If
the process was stopped by a signal: the return value is <code>#f</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>wstatus-received-signal</b><var> status<a name="index-wstatus_002dreceived_002dsignal-298"></a></var><br>
<blockquote><p>Return a symbol representing the signal that caused the termination of
the child process.  If no signal was received: return <code>#f</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-signal"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-file">posix file</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-waitpid">posix waitpid</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.4 Delivering signals to processes</h3>

<p><a name="index-g_t_0040code_007bSIGABRT_007d-299"></a><a name="index-g_t_0040code_007bSIGALRM_007d-300"></a><a name="index-g_t_0040code_007bSIGBUS_007d-301"></a><a name="index-g_t_0040code_007bSIGCHLD_007d-302"></a><a name="index-g_t_0040code_007bSIGCONT_007d-303"></a><a name="index-g_t_0040code_007bSIGFPE_007d-304"></a><a name="index-g_t_0040code_007bSIGHUP_007d-305"></a><a name="index-g_t_0040code_007bSIGILL_007d-306"></a><a name="index-g_t_0040code_007bSIGINT_007d-307"></a><a name="index-g_t_0040code_007bSIGKILL_007d-308"></a><a name="index-g_t_0040code_007bSIGPIPE_007d-309"></a><a name="index-g_t_0040code_007bSIGQUIT_007d-310"></a><a name="index-g_t_0040code_007bSIGSEGV_007d-311"></a><a name="index-g_t_0040code_007bSIGSTOP_007d-312"></a><a name="index-g_t_0040code_007bSIGTERM_007d-313"></a><a name="index-g_t_0040code_007bSIGTSTP_007d-314"></a><a name="index-g_t_0040code_007bSIGTTIN_007d-315"></a><a name="index-g_t_0040code_007bSIGTTOU_007d-316"></a><a name="index-g_t_0040code_007bSIGUSR1_007d-317"></a><a name="index-g_t_0040code_007bSIGUSR2_007d-318"></a><a name="index-g_t_0040code_007bSIGPOLL_007d-319"></a><a name="index-g_t_0040code_007bSIGPROF_007d-320"></a><a name="index-g_t_0040code_007bSIGSYS_007d-321"></a><a name="index-g_t_0040code_007bSIGTRAP_007d-322"></a><a name="index-g_t_0040code_007bSIGURG_007d-323"></a><a name="index-g_t_0040code_007bSIGVTALRM_007d-324"></a><a name="index-g_t_0040code_007bSIGXCPU_007d-325"></a><a name="index-g_t_0040code_007bSIGXFSZ_007d-326"></a>

<div class="defun">
&mdash; Function: <b>kill</b><var> pid signame<a name="index-kill-327"></a></var><br>
<blockquote><p>Send the signal selected by <var>signame</var> to the process or group of
processes selected by <var>pid</var>.  Make use of the system <code>kill()</code>
function.  If an error occurs: an exception is raised.

        <p>Following is the meaning of <var>pid</var>:

          <dl>
<dt><var>pid</var><code> &gt; 0</code><dd>deliver the signal to the process having <var>pid</var> as identifier;

          <br><dt><var>pid</var><code> == 0</code><dd>deliver the signal to all the process in the group of the sender;

          <br><dt><var>pid</var><code> == -1</code><dd>deliver the signal to all the process having the same effective user
identifier of the sender; see the whole documentation in the system
library;

          <br><dt><var>pid</var><code> &lt; -1</code><dd>deliver the signal to all the process in the group having identifier
equal to the absolute value of <var>pid</var>. 
</dl>

        <p><var>signame</var> must be a symbol specifying a signal.  Supported signal
names follow:

     <pre class="example">          SIGABRT         SIGALRM         SIGBUS
          SIGCHLD         SIGCONT         SIGFPE
          SIGHUP          SIGILL          SIGINT
          SIGKILL         SIGPIPE         SIGQUIT
          SIGSEGV         SIGSTOP         SIGTERM
          SIGTSTP         SIGTTIN         SIGTTOU
          SIGUSR1         SIGUSR2         SIGPOLL
          SIGPROF         SIGSYS          SIGTRAP
          SIGURG          SIGVTALRM       SIGXCPU
          SIGXFSZ
</pre>
        <p><a href="libc.html#Signaling-Another-Process">Signaling Another Process</a><br>
<a href="libc.html#Standard-Signals">Standard Signals</a>
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-file"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-dir">posix dir</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-signal">posix signal</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.5 Interfacing with the file system</h3>

<h5 class="subsubheading">Current working directory</h5>

<div class="defun">
&mdash; Function: <b>current-directory</b> [<var>pathname</var>]<var><a name="index-current_002ddirectory-328"></a></var><br>
<blockquote><p>When invoked with an argument, change the current working directory to
the one selected by the string <var>pathname</var>.  Make use of the system
<code>chdir()</code> function.

        <p>When invoked without argument, return a string representing the current
working directory pathname.  Make use of the system <code>getcwd()</code>
function.

        <p>If an error occurs, an exception is raised.

        <p><a href="libc.html#Working-Directory">Working Directory</a>
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Inspecting the file system</h5>

<div class="defun">
&mdash; Function: <b>directory-list</b><var> pathname<a name="index-directory_002dlist-329"></a></var><br>
<blockquote><p>Build and return the list of strings representing the entries in the
directory selected by the string <var>pathname</var>.  Make use of the
<code>opendir()</code>, <code>readdir()</code>, <code>closedir()</code> system functions.

        <p>If an error occurs, an exception is raised.

        <p><a href="libc.html#Opening-a-Directory">Opening a Directory</a><br>
<a href="libc.html#Reading_002fClosing-Directory">Reading/Closing Directory</a>
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>file-ctime</b><var> pathname<a name="index-file_002dctime-330"></a></var><br>
<blockquote><p>Return the time of the last modification to the attributes of the file;
makes use of the <code>stat()</code> system function, and return the
<code>st_ctime</code> field of the <code>stat</code> data structure.

        <p>The returned value is an exact integer, representing the number of
seconds elapsed since the Epoch (00:00:00 on January 1, 1970,
Coordinated Universal Time).

        <p>If an error occurs, an exception is raised.

        <p><a href="libc.html#Reading-Attributes">Reading Attributes</a>
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Inspecting file types</h5>

<p>For the following functions: if <var>follow</var> is <code>#t</code>, the default,
make use of the <code>stat()</code> system function; if <var>follow</var> is
<code>#f</code>, make use of the <code>lstat()</code> system function.

   <p><a href="libc.html#Reading-Attributes">Reading Attributes</a>

<div class="defun">
&mdash; Function: <b>file-exists?</b><var> pathname </var>[<var>follow</var>]<var><a name="index-file_002dexists_003f-331"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>pathname</var> exists on the file system; otherwise
return <code>#f</code>.  If an error occurs, an exception is raised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>file-regular?</b><var> pathname </var>[<var>follow</var>]<var><a name="index-file_002dregular_003f-332"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>pathname</var> exists on the file system and it is a
regular file; otherwise return <code>#f</code>.  If an error occurs, an
exception is raised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>file-directory?</b><var> pathname </var>[<var>follow</var>]<var><a name="index-file_002ddirectory_003f-333"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>pathname</var> exists on the file system and it is a
directory; otherwise return <code>#f</code>.  If an error occurs, an exception
is raised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>file-symbolic-link?</b><var> pathname </var>[<var>follow</var>]<var><a name="index-file_002dsymbolic_002dlink_003f-334"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>pathname</var> exists on the file system and it is a
symbolic link; otherwise return <code>#f</code>.  If an error occurs, an
exception is raised. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Creation</h5>

<div class="defun">
&mdash; Function: <b>make-symbolic-link</b><var> to pathname<a name="index-make_002dsymbolic_002dlink-335"></a></var><br>
<blockquote><p>Create a symbolic link whose pathname is the string <var>pathname</var>
referencing the <var>to</var> string pathname.  Make use of the
<code>symlink()</code> system function.  If an error occurs, an exception is
raised.

        <p><a href="libc.html#Symbolic-Links">Symbolic Links</a>
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-directory</b><var> pathname </var>[<var>mode</var>]<var><a name="index-make_002ddirectory-336"></a></var><br>
<blockquote><p>Create a directory with name selected by the string <var>pathname</var>. 
Make use of the <code>mkdir()</code> system function.  If an error occurs, an
exception is raised.

        <p><var>mode</var> must be an exact integere selecting the access permissions
for the directory; it defaults to &lsquo;<samp><span class="samp">#o755</span></samp>&rsquo;.

        <p><a href="libc.html#Creating-Directories">Creating Directories</a>
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Deletion</h5>

<div class="defun">
&mdash; Function: <b>delete-file</b><var> pathname<a name="index-delete_002dfile-337"></a></var><br>
<blockquote><p>Remove from the system the file selected by the <var>pathname</var> string. 
Make use of the <code>unlink()</code> system function.  If an error occurs, an
exception is raised.

        <p><a href="libc.html#Deleting-Files">Deleting Files</a>
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>delete-directory</b><var> pathname<a name="index-delete_002ddirectory-338"></a></var><br>
<blockquote><p>Remove from the system the directory selected by the <var>pathname</var>
string.  Make use of the <code>rmdir()</code> system function.  If an error
occurs, an exception is raised.

        <p><a href="libc.html#Deleting-Files">Deleting Files</a>
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Permissions</h5>

<div class="defun">
&mdash; Function: <b>change-mode</b><var> pathname mode<a name="index-change_002dmode-339"></a></var><br>
<blockquote><p>Change the access permissions of the file or directory selected by the
<var>pathname</var> string.  Make use of the <code>chmod()</code> system function. 
If an error occurs, an exception is raised.

        <p><var>mode</var> must be an exact integer selecting the permissions.

        <p><a href="libc.html#Setting-Permissions">Setting Permissions</a>
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-dir"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-env">posix env</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-file">posix file</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.6 File system directory inspection</h3>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>open-directory-stream</b><var> filename<a name="index-open_002ddirectory_002dstream-340"></a></var><br>
<blockquote><p>Open the file system directory <var>filename</var>, which must be a string,
and return a directory stream object to be closed by
<code>close-directory-stream</code> or left to automatic closing by the
garbage collector. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>directory-stream?</b><var> stream<a name="index-directory_002dstream_003f-341"></a></var><br>
<blockquote><p>Return true if <var>stream</var> is a directory stream returned by
<code>open-directory-stream</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>read-directory-stream</b><var> stream<a name="index-read_002ddirectory_002dstream-342"></a></var><br>
<blockquote><p>Return the next entry from the directory <var>stream</var>, or false if no
more entries are available.  The entry is a string representing a
filename.  Raise an exception if an error occurs. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>close-directory-stream</b><var> stream<a name="index-close_002ddirectory_002dstream-343"></a></var><br>
&mdash; Function: <b>close-directory-stream</b><var> stream raise-error?<a name="index-close_002ddirectory_002dstream-344"></a></var><br>
<blockquote><p>Close the directory <var>STREAM</var>.  If an error occurs raise an exception
only when <var>raise-error?</var> is true.  <var>raise-error?</var>  defaults to
true. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-env"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-misc">posix misc</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-dir">posix dir</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.7 Interfacing with the execution environment</h3>

<div class="defun">
&mdash; Function: <b>getenv</b><var> varname<a name="index-getenv-345"></a></var><br>
<blockquote><p>Return the current value, as a string, of the system environment
variable selected by the string <var>varname</var>.  If the variable is not
set: <code>#f</code> is returned.

        <p>Example:

     <pre class="example">          (getenv "PATH")
          &rArr; "/usr/local/bin:/usr/bin:/bin"
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-misc"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-int-intro">posix int intro</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-env">posix env</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.8 Miscellaneous functions</h3>

<div class="defun">
&mdash; Function: <b>strerror</b><var> error-code<a name="index-strerror-346"></a></var><br>
<blockquote><p>Return a string describing the <code>errno</code> code <var>error-code</var>. 
Makes use of the system function <code>strerror()</code>.  If <var>error-code</var>
is not a valid <code>errno</code> value: return a string telling it.

        <p><a href="libc.html#Error-Messages">Error Messages</a>
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>nanosleep</b><var> seconds nanoseconds<a name="index-nanosleep-347"></a></var><br>
<blockquote><p>Suspend the process for the selected time; it makes use of the system
<code>nanosleep()</code> function.  <var>seconds</var> and <var>nanoseconds</var> must be
positive exact integers.  If an error occurs an exception is raised.

        <p><a href="libc.html#Sleeping">Sleeping</a>
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-int-intro"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-int-errno">posix int errno</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-misc">posix misc</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.9 Internals: introduction to the <acronym>POSIX</acronym> <acronym>API</acronym></h3>

<p>The C language&ndash;level implementation is mostly in the files
<samp><span class="file">src/ikarus-runtime.c</span></samp> and <samp><span class="file">src/ikarus-io.c</span></samp>; the
Scheme&ndash;level implementation is in the library <code>(ikarus.posix)</code>,
file <samp><span class="file">scheme/ikarus.posix.ss</span></samp>.

   <p>File pathnames are always bytevector objects and the C language level,
while they are strings at the Scheme language level; the conversion is
performed with <code>string-&gt;utf8</code>.

<!--  -->
<h5 class="subsubheading">How to add a <acronym>POSIX</acronym> primitive</h5>

<p>Remember that the <acronym>POSIX</acronym> primitives end up exported by the
<code>(ikarus)</code> library.  Follow these steps:

     <ol type=1 start=1>
<li>In the file <samp><span class="file">scheme/makefile.sps</span></samp>: add an entry for the function to
the list bound to <code>identifier-&gt;library-map</code>, respect alphabetic
order.  For example, for <code>getpid</code> add:

     <pre class="example">          [getpid         i]
</pre>
     <li>In the file <samp><span class="file">scheme/ikarus.posix.ss</span></samp>: add the binding to both the
export list of <code>(ikarus.posix)</code> and to the <code>except</code> import
list from <code>(ikarus)</code>; add the function implementation calling the
foreign function.  For example, for <code>getpid</code> add:

     <pre class="example">          (define getppid
            (lambda ()
              (foreign-call "ikrt_getppid")))
</pre>
     <li>Select an appropriate C language file in the <samp><span class="file">src</span></samp> subdirectory and
add the primitive function.  For example, for <code>getpid</code> in the file
<samp><span class="file">ikarus-process.c</span></samp> add:

     <pre class="example">          ikptr
          ikrt_getpid(void)
          {
            return fix(getpid());
          }
</pre>
     <li>Add a file to the <samp><span class="file">tests</span></samp> subdirectory with tests for the new
primitive.  For example, for <code>getpid</code> add:

     <pre class="example">          (import (rnrs)
            (ikarus)
            (checks))
          
          (check-set-mode! 'report-failed)
          (display "*** testing getpid\n")
          
          (display "result of getpid() is " )
          (display (getpid))
          (newline)
          
          (check
              (fixnum? (getpid))
            =&gt; #t)
          
          (check-report)
</pre>
     </ol>

<!-- page -->
<div class="node">
<a name="posix-int-errno"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-int-fd">posix int fd</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-int-intro">posix int intro</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.10 Internals: handling <code>errno</code> codes</h3>

<div class="defun">
&mdash; Function: ikptr <b>ik_errno_to_code</b> (<var>void</var>)<var><a name="index-ik_005ferrno_005fto_005fcode-348"></a></var><br>
<blockquote><p>Apply <code>ik_errno_num_to_code()</code> to the current <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ik_errno_num_to_code</b> (<var>int en</var>)<var><a name="index-ik_005ferrno_005fnum_005fto_005fcode-349"></a></var><br>
<blockquote><p>Convert the <code>errno</code> value <var>en</var> into an internal representation
as fixnum, then return the fixnum.  If <var>en</var> is an unknown
<code>errno</code> value, return a fixnum representing -99999. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_errno_code_to_name</b> (<var>ikptr ec, ikpcb * pcb</var>)<var><a name="index-ikrt_005ferrno_005fcode_005fto_005fname-350"></a></var><br>
<blockquote><p>Convert a fixnum, internal, representation of an <code>errno</code> code into
a bytevector holding the string representation of that code; return a
reference to the bytevector.  If <var>ec</var> is invalid: return
<code>false_object</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_strerror</b> (<var>ikptr ec, ikpcb * pcb</var>)<var><a name="index-ikrt_005fstrerror-351"></a></var><br>
<blockquote><p>Interface to the <code>strerror()</code> C function.  <a href="libc.html#Error-Messages">strerror</a>.

        <p>Convert a fixnum, internal, representation of an <code>errno</code> code into
a bytevector holding the string message which describes it; return a
reference to the bytevector.  If <var>ec</var> is invalid: return
<code>false_object</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_last_errno</b> (<var>ikpcb * pcb</var>)<var><a name="index-ikrt_005flast_005ferrno-352"></a></var><br>
<blockquote><p>Return an exact integer representing the value of <code>errno</code> right
after the last call to a foreign function through the <acronym>FFI</acronym>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-int-fd"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-int-pid">posix int pid</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-int-errno">posix int errno</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.11 Internals: file descriptors</h3>

<p>File descriptors are represented as fixnums.

<ul class="menu">
<li><a accesskey="1" href="#posix-int-fd-open">posix int fd open</a>:            Opening and closing file
                                descriptors. 
<li><a accesskey="2" href="#posix-int-fd-seek">posix int fd seek</a>:            Handling file descriptor cursor. 
<li><a accesskey="3" href="#posix-int-fd-rw">posix int fd rw</a>:              Reading and writing. 
<li><a accesskey="4" href="#posix-int-fd-event">posix int fd event</a>:           Handling file descriptor events. 
<li><a accesskey="5" href="#posix-int-fd-net">posix int fd net</a>:             Handling sockets. 
</ul>

<!-- page -->
<div class="node">
<a name="posix-int-fd-open"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-int-fd-seek">posix int fd seek</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-int-fd">posix int fd</a>

</div>

<h4 class="subsection">4.11.1 Opening and closing file descriptors</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_close_fd</b> (<var>ikptr fd</var>)<var><a name="index-ikrt_005fclose_005ffd-353"></a></var><br>
<blockquote><p>Interface to the <code>close()</code> C function.  <a href="libc.html#Opening-and-Closing-Files">close</a>.  Close a file descriptor.

        <p><var>fd</var> must be a fixnum representing a file descriptor.

        <p>If successful return <code>false_object</code>; if an error occurs in
<code>close()</code> return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_open_input_fd</b> (<var>ikptr pathname</var>)<var><a name="index-ikrt_005fopen_005finput_005ffd-354"></a></var><br>
<blockquote><p>Interface to the <code>open()</code> C function.  <a href="libc.html#Opening-and-Closing-Files">open</a>.  Open a file for reading, using open mode <code>O_RDONLY</code>.

        <p><var>pathname</var> must reference a bytevector object holding the file
pathname.

        <p>If successful return a fixnum representing the file descriptor; if an
error occurs in <code>open()</code> return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_open_output_fd</b> (<var>ikptr pathname, ikptr opts</var>)<var><a name="index-ikrt_005fopen_005foutput_005ffd-355"></a></var><br>
<blockquote><p>Interface to the <code>open()</code> C function.  <a href="libc.html#Opening-and-Closing-Files">open</a>.  Open a file for writing with configurable mode based on
<code>O_WRONLY</code>; the access permissions when a new file is created are
<code>S_IRUSR | S_IWUSR | S_IRGRP | S_IROTH</code>.

        <p><var>pathname</var> must reference a bytevector object holding the file
pathname; <var>opts</var> must be a fixnum with the following encoding:

          <dl>
<dt><code>0</code><dd>The open mode is <code>O_WRONLY | O_CREAT | O_EXCL</code>.

          <br><dt><code>1</code><dd>The open mode is <code>O_WRONLY | O_TRUNC</code>.

          <br><dt><code>2</code><dd>The open mode is <code>O_WRONLY | O_TRUNC | O_CREAT</code>.

          <br><dt><code>3</code><dd>The open mode is <code>O_WRONLY | O_TRUNC</code>.

          <br><dt><code>4</code><dd>The open mode is <code>O_WRONLY | O_CREAT | O_EXCL</code>.

          <br><dt><code>5</code><dd>The open mode is <code>O_WRONLY | O_CREAT</code>.

          <br><dt><code>6</code><dd>The open mode is <code>O_WRONLY | O_CREAT</code>.

          <br><dt><code>7</code><dd>The open mode is <code>O_WRONLY</code>. 
</dl>

        <p>If successful return a fixnum representing the file descriptor; if an
error occurs in <code>open()</code> return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_open_input_output_fd</b> (<var>ikptr pathname, ikptr opts</var>)<var><a name="index-ikrt_005fopen_005finput_005foutput_005ffd-356"></a></var><br>
<blockquote><p>Interface to the <code>open()</code> C function.  <a href="libc.html#Opening-and-Closing-Files">open</a>.  Open a file for reading and writing with configurable
mode based on <code>O_RDWR</code>; the access permissions when a new file is
created are <code>S_IRUSR | S_IWUSR | S_IRGRP | S_IROTH</code>.

        <p><var>pathname</var> must reference a bytevector object holding the file
pathname; <var>opts</var> must be a fixnum representing the opening flags, it
has the same format of the <var>opts</var> argument to
<code>ikrt_open_output_fd</code>.

        <p>If successful return a fixnum representing the file descriptor; if an
error occurs in <code>open()</code> return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-int-fd-seek"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-int-fd-rw">posix int fd rw</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-int-fd-open">posix int fd open</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-int-fd">posix int fd</a>

</div>

<h4 class="subsection">4.11.2 Handling file descriptor cursor</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_position</b> (<var>ikptr fd, ikptr pos</var>)<var><a name="index-ikrt_005fset_005fposition-357"></a></var><br>
<blockquote><p>Interface to the <code>lseek()</code> C function.  <a href="libc.html#File-Position-Primitive">lseek</a>.  Set the cursor position.

        <p><var>fd</var> must be a fixnum representing a file descriptor; <var>pos</var> must
be an exact integer in the range of the <code>off_t</code> platform type.

        <p>If successful return <code>false_object</code>; if an error occurs in
<code>lseek()</code> return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-int-fd-rw"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-int-fd-event">posix int fd event</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-int-fd-seek">posix int fd seek</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-int-fd">posix int fd</a>

</div>

<h4 class="subsection">4.11.3 Reading and writing</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_read_fd</b> (<var>ikptr fd, ikptr buffer, ikptr buffer-start, ikptr size</var>)<var><a name="index-ikrt_005fread_005ffd-358"></a></var><br>
<blockquote><p>Interface to the <code>read()</code> C function.  <a href="libc.html#Input-and-Output-Primitives">read</a>.  Read data from a file descriptor.

        <p><var>fd</var> must be a fixnum representing a file descriptor; <var>buffer</var>
must reference a bytevector object in which the data will be stored;
<var>buffer-start</var> must be a fixnum representing the offset in the
buffer at which data will be written; <var>size</var> must be a fixnum
representing the number of bytes to read.

        <p>If successful return a fixnum representing the number of bytes actually
read and stored in the buffer; if an error occurs in <code>read()</code> return
the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_write_fd</b> (<var>ikptr fd, ikptr buffer, ikptr buffer-start, ikptr size</var>)<var><a name="index-ikrt_005fwrite_005ffd-359"></a></var><br>
<blockquote><p>Interface to the <code>write()</code> C function.  <a href="libc.html#Input-and-Output-Primitives">write</a>.  Write data to a file descriptor.

        <p><var>fd</var> must be a fixnum representing a file descriptor; <var>buffer</var>
must reference a bytevector object from which the data will be read;
<var>buffer-start</var> must be a fixnum representing the offset in the
buffer from which data will be read; <var>size</var> must be a fixnum
representing the number of bytes to write.

        <p>If successful return a fixnum representing the number of bytes actually
written; if an error occurs in <code>write()</code> return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-int-fd-event"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-int-fd-net">posix int fd net</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-int-fd-rw">posix int fd rw</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-int-fd">posix int fd</a>

</div>

<h4 class="subsection">4.11.4 Handling file descriptor events</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_select</b> (<var>ikptr max-fd, ikptr rfds, ikptr wfds, ikptr xfds</var>)<var><a name="index-ikrt_005fselect-360"></a></var><br>
<blockquote><p>Interface to the <code>select()</code> C function.  <a href="libc.html#Waiting-for-I_002fO">select</a>.  Poll for events on sets of file descriptors, without timeout.

        <p><var>max-fd</var> must be a fixnum representing the maximum file descriptor
for which to wait for events; <var>rfds</var>, <var>wfds</var> and <var>xfds</var> must
reference bytevectors holding <code>fd_set</code> data structures.

        <p>If successful return a fixnum representing the return value from
<code>select()</code>; if an error occurs in <code>select()</code> return the return
value of <code>ik_errno_to_code()</code>.  Notice that if the call is
interrupted by a signal, so it returns with <code>EINTR</code>, the function
returns with error without reattempting the call. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_make_fd_nonblocking</b> (<var>ikptr fd</var>)<var><a name="index-ikrt_005fmake_005ffd_005fnonblocking-361"></a></var><br>
<blockquote><p>Interface to the <code>fcntl()</code> C function.  <a href="libc.html#Control-Operations">fcntl</a>.  Set non&ndash;blocking mode for a file descriptor.

        <p><var>fd</var> must be a fixnum representing the file descriptor.

        <p>If successful return the raw C language <code>NULL</code> pointer; if an error
occurs in <code>fcntl()</code> return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-int-fd-net"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-int-fd-event">posix int fd event</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-int-fd">posix int fd</a>

</div>

<h4 class="subsection">4.11.5 Handling sockets</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_tcp_connect</b> (<var>ikptr host, ikptr srvc</var>)<var><a name="index-ikrt_005ftcp_005fconnect-362"></a></var><br>
&mdash; Function: ikptr <b>ikrt_ucp_connect</b> (<var>ikptr host, ikptr srvc</var>)<var><a name="index-ikrt_005fucp_005fconnect-363"></a></var><br>
<blockquote><p>Interface to the <code>getaddrinfo()</code>, <code>socket()</code> and <code>connect()</code>
C functions.  <a href="libc.html#Sockets">Sockets</a>.  Establish a client
connection to a remote server using the <code>SOCK_STREAM</code> or
<code>SOCK_DGRAM</code> style.

        <p><var>host</var> must reference a bytevector holding the remote server
hostname; <var>srvc</var> must reference a bytevector holding the service
specification.

        <p>If successful return a fixnum representing the socket; if an error
occurs resolving the host name and address, return <code>false_object</code>;
if an error occurs in one of the C function calls, return the return
value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_listen</b> (<var>ikptr port-number</var>)<var><a name="index-ikrt_005flisten-364"></a></var><br>
<blockquote><p>Interface to the <code>socket()</code>, <code>bind()</code>, <code>listen()</code> and
<code>setsockopt()</code> C functions.  <a href="libc.html#Sockets">Sockets</a>.  Create a
server socket bound to the given port number for the local host, using
the <code>AF_INET</code> namespace and the <code>SOCK_STREAM</code> style; the
option <code>SO_REUSEADDR</code> is set for the server socket; at most
1024 concurrent connections to the socket will be enqueued.

        <p><var>port-number</var> must be a fixnum representing the port number to use.

        <p>If successful return a fixnum representing the server socket; if an
error occurs in one of the C function calls, return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_accept</b> (<var>ikptr sock, ikptr sockaddr</var>)<var><a name="index-ikrt_005faccept-365"></a></var><br>
<blockquote><p>Interface to the <code>accept()</code> C function.  <a href="libc.html#Accepting-Connections">accept</a>.  Accept a connection to a server socket.

        <p><var>sock</var> must be a fixnum representing the server socket;
<var>sockaddr</var> must reference a bytevector object which will hold the
<code>struct sockaddr</code> describing the client's address.

        <p>If successful return a fixnum representing the client socket and fill
<var>sockaddr</var> with the client address; if an error occurs in
<code>accept()</code>, return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_shutdown</b> (<var>ikptr sock</var>)<var><a name="index-ikrt_005fshutdown-366"></a></var><br>
<blockquote><p>Interface to the <code>shutdown()</code> C function.  <a href="libc.html#Closing-a-Socket">shutdown</a>.  Close a socket for both reading and writing.

        <p><var>sock</var> must be a fixnum representing the socket.

        <p>If successful return the raw C language <code>NULL</code> pointer; if an error
occurs in <code>shutdown()</code>, return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-int-pid"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-int-files">posix int files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-int-fd">posix int fd</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.12 Internals: process identifier functions</h3>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_getpid</b> (<var>void</var>)<var><a name="index-ikrt_005fgetpid-367"></a></var><br>
<blockquote><p>Return the process identifier as fixnum.  <a href="libc.html#Process-Identification">getpid</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_getppid</b> (<var>void</var>)<var><a name="index-ikrt_005fgetppid-368"></a></var><br>
<blockquote><p>Return the parent process identifier as fixnum.  <a href="libc.html#Process-Identification">getpid</a>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-int-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-int-exec">posix int exec</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-int-pid">posix int pid</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.13 Internals: file system interface</h3>

<p>The functions documented in this section are defined in
<samp><span class="file">src/ikarus-runtime.c</span></samp>.

<ul class="menu">
<li><a accesskey="1" href="#posix-int-files-stat">posix int files stat</a>:         Status and access permissions. 
<li><a accesskey="2" href="#posix-int-files-dir">posix int files dir</a>:          Handling directories. 
<li><a accesskey="3" href="#posix-int-files-link">posix int files link</a>:         Handling links and symbolic links. 
</ul>

<!-- page -->
<div class="node">
<a name="posix-int-files-stat"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-int-files-dir">posix int files dir</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-int-files">posix int files</a>

</div>

<h4 class="subsection">4.13.1 Status and access permissions</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_stat</b> (<var>ikptr pathname, ikptr follow</var>)<var><a name="index-ikrt_005fstat-369"></a></var><br>
<blockquote><p>Interface to the <code>stat()</code> and <code>lstat()</code> C functions. 
<a href="libc.html#Reading-Attributes">stat</a>.

        <p><var>pathname</var> must reference a bytevector object holding a file
pathname; when <var>follow</var> is <code>false_object</code> <code>lstat()</code> is
used, else <code>stat()</code> is used.

        <p>If successful return a fixnum object: &lsquo;<samp><span class="samp">1</span></samp>&rsquo; if <var>pathname</var> is a
regular file, &lsquo;<samp><span class="samp">2</span></samp>&rsquo; if it is a directory, &lsquo;<samp><span class="samp">3</span></samp>&rsquo; if it is a
symbolic link, &lsquo;<samp><span class="samp">0</span></samp>&rsquo; otherwise.  If an error occurs in <code>stat()</code>
or <code>lstat()</code>: return the result of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_chmod</b> (<var>ikptr pathname, ikptr mode</var>)<var><a name="index-ikrt_005fchmod-370"></a></var><br>
<blockquote><p>Interface to the <code>chmod()</code> C function.  <a href="libc.html#Setting-Permissions">chmod</a>.  Change the access permissions of a file.

        <p><var>pathname</var> must reference a bytevector object holding the file
pathname; <var>mode</var> must be a fixnum representing the file permissions.

        <p>If successful, return <code>true_object</code>; if an error occurs in
<code>chmod()</code>, return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_access</b> (<var>ikptr pathname, ikptr how</var>)<var><a name="index-ikrt_005faccess-371"></a></var><br>
<blockquote><p>Interface to the <code>access()</code> C function.  <a href="libc.html#Testing-File-Access">access</a>.  Test access permissions for a file.

        <p><var>pathname</var> must reference a bytevector object holding a file
pathname; <var>how</var> must be a fixnum: if zero the mode is <code>F_OK</code>,
else it is an OR combination built as follows:

          <ul>
<li>If the first bit of <var>how</var> is set: <code>R_OK</code> is added.

          <li>If the second bit of <var>how</var> is set: <code>W_OK</code> is added.

          <li>If the third bit of <var>how</var> is set: <code>X_OK</code> is added. 
</ul>

        <p>If successful return <code>true_object</code>; if an error occurs in
<code>access()</code> with <code>errno</code> set to <code>EACCES</code>, <code>EROFS</code> or
<code>ETXTBSY</code> return <code>false_object</code>; if an error occurs in
<code>access()</code> under any other condition, return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_file_size</b> (<var>ikptr pathname, ikpcb * pcb</var>)<var><a name="index-ikrt_005ffile_005fsize-372"></a></var><br>
<blockquote><p>Interface to the <code>stat()</code> C function.  <a href="libc.html#Reading-Attributes">stat</a>.  Retrieve the size of a file.

        <p><var>pathname</var> must reference a bytevector object holding a file
pathname.

        <p>If successful return an exact integer representing the file size
(according to the <code>st_size</code> field of <code>struct stat</code>); if an
error occurs in <code>stat()</code>, return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_file_mtime2</b> (<var>ikptr pathname, ikpcb * pcb</var>)<var><a name="index-ikrt_005ffile_005fmtime2-373"></a></var><br>
&mdash; Function: ikptr <b>ikrt_file_ctime2</b> (<var>ikptr pathname, ikpcb * pcb</var>)<var><a name="index-ikrt_005ffile_005fctime2-374"></a></var><br>
<blockquote><p>Interface to the <code>stat()</code> and <code>lstat()</code> C functions. 
<a href="libc.html#Reading-Attributes">stat</a>.  Acquire the time of the last
modification or attribute modification for a file.

        <p><var>pathname</var> must reference a bytevector object holding the file
pathname.

        <p>If successful return a reference to a bytevector holding a packed
representation of a <code>struct timespec</code> representing the modification
time; if an error occurs in <code>stat()</code>, return the return value of
<code>ik_errno_to_code()</code>.

        <p>The packed representation of <code>struct timespec</code> in a bytevector can
be inspected as follows:

     <pre class="example">          (define bv --)  ;the bytevector
          
          ;; the size of the tv_sec  field in bytes
          (define tv_sec-size
            (bytevector-u8-ref bv 0))
          
          ;;the size of the tv_nsec field in bytes
          (define tv_nsec-size
            (bytevector-u8-ref bv 1))
          
          (define tv_sec
            (bytevector-uint-ref v 2 (native-endianness) tv_sec-size))
          
          (define tv_nsec
            (bytevector-uint-ref v (+ 2 tv_sec-size) (native-endianness)
                                 tv_nsec-size))
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_file_mtime</b> (<var>ikptr pathname, ikpcb result</var>)<var><a name="index-ikrt_005ffile_005fmtime-375"></a></var><br>
&mdash; Function: ikptr <b>ikrt_file_ctime</b> (<var>ikptr pathname, ikpcb result</var>)<var><a name="index-ikrt_005ffile_005fctime-376"></a></var><br>
<blockquote><p>Interface to the <code>stat()</code> and <code>lstat()</code> C functions. 
<a href="libc.html#Reading-Attributes">stat</a>.  Acquire the time of the last
modification or attribute modification for a file.

        <p><var>pathname</var> must reference a bytevector object holding the file
pathname; <var>result</var> must reference a pair which will be mutated to
hold the result.

        <p>If successful store the modification time in the car of the <var>result</var>
pair and set the cdr to raw zero; if an error occurs in <code>stat()</code>,
return the return value of <code>ik_errno_to_code()</code>.

        <blockquote>
<strong>NOTE</strong> Use of this function appears to be deprecated. 
</blockquote>
        </p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-int-files-dir"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-int-files-link">posix int files link</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-int-files-stat">posix int files stat</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-int-files">posix int files</a>

</div>

<h4 class="subsection">4.13.2 Handling directories</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_directory_list</b> (<var>ikptr pathname, ikpcb * pcb</var>)<var><a name="index-ikrt_005fdirectory_005flist-377"></a></var><br>
<blockquote><p>Interface to the <code>opendir()</code>, <code>readdir()</code> and <code>closedir()</code> C
functions.  <a href="libc.html#Accessing-Directories">Accessing Directories</a>. 
Inspect the contents of the selected directory.

        <p><var>pathname</var> must reference a bytevector object holding a file
pathname.

        <p>If successful, return a list of bytevectors representing the names of
the entries in the directory.  If an error occurs in the C functions,
return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_opendir</b> (<var>ikptr pathname, ikpcb * pcb</var>)<var><a name="index-ikrt_005fopendir-378"></a></var><br>
<blockquote><p>Interface to the <code>opendir()</code> C function.  <a href="libc.html#Accessing-Directories">Accessing Directories</a>.  Open a directory stream.

        <p><var>pathname</var> must reference a bytevector object holding a directory
pathname.

        <p>If successful, return a reference to a pointer object referencing the
directory entry; if an error occurs in <code>opendir()</code>, return the
return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_closedir</b> (<var>ikptr stream, ikpcb * pcb</var>)<var><a name="index-ikrt_005fclosedir-379"></a></var><br>
<blockquote><p>Interface to the <code>closedir()</code> C function.  <a href="libc.html#Accessing-Directories">Accessing Directories</a>.  Close a directory stream.

        <p><var>stream</var> must reference a pointer object referencing a directory
stream.

        <p>If successful, return a raw C language zero; if an error occurs in
<code>closedir()</code>, return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_readdir</b> (<var>ikptr stream, ikpcb * pcb</var>)<var><a name="index-ikrt_005freaddir-380"></a></var><br>
<blockquote><p>Interface to the <code>readdir()</code> C function.  <a href="libc.html#Accessing-Directories">Accessing Directories</a>.  Read a directory entry from a
directory stream.

        <p><var>stream</var> must reference a pointer object referencing a directory
stream.

        <p>If successful return a reference to a bytevector object holding the name
of the directory entry; if an error occurs in <code>readdir()</code>, return
the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_mkdir</b> (<var>ikptr pathname, ikptr mode</var>)<var><a name="index-ikrt_005fmkdir-381"></a></var><br>
<blockquote><p>Interface to the <code>mkdir()</code> C function.  <a href="libc.html#Creating-Directories">mkdir</a>.

        <p><var>pathname</var> must reference a bytevector object holding the new
directory pathname; <var>mode</var> must be a fixnum representing the file
permissions for the new directory.

        <p>If successful, return <code>true_object</code>; if an error occurs in
<code>mkdir()</code>, return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_rmdir</b> (<var>ikptr pathname</var>)<var><a name="index-ikrt_005frmdir-382"></a></var><br>
<blockquote><p>Interface to the <code>rmdir()</code> C function.  <a href="libc.html#Deleting-Files">rmdir</a>.  Remove a directory.

        <p><var>pathname</var> must reference a bytevector object holding the directory
pathname.

        <p>If successful, return <code>true_object</code>; if an error occurs in
<code>rmdir()</code>, return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_chdir</b> (<var>ikptr pathname</var>)<var><a name="index-ikrt_005fchdir-383"></a></var><br>
<blockquote><p>Interface to the <code>chdir()</code> C function.  <a href="libc.html#Working-Directory">chdir</a>.  Change the current working directory.

        <p><var>pathname</var> must reference a bytevector object holding the directory
pathname.

        <p>If successful, return <code>true_object</code>; if an error occurs in
<code>chdir()</code>, return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_getcwd</b> (<var>ikpcb * pcb</var>)<var><a name="index-ikrt_005fgetcwd-384"></a></var><br>
<blockquote><p>Interface to the <code>getcwd()</code> C function.  <a href="libc.html#Working-Directory">getcwd</a>.  Retrieve the current working directory.

        <p>If successful, return a reference to a bytevector object holding the
current working directory pathname; if an error occurs in
<code>getcwd()</code>, return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-int-files-link"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-int-files-dir">posix int files dir</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-int-files">posix int files</a>

</div>

<h4 class="subsection">4.13.3 Handling links and symbolic links</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_link</b> (<var>ikptr old_pathname, ikptr pathname</var>)<var><a name="index-ikrt_005flink-385"></a></var><br>
<blockquote><p>Interface to the <code>link()</code> C function.  <a href="libc.html#Hard-Links">link</a>. 
Create a hard link.

        <p><var>old_pathname</var> must reference a bytevector object holding the old
file pathname; <var>pathname</var> must reference a bytevector object holding
the new hard link pathname.

        <p>If successful, return <code>true_object</code>; if an error occurs in
<code>link()</code>, return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_delete_file</b> (<var>ikptr pathname</var>)<var><a name="index-ikrt_005fdelete_005ffile-386"></a></var><br>
<blockquote><p>Interface to the <code>unlink()</code> C function.  <a href="libc.html#Deleting-Files">unlink</a>.  Remove a file selected by pathname.

        <p><var>pathname</var> must reference a bytevector object holding a file
pathname.  If an error occurs in <code>unlink()</code>: return the result of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_symlink</b> (<var>ikptr old_pathname, ikptr pathname</var>)<var><a name="index-ikrt_005fsymlink-387"></a></var><br>
<blockquote><p>Interface to the <code>symlink()</code> C function.  <a href="libc.html#Symbolic-Links">symlink</a>.  Create a symbolic link.

        <p><var>old_pathname</var> must reference a bytevector object holding the old
file pathname; <var>pathname</var> must reference a bytevector object holding
the new symbolic link pathname.

        <p>If successful, return <code>true_object</code>; if an error occurs in
<code>symlink()</code>, return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_realpath</b> (<var>ikptr pathname, ikpcb * pcb</var>)<var><a name="index-ikrt_005frealpath-388"></a></var><br>
<blockquote><p>Interface to the <code>realpath()</code> C function.  <a href="libc.html#Symbolic-Links">realpath</a>.  Acquire the absolute name of the selected file, removing
dot, double&ndash;dot components and repeated separators, and following
symbolic links.

        <p><var>pathname</var> must reference a bytevector object holding the file
pathname.

        <p>If successful, return a bytevector holding the canonicalised pathname;
if an error occurs in <code>realpath()</code>, return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_rename_file</b> (<var>ikptr src, ikptr dst</var>)<var><a name="index-ikrt_005frename_005ffile-389"></a></var><br>
<blockquote><p>Interface to the <code>rename()</code> C function.  <a href="libc.html#Renaming-Files">rename</a>.

        <p><var>src</var> and <var>dst</var> must reference bytevector objects holding the
old and new pathnames.

        <p>If successful return <code>true_object</code>; if an error occurs in
<code>rename()</code>, return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-int-exec"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-int-time">posix int time</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-int-files">posix int files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.14 Internals: executing processes</h3>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_exit</b> (<var>ikptr status, ikpcb * pcb</var>)<var><a name="index-ikrt_005fexit-390"></a></var><br>
<blockquote><p>Interface to the <code>exit()</code> C function.  <a href="libc.html#Normal-Termination">exit</a>.  Exit the current process.

        <p>If <var>status</var> is a fixnum, it is used as exit status; else the exit
status is <code>EXIT_FAILURE</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_fork</b> (<var>void</var>)<var><a name="index-ikrt_005ffork-391"></a></var><br>
<blockquote><p>Interface to the <code>fork()</code> C function.  <a href="libc.html#Creating-a-Process">fork</a>.  Create a new process.

        <p>If successful return a fixnum representing the the return value of
<code>fork()</code>; if an error occurs in <code>fork()</code>, return the return
value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ik_system</b> (<var>ikptr command</var>)<var><a name="index-ik_005fsystem-392"></a></var><br>
<blockquote><p>Interface to the <code>system()</code> C function.  <a href="libc.html#Running-a-Command">system</a>.  Execute a command through the system shell.

        <p><var>command</var> must reference a bytevector object holding the command to
execute.

        <p>If successful return the exit status of the executed process; if an
error occurs in <code>system()</code>, return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-int-time"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-int-env">posix int env</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-int-exec">posix int exec</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.15 Internals: time and date</h3>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_current_time</b> (<var>ikptr time</var>)<var><a name="index-ikrt_005fcurrent_005ftime-393"></a></var><br>
<blockquote><p>Interface to the <code>gettimeofday()</code> C function. 
<a href="libc.html#High_002dResolution-Calendar">gettimeofday</a>.  Retrieve the current
time.

        <p><var>time</var> must reference a <code>time</code> internal structure, which is
filled with three values: megaseconds, seconds and microseconds.

        <p>Always return <var>time</var> itself. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_gmt_offset</b> (<var>ikptr time</var>)<var><a name="index-ikrt_005fgmt_005foffset-394"></a></var><br>
<blockquote><p>Compute the offset in seconds between the local time and the
<acronym>UTC</acronym> time.

        <p><var>time</var> must reference a <code>time</code> internal structure, already
filled with megaseconds, seconds and microseconds.

        <p>Return a fixnum representing the offset. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_nanosleep</b> (<var>ikptr secs, ikptr nsecs</var>)<var><a name="index-ikrt_005fnanosleep-395"></a></var><br>
<blockquote><p>Interface to the <code>nanosleep()</code> C function.  <a href="libc.html#Sleeping">nanosleep</a>.  Halt the current process.

        <p><var>secs</var> and <var>nsecs</var> must be fixnums or exact integers whose value
is stored in a single limb (see the <code>mpn_</code> <acronym>API</acronym> in <acronym>GMP</acronym>). 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-int-env"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-int-time">posix int time</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">4.16 Internals: environment variables</h3>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_getenv</b> (<var>ikptr variable, ikpcb * pcb</var>)<var><a name="index-ikrt_005fgetenv-396"></a></var><br>
<blockquote><p>Interface to the <code>getenv()</code> C function.  <a href="libc.html#Environment-Access">getenv</a>.  Retrieve the value of environment variables.

        <p><var>variable</var> must reference a bytevector object representing the name
of the environment variable.

        <p>If the environment variable is set: return a bytevector representing its
value; else return <code>false_object</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_setenv</b> (<var>ikptr variable, ikptr value, ikptr overwrite</var>)<var><a name="index-ikrt_005fsetenv-397"></a></var><br>
<blockquote><p>Interface to the <code>setenv()</code> C function.  <a href="libc.html#Environment-Access">setenv</a>.  Set a new value for an environment variable.

        <p><var>variable</var> must reference a bytevector object representing the name
of the environment variable; <var>value</var> must reference a bytevector
object representing the new value.  If <var>overwrite</var> is
<code>false_object</code> and the environment variable already exists: the
environment variable is left untouched; else the new value is set,
either creating a new environment variable or replacing the old value.

        <p>If successful return <code>true_object</code>; if an error occurs in
<code>setenv()</code> return <code>false_object</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_unsetenv</b> (<var>ikptr variable</var>)<var><a name="index-ikrt_005funsetenv-398"></a></var><br>
<blockquote><p>Interface to the <code>unsetenv()</code> C function.  <a href="libc.html#Environment-Access">unsetenv</a>.  Unset an environment variable.

        <p><var>variable</var> must reference a bytevector object representing the name
of the environment variable.

        <p>Return void. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_environ</b> (<var>ikpcb * pcb</var>)<var><a name="index-ikrt_005fenviron-399"></a></var><br>
<blockquote><p>Interface to the <code>environ</code> global C variable. 
<a href="libc.html#Environment-Access">unsetenv</a>.  Retrieve the full environment.

        <p>Return a list of bytevectors representing the contents of the
<code>environ</code> array; if the environment is empty (no environment
variables set) return <code>null_object</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-int">objects int</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix">posix</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">5 Low level, fast, unsafe operations</h2>

<p>The bindings documented in this chapter are low level operations inlined
by the compiler; mostly they are defined in the source file
<samp><span class="file">pass-specify-rep-primops.ss</span></samp>.

   <p>They are unsafe because when acting upon wrong arguments will cause
undefined behaviour (probably a crash).  They are also faster than the
public interface exported by <code>(ikarus)</code> and <code>(rnrs)</code>.

<ul class="menu">
<li><a accesskey="1" href="#syslib-symbols">syslib symbols</a>:               Low level symbol operations. 
<li><a accesskey="2" href="#syslib-fixnums">syslib fixnums</a>:               Low level fixnum operations. 
<li><a accesskey="3" href="#syslib-bignums">syslib bignums</a>:               Low level bignum operations. 
<li><a accesskey="4" href="#syslib-flonums">syslib flonums</a>:               Low level flonum operations. 
<li><a accesskey="5" href="#syslib-ratnums">syslib ratnums</a>:               Low level ratnum operations. 
<li><a accesskey="6" href="#syslib-compnums">syslib compnums</a>:              Low level compnum operations. 
<li><a accesskey="7" href="#syslib-cflonums">syslib cflonums</a>:              Low level cflonum operations. 
<li><a accesskey="8" href="#syslib-chars">syslib chars</a>:                 Low level character operations. 
<li><a accesskey="9" href="#syslib-pairs">syslib pairs</a>:                 Low level pair operations. 
<li><a href="#syslib-structs">syslib structs</a>:               Low level structure operations. 
<li><a href="#syslib-vectors">syslib vectors</a>:               Low level vector operations. 
<li><a href="#syslib-bytevectors">syslib bytevectors</a>:           Low level bytevector operations. 
<li><a href="#syslib-strings">syslib strings</a>:               Low level string operations. 
<li><a href="#syslib-ports">syslib ports</a>:                 Low level port structures. 
<li><a href="#syslib-transcoders">syslib transcoders</a>:           Low level transcoder operations. 
</ul>

<!-- page -->
<div class="node">
<a name="syslib-symbols"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-fixnums">syslib fixnums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">5.1 Low level symbol operations</h3>

<p>A symbols is a variable length memory block referenced by machine words
tagged as vectors.  The first machine word of a symbol block is tagged
has symbol in its least significant bits and it has the most significant
bits set to zero.

<pre class="example">     |------------------------|-------------| reference to symbol
           heap offset          vector tag
     
     |------------------------|-------------| symbol first word
        number of words         symbol tag
</pre>
   <p>A symbol memory block is 6 words wide and contains references to
the following fields: <code>string</code>, <code>ustring</code>, <code>value</code>,
<code>proc</code>, <code>plist</code>.

   <p>The arguments <var>sym</var> must be references to symbol blocks, the
arguments <var>str</var> must be references to strings.  The following
bindings are exported by the <code>(ikarus system $symbols)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-symbol</b><var> str<a name="index-g_t_0024make_002dsymbol-400"></a></var><br>
<blockquote><p>Allocate a new symbol block and initialise the <code>string</code> field with
<var>str</var>; return the reference to the symbol block.

        <p>The <code>ustring</code> is initialised to the fixnum zero.  The <code>value</code>
and <code>proc</code> fields are initialised to a special fixnum value meaning
&ldquo;unbound&rdquo;.  The <code>plist</code> field is initialised to null. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$symbol-string</b><var> sym<a name="index-g_t_0024symbol_002dstring-401"></a></var><br>
&mdash; Unsafe Operation: <b>$symbol-unique-string</b><var> sym<a name="index-g_t_0024symbol_002dunique_002dstring-402"></a></var><br>
&mdash; Unsafe Operation: <b>$symbol-plist</b><var> sym<a name="index-g_t_0024symbol_002dplist-403"></a></var><br>
&mdash; Unsafe Operation: <b>$symbol-value</b><var> sym<a name="index-g_t_0024symbol_002dvalue-404"></a></var><br>
<blockquote><p>Accessors for the fields of <var>sym</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$set-symbol-string!</b><var> sym str<a name="index-g_t_0024set_002dsymbol_002dstring_0021-405"></a></var><br>
&mdash; Unsafe Operation: <b>$set-symbol-unique-string!</b><var> sym str<a name="index-g_t_0024set_002dsymbol_002dunique_002dstring_0021-406"></a></var><br>
&mdash; Unsafe Operation: <b>$set-symbol-plist!</b><var> sym ell<a name="index-g_t_0024set_002dsymbol_002dplist_0021-407"></a></var><br>
&mdash; Unsafe Operation: <b>$set-symbol-value!</b><var> sym val<a name="index-g_t_0024set_002dsymbol_002dvalue_0021-408"></a></var><br>
&mdash; Unsafe Operation: <b>$set-symbol-proc!</b><var> sym proc<a name="index-g_t_0024set_002dsymbol_002dproc_0021-409"></a></var><br>
<blockquote><p>Mutators for the fields of <var>sym</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$set-symbol-value/proc!</b><var> sym val<a name="index-g_t_0024set_002dsymbol_002dvalue_002fproc_0021-410"></a></var><br>
<blockquote><p>Set both the fields <code>value</code> and <code>proc</code> of <var>sym</var> to
<var>val</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>top-level-value</b><var> sym<a name="index-top_002dlevel_002dvalue-411"></a></var><br>
<blockquote><p>Still to be documented. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$init-symbol-function!</b><var> sym proc<a name="index-g_t_0024init_002dsymbol_002dfunction_0021-412"></a></var><br>
<blockquote><p>Still to be documented. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-fixnums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-bignums">syslib bignums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-symbols">syslib symbols</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">5.2 Low level fixnum operations</h3>

<p>A fixnum is a machine word whose two least significant bits are set to
zero.  <acronym>R6RS</acronym> states that a fixnum must have at least 24 bits
in which to store the number; under Vicare, on a 32-bit
platform, 29 bits are available to store the number and 1
bit to store the sign:

<pre class="example">     (greatest-fixnum)       &rArr; +536870911
     (expt 2 29)             &rArr; +536870912
     (- (expt 2 29) 1)       &rArr; +536870911
     
     (least-fixnum)          &rArr; -536870912
     (- (expt 2 29))         &rArr; -536870912
</pre>
   <p>The arguments to these operations must be fixnums.  The following
bindings are exported by the <code>(ikarus system $fx)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$fxzero?</b><var> fx<a name="index-g_t_0024fxzero_003f-413"></a></var><br>
<blockquote><p>Evaluate to true if <var>fx</var> is zero. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx=</b><var> fx1 fx2<a name="index-g_t_0024fx_003d-414"></a></var><br>
<blockquote><p>Evaluate to true if the arguments are equal. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx&lt;</b><var> fx1 fx2<a name="index-g_t_0024fx_003c-415"></a></var><br>
<blockquote><p>Evaluate to true if <var>fx1</var> is less than <var>fx2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx&lt;=</b><var> fx1 fx2<a name="index-g_t_0024fx_003c_003d-416"></a></var><br>
<blockquote><p>Evaluate to true if <var>fx1</var> is less than or equal to <var>fx2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx&gt;</b><var> fx1 fx2<a name="index-g_t_0024fx_003e-417"></a></var><br>
<blockquote><p>Evaluate to true if <var>fx1</var> is greater than <var>fx2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx&gt;=</b><var> fx1 fx2<a name="index-g_t_0024fx_003e_003d-418"></a></var><br>
<blockquote><p>Evaluate to true if <var>fx1</var> is greater than or equal to <var>fx2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxadd1</b><var> fx<a name="index-g_t_0024fxadd1-419"></a></var><br>
<blockquote><p>Increment the operand by one and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxsub1</b><var> fx<a name="index-g_t_0024fxsub1-420"></a></var><br>
<blockquote><p>Decrement the operand by one and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx+</b><var> fx1 fx2<a name="index-g_t_0024fx_002b-421"></a></var><br>
<blockquote><p>Sum the operands and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx-</b><var> fx1 fx2<a name="index-g_t_0024fx_002d-422"></a></var><br>
<blockquote><p>Subtract the operands and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx*</b><var> fx1 fx2<a name="index-g_t_0024fx_002a-423"></a></var><br>
<blockquote><p>Multiply the operands and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxlognot</b><var> fx<a name="index-g_t_0024fxlognot-424"></a></var><br>
<blockquote><p>Perform the bitwise NOT on the operand and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxlogand</b><var> fx1 fx2<a name="index-g_t_0024fxlogand-425"></a></var><br>
<blockquote><p>Perform the bitwise AND on the operands and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxlogor</b><var> fx1 fx2<a name="index-g_t_0024fxlogor-426"></a></var><br>
<blockquote><p>Perform the bitwise inclusive OR on the operands and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxlogxor</b><var> fx1 fx2<a name="index-g_t_0024fxlogxor-427"></a></var><br>
<blockquote><p>Perform the bitwise exclusive OR on the operands and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxsll</b><var> fx1 fx2<a name="index-g_t_0024fxsll-428"></a></var><br>
<blockquote><p>Perform bitwise shift left of <var>fx1</var> by <var>fx2</var> positions and
return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxsra</b><var> fx1 fx2<a name="index-g_t_0024fxsra-429"></a></var><br>
<blockquote><p>Perform bitwise shift right of <var>fx1</var> by <var>fx2</var> positions and
return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxquotient</b><var> fx1 fx2<a name="index-g_t_0024fxquotient-430"></a></var><br>
<blockquote><p>Compute the quotient between the operands and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxinthash</b><var> fx<a name="index-g_t_0024fxinthash-431"></a></var><br>
<blockquote><p>Evaluate to a fixnum which can be used as hash value.

        <blockquote>
<strong>NOTE</strong>  This appears to be unused in the source. 
</blockquote>
        </p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-bignums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-flonums">syslib flonums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-fixnums">syslib fixnums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">5.3 Low level bignum operations</h3>

<p>Bignums are multi&ndash;precision exact integers bigger than fixnums; they
are implemented using the <code>mpn</code> <acronym>API</acronym> of <acronym>GNU</acronym> <acronym>GMP</acronym>,
See <a href="gmp.html#Low_002dlevel-Functions">mpn</a>.  <a href="#iklib-numerics">iklib numerics</a> for more functions acting on bignums.

   <p>A bignum is a variable length memory block referenced by machine words
tagged as vectors.  The first machine word of a bignum block is tagged
has bignum in its least significant bits; then comes a sign bit, zero if
positive; the remaining most significant bits represent the number of
words in the memory block after the first one.

<pre class="example">     |------------------------|-------------| reference to bignum
           heap offset          vector tag
     
                          sign bit
     |----------------------|-|-------------| bignum first word
        number of words         bignum tag
</pre>
   <p>A pointer to the second machine word in a bignum memory block is the
pointer of type <code>mp_limb_t</code> accepted by the <code>mpn_</code> functions
of <acronym>GMP</acronym>; <dfn>limb</dfn>, in <acronym>GMP</acronym> jargon, is a machine word holding a
portion of multi&ndash;precision number.

   <p>The arguments <var>bn</var> to these operations must be bignums.  The
following bindings are exported by the <code>(ikarus system $bignums)</code>
library.

<div class="defun">
&mdash; Unsafe Operation: <b>$bignum-positive?</b><var> bn<a name="index-g_t_0024bignum_002dpositive_003f-432"></a></var><br>
<blockquote><p>Evaluate to true if the operand is positive. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bignum-byte-ref</b><var> bn fx<a name="index-g_t_0024bignum_002dbyte_002dref-433"></a></var><br>
<blockquote><p>Return a fixnum representing the byte at index <var>fx</var> in the data of
<var>bn</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bignum-size</b><var> bn<a name="index-g_t_0024bignum_002dsize-434"></a></var><br>
<blockquote><p>Return a fixnum representing the number of machine words in the data
portion of a bignum memory block. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-flonums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-ratnums">syslib ratnums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-bignums">syslib bignums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">5.4 Low level flonum operations</h3>

<p>Flonums are double&ndash;precision floating point numbers implemented as
specified by <acronym>IEEE</acronym> 754 on the hosting platform.  <a href="#iklib-numerics">iklib numerics</a>
for more functions acting on flonums.

   <p>A flonum is a fixed length memory block referenced by machine words
tagged as vectors.  The first machine word of a flonum block is tagged
has flonum in its least significant bits and it has the most significant
bits set to zero.

<pre class="example">     |------------------------|-------------| reference to flonum
           heap offset          vector tag
     
     |------------------------|-------------| flonum first word
        all set to zero         flonum tag
</pre>
   <p>A flonum memory block is 16 bytes wide and the actual number is
stored in the last two words (both on 32-bit and 64-bit platforms) to
speed up a bit memory access by aligning data on multiples of 8.

<pre class="example">        1st word     2nd word     3rd word     4th word
     |------------|------------|------------|------------|
      tagged word     unused           data words
</pre>
   <p>The arguments <var>fl</var> to these operations must be flonums, the
arguments <var>fx</var> must be fixnums.  The following bindings are exported
by the <code>(ikarus system $flonums)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-flonum</b><var><a name="index-g_t_0024make_002dflonum-435"></a></var><br>
<blockquote><p>Allocate a new flonum memory block and return a reference to it.  Does
not initialise the data area. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$flonum-u8-ref</b><var> fl fx<a name="index-g_t_0024flonum_002du8_002dref-436"></a></var><br>
<blockquote><p>Return the octet at index <var>fx</var> in the data area of <var>fl</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$flonum-set!</b><var> fl fx-index fx-value<a name="index-g_t_0024flonum_002dset_0021-437"></a></var><br>
<blockquote><p>Store the byte or octet represented by <var>fx-value</var> at index
<var>fx-index</var> in the data area of <var>fl</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fixnum-&gt;flonum</b><var> fx<a name="index-g_t_0024fixnum_002d_003eflonum-438"></a></var><br>
<blockquote><p>Convert the fixnum operand into a flonum and return a reference to the
result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fl+</b><var> fl1 fl2<a name="index-g_t_0024fl_002b-439"></a></var><br>
&mdash; Unsafe Operation: <b>$fl-</b><var> fl1 fl2<a name="index-g_t_0024fl_002d-440"></a></var><br>
&mdash; Unsafe Operation: <b>$fl*</b><var> fl1 fl2<a name="index-g_t_0024fl_002a-441"></a></var><br>
&mdash; Unsafe Operation: <b>$fl/</b><var> fl1 fl2<a name="index-g_t_0024fl_002f-442"></a></var><br>
<blockquote><p>Perform arithmetic operations. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fl=</b><var> fl1 fl2<a name="index-g_t_0024fl_003d-443"></a></var><br>
&mdash; Unsafe Operation: <b>$fl&lt;</b><var> fl1 fl2<a name="index-g_t_0024fl_003c-444"></a></var><br>
&mdash; Unsafe Operation: <b>$fl&lt;=</b><var> fl1 fl2<a name="index-g_t_0024fl_003c_003d-445"></a></var><br>
&mdash; Unsafe Operation: <b>$fl&gt;</b><var> fl1 fl2<a name="index-g_t_0024fl_003e-446"></a></var><br>
&mdash; Unsafe Operation: <b>$fl&gt;=</b><var> fl1 fl2<a name="index-g_t_0024fl_003e_003d-447"></a></var><br>
<blockquote><p>Perform comparison operations
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$flonum-sbe</b><var> fl<a name="index-g_t_0024flonum_002dsbe-448"></a></var><br>
<blockquote><p>Return a fixnum<small class="dots">...</small> Still undocumented, read the code look at the
format of <acronym>IEEE</acronym> double precision flonums. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-ratnums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-compnums">syslib compnums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-flonums">syslib flonums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">5.5 Low level ratnum operations</h3>

<p>Ratnums are exact rational numbers, having a fixnum or bignum as
numerator and a fixnum or bignum as denominator.  <a href="#iklib-numerics">iklib numerics</a>
for more functions acting on ratnums.

   <p>A ratnum is a fixed length memory block referenced by machine words
tagged as vectors.  The first machine word of a ratnum block is tagged
has ratnum in its least significant bits and it has the most significant
bits set to zero.

<pre class="example">     |------------------------|-------------| reference to ratnum
           heap offset          vector tag
     
     |------------------------|-------------| ratnum first word
        all set to zero         ratnum tag
</pre>
   <p>A ratnum memory block is 4 words wide; a reference to the
numerator is stored in the second word and a reference to the
denominator is stored in the third word

<pre class="example">        1st word     2nd word     3rd word     4th word
     |------------|------------|------------|------------|
      tagged word   numerator   denominator     unused
</pre>
   <p>The arguments <var>rat</var> to these operations must be ratnums, the
arguments <var>num</var> must be references to either fixnums or bignums. 
The following bindings are exported by the <code>(ikarus system
$ratnums)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-ratnum</b><var> num1 num2<a name="index-g_t_0024make_002dratnum-449"></a></var><br>
<blockquote><p>Allocate a new ratnum memory block, store <var>num1</var> as reference to the
numerator and <var>num2</var> as reference to the denominator.  Return a
reference to the ratnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$ratnum-n</b><var> rat<a name="index-g_t_0024ratnum_002dn-450"></a></var><br>
<blockquote><p>Return the reference to the numerator. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$ratnum-d</b><var> rat<a name="index-g_t_0024ratnum_002dd-451"></a></var><br>
<blockquote><p>Return the reference to the denominator. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-compnums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-cflonums">syslib cflonums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-ratnums">syslib ratnums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">5.6 Low level compnum operations</h3>

<p>Compnums are complex numbers having a fixnum, bignum or flonum as real
part and a fixnum, bignum or flonum as imaginary part, but <strong>not</strong>
both flonums.  <a href="#iklib-numerics">iklib numerics</a> for more functions acting on
compnums.

   <p>A compnum is a fixed length memory block referenced by machine words
tagged as vectors.  The first machine word of a compnum block is tagged
has compnum in its least significant bits and it has the most
significant bits set to zero.

<pre class="example">     |------------------------|-------------| reference to compnum
           heap offset          vector tag
     
     |------------------------|-------------| compnum first word
        all set to zero         compnum tag
</pre>
   <p>A compnum memory block is 4 words wide; a reference to the real
part is stored in the second word and a reference to the imaginary part
is stored in the third word

<pre class="example">        1st word     2nd word     3rd word     4th word
     |------------|------------|------------|------------|
      tagged word   real part    imag part     unused
</pre>
   <p>The arguments <var>cmp</var> to these operations must be compnums, the
arguments <var>num</var> must be references to either fixnums, bignums or
flonums.  The following bindings are exported by the <code>(ikarus
system $compnums)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-compnum</b><var> num1 num2<a name="index-g_t_0024make_002dcompnum-452"></a></var><br>
<blockquote><p>Allocate a new compnum memory block, store <var>num1</var> as reference to
the real part and <var>num2</var> as reference to the imaginary part. 
Return a reference to the compnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$compnum-real</b><var> cmp<a name="index-g_t_0024compnum_002dreal-453"></a></var><br>
<blockquote><p>Return the reference to the real part. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$compnum-imag</b><var> cmp<a name="index-g_t_0024compnum_002dimag-454"></a></var><br>
<blockquote><p>Return the reference to the imaginary part. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-cflonums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-chars">syslib chars</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-compnums">syslib compnums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">5.7 Low level cflonum operations</h3>

<p>Cflonums are complex numbers having a flonum as real part and flonum as
imaginary part.  <a href="#iklib-numerics">iklib numerics</a> for more functions acting on
cflonums.

   <p>A cflonum is a fixed length memory block referenced by machine words
tagged as vectors.  The first machine word of a cflonum block is tagged
has cflonum in its least significant bits and it has the most
significant bits set to zero.

<pre class="example">     |------------------------|-------------| reference to cflonum
           heap offset          vector tag
     
     |------------------------|-------------| cflonum first word
        all set to zero         cflonum tag
</pre>
   <p>A cflonum memory block is 4 words wide; a reference to the real
part is stored in the second word and a reference to the imaginary part
is stored in the third word

<pre class="example">        1st word     2nd word     3rd word     4th word
     |------------|------------|------------|------------|
      tagged word   real part    imag part     unused
</pre>
   <p>The arguments <var>cmp</var> to these operations must be cflonums, the
arguments <var>fl</var> must be references to flonums.  The following
bindings are exported by the <code>(ikarus system $compnums)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-cflonum</b><var> fl1 fl2<a name="index-g_t_0024make_002dcflonum-455"></a></var><br>
<blockquote><p>Allocate a new cflonum memory block, store <var>fl1</var> as reference to the
real part and <var>fl2</var> as reference to the imaginary part.  Return a
reference to the cflonum. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$cflonum-real</b><var> cmp<a name="index-g_t_0024cflonum_002dreal-456"></a></var><br>
<blockquote><p>Return the reference to the real part. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$cflonum-imag</b><var> cmp<a name="index-g_t_0024cflonum_002dimag-457"></a></var><br>
<blockquote><p>Return the reference to the imaginary part. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-chars"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-pairs">syslib pairs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-cflonums">syslib cflonums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">5.8 Low level character operations</h3>

<p>A character is a machine word whose least significant bits are set to
the character tag.

   <p>The arguments <var>ch</var> to these operations must be characters, the
arguments <var>fx</var> must be fixnums in the range <code>[0, #x10FFFF]</code> but
not in the range <code>[#xD800, #xDFFF]</code>.  The following bindings are
exported by the <code>(ikarus system $chars)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$char=</b><var> ch1 ch2<a name="index-g_t_0024char_003d-458"></a></var><br>
<blockquote><p>Evaluate to true if the operands are equal. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$char&lt;</b><var> ch1 ch2<a name="index-g_t_0024char_003c-459"></a></var><br>
<blockquote><p>Evaluate to true if the <var>ch1</var> is less than <var>ch2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$char&lt;=</b><var> ch1 ch2<a name="index-g_t_0024char_003c_003d-460"></a></var><br>
<blockquote><p>Evaluate to true if the <var>ch1</var> is less than or equal to <var>ch2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$char&gt;</b><var> ch1 ch2<a name="index-g_t_0024char_003e-461"></a></var><br>
<blockquote><p>Evaluate to true if the <var>ch1</var> is greater than <var>ch2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$char&gt;=</b><var> ch1 ch2<a name="index-g_t_0024char_003e_003d-462"></a></var><br>
<blockquote><p>Evaluate to true if the <var>ch1</var> is greater than or equal to
<var>ch2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fixnum-&gt;char</b><var> fx<a name="index-g_t_0024fixnum_002d_003echar-463"></a></var><br>
<blockquote><p>Return a new character value whose code point equals <var>fx</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$char-&gt;fixnum</b><var> ch<a name="index-g_t_0024char_002d_003efixnum-464"></a></var><br>
<blockquote><p>Return a fixnum representing the code point of the operand. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-pairs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-structs">syslib structs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-chars">syslib chars</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">5.9 Low level pair operations</h3>

<p>The arguments <var>P</var> to these operations must be pairs.  The following
bindings are exported by the <code>(ikarus system $pairs)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$car</b><var> P<a name="index-g_t_0024car-465"></a></var><br>
<blockquote><p>Return the car of the operand. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$cdr</b><var> P<a name="index-g_t_0024cdr-466"></a></var><br>
<blockquote><p>Return the cdr of the operand. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$set-car!</b><var> P value<a name="index-g_t_0024set_002dcar_0021-467"></a></var><br>
<blockquote><p>Store <var>value</var> in the car location of <var>P</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$set-cdr!</b><var> P value<a name="index-g_t_0024set_002dcdr_0021-468"></a></var><br>
<blockquote><p>Store <var>value</var> in the cdr location of <var>P</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-structs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-vectors">syslib vectors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-pairs">syslib pairs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">5.10 Low level structure operations</h3>

<p>A data structure is a variable length block of memory allocated as a
vector; a reference to a structure value is a machine word tagged as
vector.  The first machine word of the structure is a reference to the
type descriptor; a type descriptor is itself a data structure.  A block
of memory is a data structure if and only if: a reference to it is
tagged as vector and its first word is tagged as vector.

<pre class="example">     |----------------|----------| reference to structure
       heap offset     vector tag
     
     |----------------|----------| first word of structure
       heap offset     vector tag    = reference to rtd
                                     = reference to structure
</pre>
   <p>The type descriptor of the type descriptors is the return value of
<code>base-rtd</code>.  <a href="#iklib-structs">iklib structs</a> for more informations on the
public interface of data structures.

   <p>The arguments <var>stru</var> to these operations must be references to data
structures, the arguments <var>rtd</var> must be references to structure type
descriptors, the arguments <var>fx</var> must be fixnums of appropriate
value.  The following bindings are exported by the <code>(ikarus
system $structs)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>base-rtd</b><var><a name="index-base_002drtd-469"></a></var><br>
<blockquote><p>Return a reference to the type descriptor used as type for all the type
descriptors. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$struct?</b><var> obj<a name="index-g_t_0024struct_003f-470"></a></var><br>
<blockquote><p>Evaluate to true if <var>obj</var> is the reference to a structure. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$struct/rtd?</b><var> stru rtd<a name="index-g_t_0024struct_002frtd_003f-471"></a></var><br>
<blockquote><p>Evaluate to true if <var>stru</var> is a structure of type <var>rtd</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$make-struct</b><var> rtd fx<a name="index-g_t_0024make_002dstruct-472"></a></var><br>
<blockquote><p>Allocate a new data structure of type <var>rtd</var> capable of holding
<var>fx</var> words and return a reference to it. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$struct-rtd</b><var> stru<a name="index-g_t_0024struct_002drtd-473"></a></var><br>
<blockquote><p>Return a reference to the type descriptor of <var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$struct-ref</b><var> stru fx<a name="index-g_t_0024struct_002dref-474"></a></var><br>
<blockquote><p>Return the value in the field at index <var>fx</var> of <var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$struct-set!</b><var> stru fx value<a name="index-g_t_0024struct_002dset_0021-475"></a></var><br>
<blockquote><p>Store <var>value</var> in the field at index <var>fx</var> of <var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$struct</b><var> rtd value ...<a name="index-g_t_0024struct-476"></a></var><br>
<blockquote><p>Allocate a new data structure of type <var>rtd</var> capable of holding as
many words as given <var>value</var> arguments and initialise the fields with
such values.  Return a reference to the structure. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-vectors"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-bytevectors">syslib bytevectors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-structs">syslib structs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">5.11 Low level vector operations</h3>

<p>Vectors are variable length blocks of memory referenced by machine words
tagged as vectors.  The first machine word of a vector block contains a
fixnum representing the vector length; a vector is capable of holding at
most a number of values equal to the return value of
<code>greatest-fixnum</code>.  This means that the first word of a vector is
tagged as a fixnum.

<pre class="example">     |------------------------|-------------| reference to vector
           heap offset          vector tag
     
     |------------------------|-------------| vector first word
          number of words       fixnum tag
</pre>
   <p>The arguments <var>vec</var> to these operations must be fixnums, the
arguments <var>fx</var> must be fixnums.  The following bindings are exported
by the <code>(ikarus system $vectors)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-vector</b><var> fx<a name="index-g_t_0024make_002dvector-477"></a></var><br>
<blockquote><p>Allocate and return a new vector value of <var>fx</var> elements. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$vector-length</b><var> vec<a name="index-g_t_0024vector_002dlength-478"></a></var><br>
<blockquote><p>Evaluate to a fixnum representing the numbe of values in <var>vec</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$vector-ref</b><var> vec fx<a name="index-g_t_0024vector_002dref-479"></a></var><br>
<blockquote><p>Return the value at index <var>fx</var> in <var>vec</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$vector-set!</b><var> vec fx value<a name="index-g_t_0024vector_002dset_0021-480"></a></var><br>
<blockquote><p>Store <var>value</var> at index <var>fx</var> in <var>vec</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-bytevectors"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-strings">syslib strings</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-vectors">syslib vectors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">5.12 Low level bytevector operations</h3>

<p>Bytevectors are blocks of memory referenced by machine words tagged as
bytevectors.  The first word in the memory block is a fixnum
representing the number of bytes in the data area; a bytevector is
capable of holding at most a number of values equal to the return value
of <code>greatest-fixnum</code>.

   <p>The arguments <var>bv</var> to these operations must be references to
bytevectors, the arguments <var>fx</var> must be fixnums in the appropriate
range, the arguments <var>fl</var> must be flonums.  The following bindings
are exported by the <code>(ikarus system $bytevectors)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-bytevector</b><var> fx<a name="index-g_t_0024make_002dbytevector-481"></a></var><br>
<blockquote><p>Allocate a new bytevector capable of holding <var>fx</var> bytes and return a
reference to it. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-length</b><var> bv<a name="index-g_t_0024bytevector_002dlength-482"></a></var><br>
<blockquote><p>Return a fixnum representing the number of bytes in the operand. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-u8-ref</b><var> bv fx<a name="index-g_t_0024bytevector_002du8_002dref-483"></a></var><br>
<blockquote><p>Return a fixnum representing the octet at offset <var>fx</var> in <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-s8-ref</b><var> bv fx<a name="index-g_t_0024bytevector_002ds8_002dref-484"></a></var><br>
<blockquote><p>Return a fixnum representing the byte at offset <var>fx</var> in <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-set!</b><var> bv fx-index fx-value<a name="index-g_t_0024bytevector_002dset_0021-485"></a></var><br>
<blockquote><p>Store the octet or byte <var>fx-value</var> at index <var>fx-index</var> of
<var>bv</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Double&ndash;precision <acronym>IEEE</acronym> flonums</h5>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-double-native-ref</b><var> bv fx<a name="index-g_t_0024bytevector_002dieee_002ddouble_002dnative_002dref-486"></a></var><br>
<blockquote><p>Return a flonum representing the value at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-double-native-set!</b><var> bv fx fl<a name="index-g_t_0024bytevector_002dieee_002ddouble_002dnative_002dset_0021-487"></a></var><br>
<blockquote><p>Store <var>fl</var> at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-double-nonnative-ref</b><var> bv fx<a name="index-g_t_0024bytevector_002dieee_002ddouble_002dnonnative_002dref-488"></a></var><br>
<blockquote><p>Return a flonum representing the value at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-double-nonnative-set!</b><var> bv fx fl<a name="index-g_t_0024bytevector_002dieee_002ddouble_002dnonnative_002dset_0021-489"></a></var><br>
<blockquote><p>Store <var>fl</var> at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Single&ndash;precision <acronym>IEEE</acronym> flonums</h5>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-single-native-ref</b><var> bv fx<a name="index-g_t_0024bytevector_002dieee_002dsingle_002dnative_002dref-490"></a></var><br>
<blockquote><p>Return a flonum representing the value at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-single-native-set!</b><var> bv fx fl<a name="index-g_t_0024bytevector_002dieee_002dsingle_002dnative_002dset_0021-491"></a></var><br>
<blockquote><p>Store <var>fl</var> at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-single-nonnative-ref</b><var> bv fx<a name="index-g_t_0024bytevector_002dieee_002dsingle_002dnonnative_002dref-492"></a></var><br>
<blockquote><p>Return a flonum representing the value at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-single-nonnative-set!</b><var> bv fx fl<a name="index-g_t_0024bytevector_002dieee_002dsingle_002dnonnative_002dset_0021-493"></a></var><br>
<blockquote><p>Store <var>fl</var> at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-strings"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-ports">syslib ports</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-bytevectors">syslib bytevectors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">5.13 Low level string operations</h3>

<p>Strings are blocks of memory referenced by machine words tagged as
strings.  The first word in the memory block is a fixnum representing
the number of characters in the data area; a string is capable of
holding at most a number of characters equal to the return value of
<code>greatest-fixnum</code>.

   <p>The arguments <var>str</var> to these operations must be references to
strings, the arguments <var>fx</var> must be fixnums in the appropriate
range, the arguments <var>ch</var> must be characters.  The following
bindings are exported by the <code>(ikarus system $strings)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-string</b><var> fx<a name="index-g_t_0024make_002dstring-494"></a></var><br>
<blockquote><p>Allocate a new string capable of holding <var>fx</var> characters and return
a reference to it. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$string-length</b><var> str<a name="index-g_t_0024string_002dlength-495"></a></var><br>
<blockquote><p>Return a fixnum representing the length of the operand. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$string-ref</b><var> str fx<a name="index-g_t_0024string_002dref-496"></a></var><br>
<blockquote><p>Return the character at offset <var>fx</var> in <var>str</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$string-set!</b><var> str fx ch<a name="index-g_t_0024string_002dset_0021-497"></a></var><br>
<blockquote><p>Store <var>ch</var> at index <var>fx</var> of <var>str</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-ports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-transcoders">syslib transcoders</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-strings">syslib strings</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">5.14 Low level port structures</h3>

<p>A port value is a block of memory allocated as a vector; a reference to
a port value is a reference to a vector.  The first word of the vector
is the bitwise OR between a port tag and a bitvector of port attributes.

<pre class="example">     |----------------|----------| port value
       heap offset     vector tag
     
     |----------------|----------| 1st word of port's memory block
      port attributes   port tag
</pre>
   <p>At present the port tag is 6 bits wide, so we have: on 32 bits
platforms: 32 - 6 = 24 bits available for attributes; on 64 bits
platforms: 64 - 6 = 58 bits available for attributes.

   <p>See the source code for a more comprehensive documentation.

   <p>The following bindings are exported by the <code>(ikarus system $io)</code>
library.

<div class="defun">
&mdash; Function: <b>port?</b><var> obj<a name="index-port_003f-498"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is the reference to a port structure; return
false otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$make-port</b><var> attrs idx sz buf tr id read write getp setp cl cookie<a name="index-g_t_0024make_002dport-499"></a></var><br>
<blockquote><p>Allocate a new port structure, initialise its fields with the arguments,
return a reference to it. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$port-index</b><var> port<a name="index-g_t_0024port_002dindex-500"></a></var><br>
&mdash; Unsafe Operation: <b>$port-size</b><var> port<a name="index-g_t_0024port_002dsize-501"></a></var><br>
&mdash; Unsafe Operation: <b>$port-buffer</b><var> port<a name="index-g_t_0024port_002dbuffer-502"></a></var><br>
&mdash; Unsafe Operation: <b>$port-transcoder</b><var> port<a name="index-g_t_0024port_002dtranscoder-503"></a></var><br>
&mdash; Unsafe Operation: <b>$port-id</b><var> port<a name="index-g_t_0024port_002did-504"></a></var><br>
&mdash; Unsafe Operation: <b>$port-read!</b><var> port<a name="index-g_t_0024port_002dread_0021-505"></a></var><br>
&mdash; Unsafe Operation: <b>$port-write!</b><var> port<a name="index-g_t_0024port_002dwrite_0021-506"></a></var><br>
&mdash; Unsafe Operation: <b>$port-get-position</b><var> port<a name="index-g_t_0024port_002dget_002dposition-507"></a></var><br>
&mdash; Unsafe Operation: <b>$port-set-position!</b><var> port<a name="index-g_t_0024port_002dset_002dposition_0021-508"></a></var><br>
&mdash; Unsafe Operation: <b>$port-close</b><var> port<a name="index-g_t_0024port_002dclose-509"></a></var><br>
&mdash; Unsafe Operation: <b>$port-cookie</b><var> port<a name="index-g_t_0024port_002dcookie-510"></a></var><br>
<blockquote><p>Accessors for the fields of a port structure. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$port-attrs</b><var> port<a name="index-g_t_0024port_002dattrs-511"></a></var><br>
<blockquote><p>Given a port value: return a fixnum representing the port attributes. 
</p></blockquote></div>

<div class="defun">
&mdash; Safe Operation: <b>$port-tag</b><var> port<a name="index-g_t_0024port_002dtag-512"></a></var><br>
<blockquote><p>Extract from a port reference a fixnum representing the port attributes;
if the argument is not a port reference the return value is zero. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$set-port-index!</b><var> port new-index<a name="index-g_t_0024set_002dport_002dindex_0021-513"></a></var><br>
<blockquote><p>Mutator for the buffer index field. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$set-port-size!</b><var> port new-used-size<a name="index-g_t_0024set_002dport_002dsize_0021-514"></a></var><br>
<blockquote><p>Mutator for the buffer used size field. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$set-port-attrs!</b><var> port new-attrs<a name="index-g_t_0024set_002dport_002dattrs_0021-515"></a></var><br>
<blockquote><p>Mutator for the port attributes. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-transcoders"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-ports">syslib ports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">5.15 Low level transcoder operations</h3>

<p>A transcoder is a machine word tagged to make it of a disjoint type. 
The transcoder data (codec, <acronym>EOL</acronym> style, error handling) is encoded in
the most significant bits of this word.

<pre class="example">     |---------------------------|------------| transcoder
            payload bits          transcoder-tag
</pre>
   <p>The arguments <var>tran</var> to these operations must be transcoders, the
arguments <var>fx</var> must be fixnums in the appropriate range.  The
following bindings are exported by the <code>(ikarus system
$transcoders)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$data-&gt;transcoder</b><var> fx<a name="index-g_t_0024data_002d_003etranscoder-516"></a></var><br>
<blockquote><p>Encode <var>fx</var> as payload bits of a transcoder word and return the
resulting transcoder. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$transcoder-&gt;data</b><var> tran<a name="index-g_t_0024transcoder_002d_003edata-517"></a></var><br>
<blockquote><p>Extract the payload bits from a transcoder and return them as fixnum. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-int"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#debug-int">debug int</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib">syslib</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">6 Internals: builtin objects</h2>

<ul class="menu">
<li><a accesskey="1" href="#objects-int-intro">objects int intro</a>:            Introduction to buitin objects. 
<li><a accesskey="2" href="#objects-int-refs">objects int refs</a>:             Builtin object references. 
<li><a accesskey="3" href="#objects-int-const">objects int const</a>:            Constant values. 
<li><a accesskey="4" href="#objects-int-alloc">objects int alloc</a>:            Allocating memory for builtin
                                objects. 
<li><a accesskey="5" href="#objects-int-fixnum">objects int fixnum</a>:           Fixnum objects. 
<li><a accesskey="6" href="#objects-int-bytevector">objects int bytevector</a>:       Bytevector objects. 
<li><a accesskey="7" href="#objects-int-vector">objects int vector</a>:           Vector objects. 
</ul>

<!-- page -->
<div class="node">
<a name="objects-int-intro"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-int-refs">objects int refs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects-int">objects int</a>

</div>

<h3 class="section">6.1 Introduction to buitin objects</h3>

<p>Builtin objects are implemented in the C language portion of the source
code; the overall definitions are in <samp><span class="file">src/ikarus-data.h</span></samp>.

<!-- page -->
<div class="node">
<a name="objects-int-refs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-int-const">objects int const</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-int-intro">objects int intro</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects-int">objects int</a>

</div>

<h3 class="section">6.2 Builtin object references</h3>

<div class="defun">
&mdash; Object Reference: <b>ikptr</b><var><a name="index-ikptr-518"></a></var><br>
<blockquote><p>In general, it is a reference to a builtin object, implemented as an
<code>unsigned long int</code>; it can be:

          <ul>
<li>A tagged pointer referencing a memory block holding a builtin object;
the pointer is aligned in such a way that the 3 least significant
bits are set to zero, the tag is stored in those 3 bits.

          <li>An embedded fixnum, in which case the 2 least significant bits
are set to zero; the fixnum can be extracted with the <code>fix</code> macro.

          <li>An embedded constant value, in which case all the 3 least
significant bits are set to one. 
</ul>

        <p>The definition assumes that:

          <ul>
<li>On 32 bits platforms, <code>unsigned long int</code> is a 32 bits value.

          <li>On 64 bits platforms, <code>unsigned long int</code> is a 64 bits value.

          <li>The type <code>unsigned long int</code> is big enough to hold a pointer for
the underlying platform. 
</ul>

        <p>If an <code>ikptr</code> value is neither a fixnum nor a constant value, the
3 least significant bits of an <code>ikptr</code> represent the &ldquo;tag&rdquo;
of the referenced object's type.

        <p>Notice that the type definition of <code>ikptr</code> is <strong>not</strong> a
pointer; this means that when storing a pointer into an <code>ikptr</code> and
then adding offsets to it, the offset is in bytes:

     <pre class="example">          uint8_t *p = ...;
          ikptr    q = (ikptr)p;
          
          void *   r = (void *)(p + 3);  /* pointer to the 4th byte */
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Macro: <b>tagof</b> (<var>ref</var>)<var><a name="index-tagof-519"></a></var><br>
<blockquote><p>Extract the 3 least significant bits of an <code>ikptr</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>ref</b> (<var>ptr, offset</var>)<var><a name="index-ref-520"></a></var><br>
<blockquote><p>Expand to the word at <var>offset</var> past <var>ptr</var>; it can be used either
as operand or as left&ndash;side of an assignment.  The &ldquo;word&rdquo; is the
unsigned integer type used in the type definition of <code>ikptr</code>;
<var>ptr</var> can be a pointer of any type: it is cast to a &ldquo;pointer to
words&rdquo;.  Example:

     <pre class="example">          char *   p = ...;
          ikptr    q;
          
          ref(p, 1) = 123L;       /* store the value in the first
                                     word of the array */
          
          q = ref(p, 3);          /* retrieve the third word in
                                     the array */
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-int-const"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-int-alloc">objects int alloc</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-int-refs">objects int refs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects-int">objects int</a>

</div>

<h3 class="section">6.3 Constant values</h3>

<div class="defun">
&mdash; Macro: <b>false_object</b><var><a name="index-false_005fobject-521"></a></var><br>
<blockquote><p>An <code>ikptr</code> value representing <code>#f</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>true_object</b><var><a name="index-true_005fobject-522"></a></var><br>
<blockquote><p>An <code>ikptr</code> value representing <code>#t</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>null_object</b><var><a name="index-null_005fobject-523"></a></var><br>
<blockquote><p>An <code>ikptr</code> value representing null (the empty list). 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>void_object</b><var><a name="index-void_005fobject-524"></a></var><br>
<blockquote><p>An <code>ikptr</code> value representing <code>#&lt;void&gt;</code>, the return value of
functions returning no value. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-int-alloc"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-int-fixnum">objects int fixnum</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-int-const">objects int const</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects-int">objects int</a>

</div>

<h3 class="section">6.4 Allocating memory for builtin objects</h3>

<p>In short, memory allocation is performed as follows:

<pre class="example">     ikpcb     pcb = ...;
     long int  number_of_bytes = ...;
     ikptr     p = ik_safe_alloc(pcb, align(number_of_bytes));
</pre>
   <p class="noindent">where <code>pcb</code> is the pointer to a data structure describing the
memory heap.  Memory blocks, subject to garbage collection, are
allocated on the heap, a contiguous region of memory:

<pre class="example">         allocated  allocated      allocated
         block      block          block
     ...|----------|--------------|--------|------...
         ^          ^              ^        ^
         |          |              |        |
       pointer    pointer        pointer   pointer to
                                           next block
</pre>
   <p class="noindent">every pointer must satisfy alignment constraints with the following
purposes:

     <ol type=1 start=1>
<li>To make pointer indirection efficient on the underlying platform.

     <li>To have pointer values with the 3 least significant bits set to
zero.
        </ol>

<p class="noindent">for this reason we must always filter the requested size (in bytes)
through the <code>align</code> macro.  The <code>pcb</code> always references a
&ldquo;pointer to the next free block&rdquo; with alignment constraints satisfied;
if we filter the requested number of bytes through <code>align</code>, we
obtain a number of bytes which, added to the pointer, gives a correctly
aligned pointer:

<pre class="example">     uint8_t * allocated_block = (uint8_t *)pcb-&gt;allocation_pointer;
     long int  requested_size  = ...;
     long int  aligned_size    = align(requested_size);
     uint8_t * next_free_block = allocated_block + aligned_size;
     pcb-&gt;allocation_pointer   = (ikptr)next_free_block;
     
     /* use "allocated_block" */
     
     
                 requested size
            |.......................|
                 aligned size
            |..........................|
     ...----|--------------------------|-----------....
             ^                          ^
             |                          |
           pointer to an              pointer to the
           allocated block            next block
</pre>
   <div class="defun">
&mdash; Macro: <b>align</b> (<var>number_of_bytes</var>)<var><a name="index-align-525"></a></var><br>
<blockquote><p>Convert <var>number_of_bytes</var>, which must be an integer of type
<code>long int</code>, to the number of bytes requested to satisfy pointer
alignment constraints.  We can simulate the computation with:

     <pre class="example">          (import (ikarus))
          
          (define sizeof-ikptr
            (make-parameter #f))
          
          (define (align n)
            (let* ((wordsize      (sizeof-ikptr))
                   (wordshift     (if (= wordsize 4) 2 3))
                   (align_shift   (+ 1 wordshift))
                   (align_size    (* 2 wordsize))
                   (&lt;&lt;            bitwise-arithmetic-shift-left)
                   (&gt;&gt;            bitwise-arithmetic-shift-right))
              (&lt;&lt; (&gt;&gt; (- (+ n align_size) 1)
                      align_shift)
                  align_shift)))
          
          (define (print-align n)
            (let ((m (align n))
                  (base-pointer (expt 2 (- (* 8 (sizeof-ikptr)) 1))))
              (display n)
              (display " -&gt; ")
              (display m)
              (display "\t")
              (display (number-&gt;string base-pointer 2))
              (display " -&gt; ")
              (display (number-&gt;string (+ base-pointer m) 2))
              (newline)))
          
          (parameterize ((sizeof-ikptr 4)) ; 32 bits platform
            (print-align 12)
            (print-align 17)
            (print-align 1234))
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ik_safe_alloc</b> (<var>ikpcb * pcb, int aligned_size</var>)<var><a name="index-ik_005fsafe_005falloc-526"></a></var><br>
<blockquote><p>Allocate a memory block on the heap and return a reference to it as an
untagged pointer.  <var>pcb</var> must reference the heap, <var>aligned_size</var>
must be the requested number of bytes filtered through <code>align</code>.

        <p>If not enough memory is available on the heap, a garbage collection is
triggered; then allocation is tried again: if it still fails the process
is terminated with exit status <code>-1</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-int-fixnum"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-int-bytevector">objects int bytevector</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-int-alloc">objects int alloc</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects-int">objects int</a>

</div>

<h3 class="section">6.5 Fixnum objects</h3>

<p>Fixnums are &ldquo;small&rdquo; exact integers.  In Vicare's jargon, &ldquo;word size&rdquo;
is the number of bytes in an <code>ikptr</code>; if the word size is 4,
30 bits are used for fixnum representation, else the number of
bits used is the number of bits in a word minus 3:

<pre class="example">     #define wordsize ((int)(sizeof(ikptr)))
     #define wordshift ((wordsize == 4)?2:3)
</pre>
   <p>Let's say <code>ikptr</code> is a 32 bits value, which means the word
size is 4 bytes; then the representation of a fixnum is:

<pre class="example">        30 bits fixnum representation
     |.................................|00
     
     |--------|--------|--------|------+--|
       byte3    byte2    byte1    byte0
</pre>
   <p class="noindent">the two least significant bits are set to zero: this &ldquo;tags&rdquo; the
<code>ikptr</code> which embed fixnums.

<div class="defun">
&mdash; Macro: <b>fix</b> (<var>num</var>)<var><a name="index-fix-527"></a></var><br>
<blockquote><p>Convert a small exact integer in the correct range for a fixnum, into a
<code>ikptr</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>unfix</b> (<var>ref</var>)<var><a name="index-unfix-528"></a></var><br>
<blockquote><p>Convert an <code>ikptr</code> value holding a fixnum into a fixnum of type
<code>long int</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>is_fixnum</b> (<var>ref</var>)<var><a name="index-is_005ffixnum-529"></a></var><br>
<blockquote><p>Expand to true if <var>ref</var> is an <code>ikptr</code> embedding a fixnum.  It
just tests if the least significant bits in the tag are set to zero. 
</p></blockquote></div>

   <p>Examples:

<pre class="example">     long int  n = 123L;
     ikptr     p = fix(n);
     long int  m = unfix(p);
</pre>
   <!-- page -->
<div class="node">
<a name="objects-int-bytevector"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-int-vector">objects int vector</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-int-fixnum">objects int fixnum</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects-int">objects int</a>

</div>

<h3 class="section">6.6 Bytevector objects</h3>

<p>Bytevector objects are allocated on the heap; there is no function to
allocate a bytevector, we have to call <code>ik_safe_alloc()</code> explicitly;
to perform the allocation we compute the whole size of the bytevector
data area, add to it room for meta data and finally compute the aligned
block size:

<pre class="example">     ikpcb     pcb = ...;
     long int  requested_size = ...;
     long int  block_size     = disp_bytevector_data + requested_size;
     lont int  aligned_size   = align(block_size);
     ikptr     bv = ik_safe_alloc(pcb, aligned_size) + bytevector_tag;
</pre>
   <p class="noindent"><code>ik_safe_alloc()</code> returns an <code>ikptr</code> value representing the
aligned pointer, having the 3 least significant bits set to zero;
we add to it the bytevector tag (an integer value fitting in 3
bits) which allows to recognise bytevectors among all the other builtin
objects.

   <p>We have to explicitly store the bytevector length in the memory block as
a fixnum, so usually a full allocation looks like this:

<pre class="example">     ikpcb     pcb;
     long int  size;
     ikptr     bv;
     uint8_t * data_area;
     
     pcb  = ...;
     size = ...;
     bv   = ik_safe_alloc(pcb, align(disp_bytevector_data+size))
            + bytevector_tag;
     
     ref(bv, off_bytevector_length) = fix(size);
     data_area = bv + off_bytevector_data;
</pre>
   <div class="defun">
&mdash; Macro: <b>bytevector_tag</b><var><a name="index-bytevector_005ftag-530"></a></var><br>
<blockquote><p>An integer used to tag pointers to bytevector memory blocks. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>disp_bytevector_length</b><var><a name="index-disp_005fbytevector_005flength-531"></a></var><br>
<blockquote><p>Displacement of length.  The number of bytes to add to an untagged
pointer to bytevector to get the pointer to the first byte in the word
holding the bytevector length as fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>disp_bytevector_data</b><var><a name="index-disp_005fbytevector_005fdata-532"></a></var><br>
<blockquote><p>Displacement of data area.  The number of bytes to add to an untagged
pointer to bytevector to get the pointer to the first byte in the data
area. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>off_bytevector_length</b><var><a name="index-off_005fbytevector_005flength-533"></a></var><br>
<blockquote><p>An integer to add to a tagged bytevector reference (<code>ikptr</code>) to
retrieve the pointer to the first byte of the bytevector length.  The
bytevector length is a fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>off_bytevector_data</b><var><a name="index-off_005fbytevector_005fdata-534"></a></var><br>
<blockquote><p>An integer to add to a tagged bytevector reference (<code>ikptr</code>) to
retrieve the pointer to the first byte of the bytevector length.  The
bytevector length is a fixnum.

        <p>Notice that on both 32 bits and 64 bits platforms: the
first byte of the data area is at the same offset from the first byte of
the bytevector memory block. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-int-vector"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-int-bytevector">objects int bytevector</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects-int">objects int</a>

</div>

<h3 class="section">6.7 Vector objects</h3>

<p>Vector objects are allocated on the heap; the function
<code>ikrt_make_vector1()</code> can allocate a vector, but we can also call
<code>ik_safe_alloc()</code> explicitly; to perform the allocation we compute
the whole size of the vector data area, add to it room for meta data and
finally compute the aligned block size:

<pre class="example">     ikpcb     pcb = ...;
     long int  number_of_elements = ...;
     long int  requested_size = sizeof(ikptr) * number_of_elements;
     long int  block_size     = disp_vector_data + requested_size;
     lont int  aligned_size   = align(block_size);
     ikptr     vec = ik_safe_alloc(pcb, aligned_size) + vector_tag;
</pre>
   <p class="noindent"><code>ik_safe_alloc()</code> returns an <code>ikptr</code> value representing the
aligned pointer, having the 3 least significant bits set to zero;
we add to it the vector tag (an integer value fitting in 3 bits)
which allows to recognise vectors among all the other builtin objects.

   <p>We have to explicitly store the vector length in the memory block as a
fixnum, so usually a full allocation looks like this:

<pre class="example">     ikpcb     pcb;
     long int  size;
     ikptr     bv;
     uint8_t * data_area;
     
     pcb  = ...;
     size = ...;
     bv   = ik_safe_alloc(pcb, align(disp_vector_data+size))
            + vector_tag;
     
     ref(bv, off_vector_length) = fix(size);
     data_area = bv + off_vector_data;
</pre>
   <div class="defun">
&mdash; Macro: <b>vector_tag</b><var><a name="index-vector_005ftag-535"></a></var><br>
<blockquote><p>An integer used to tag pointers to vector memory blocks. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>disp_vector_length</b><var><a name="index-disp_005fvector_005flength-536"></a></var><br>
<blockquote><p>Displacement of length.  The number of bytes to add to an untagged
pointer to vector to get the pointer to the first byte in the word
holding the vector length as fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>disp_vector_data</b><var><a name="index-disp_005fvector_005fdata-537"></a></var><br>
<blockquote><p>Displacement of data area.  The number of bytes to add to an untagged
pointer to vector to get the pointer to the first byte in the data area. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>off_vector_length</b><var><a name="index-off_005fvector_005flength-538"></a></var><br>
<blockquote><p>An integer to add to a tagged vector reference (<code>ikptr</code>) to
retrieve the pointer to the first byte of the vector length.  The
vector length is a fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>off_vector_data</b><var><a name="index-off_005fvector_005fdata-539"></a></var><br>
<blockquote><p>An integer to add to a tagged vector reference (<code>ikptr</code>) to
retrieve the pointer to the first byte of the vector length.  The
vector length is a fixnum.

        <p>Notice that on both 32 bits and 64 bits platforms: the
first byte of the data area is at the same offset from the first byte of
the vector memory block. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="debug-int"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#compiler">compiler</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-int">objects int</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">7 Internals: debug mode</h2>

<ul class="menu">
<li><a accesskey="1" href="#debug-int-intro">debug int intro</a>:              Introduction to debug mode. 
</ul>

<!-- page -->
<div class="node">
<a name="debug-int-intro"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#debug-int">debug int</a>

</div>

<h3 class="section">7.1 Introduction to debug mode</h3>

<p>Debug mode is driven with the following options:

     <dl>
<dt><samp><span class="option">-d</span></samp><dt><samp><span class="option">--debug</span></samp><dd>Turn on debugging mode.  The parameter <code>generate-debug-calls</code> is
set to true.

     <br><dt><samp><span class="option">-nd</span></samp><dt><samp><span class="option">--no-debug</span></samp><dd>Turn off debugging mode.  The parameter <code>generate-debug-calls</code> is
set to false. 
</dl>

   <p>The implementation is mostly in <samp><span class="file">ikarus.debugger.ss</span></samp> and
<samp><span class="file">ikarus.compiler.ss</span></samp>.

<div class="defun">
&mdash; Parameter: <b>generate-debug-calls</b><var><a name="index-generate_002ddebug_002dcalls-540"></a></var><br>
<blockquote><p>Set to true when debug mode is turned on.  Defined in
<samp><span class="file">ikarus.compiler.ss</span></samp>, configured in <samp><span class="file">ikarus.main.ss</span></samp>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>guarded-start</b><var> proc<a name="index-guarded_002dstart-541"></a></var><br>
<blockquote><p>Evaluate the procedure <var>proc</var> under the debugging infrastructure. 
It is used in the <code>(ikarus main)</code> library (<samp><span class="file">ikarus.main.ss</span></samp>)
to start the execution of a program and all the other execution modes.

        <p><var>proc</var> is evaluated under the installation of an exception handler
displaying the stack trace and offering the continuation alternatives. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="compiler"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#missing">missing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#debug-int">debug int</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">8 Wild notes on the compiler internals</h2>

<blockquote>
This chapter is a collection of notes on the internals of the compiler;
there is guarantee of neither their correctness nor their completeness,
because the original compiler code is fully undocumented. 
</blockquote>

<ul class="menu">
<li><a accesskey="1" href="#compiler-intro">compiler intro</a>:               Introduction to the compiler. 
<li><a accesskey="2" href="#compiler-conventions">compiler conventions</a>:         Coding conventions in the compiler
                                code. 
<li><a accesskey="3" href="#compiler-cogen">compiler cogen</a>:               Stuff in <samp><span class="file">ikarus.compiler.altcogen.ss</span></samp>. 
</ul>

<!-- page -->
<div class="node">
<a name="compiler-intro"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#compiler-conventions">compiler conventions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#compiler">compiler</a>

</div>

<h3 class="section">8.1 Introduction to the compiler</h3>

<p>Vicare Scheme's compiler supports only the Intel architecture.  The
compiler is coded in the following files

     <dl>
<dt><samp><span class="file">ikarus.compiler.altcogen.ss</span></samp><dd>Generate assembly code in S&ndash;expression format. 
</dl>

   <p>How do we generate assembly code?  First we need to generate a single
line of assembly code; this is done by <code>make-asm-instr</code> which
accepts as first argument a Scheme symbol representing the instruction,
for example: &lsquo;<samp><span class="samp">move</span></samp>&rsquo;, &lsquo;<samp><span class="samp">idiv</span></samp>&rsquo;, &lsquo;<samp><span class="samp">int+</span></samp>&rsquo;.

   <p>Then we need to generate blocks of assembly instructions: sequences of
instructions which must be executed in order.  There are two types of
blocks: the ones which at the end generate a value to be stored in a
location (register or memory), the ones which perform some operation but
do not generate a value.  The first kind are blocks which &ldquo;impose a
value&rdquo;, the second kind are the &ldquo;side effects&rdquo;.

<!-- page -->
<div class="node">
<a name="compiler-conventions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#compiler-cogen">compiler cogen</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#compiler-intro">compiler intro</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#compiler">compiler</a>

</div>

<h3 class="section">8.2 Coding conventions in the compiler code</h3>

<p>Throughout the compiler code variables with the following names appear:

     <dl>
<dt><var>op</var><dd>Scheme symbol representing an <strong>operation</strong> to be directly
translated into assembly.  Examples: &lsquo;<samp><span class="samp">alloc</span></samp>&rsquo;, &lsquo;<samp><span class="samp">mref</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">mref32</span></samp>&rsquo;, &lsquo;<samp><span class="samp">bref</span></samp>&rsquo;, &lsquo;<samp><span class="samp">logand</span></samp>&rsquo;, &lsquo;<samp><span class="samp">logxor</span></samp>&rsquo;, &lsquo;<samp><span class="samp">logor</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">int+</span></samp>&rsquo;, &lsquo;<samp><span class="samp">int-</span></samp>&rsquo;, &lsquo;<samp><span class="samp">int*</span></samp>&rsquo;, &lsquo;<samp><span class="samp">int-quotient</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">int-remainder</span></samp>&rsquo;, &lsquo;<samp><span class="samp">sll</span></samp>&rsquo;, &lsquo;<samp><span class="samp">sra</span></samp>&rsquo;.

     <br><dt><var>rator</var><dd>Represents a reference to an <strong>operator</strong>: a function coded in
assembly or C language.

     <br><dt><var>rands</var><dd>Scheme list holding the <strong>operands</strong> to which an operation must be
applied.  These operands are in such a format that can be directly used
in the assembly S&ndash;expression like:

     <pre class="example">          (make-set eax (car rands))
</pre>
     <p class="noindent">which generate an assignment operation to store the first element of
<var>rands</var> into the <code>eax</code> processor register. 
</dl>

<!-- page -->
<div class="node">
<a name="compiler-cogen"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#compiler-conventions">compiler conventions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#compiler">compiler</a>

</div>

<h3 class="section">8.3 Stuff in <samp><span class="file">ikarus.compiler.altcogen.ss</span></samp></h3>

<!-- page -->
<div class="node">
<a name="missing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#building">building</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#compiler">compiler</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix A Missing Features</h2>

<p>Vicare does not fully conform to <acronym>R6RS</acronym> yet.  Although it implements
most of <acronym>R6RS</acronym>'s macros and procedures, some are still missing.  This
appendix summarizes the set of missing features and procedures.

     <ul>
<li>The procedure <code>equal?</code> may not terminate on infinite (circular)
input, when the input is <code>equal?</code>.

     <li><code>number-&gt;string</code> does not accept the third argument (precision). 
Similarly, <code>string-&gt;number</code> and the reader do not recognize the
<code>|p</code> notation.

     <li>The following procedures are missing from <code>(rnrs arithmetic
bitwise)</code>:

     <pre class="example">          bitwise-reverse-bit-field               bitwise-rotate-bit-field
</pre>
     <li>The following procedures are missing from <code>(rnrs arithmetic
fixnum)</code>:

     <pre class="example">          fxrotate-bit-field
</pre>
     <li>The following procedures are missing from <code>(rnrs hashtables)</code>:

     <pre class="example">          make-eqv-hashtable                      equal-hash
</pre>
     <li>The following procedures are missing from <code>(rnrs io ports)</code>:

     <pre class="example">          port-has-port-position?                 port-position
          port-has-set-port-position!?            set-port-position!
          make-custom-binary-input/output-port
          make-custom-textual-input/output-port
          open-file-input/output-port
</pre>
     </ul>

<!-- page -->
<div class="node">
<a name="building"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#credits">credits</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#missing">missing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix B Building infrastructure</h2>

<p>This appendix contains instructions on how to use and modify the
building infrastructure of Vicare Scheme.  The source of the package
is manage by a Git repository, so some bits of the infrastructure depend
on Git.

<ul class="menu">
<li><a accesskey="1" href="#building-revision">building revision</a>:            Package revision in the banner. 
</ul>

<!-- page -->
<div class="node">
<a name="building-revision"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#building">building</a>

</div>

<h3 class="appendixsec">B.1 Package revision in the banner</h3>

<p>When running <samp><span class="command">vicare</span></samp> in a terminal, it prints a banner
showing the revision number:

<pre class="smallexample">     $ vicare
     Vicare Scheme version 0.1d0+ \
       (revision master/21da24720f161708372756e1324c230bd5ff6ac9, \
        build 2010-05-01)
     Copyright (c) 2006-2010 Abdulaziz Ghuloum
</pre>
   <p>The revision specification shows the branch name and the commit hash;
they are read from the file <samp><span class="file">./scheme/last-revision</span></samp>, which is
generated by the following chunk of code in the
<samp><span class="file">.git/hooks/post-commit</span></samp> script:

<pre class="smallexample">     LAST_REVISION_FILE=./scheme/last-revision
     BRANCH_NAME=$(git branch 2&gt;/dev/null | \
                     sed -e '/^[^*]/d' -e 's/^* //')
     COMMIT_HASH=$(git show | head -1 | cut -d' ' -f2)
     echo "$BRANCH_NAME/$COMMIT_HASH" &gt;$LAST_REVISION_FILE
</pre>
   <!-- page -->
<div class="node">
<a name="credits"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#package-license">package license</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#building">building</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix C Credits for this document</h2>

<p>The skeleton of this document is the original &ldquo;Ikarus User's Guide&rdquo; in
XeLaTeX format, by Abdulaziz Ghulom.  That document is available in the
Ikarus distribution and is covered by the <acronym>GNU</acronym> General Public License
version 3 as published by the Free Software Foundation.  It is available
at the following <acronym>URL</acronym>s:

<div align="center"><a href="http://www.cs.indiana.edu/~aghuloum/ikarus/">http://www.cs.indiana.edu/~aghuloum/ikarus/</a></div>
<div align="center"><a href="https://launchpad.net/ikarus">https://launchpad.net/ikarus</a></div>

<!-- page -->
<div class="node">
<a name="package-license"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#references">references</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#credits">credits</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix D <acronym>GNU</acronym> General Public License</h2>

<!-- The GNU General Public License. -->
<div align="center">Version 3, 29 June 2007</div>

<pre class="display">     Copyright &copy; 2007 Free Software Foundation, Inc. <a href="http://fsf.org/">http://fsf.org/</a>
     
     Everyone is permitted to copy and distribute verbatim copies of this
     license document, but changing it is not allowed.
</pre>
   <h3 class="heading">Preamble</h3>

<p>The GNU General Public License is a free, copyleft license for
software and other kinds of works.

   <p>The licenses for most software and other practical works are designed
to take away your freedom to share and change the works.  By contrast,
the GNU General Public License is intended to guarantee your freedom
to share and change all versions of a program&mdash;to make sure it remains
free software for all its users.  We, the Free Software Foundation,
use the GNU General Public License for most of our software; it
applies also to any other work released this way by its authors.  You
can apply it to your programs, too.

   <p>When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
them if you wish), that you receive source code or can get it if you
want it, that you can change the software or use pieces of it in new
free programs, and that you know you can do these things.

   <p>To protect your rights, we need to prevent others from denying you
these rights or asking you to surrender the rights.  Therefore, you
have certain responsibilities if you distribute copies of the
software, or if you modify it: responsibilities to respect the freedom
of others.

   <p>For example, if you distribute copies of such a program, whether
gratis or for a fee, you must pass on to the recipients the same
freedoms that you received.  You must make sure that they, too,
receive or can get the source code.  And you must show them these
terms so they know their rights.

   <p>Developers that use the GNU GPL protect your rights with two steps:
(1) assert copyright on the software, and (2) offer you this License
giving you legal permission to copy, distribute and/or modify it.

   <p>For the developers' and authors' protection, the GPL clearly explains
that there is no warranty for this free software.  For both users' and
authors' sake, the GPL requires that modified versions be marked as
changed, so that their problems will not be attributed erroneously to
authors of previous versions.

   <p>Some devices are designed to deny users access to install or run
modified versions of the software inside them, although the
manufacturer can do so.  This is fundamentally incompatible with the
aim of protecting users' freedom to change the software.  The
systematic pattern of such abuse occurs in the area of products for
individuals to use, which is precisely where it is most unacceptable. 
Therefore, we have designed this version of the GPL to prohibit the
practice for those products.  If such problems arise substantially in
other domains, we stand ready to extend this provision to those
domains in future versions of the GPL, as needed to protect the
freedom of users.

   <p>Finally, every program is threatened constantly by software patents. 
States should not allow patents to restrict development and use of
software on general-purpose computers, but in those that do, we wish
to avoid the special danger that patents applied to a free program
could make it effectively proprietary.  To prevent this, the GPL
assures that patents cannot be used to render the program non-free.

   <p>The precise terms and conditions for copying, distribution and
modification follow.

<h3 class="heading">TERMS AND CONDITIONS</h3>

     <ol type=1 start=0>
<li>Definitions.

     <p>&ldquo;This License&rdquo; refers to version 3 of the GNU General Public License.

     <p>&ldquo;Copyright&rdquo; also means copyright-like laws that apply to other kinds
of works, such as semiconductor masks.

     <p>&ldquo;The Program&rdquo; refers to any copyrightable work licensed under this
License.  Each licensee is addressed as &ldquo;you&rdquo;.  &ldquo;Licensees&rdquo; and
&ldquo;recipients&rdquo; may be individuals or organizations.

     <p>To &ldquo;modify&rdquo; a work means to copy from or adapt all or part of the work
in a fashion requiring copyright permission, other than the making of
an exact copy.  The resulting work is called a &ldquo;modified version&rdquo; of
the earlier work or a work &ldquo;based on&rdquo; the earlier work.

     <p>A &ldquo;covered work&rdquo; means either the unmodified Program or a work based
on the Program.

     <p>To &ldquo;propagate&rdquo; a work means to do anything with it that, without
permission, would make you directly or secondarily liable for
infringement under applicable copyright law, except executing it on a
computer or modifying a private copy.  Propagation includes copying,
distribution (with or without modification), making available to the
public, and in some countries other activities as well.

     <p>To &ldquo;convey&rdquo; a work means any kind of propagation that enables other
parties to make or receive copies.  Mere interaction with a user
through a computer network, with no transfer of a copy, is not
conveying.

     <p>An interactive user interface displays &ldquo;Appropriate Legal Notices&rdquo; to
the extent that it includes a convenient and prominently visible
feature that (1) displays an appropriate copyright notice, and (2)
tells the user that there is no warranty for the work (except to the
extent that warranties are provided), that licensees may convey the
work under this License, and how to view a copy of this License.  If
the interface presents a list of user commands or options, such as a
menu, a prominent <li>in the list meets this criterion.

     <li>Source Code.

     <p>The &ldquo;source code&rdquo; for a work means the preferred form of the work for
making modifications to it.  &ldquo;Object code&rdquo; means any non-source form
of a work.

     <p>A &ldquo;Standard Interface&rdquo; means an interface that either is an official
standard defined by a recognized standards body, or, in the case of
interfaces specified for a particular programming language, one that
is widely used among developers working in that language.

     <p>The &ldquo;System Libraries&rdquo; of an executable work include anything, other
than the work as a whole, that (a) is included in the normal form of
packaging a Major Component, but which is not part of that Major
Component, and (b) serves only to enable use of the work with that
Major Component, or to implement a Standard Interface for which an
implementation is available to the public in source code form.  A
&ldquo;Major Component&rdquo;, in this context, means a major essential component
(kernel, window system, and so on) of the specific operating system
(if any) on which the executable work runs, or a compiler used to
produce the work, or an object code interpreter used to run it.

     <p>The &ldquo;Corresponding Source&rdquo; for a work in object code form means all
the source code needed to generate, install, and (for an executable
work) run the object code and to modify the work, including scripts to
control those activities.  However, it does not include the work's
System Libraries, or general-purpose tools or generally available free
programs which are used unmodified in performing those activities but
which are not part of the work.  For example, Corresponding Source
includes interface definition files associated with source files for
the work, and the source code for shared libraries and dynamically
linked subprograms that the work is specifically designed to require,
such as by intimate data communication or control flow between those
subprograms and other parts of the work.

     <p>The Corresponding Source need not include anything that users can
regenerate automatically from other parts of the Corresponding Source.

     <p>The Corresponding Source for a work in source code form is that same
work.

     <li>Basic Permissions.

     <p>All rights granted under this License are granted for the term of
copyright on the Program, and are irrevocable provided the stated
conditions are met.  This License explicitly affirms your unlimited
permission to run the unmodified Program.  The output from running a
covered work is covered by this License only if the output, given its
content, constitutes a covered work.  This License acknowledges your
rights of fair use or other equivalent, as provided by copyright law.

     <p>You may make, run and propagate covered works that you do not convey,
without conditions so long as your license otherwise remains in force. 
You may convey covered works to others for the sole purpose of having
them make modifications exclusively for you, or provide you with
facilities for running those works, provided that you comply with the
terms of this License in conveying all material for which you do not
control copyright.  Those thus making or running the covered works for
you must do so exclusively on your behalf, under your direction and
control, on terms that prohibit them from making any copies of your
copyrighted material outside their relationship with you.

     <p>Conveying under any other circumstances is permitted solely under the
conditions stated below.  Sublicensing is not allowed; section 10
makes it unnecessary.

     <li>Protecting Users' Legal Rights From Anti-Circumvention Law.

     <p>No covered work shall be deemed part of an effective technological
measure under any applicable law fulfilling obligations under article
11 of the WIPO copyright treaty adopted on 20 December 1996, or
similar laws prohibiting or restricting circumvention of such
measures.

     <p>When you convey a covered work, you waive any legal power to forbid
circumvention of technological measures to the extent such
circumvention is effected by exercising rights under this License with
respect to the covered work, and you disclaim any intention to limit
operation or modification of the work as a means of enforcing, against
the work's users, your or third parties' legal rights to forbid
circumvention of technological measures.

     <li>Conveying Verbatim Copies.

     <p>You may convey verbatim copies of the Program's source code as you
receive it, in any medium, provided that you conspicuously and
appropriately publish on each copy an appropriate copyright notice;
keep intact all notices stating that this License and any
non-permissive terms added in accord with section 7 apply to the code;
keep intact all notices of the absence of any warranty; and give all
recipients a copy of this License along with the Program.

     <p>You may charge any price or no price for each copy that you convey,
and you may offer support or warranty protection for a fee.

     <li>Conveying Modified Source Versions.

     <p>You may convey a work based on the Program, or the modifications to
produce it from the Program, in the form of source code under the
terms of section 4, provided that you also meet all of these
conditions:

          <ol type=a start=1>
<li>
The work must carry prominent notices stating that you modified it,
and giving a relevant date.

          <li>
The work must carry prominent notices stating that it is released
under this License and any conditions added under section 7.  This
requirement modifies the requirement in section 4 to &ldquo;keep intact all
notices&rdquo;.

          <li>
You must license the entire work, as a whole, under this License to
anyone who comes into possession of a copy.  This License will
therefore apply, along with any applicable section 7 additional terms,
to the whole of the work, and all its parts, regardless of how they
are packaged.  This License gives no permission to license the work in
any other way, but it does not invalidate such permission if you have
separately received it.

          <li>
If the work has interactive user interfaces, each must display
Appropriate Legal Notices; however, if the Program has interactive
interfaces that do not display Appropriate Legal Notices, your work
need not make them do so.
          </ol>

     <p>A compilation of a covered work with other separate and independent
works, which are not by their nature extensions of the covered work,
and which are not combined with it such as to form a larger program,
in or on a volume of a storage or distribution medium, is called an
&ldquo;aggregate&rdquo; if the compilation and its resulting copyright are not
used to limit the access or legal rights of the compilation's users
beyond what the individual works permit.  Inclusion of a covered work
in an aggregate does not cause this License to apply to the other
parts of the aggregate.

     <li> Conveying Non-Source Forms.

     <p>You may convey a covered work in object code form under the terms of
sections 4 and 5, provided that you also convey the machine-readable
Corresponding Source under the terms of this License, in one of these
ways:

          <ol type=a start=1>
<li>
Convey the object code in, or embodied in, a physical product
(including a physical distribution medium), accompanied by the
Corresponding Source fixed on a durable physical medium customarily
used for software interchange.

          <li>
Convey the object code in, or embodied in, a physical product
(including a physical distribution medium), accompanied by a written
offer, valid for at least three years and valid for as long as you
offer spare parts or customer support for that product model, to give
anyone who possesses the object code either (1) a copy of the
Corresponding Source for all the software in the product that is
covered by this License, on a durable physical medium customarily used
for software interchange, for a price no more than your reasonable
cost of physically performing this conveying of source, or (2) access
to copy the Corresponding Source from a network server at no charge.

          <li>
Convey individual copies of the object code with a copy of the written
offer to provide the Corresponding Source.  This alternative is
allowed only occasionally and noncommercially, and only if you
received the object code with such an offer, in accord with subsection
6b.

          <li>
Convey the object code by offering access from a designated place
(gratis or for a charge), and offer equivalent access to the
Corresponding Source in the same way through the same place at no
further charge.  You need not require recipients to copy the
Corresponding Source along with the object code.  If the place to copy
the object code is a network server, the Corresponding Source may be
on a different server (operated by you or a third party) that supports
equivalent copying facilities, provided you maintain clear directions
next to the object code saying where to find the Corresponding Source. 
Regardless of what server hosts the Corresponding Source, you remain
obligated to ensure that it is available for as long as needed to
satisfy these requirements.

          <li>
Convey the object code using peer-to-peer transmission, provided you
inform other peers where the object code and Corresponding Source of
the work are being offered to the general public at no charge under
subsection 6d.

          </ol>

     <p>A separable portion of the object code, whose source code is excluded
from the Corresponding Source as a System Library, need not be
included in conveying the object code work.

     <p>A &ldquo;User Product&rdquo; is either (1) a &ldquo;consumer product&rdquo;, which means any
tangible personal property which is normally used for personal,
family, or household purposes, or (2) anything designed or sold for
incorporation into a dwelling.  In determining whether a product is a
consumer product, doubtful cases shall be resolved in favor of
coverage.  For a particular product received by a particular user,
&ldquo;normally used&rdquo; refers to a typical or common use of that class of
product, regardless of the status of the particular user or of the way
in which the particular user actually uses, or expects or is expected
to use, the product.  A product is a consumer product regardless of
whether the product has substantial commercial, industrial or
non-consumer uses, unless such uses represent the only significant
mode of use of the product.

     <p>&ldquo;Installation Information&rdquo; for a User Product means any methods,
procedures, authorization keys, or other information required to
install and execute modified versions of a covered work in that User
Product from a modified version of its Corresponding Source.  The
information must suffice to ensure that the continued functioning of
the modified object code is in no case prevented or interfered with
solely because modification has been made.

     <p>If you convey an object code work under this section in, or with, or
specifically for use in, a User Product, and the conveying occurs as
part of a transaction in which the right of possession and use of the
User Product is transferred to the recipient in perpetuity or for a
fixed term (regardless of how the transaction is characterized), the
Corresponding Source conveyed under this section must be accompanied
by the Installation Information.  But this requirement does not apply
if neither you nor any third party retains the ability to install
modified object code on the User Product (for example, the work has
been installed in ROM).

     <p>The requirement to provide Installation Information does not include a
requirement to continue to provide support service, warranty, or
updates for a work that has been modified or installed by the
recipient, or for the User Product in which it has been modified or
installed.  Access to a network may be denied when the modification
itself materially and adversely affects the operation of the network
or violates the rules and protocols for communication across the
network.

     <p>Corresponding Source conveyed, and Installation Information provided,
in accord with this section must be in a format that is publicly
documented (and with an implementation available to the public in
source code form), and must require no special password or key for
unpacking, reading or copying.

     <li>Additional Terms.

     <p>&ldquo;Additional permissions&rdquo; are terms that supplement the terms of this
License by making exceptions from one or more of its conditions. 
Additional permissions that are applicable to the entire Program shall
be treated as though they were included in this License, to the extent
that they are valid under applicable law.  If additional permissions
apply only to part of the Program, that part may be used separately
under those permissions, but the entire Program remains governed by
this License without regard to the additional permissions.

     <p>When you convey a copy of a covered work, you may at your option
remove any additional permissions from that copy, or from any part of
it.  (Additional permissions may be written to require their own
removal in certain cases when you modify the work.)  You may place
additional permissions on material, added by you to a covered work,
for which you have or can give appropriate copyright permission.

     <p>Notwithstanding any other provision of this License, for material you
add to a covered work, you may (if authorized by the copyright holders
of that material) supplement the terms of this License with terms:

          <ol type=a start=1>
<li>
Disclaiming warranty or limiting liability differently from the terms
of sections 15 and 16 of this License; or

          <li>
Requiring preservation of specified reasonable legal notices or author
attributions in that material or in the Appropriate Legal Notices
displayed by works containing it; or

          <li>
Prohibiting misrepresentation of the origin of that material, or
requiring that modified versions of such material be marked in
reasonable ways as different from the original version; or

          <li>
Limiting the use for publicity purposes of names of licensors or
authors of the material; or

          <li>
Declining to grant rights under trademark law for use of some trade
names, trademarks, or service marks; or

          <li>
Requiring indemnification of licensors and authors of that material by
anyone who conveys the material (or modified versions of it) with
contractual assumptions of liability to the recipient, for any
liability that these contractual assumptions directly impose on those
licensors and authors.
          </ol>

     <p>All other non-permissive additional terms are considered &ldquo;further
restrictions&rdquo; within the meaning of section 10.  If the Program as you
received it, or any part of it, contains a notice stating that it is
governed by this License along with a term that is a further
restriction, you may remove that term.  If a license document contains
a further restriction but permits relicensing or conveying under this
License, you may add to a covered work material governed by the terms
of that license document, provided that the further restriction does
not survive such relicensing or conveying.

     <p>If you add terms to a covered work in accord with this section, you
must place, in the relevant source files, a statement of the
additional terms that apply to those files, or a notice indicating
where to find the applicable terms.

     <p>Additional terms, permissive or non-permissive, may be stated in the
form of a separately written license, or stated as exceptions; the
above requirements apply either way.

     <li>Termination.

     <p>You may not propagate or modify a covered work except as expressly
provided under this License.  Any attempt otherwise to propagate or
modify it is void, and will automatically terminate your rights under
this License (including any patent licenses granted under the third
paragraph of section 11).

     <p>However, if you cease all violation of this License, then your license
from a particular copyright holder is reinstated (a) provisionally,
unless and until the copyright holder explicitly and finally
terminates your license, and (b) permanently, if the copyright holder
fails to notify you of the violation by some reasonable means prior to
60 days after the cessation.

     <p>Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.

     <p>Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, you do not qualify to receive new licenses for the same
material under section 10.

     <li>Acceptance Not Required for Having Copies.

     <p>You are not required to accept this License in order to receive or run
a copy of the Program.  Ancillary propagation of a covered work
occurring solely as a consequence of using peer-to-peer transmission
to receive a copy likewise does not require acceptance.  However,
nothing other than this License grants you permission to propagate or
modify any covered work.  These actions infringe copyright if you do
not accept this License.  Therefore, by modifying or propagating a
covered work, you indicate your acceptance of this License to do so.

     <li>Automatic Licensing of Downstream Recipients.

     <p>Each time you convey a covered work, the recipient automatically
receives a license from the original licensors, to run, modify and
propagate that work, subject to this License.  You are not responsible
for enforcing compliance by third parties with this License.

     <p>An &ldquo;entity transaction&rdquo; is a transaction transferring control of an
organization, or substantially all assets of one, or subdividing an
organization, or merging organizations.  If propagation of a covered
work results from an entity transaction, each party to that
transaction who receives a copy of the work also receives whatever
licenses to the work the party's predecessor in interest had or could
give under the previous paragraph, plus a right to possession of the
Corresponding Source of the work from the predecessor in interest, if
the predecessor has it or can get it with reasonable efforts.

     <p>You may not impose any further restrictions on the exercise of the
rights granted or affirmed under this License.  For example, you may
not impose a license fee, royalty, or other charge for exercise of
rights granted under this License, and you may not initiate litigation
(including a cross-claim or counterclaim in a lawsuit) alleging that
any patent claim is infringed by making, using, selling, offering for
sale, or importing the Program or any portion of it.

     <li>Patents.

     <p>A &ldquo;contributor&rdquo; is a copyright holder who authorizes use under this
License of the Program or a work on which the Program is based.  The
work thus licensed is called the contributor's &ldquo;contributor version&rdquo;.

     <p>A contributor's &ldquo;essential patent claims&rdquo; are all patent claims owned
or controlled by the contributor, whether already acquired or
hereafter acquired, that would be infringed by some manner, permitted
by this License, of making, using, or selling its contributor version,
but do not include claims that would be infringed only as a
consequence of further modification of the contributor version.  For
purposes of this definition, &ldquo;control&rdquo; includes the right to grant
patent sublicenses in a manner consistent with the requirements of
this License.

     <p>Each contributor grants you a non-exclusive, worldwide, royalty-free
patent license under the contributor's essential patent claims, to
make, use, sell, offer for sale, import and otherwise run, modify and
propagate the contents of its contributor version.

     <p>In the following three paragraphs, a &ldquo;patent license&rdquo; is any express
agreement or commitment, however denominated, not to enforce a patent
(such as an express permission to practice a patent or covenant not to
sue for patent infringement).  To &ldquo;grant&rdquo; such a patent license to a
party means to make such an agreement or commitment not to enforce a
patent against the party.

     <p>If you convey a covered work, knowingly relying on a patent license,
and the Corresponding Source of the work is not available for anyone
to copy, free of charge and under the terms of this License, through a
publicly available network server or other readily accessible means,
then you must either (1) cause the Corresponding Source to be so
available, or (2) arrange to deprive yourself of the benefit of the
patent license for this particular work, or (3) arrange, in a manner
consistent with the requirements of this License, to extend the patent
license to downstream recipients.  &ldquo;Knowingly relying&rdquo; means you have
actual knowledge that, but for the patent license, your conveying the
covered work in a country, or your recipient's use of the covered work
in a country, would infringe one or more identifiable patents in that
country that you have reason to believe are valid.

     <p>If, pursuant to or in connection with a single transaction or
arrangement, you convey, or propagate by procuring conveyance of, a
covered work, and grant a patent license to some of the parties
receiving the covered work authorizing them to use, propagate, modify
or convey a specific copy of the covered work, then the patent license
you grant is automatically extended to all recipients of the covered
work and works based on it.

     <p>A patent license is &ldquo;discriminatory&rdquo; if it does not include within the
scope of its coverage, prohibits the exercise of, or is conditioned on
the non-exercise of one or more of the rights that are specifically
granted under this License.  You may not convey a covered work if you
are a party to an arrangement with a third party that is in the
business of distributing software, under which you make payment to the
third party based on the extent of your activity of conveying the
work, and under which the third party grants, to any of the parties
who would receive the covered work from you, a discriminatory patent
license (a) in connection with copies of the covered work conveyed by
you (or copies made from those copies), or (b) primarily for and in
connection with specific products or compilations that contain the
covered work, unless you entered into that arrangement, or that patent
license was granted, prior to 28 March 2007.

     <p>Nothing in this License shall be construed as excluding or limiting
any implied license or other defenses to infringement that may
otherwise be available to you under applicable patent law.

     <li>No Surrender of Others' Freedom.

     <p>If conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot convey
a covered work so as to satisfy simultaneously your obligations under
this License and any other pertinent obligations, then as a
consequence you may not convey it at all.  For example, if you agree
to terms that obligate you to collect a royalty for further conveying
from those to whom you convey the Program, the only way you could
satisfy both those terms and this License would be to refrain entirely
from conveying the Program.

     <li>Use with the GNU Affero General Public License.

     <p>Notwithstanding any other provision of this License, you have
permission to link or combine any covered work with a work licensed
under version 3 of the GNU Affero General Public License into a single
combined work, and to convey the resulting work.  The terms of this
License will continue to apply to the part which is the covered work,
but the special requirements of the GNU Affero General Public License,
section 13, concerning interaction through a network will apply to the
combination as such.

     <li>Revised Versions of this License.

     <p>The Free Software Foundation may publish revised and/or new versions
of the GNU General Public License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.

     <p>Each version is given a distinguishing version number.  If the Program
specifies that a certain numbered version of the GNU General Public
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that numbered version or
of any later version published by the Free Software Foundation.  If
the Program does not specify a version number of the GNU General
Public License, you may choose any version ever published by the Free
Software Foundation.

     <p>If the Program specifies that a proxy can decide which future versions
of the GNU General Public License can be used, that proxy's public
statement of acceptance of a version permanently authorizes you to
choose that version for the Program.

     <p>Later license versions may give you additional or different
permissions.  However, no additional obligations are imposed on any
author or copyright holder as a result of your choosing to follow a
later version.

     <li>Disclaimer of Warranty.

     <p>THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY
APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT
HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM &ldquo;AS IS&rdquo; WITHOUT
WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND
PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE PROGRAM PROVE
DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR
CORRECTION.

     <li>Limitation of Liability.

     <p>IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR
CONVEYS THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES
ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT
NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR
LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM
TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER
PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

     <li>Interpretation of Sections 15 and 16.

     <p>If the disclaimer of warranty and limitation of liability provided
above cannot be given local legal effect according to their terms,
reviewing courts shall apply local law that most closely approximates
an absolute waiver of all civil liability in connection with the
Program, unless a warranty or assumption of liability accompanies a
copy of the Program in return for a fee.

     </ol>

<h3 class="heading">END OF TERMS AND CONDITIONS</h3>

<h3 class="heading">How to Apply These Terms to Your New Programs</h3>

<p>If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these
terms.

   <p>To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
state the exclusion of warranty; and each file should have at least
the &ldquo;copyright&rdquo; line and a pointer to where the full notice is found.

<pre class="smallexample">     <var>one line to give the program's name and a brief idea of what it does.</var>
     Copyright (C) <var>year</var> <var>name of author</var>
     
     This program is free software: you can redistribute it and/or modify
     it under the terms of the GNU General Public License as published by
     the Free Software Foundation, either version 3 of the License, or (at
     your option) any later version.
     
     This program is distributed in the hope that it will be useful, but
     WITHOUT ANY WARRANTY; without even the implied warranty of
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
     General Public License for more details.
     
     You should have received a copy of the GNU General Public License
     along with this program.  If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.
</pre>
   <p>Also add information on how to contact you by electronic and paper mail.

   <p>If the program does terminal interaction, make it output a short
notice like this when it starts in an interactive mode:

<pre class="smallexample">     <var>program</var> Copyright (C) <var>year</var> <var>name of author</var>
     This program comes with ABSOLUTELY NO WARRANTY; for details type &lsquo;<samp><span class="samp">show w</span></samp>&rsquo;.
     This is free software, and you are welcome to redistribute it
     under certain conditions; type &lsquo;<samp><span class="samp">show c</span></samp>&rsquo; for details.
</pre>
   <p>The hypothetical commands &lsquo;<samp><span class="samp">show w</span></samp>&rsquo; and &lsquo;<samp><span class="samp">show c</span></samp>&rsquo; should show
the appropriate parts of the General Public License.  Of course, your
program's commands might be different; for a GUI interface, you would
use an &ldquo;about box&rdquo;.

   <p>You should also get your employer (if you work as a programmer) or school,
if any, to sign a &ldquo;copyright disclaimer&rdquo; for the program, if necessary. 
For more information on this, and how to apply and follow the GNU GPL, see
<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.

   <p>The GNU General Public License does not permit incorporating your
program into proprietary programs.  If your program is a subroutine
library, you may consider it more useful to permit linking proprietary
applications with the library.  If this is what you want to do, use
the GNU Lesser General Public License instead of this License.  But
first, please read <a href="http://www.gnu.org/philosophy/why-not-lgpl.html">http://www.gnu.org/philosophy/why-not-lgpl.html</a>.

<!-- page -->
<div class="node">
<a name="references"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#concept-index">concept index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#package-license">package license</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix E Bibliography and references</h2>

<p class="noindent"><em>Revised^6 Report on the Algorithmic Language Scheme.</em>  Michael
Sperber and R. Kent Dybvig and Matthew Flatt and Anton Van Straaten
(Editors).  2007.

<p class="noindent"><em>Revised^6 Report on the Algorithmic Language Scheme&mdash;Standard
Libraries.</em>  Michael Sperber and R. Kent Dybvig and Matthew Flatt and
Anton Van Straaten (Editors). 2007.

<p class="noindent"><em>Scheme Request for Implementation 41: Streams.</em>  Philip L. Bewig. 
2007.  <a href="http://srfi.schemers.org/srfi-41/srfi-41.html">http://srfi.schemers.org/srfi-41/srfi-41.html</a>

<p class="noindent"><code>[DYBGUA]</code> <em>Guardians in a generation&ndash;based garbage
collector</em>.  R. Kent Dybvig and Carl Bruggeman and David Eby.  PLDI '93,
pages 207&ndash;216, June 1993.  Introduces guardians and describes the
implementation of guardians and weak pairs in Chez Scheme.

<p class="noindent"><em>Don't stop the BiBOP: Flexible and efficient storage management
for dynamically&ndash;typed languages.</em>  R. Kent Dybvig and David Eby and
Carl Bruggeman.  Technical Report 400, Indiana University, March 1994. 
Describes Chez Scheme's storage management system.

<p class="noindent"><em>Generation Friendly Eq Hash Tables.</em>  Abdulaziz Ghuloum and
R. Kent Dybvig. In <em>Proceedings of the 2007 Workshop on Scheme and
Functional Programming</em>, pages 207&ndash;216.  Universite Laval Technical
Report DIUL-RT-0701, 2007.

<p class="noindent"><em>Extending the Scope of Syntactic Abstraction.</em>  Oscar Waddell. 
PhD thesis, Indiana University Computer Science Department, August 1999. 
<a href="http://www.cs.indiana.edu/~owaddell/papers/thesis.ps.gz">http://www.cs.indiana.edu/~owaddell/papers/thesis.ps.gz</a>

<p class="noindent"><em>Extending the Scope of Syntactic Abstraction.</em>  Oscar Waddell and
R. Kent Dybvig.  In <em>Conference Record of POPL'99: The 26th ACM
SIGPLAN-SIGACT Symposium on Principles of Programming Languages</em>, pages
203&ndash;213, January 1999. 
<a href="http://www.cs.indiana.edu/~dyb/papers/popl99.ps.gz">http://www.cs.indiana.edu/~dyb/papers/popl99.ps.gz</a>

<p class="noindent"><em>Chez Scheme Version 7 User's Guide.</em>  R. Kent Dybvig.  Cadence
Research Systems, 2005.  User's guide and reference manual for Chez
Scheme Version 7.  <a href="http://www.scheme.com/csug7/">http://www.scheme.com/csug7/</a>

<p class="noindent"><em>Implicit phasing for R6RS libraries.</em>  Abdulaziz Ghuloum and
R. Kent Dybvig.  In <em>ICFP '07: Proceedings of the 2007 ACM SIGPLAN
international conference on Functional programming</em>, pages 303&ndash;314. 
New York, NY, USA, 2007.  ACM.

<!-- page -->
<div class="node">
<a name="concept-index"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#function-index">function index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#references">references</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix F An entry for each concept</h2>

<ul class="index-cp" compact>
<li><a href="#index-Command-line-11">Command line</a>: <a href="#using">using</a></li>
<li><a href="#index-Disinstalling-_0040value_007bPRJNAME_007d-9">Disinstalling Vicare</a>: <a href="#overview-install-uninstall">overview install uninstall</a></li>
<li><a href="#index-Disinstalling-_0040value_007bPRJNAME_007d-3">Disinstalling Vicare</a>: <a href="#overview-install">overview install</a></li>
<li><a href="#index-Environment_002c-interaction-51">Environment, interaction</a>: <a href="#iklib-environment">iklib environment</a></li>
<li><a href="#index-Installing-_0040value_007bPRJNAME_007d-1">Installing Vicare</a>: <a href="#overview-install">overview install</a></li>
<li><a href="#index-Invoking-_0040value_007bPRJNAME_007d-12">Invoking Vicare</a>: <a href="#using">using</a></li>
<li><a href="#index-g_t_0040code_007bSIGABRT_007d-299"><code>SIGABRT</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGALRM_007d-300"><code>SIGALRM</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGBUS_007d-301"><code>SIGBUS</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGCHLD_007d-302"><code>SIGCHLD</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGCONT_007d-303"><code>SIGCONT</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGFPE_007d-304"><code>SIGFPE</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGHUP_007d-305"><code>SIGHUP</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGILL_007d-306"><code>SIGILL</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGINT_007d-307"><code>SIGINT</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGKILL_007d-308"><code>SIGKILL</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGPIPE_007d-309"><code>SIGPIPE</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGPOLL_007d-319"><code>SIGPOLL</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGPROF_007d-320"><code>SIGPROF</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGQUIT_007d-310"><code>SIGQUIT</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGSEGV_007d-311"><code>SIGSEGV</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGSTOP_007d-312"><code>SIGSTOP</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGSYS_007d-321"><code>SIGSYS</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGTERM_007d-313"><code>SIGTERM</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGTRAP_007d-322"><code>SIGTRAP</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGTSTP_007d-314"><code>SIGTSTP</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGTTIN_007d-315"><code>SIGTTIN</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGTTOU_007d-316"><code>SIGTTOU</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGURG_007d-323"><code>SIGURG</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGUSR1_007d-317"><code>SIGUSR1</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGUSR2_007d-318"><code>SIGUSR2</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGVTALRM_007d-324"><code>SIGVTALRM</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGXCPU_007d-325"><code>SIGXCPU</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-g_t_0040code_007bSIGXFSZ_007d-326"><code>SIGXFSZ</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-Uninstalling-_0040value_007bPRJNAME_007d-10">Uninstalling Vicare</a>: <a href="#overview-install-uninstall">overview install uninstall</a></li>
<li><a href="#index-Uninstalling-_0040value_007bPRJNAME_007d-2">Uninstalling Vicare</a>: <a href="#overview-install">overview install</a></li>
<li><a href="#index-g_t_0040value_007bPRJNAME_007d_002c-disinstalling-8">Vicare, disinstalling</a>: <a href="#overview-install-uninstall">overview install uninstall</a></li>
<li><a href="#index-g_t_0040value_007bPRJNAME_007d_002c-disinstalling-6">Vicare, disinstalling</a>: <a href="#overview-install">overview install</a></li>
<li><a href="#index-g_t_0040value_007bPRJNAME_007d_002c-installing-4">Vicare, installing</a>: <a href="#overview-install">overview install</a></li>
<li><a href="#index-g_t_0040value_007bPRJNAME_007d_002c-uninstalling-7">Vicare, uninstalling</a>: <a href="#overview-install-uninstall">overview install uninstall</a></li>
<li><a href="#index-g_t_0040value_007bPRJNAME_007d_002c-uninstalling-5">Vicare, uninstalling</a>: <a href="#overview-install">overview install</a></li>
   </ul><div class="node">
<a name="function-index"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#variable-index">variable index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#concept-index">concept index</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix G An entry for each function.</h2>



<ul class="index-fn" compact>
<li><a href="#index-g_t_0023_0021eof-45"><code>#!eof</code></a>: <a href="#iklib-reader-stx">iklib reader stx</a></li>
<li><a href="#index-g_t_0023_0021ikarus-22"><code>#!ikarus</code></a>: <a href="#iklib-reader-mode">iklib reader mode</a></li>
<li><a href="#index-g_t_0023_0021vicare-21"><code>#!vicare</code></a>: <a href="#iklib-reader-mode">iklib reader mode</a></li>
<li><a href="#index-g_t_0023_003apretty_002dname-153"><code>#:pretty-name</code></a>: <a href="#iklib-gensym">iklib gensym</a></li>
<li><a href="#index-g_t_0023vs16b_0028_0040var_007bword_007d-_002e_002e_002e_0029-30"><code>#vs16b(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs16l_0028_0040var_007bword_007d-_002e_002e_002e_0029-29"><code>#vs16l(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs16n_0028_0040var_007bword_007d-_002e_002e_002e_0029-31"><code>#vs16n(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs32b_0028_0040var_007bword_007d-_002e_002e_002e_0029-36"><code>#vs32b(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs32l_0028_0040var_007bword_007d-_002e_002e_002e_0029-35"><code>#vs32l(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs32n_0028_0040var_007bword_007d-_002e_002e_002e_0029-37"><code>#vs32n(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs64b_0028_0040var_007bword_007d-_002e_002e_002e_0029-42"><code>#vs64b(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs64l_0028_0040var_007bword_007d-_002e_002e_002e_0029-41"><code>#vs64l(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs64n_0028_0040var_007bword_007d-_002e_002e_002e_0029-43"><code>#vs64n(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs8_0028_0040var_007bbyte_007d-_002e_002e_002e_0029-25"><code>#vs8(</code><var>byte</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu16b_0028_0040var_007bword_007d-_002e_002e_002e_0029-27"><code>#vu16b(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu16l_0028_0040var_007bword_007d-_002e_002e_002e_0029-26"><code>#vu16l(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu16n_0028_0040var_007bword_007d-_002e_002e_002e_0029-28"><code>#vu16n(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu32b_0028_0040var_007bword_007d-_002e_002e_002e_0029-33"><code>#vu32b(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu32l_0028_0040var_007bword_007d-_002e_002e_002e_0029-32"><code>#vu32l(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu32n_0028_0040var_007bword_007d-_002e_002e_002e_0029-34"><code>#vu32n(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu64b_0028_0040var_007bword_007d-_002e_002e_002e_0029-39"><code>#vu64b(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu64l_0028_0040var_007bword_007d-_002e_002e_002e_0029-38"><code>#vu64l(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu64n_0028_0040var_007bword_007d-_002e_002e_002e_0029-40"><code>#vu64n(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023_0040_007bgensym_0040_007d-150"><code>#{gensym}</code></a>: <a href="#iklib-gensym">iklib gensym</a></li>
<li><a href="#index-g_t_0023_0040_007bpretty_002dname-unique_002dname_0040_007d-152"><code>#{pretty-name unique-name}</code></a>: <a href="#iklib-gensym">iklib gensym</a></li>
<li><a href="#index-g_t_0023_0040_007bunique_002dname_0040_007d-151"><code>#{unique-name}</code></a>: <a href="#iklib-gensym">iklib gensym</a></li>
<li><a href="#index-g_t_0024bignum_002dbyte_002dref-433"><code>$bignum-byte-ref</code></a>: <a href="#syslib-bignums">syslib bignums</a></li>
<li><a href="#index-g_t_0024bignum_002dpositive_003f-432"><code>$bignum-positive?</code></a>: <a href="#syslib-bignums">syslib bignums</a></li>
<li><a href="#index-g_t_0024bignum_002dsize-434"><code>$bignum-size</code></a>: <a href="#syslib-bignums">syslib bignums</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002ddouble_002dnative_002dref-486"><code>$bytevector-ieee-double-native-ref</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002ddouble_002dnative_002dset_0021-487"><code>$bytevector-ieee-double-native-set!</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002ddouble_002dnonnative_002dref-488"><code>$bytevector-ieee-double-nonnative-ref</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002ddouble_002dnonnative_002dset_0021-489"><code>$bytevector-ieee-double-nonnative-set!</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002dsingle_002dnative_002dref-490"><code>$bytevector-ieee-single-native-ref</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002dsingle_002dnative_002dset_0021-491"><code>$bytevector-ieee-single-native-set!</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002dsingle_002dnonnative_002dref-492"><code>$bytevector-ieee-single-nonnative-ref</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002dsingle_002dnonnative_002dset_0021-493"><code>$bytevector-ieee-single-nonnative-set!</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dlength-482"><code>$bytevector-length</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002ds8_002dref-484"><code>$bytevector-s8-ref</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dset_0021-485"><code>$bytevector-set!</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002du8_002dref-483"><code>$bytevector-u8-ref</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024car-465"><code>$car</code></a>: <a href="#syslib-pairs">syslib pairs</a></li>
<li><a href="#index-g_t_0024cdr-466"><code>$cdr</code></a>: <a href="#syslib-pairs">syslib pairs</a></li>
<li><a href="#index-g_t_0024cflonum_002dimag-457"><code>$cflonum-imag</code></a>: <a href="#syslib-cflonums">syslib cflonums</a></li>
<li><a href="#index-g_t_0024cflonum_002dreal-456"><code>$cflonum-real</code></a>: <a href="#syslib-cflonums">syslib cflonums</a></li>
<li><a href="#index-g_t_0024char_002d_003efixnum-464"><code>$char-&gt;fixnum</code></a>: <a href="#syslib-chars">syslib chars</a></li>
<li><a href="#index-g_t_0024char_003c-459"><code>$char&lt;</code></a>: <a href="#syslib-chars">syslib chars</a></li>
<li><a href="#index-g_t_0024char_003c_003d-460"><code>$char&lt;=</code></a>: <a href="#syslib-chars">syslib chars</a></li>
<li><a href="#index-g_t_0024char_003d-458"><code>$char=</code></a>: <a href="#syslib-chars">syslib chars</a></li>
<li><a href="#index-g_t_0024char_003e-461"><code>$char&gt;</code></a>: <a href="#syslib-chars">syslib chars</a></li>
<li><a href="#index-g_t_0024char_003e_003d-462"><code>$char&gt;=</code></a>: <a href="#syslib-chars">syslib chars</a></li>
<li><a href="#index-g_t_0024compnum_002dimag-454"><code>$compnum-imag</code></a>: <a href="#syslib-compnums">syslib compnums</a></li>
<li><a href="#index-g_t_0024compnum_002dreal-453"><code>$compnum-real</code></a>: <a href="#syslib-compnums">syslib compnums</a></li>
<li><a href="#index-g_t_0024data_002d_003etranscoder-516"><code>$data-&gt;transcoder</code></a>: <a href="#syslib-transcoders">syslib transcoders</a></li>
<li><a href="#index-g_t_0024fixnum_002d_003echar-463"><code>$fixnum-&gt;char</code></a>: <a href="#syslib-chars">syslib chars</a></li>
<li><a href="#index-g_t_0024fixnum_002d_003eflonum-438"><code>$fixnum-&gt;flonum</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_002a-441"><code>$fl*</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_002b-439"><code>$fl+</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_002d-440"><code>$fl-</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_002f-442"><code>$fl/</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_003c-444"><code>$fl&lt;</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_003c_003d-445"><code>$fl&lt;=</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_003d-443"><code>$fl=</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_003e-446"><code>$fl&gt;</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_003e_003d-447"><code>$fl&gt;=</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024flonum_002dsbe-448"><code>$flonum-sbe</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024flonum_002dset_0021-437"><code>$flonum-set!</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024flonum_002du8_002dref-436"><code>$flonum-u8-ref</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fx_002a-423"><code>$fx*</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fx_002b-421"><code>$fx+</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fx_002d-422"><code>$fx-</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fx_003c-415"><code>$fx&lt;</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fx_003c_003d-416"><code>$fx&lt;=</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fx_003d-414"><code>$fx=</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fx_003e-417"><code>$fx&gt;</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fx_003e_003d-418"><code>$fx&gt;=</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxadd1-419"><code>$fxadd1</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxinthash-431"><code>$fxinthash</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxlogand-425"><code>$fxlogand</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxlognot-424"><code>$fxlognot</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxlogor-426"><code>$fxlogor</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxlogxor-427"><code>$fxlogxor</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxquotient-430"><code>$fxquotient</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxsll-428"><code>$fxsll</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxsra-429"><code>$fxsra</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxsub1-420"><code>$fxsub1</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxzero_003f-413"><code>$fxzero?</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024init_002dsymbol_002dfunction_0021-412"><code>$init-symbol-function!</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024make_002dbytevector-481"><code>$make-bytevector</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024make_002dcflonum-455"><code>$make-cflonum</code></a>: <a href="#syslib-cflonums">syslib cflonums</a></li>
<li><a href="#index-g_t_0024make_002dcompnum-452"><code>$make-compnum</code></a>: <a href="#syslib-compnums">syslib compnums</a></li>
<li><a href="#index-g_t_0024make_002dflonum-435"><code>$make-flonum</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024make_002dport-499"><code>$make-port</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024make_002dratnum-449"><code>$make-ratnum</code></a>: <a href="#syslib-ratnums">syslib ratnums</a></li>
<li><a href="#index-g_t_0024make_002dstring-494"><code>$make-string</code></a>: <a href="#syslib-strings">syslib strings</a></li>
<li><a href="#index-g_t_0024make_002dstruct-472"><code>$make-struct</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-g_t_0024make_002dsymbol-400"><code>$make-symbol</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024make_002dvector-477"><code>$make-vector</code></a>: <a href="#syslib-vectors">syslib vectors</a></li>
<li><a href="#index-g_t_0024port_002dattrs-511"><code>$port-attrs</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dbuffer-502"><code>$port-buffer</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dclose-509"><code>$port-close</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dcookie-510"><code>$port-cookie</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dget_002dposition-507"><code>$port-get-position</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002did-504"><code>$port-id</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dindex-500"><code>$port-index</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dread_0021-505"><code>$port-read!</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dset_002dposition_0021-508"><code>$port-set-position!</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dsize-501"><code>$port-size</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dtag-512"><code>$port-tag</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dtranscoder-503"><code>$port-transcoder</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dwrite_0021-506"><code>$port-write!</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024ratnum_002dd-451"><code>$ratnum-d</code></a>: <a href="#syslib-ratnums">syslib ratnums</a></li>
<li><a href="#index-g_t_0024ratnum_002dn-450"><code>$ratnum-n</code></a>: <a href="#syslib-ratnums">syslib ratnums</a></li>
<li><a href="#index-g_t_0024set_002dcar_0021-467"><code>$set-car!</code></a>: <a href="#syslib-pairs">syslib pairs</a></li>
<li><a href="#index-g_t_0024set_002dcdr_0021-468"><code>$set-cdr!</code></a>: <a href="#syslib-pairs">syslib pairs</a></li>
<li><a href="#index-g_t_0024set_002dport_002dattrs_0021-515"><code>$set-port-attrs!</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024set_002dport_002dindex_0021-513"><code>$set-port-index!</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024set_002dport_002dsize_0021-514"><code>$set-port-size!</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024set_002dsymbol_002dplist_0021-407"><code>$set-symbol-plist!</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024set_002dsymbol_002dproc_0021-409"><code>$set-symbol-proc!</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024set_002dsymbol_002dstring_0021-405"><code>$set-symbol-string!</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024set_002dsymbol_002dunique_002dstring_0021-406"><code>$set-symbol-unique-string!</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024set_002dsymbol_002dvalue_0021-408"><code>$set-symbol-value!</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024set_002dsymbol_002dvalue_002fproc_0021-410"><code>$set-symbol-value/proc!</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024string_002dlength-495"><code>$string-length</code></a>: <a href="#syslib-strings">syslib strings</a></li>
<li><a href="#index-g_t_0024string_002dref-496"><code>$string-ref</code></a>: <a href="#syslib-strings">syslib strings</a></li>
<li><a href="#index-g_t_0024string_002dset_0021-497"><code>$string-set!</code></a>: <a href="#syslib-strings">syslib strings</a></li>
<li><a href="#index-g_t_0024struct-476"><code>$struct</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-g_t_0024struct_002dref-474"><code>$struct-ref</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-g_t_0024struct_002drtd-473"><code>$struct-rtd</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-g_t_0024struct_002dset_0021-475"><code>$struct-set!</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-g_t_0024struct_002frtd_003f-471"><code>$struct/rtd?</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-g_t_0024struct_003f-470"><code>$struct?</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-g_t_0024symbol_002dplist-403"><code>$symbol-plist</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024symbol_002dstring-401"><code>$symbol-string</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024symbol_002dunique_002dstring-402"><code>$symbol-unique-string</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024symbol_002dvalue-404"><code>$symbol-value</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024transcoder_002d_003edata-517"><code>$transcoder-&gt;data</code></a>: <a href="#syslib-transcoders">syslib transcoders</a></li>
<li><a href="#index-g_t_0024vector_002dlength-478"><code>$vector-length</code></a>: <a href="#syslib-vectors">syslib vectors</a></li>
<li><a href="#index-g_t_0024vector_002dref-479"><code>$vector-ref</code></a>: <a href="#syslib-vectors">syslib vectors</a></li>
<li><a href="#index-g_t_0024vector_002dset_0021-480"><code>$vector-set!</code></a>: <a href="#syslib-vectors">syslib vectors</a></li>
<li><a href="#index-accept_002dconnection-248"><code>accept-connection</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-accept_002dconnection_002dnonblocking-249"><code>accept-connection-nonblocking</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-align-525"><code>align</code></a>: <a href="#objects-int-alloc">objects int alloc</a></li>
<li><a href="#index-base_002drtd-469"><code>base-rtd</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-bignum_003f-133"><code>bignum?</code></a>: <a href="#iklib-numerics-preds">iklib numerics preds</a></li>
<li><a href="#index-bytevector_002d_003es16b_002dlist-91"><code>bytevector-&gt;s16b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es16l_002dlist-90"><code>bytevector-&gt;s16l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es16n_002dlist-92"><code>bytevector-&gt;s16n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es32b_002dlist-103"><code>bytevector-&gt;s32b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es32l_002dlist-102"><code>bytevector-&gt;s32l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es32n_002dlist-104"><code>bytevector-&gt;s32n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es64b_002dlist-115"><code>bytevector-&gt;s64b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es64l_002dlist-114"><code>bytevector-&gt;s64l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es64n_002dlist-116"><code>bytevector-&gt;s64n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es8_002dlist-82"><code>bytevector-&gt;s8-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu16b_002dlist-94"><code>bytevector-&gt;u16b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu16l_002dlist-93"><code>bytevector-&gt;u16l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu16n_002dlist-95"><code>bytevector-&gt;u16n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu32b_002dlist-106"><code>bytevector-&gt;u32b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu32l_002dlist-105"><code>bytevector-&gt;u32l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu32n_002dlist-107"><code>bytevector-&gt;u32n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu64b_002dlist-118"><code>bytevector-&gt;u64b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu64l_002dlist-117"><code>bytevector-&gt;u64l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu64n_002dlist-119"><code>bytevector-&gt;u64n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002dappend-120"><code>bytevector-append</code></a>: <a href="#iklib-bytevectors-generic">iklib bytevectors generic</a></li>
<li><a href="#index-bytevector_002dport_002dbuffer_002dsize-226"><code>bytevector-port-buffer-size</code></a>: <a href="#iklib-io-buffer">iklib io buffer</a></li>
<li><a href="#index-bytevector_005ftag-530"><code>bytevector_tag</code></a>: <a href="#objects-int-bytevector">objects int bytevector</a></li>
<li><a href="#index-call_002dwith_002dinput_002dfile-206"><code>call-with-input-file</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-call_002dwith_002doutput_002dfile-209"><code>call-with-output-file</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-cflonum_003f-135"><code>cflonum?</code></a>: <a href="#iklib-numerics-preds">iklib numerics preds</a></li>
<li><a href="#index-change_002dmode-339"><code>change-mode</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-close_002ddirectory_002dstream-343"><code>close-directory-stream</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-close_002dtcp_002dserver_002dsocket-250"><code>close-tcp-server-socket</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-collect-198"><code>collect</code></a>: <a href="#iklib-guardians">iklib guardians</a></li>
<li><a href="#index-compnum_003f-136"><code>compnum?</code></a>: <a href="#iklib-numerics-preds">iklib numerics preds</a></li>
<li><a href="#index-console_002derror_002dport-217"><code>console-error-port</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-console_002dinput_002dport-215"><code>console-input-port</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-console_002doutput_002dport-216"><code>console-output-port</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-core_002dexpand-48"><code>core-expand</code></a>: <a href="#iklib-expander">iklib expander</a></li>
<li><a href="#index-current_002ddirectory-328"><code>current-directory</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-define_002dstruct-57"><code>define-struct</code></a>: <a href="#iklib-structs-rtd">iklib structs rtd</a></li>
<li><a href="#index-delete_002ddirectory-338"><code>delete-directory</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-delete_002dfile-337"><code>delete-file</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-directory_002dlist-329"><code>directory-list</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-directory_002dstream_003f-341"><code>directory-stream?</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-disp_005fbytevector_005fdata-532"><code>disp_bytevector_data</code></a>: <a href="#objects-int-bytevector">objects int bytevector</a></li>
<li><a href="#index-disp_005fbytevector_005flength-531"><code>disp_bytevector_length</code></a>: <a href="#objects-int-bytevector">objects int bytevector</a></li>
<li><a href="#index-disp_005fvector_005fdata-537"><code>disp_vector_data</code></a>: <a href="#objects-int-vector">objects int vector</a></li>
<li><a href="#index-disp_005fvector_005flength-536"><code>disp_vector_length</code></a>: <a href="#objects-int-vector">objects int vector</a></li>
<li><a href="#index-dlclose-285"><code>dlclose</code></a>: <a href="#iklib-foreign-dl">iklib foreign dl</a></li>
<li><a href="#index-dlerror-287"><code>dlerror</code></a>: <a href="#iklib-foreign-dl">iklib foreign dl</a></li>
<li><a href="#index-dlopen-282"><code>dlopen</code></a>: <a href="#iklib-foreign-dl">iklib foreign dl</a></li>
<li><a href="#index-dlsym-286"><code>dlsym</code></a>: <a href="#iklib-foreign-dl">iklib foreign dl</a></li>
<li><a href="#index-environment_002dsymbols-55"><code>environment-symbols</code></a>: <a href="#iklib-environment">iklib environment</a></li>
<li><a href="#index-environment_003f-52"><code>environment?</code></a>: <a href="#iklib-environment">iklib environment</a></li>
<li><a href="#index-expand-47"><code>expand</code></a>: <a href="#iklib-expander">iklib expander</a></li>
<li><a href="#index-expand_002foptimize-49"><code>expand/optimize</code></a>: <a href="#iklib-expander">iklib expander</a></li>
<li><a href="#index-expand_002fscc_002dletrec-50"><code>expand/scc-letrec</code></a>: <a href="#iklib-expander">iklib expander</a></li>
<li><a href="#index-false_005fobject-521"><code>false_object</code></a>: <a href="#objects-int-const">objects int const</a></li>
<li><a href="#index-file_002dctime-330"><code>file-ctime</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-file_002ddirectory_003f-333"><code>file-directory?</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-file_002dexists_003f-331"><code>file-exists?</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-file_002dregular_003f-332"><code>file-regular?</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-file_002dsymbolic_002dlink_003f-334"><code>file-symbolic-link?</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-filename_002d_003estring_002dfunc-202"><code>filename-&gt;string-func</code></a>: <a href="#iklib-io-filename">iklib io filename</a></li>
<li><a href="#index-fix-527"><code>fix</code></a>: <a href="#objects-int-fixnum">objects int fixnum</a></li>
<li><a href="#index-fork-293"><code>fork</code></a>: <a href="#posix-process">posix process</a></li>
<li><a href="#index-format-158"><code>format</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-fprintf-160"><code>fprintf</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-free-256"><code>free</code></a>: <a href="#iklib-foreign-memops-alloc">iklib foreign memops alloc</a></li>
<li><a href="#index-generate_002ddebug_002dcalls-540"><code>generate-debug-calls</code></a>: <a href="#debug-int-intro">debug int intro</a></li>
<li><a href="#index-gensym-145"><code>gensym</code></a>: <a href="#iklib-gensym">iklib gensym</a></li>
<li><a href="#index-gensym_002d_003eunique_002dstring-149"><code>gensym-&gt;unique-string</code></a>: <a href="#iklib-gensym">iklib gensym</a></li>
<li><a href="#index-gensym_002dcount-173"><code>gensym-count</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-gensym_002dprefix-171"><code>gensym-prefix</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-gensym_003f-148"><code>gensym?</code></a>: <a href="#iklib-gensym">iklib gensym</a></li>
<li><a href="#index-get_002dannotated_002ddatum-46"><code>get-annotated-datum</code></a>: <a href="#iklib-reader-fun">iklib reader fun</a></li>
<li><a href="#index-get_002dchar_002dand_002dtrack_002dtextual_002dposition-224"><code>get-char-and-track-textual-position</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-getenv-345"><code>getenv</code></a>: <a href="#posix-env">posix env</a></li>
<li><a href="#index-getpid-291"><code>getpid</code></a>: <a href="#posix-pid">posix pid</a></li>
<li><a href="#index-getppid-292"><code>getppid</code></a>: <a href="#posix-pid">posix pid</a></li>
<li><a href="#index-getprop-130"><code>getprop</code></a>: <a href="#iklib-symbols-plists">iklib symbols plists</a></li>
<li><a href="#index-guarded_002dstart-541"><code>guarded-start</code></a>: <a href="#debug-int-intro">debug int intro</a></li>
<li><a href="#index-i_002fo_002dagain_002derror_003f-20"><code>i/o-again-error?</code></a>: <a href="#iklib-conditions-eagain">iklib conditions eagain</a></li>
<li><a href="#index-ik_005ferrno_005fnum_005fto_005fcode-349"><code>ik_errno_num_to_code</code></a>: <a href="#posix-int-errno">posix int errno</a></li>
<li><a href="#index-ik_005ferrno_005fto_005fcode-348"><code>ik_errno_to_code</code></a>: <a href="#posix-int-errno">posix int errno</a></li>
<li><a href="#index-ik_005fsafe_005falloc-526"><code>ik_safe_alloc</code></a>: <a href="#objects-int-alloc">objects int alloc</a></li>
<li><a href="#index-ik_005fsystem-392"><code>ik_system</code></a>: <a href="#posix-int-exec">posix int exec</a></li>
<li><a href="#index-ikrt_005faccept-365"><code>ikrt_accept</code></a>: <a href="#posix-int-fd-net">posix int fd net</a></li>
<li><a href="#index-ikrt_005faccess-371"><code>ikrt_access</code></a>: <a href="#posix-int-files-stat">posix int files stat</a></li>
<li><a href="#index-ikrt_005fchdir-383"><code>ikrt_chdir</code></a>: <a href="#posix-int-files-dir">posix int files dir</a></li>
<li><a href="#index-ikrt_005fchmod-370"><code>ikrt_chmod</code></a>: <a href="#posix-int-files-stat">posix int files stat</a></li>
<li><a href="#index-ikrt_005fclose_005ffd-353"><code>ikrt_close_fd</code></a>: <a href="#posix-int-fd-open">posix int fd open</a></li>
<li><a href="#index-ikrt_005fclosedir-379"><code>ikrt_closedir</code></a>: <a href="#posix-int-files-dir">posix int files dir</a></li>
<li><a href="#index-ikrt_005fcurrent_005ftime-393"><code>ikrt_current_time</code></a>: <a href="#posix-int-time">posix int time</a></li>
<li><a href="#index-ikrt_005fdelete_005ffile-386"><code>ikrt_delete_file</code></a>: <a href="#posix-int-files-link">posix int files link</a></li>
<li><a href="#index-ikrt_005fdirectory_005flist-377"><code>ikrt_directory_list</code></a>: <a href="#posix-int-files-dir">posix int files dir</a></li>
<li><a href="#index-ikrt_005fenviron-399"><code>ikrt_environ</code></a>: <a href="#posix-int-env">posix int env</a></li>
<li><a href="#index-ikrt_005ferrno_005fcode_005fto_005fname-350"><code>ikrt_errno_code_to_name</code></a>: <a href="#posix-int-errno">posix int errno</a></li>
<li><a href="#index-ikrt_005fexit-390"><code>ikrt_exit</code></a>: <a href="#posix-int-exec">posix int exec</a></li>
<li><a href="#index-ikrt_005ffile_005fctime-376"><code>ikrt_file_ctime</code></a>: <a href="#posix-int-files-stat">posix int files stat</a></li>
<li><a href="#index-ikrt_005ffile_005fctime2-374"><code>ikrt_file_ctime2</code></a>: <a href="#posix-int-files-stat">posix int files stat</a></li>
<li><a href="#index-ikrt_005ffile_005fmtime-375"><code>ikrt_file_mtime</code></a>: <a href="#posix-int-files-stat">posix int files stat</a></li>
<li><a href="#index-ikrt_005ffile_005fmtime2-373"><code>ikrt_file_mtime2</code></a>: <a href="#posix-int-files-stat">posix int files stat</a></li>
<li><a href="#index-ikrt_005ffile_005fsize-372"><code>ikrt_file_size</code></a>: <a href="#posix-int-files-stat">posix int files stat</a></li>
<li><a href="#index-ikrt_005ffork-391"><code>ikrt_fork</code></a>: <a href="#posix-int-exec">posix int exec</a></li>
<li><a href="#index-ikrt_005fgetcwd-384"><code>ikrt_getcwd</code></a>: <a href="#posix-int-files-dir">posix int files dir</a></li>
<li><a href="#index-ikrt_005fgetenv-396"><code>ikrt_getenv</code></a>: <a href="#posix-int-env">posix int env</a></li>
<li><a href="#index-ikrt_005fgetpid-367"><code>ikrt_getpid</code></a>: <a href="#posix-int-pid">posix int pid</a></li>
<li><a href="#index-ikrt_005fgetppid-368"><code>ikrt_getppid</code></a>: <a href="#posix-int-pid">posix int pid</a></li>
<li><a href="#index-ikrt_005fgmt_005foffset-394"><code>ikrt_gmt_offset</code></a>: <a href="#posix-int-time">posix int time</a></li>
<li><a href="#index-ikrt_005flast_005ferrno-352"><code>ikrt_last_errno</code></a>: <a href="#posix-int-errno">posix int errno</a></li>
<li><a href="#index-ikrt_005flink-385"><code>ikrt_link</code></a>: <a href="#posix-int-files-link">posix int files link</a></li>
<li><a href="#index-ikrt_005flisten-364"><code>ikrt_listen</code></a>: <a href="#posix-int-fd-net">posix int fd net</a></li>
<li><a href="#index-ikrt_005fmake_005ffd_005fnonblocking-361"><code>ikrt_make_fd_nonblocking</code></a>: <a href="#posix-int-fd-event">posix int fd event</a></li>
<li><a href="#index-ikrt_005fmkdir-381"><code>ikrt_mkdir</code></a>: <a href="#posix-int-files-dir">posix int files dir</a></li>
<li><a href="#index-ikrt_005fnanosleep-395"><code>ikrt_nanosleep</code></a>: <a href="#posix-int-time">posix int time</a></li>
<li><a href="#index-ikrt_005fopen_005finput_005ffd-354"><code>ikrt_open_input_fd</code></a>: <a href="#posix-int-fd-open">posix int fd open</a></li>
<li><a href="#index-ikrt_005fopen_005finput_005foutput_005ffd-356"><code>ikrt_open_input_output_fd</code></a>: <a href="#posix-int-fd-open">posix int fd open</a></li>
<li><a href="#index-ikrt_005fopen_005foutput_005ffd-355"><code>ikrt_open_output_fd</code></a>: <a href="#posix-int-fd-open">posix int fd open</a></li>
<li><a href="#index-ikrt_005fopendir-378"><code>ikrt_opendir</code></a>: <a href="#posix-int-files-dir">posix int files dir</a></li>
<li><a href="#index-ikrt_005fread_005ffd-358"><code>ikrt_read_fd</code></a>: <a href="#posix-int-fd-rw">posix int fd rw</a></li>
<li><a href="#index-ikrt_005freaddir-380"><code>ikrt_readdir</code></a>: <a href="#posix-int-files-dir">posix int files dir</a></li>
<li><a href="#index-ikrt_005frealpath-388"><code>ikrt_realpath</code></a>: <a href="#posix-int-files-link">posix int files link</a></li>
<li><a href="#index-ikrt_005frename_005ffile-389"><code>ikrt_rename_file</code></a>: <a href="#posix-int-files-link">posix int files link</a></li>
<li><a href="#index-ikrt_005frmdir-382"><code>ikrt_rmdir</code></a>: <a href="#posix-int-files-dir">posix int files dir</a></li>
<li><a href="#index-ikrt_005fselect-360"><code>ikrt_select</code></a>: <a href="#posix-int-fd-event">posix int fd event</a></li>
<li><a href="#index-ikrt_005fset_005fposition-357"><code>ikrt_set_position</code></a>: <a href="#posix-int-fd-seek">posix int fd seek</a></li>
<li><a href="#index-ikrt_005fsetenv-397"><code>ikrt_setenv</code></a>: <a href="#posix-int-env">posix int env</a></li>
<li><a href="#index-ikrt_005fshutdown-366"><code>ikrt_shutdown</code></a>: <a href="#posix-int-fd-net">posix int fd net</a></li>
<li><a href="#index-ikrt_005fstat-369"><code>ikrt_stat</code></a>: <a href="#posix-int-files-stat">posix int files stat</a></li>
<li><a href="#index-ikrt_005fstrerror-351"><code>ikrt_strerror</code></a>: <a href="#posix-int-errno">posix int errno</a></li>
<li><a href="#index-ikrt_005fsymlink-387"><code>ikrt_symlink</code></a>: <a href="#posix-int-files-link">posix int files link</a></li>
<li><a href="#index-ikrt_005ftcp_005fconnect-362"><code>ikrt_tcp_connect</code></a>: <a href="#posix-int-fd-net">posix int fd net</a></li>
<li><a href="#index-ikrt_005fucp_005fconnect-363"><code>ikrt_ucp_connect</code></a>: <a href="#posix-int-fd-net">posix int fd net</a></li>
<li><a href="#index-ikrt_005funsetenv-398"><code>ikrt_unsetenv</code></a>: <a href="#posix-int-env">posix int env</a></li>
<li><a href="#index-ikrt_005fwrite_005ffd-359"><code>ikrt_write_fd</code></a>: <a href="#posix-int-fd-rw">posix int fd rw</a></li>
<li><a href="#index-import-139"><code>import</code></a>: <a href="#iklib-import">iklib import</a></li>
<li><a href="#index-input_002dfile_002dbuffer_002dsize-230"><code>input-file-buffer-size</code></a>: <a href="#iklib-io-buffer">iklib io buffer</a></li>
<li><a href="#index-input_002dsocket_002dbuffer_002dsize-252"><code>input-socket-buffer-size</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-input_002dsocket_002dbuffer_002dsize-236"><code>input-socket-buffer-size</code></a>: <a href="#iklib-io-buffer">iklib io buffer</a></li>
<li><a href="#index-input_002foutput_002dfile_002dbuffer_002dsize-234"><code>input/output-file-buffer-size</code></a>: <a href="#iklib-io-buffer">iklib io buffer</a></li>
<li><a href="#index-integer_002d_003epointer-258"><code>integer-&gt;pointer</code></a>: <a href="#iklib-foreign-memops-pointer">iklib foreign memops pointer</a></li>
<li><a href="#index-interaction_002denvironment-53"><code>interaction-environment</code></a>: <a href="#iklib-environment">iklib environment</a></li>
<li><a href="#index-is_005ffixnum-529"><code>is_fixnum</code></a>: <a href="#objects-int-fixnum">objects int fixnum</a></li>
<li><a href="#index-kill-327"><code>kill</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-latin1_002d_003estring-122"><code>latin1-&gt;string</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-load-137"><code>load</code></a>: <a href="#iklib-load">iklib load</a></li>
<li><a href="#index-lookahead_002dtwo_002du8-214"><code>lookahead-two-u8</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-make_002dc_002dcallback-289"><code>make-c-callback</code></a>: <a href="#iklib-foreign-call-back">iklib foreign call back</a></li>
<li><a href="#index-make_002dc_002dcallout-288"><code>make-c-callout</code></a>: <a href="#iklib-foreign-call-out-api">iklib foreign call out api</a></li>
<li><a href="#index-make_002ddirectory-336"><code>make-directory</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-make_002dguardian-199"><code>make-guardian</code></a>: <a href="#iklib-guardians-api">iklib guardians api</a></li>
<li><a href="#index-make_002di_002fo_002deagain-19"><code>make-i/o-eagain</code></a>: <a href="#iklib-conditions-eagain">iklib conditions eagain</a></li>
<li><a href="#index-make_002dparameter-142"><code>make-parameter</code></a>: <a href="#iklib-parameters">iklib parameters</a></li>
<li><a href="#index-make_002dsource_002dposition_002dcondition-14"><code>make-source-position-condition</code></a>: <a href="#iklib-conditions-spos">iklib conditions spos</a></li>
<li><a href="#index-make_002dstruct_002dtype-58"><code>make-struct-type</code></a>: <a href="#iklib-structs-rtd">iklib structs rtd</a></li>
<li><a href="#index-make_002dsymbolic_002dlink-335"><code>make-symbolic-link</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-make_002dtraced_002dprocedure-178"><code>make-traced-procedure</code></a>: <a href="#iklib-tracing">iklib tracing</a></li>
<li><a href="#index-malloc-255"><code>malloc</code></a>: <a href="#iklib-foreign-memops-alloc">iklib foreign memops alloc</a></li>
<li><a href="#index-module-140"><code>module</code></a>: <a href="#iklib-modules-api">iklib modules api</a></li>
<li><a href="#index-nanosleep-347"><code>nanosleep</code></a>: <a href="#posix-misc">posix misc</a></li>
<li><a href="#index-native_002dtranscoder-203"><code>native-transcoder</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-new_002dcafe-56"><code>new-cafe</code></a>: <a href="#iklib-cafe">iklib cafe</a></li>
<li><a href="#index-new_002dinteraction_002denvironment-54"><code>new-interaction-environment</code></a>: <a href="#iklib-environment">iklib environment</a></li>
<li><a href="#index-null_005fobject-523"><code>null_object</code></a>: <a href="#objects-int-const">objects int const</a></li>
<li><a href="#index-off_005fbytevector_005fdata-534"><code>off_bytevector_data</code></a>: <a href="#objects-int-bytevector">objects int bytevector</a></li>
<li><a href="#index-off_005fbytevector_005flength-533"><code>off_bytevector_length</code></a>: <a href="#objects-int-bytevector">objects int bytevector</a></li>
<li><a href="#index-off_005fvector_005fdata-539"><code>off_vector_data</code></a>: <a href="#objects-int-vector">objects int vector</a></li>
<li><a href="#index-off_005fvector_005flength-538"><code>off_vector_length</code></a>: <a href="#objects-int-vector">objects int vector</a></li>
<li><a href="#index-open_002ddirectory_002dstream-340"><code>open-directory-stream</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-open_002dinput_002dfile-204"><code>open-input-file</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-open_002doutput_002dfile-207"><code>open-output-file</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-open_002dstring_002dinput_002dport-218"><code>open-string-input-port</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-open_002dstring_002dinput_002dport_002fid-220"><code>open-string-input-port/id</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-open_002dstring_002doutput_002dport-222"><code>open-string-output-port</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-output_002dfile_002dbuffer_002dsize-232"><code>output-file-buffer-size</code></a>: <a href="#iklib-io-buffer">iklib io buffer</a></li>
<li><a href="#index-output_002dsocket_002dbuffer_002dsize-253"><code>output-socket-buffer-size</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-output_002dsocket_002dbuffer_002dsize-238"><code>output-socket-buffer-size</code></a>: <a href="#iklib-io-buffer">iklib io buffer</a></li>
<li><a href="#index-parameterize-144"><code>parameterize</code></a>: <a href="#iklib-parameters">iklib parameters</a></li>
<li><a href="#index-pointer_002d_003einteger-257"><code>pointer-&gt;integer</code></a>: <a href="#iklib-foreign-memops-pointer">iklib foreign memops pointer</a></li>
<li><a href="#index-pointer_002dref_002dc_002ddouble-280"><code>pointer-ref-c-double</code></a>: <a href="#iklib-foreign-memops-peek">iklib foreign memops peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dfloat-279"><code>pointer-ref-c-float</code></a>: <a href="#iklib-foreign-memops-peek">iklib foreign memops peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dpointer-281"><code>pointer-ref-c-pointer</code></a>: <a href="#iklib-foreign-memops-peek">iklib foreign memops peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dsigned_002dchar-269"><code>pointer-ref-c-signed-char</code></a>: <a href="#iklib-foreign-memops-peek">iklib foreign memops peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dsigned_002dint-273"><code>pointer-ref-c-signed-int</code></a>: <a href="#iklib-foreign-memops-peek">iklib foreign memops peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dsigned_002dlong-275"><code>pointer-ref-c-signed-long</code></a>: <a href="#iklib-foreign-memops-peek">iklib foreign memops peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dsigned_002dlong_002dlong-277"><code>pointer-ref-c-signed-long-long</code></a>: <a href="#iklib-foreign-memops-peek">iklib foreign memops peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dsigned_002dshort-271"><code>pointer-ref-c-signed-short</code></a>: <a href="#iklib-foreign-memops-peek">iklib foreign memops peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dunsigned_002dchar-270"><code>pointer-ref-c-unsigned-char</code></a>: <a href="#iklib-foreign-memops-peek">iklib foreign memops peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dunsigned_002dint-274"><code>pointer-ref-c-unsigned-int</code></a>: <a href="#iklib-foreign-memops-peek">iklib foreign memops peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dunsigned_002dlong-276"><code>pointer-ref-c-unsigned-long</code></a>: <a href="#iklib-foreign-memops-peek">iklib foreign memops peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dunsigned_002dlong_002dlong-278"><code>pointer-ref-c-unsigned-long-long</code></a>: <a href="#iklib-foreign-memops-peek">iklib foreign memops peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dunsigned_002dshort-272"><code>pointer-ref-c-unsigned-short</code></a>: <a href="#iklib-foreign-memops-peek">iklib foreign memops peek</a></li>
<li><a href="#index-pointer_002dset_002dc_002dchar_0021-261"><code>pointer-set-c-char!</code></a>: <a href="#iklib-foreign-memops-poke">iklib foreign memops poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002ddouble_0021-267"><code>pointer-set-c-double!</code></a>: <a href="#iklib-foreign-memops-poke">iklib foreign memops poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dfloat_0021-266"><code>pointer-set-c-float!</code></a>: <a href="#iklib-foreign-memops-poke">iklib foreign memops poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dint_0021-263"><code>pointer-set-c-int!</code></a>: <a href="#iklib-foreign-memops-poke">iklib foreign memops poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dlong_0021-264"><code>pointer-set-c-long!</code></a>: <a href="#iklib-foreign-memops-poke">iklib foreign memops poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dlong_002dlong_0021-265"><code>pointer-set-c-long-long!</code></a>: <a href="#iklib-foreign-memops-poke">iklib foreign memops poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dpointer_0021-268"><code>pointer-set-c-pointer!</code></a>: <a href="#iklib-foreign-memops-poke">iklib foreign memops poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dshort_0021-262"><code>pointer-set-c-short!</code></a>: <a href="#iklib-foreign-memops-poke">iklib foreign memops poke</a></li>
<li><a href="#index-pointer_002dsize-260"><code>pointer-size</code></a>: <a href="#iklib-foreign-memops-pointer">iklib foreign memops pointer</a></li>
<li><a href="#index-pointer_003f-259"><code>pointer?</code></a>: <a href="#iklib-foreign-memops-pointer">iklib foreign memops pointer</a></li>
<li><a href="#index-port_002did-254"><code>port-id</code></a>: <a href="#iklib-io-misc">iklib io misc</a></li>
<li><a href="#index-port_002dmode-23"><code>port-mode</code></a>: <a href="#iklib-reader-mode">iklib reader mode</a></li>
<li><a href="#index-port_002dtextual_002dposition-225"><code>port-textual-position</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-port_003f-498"><code>port?</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-post_002dgc_002dhooks-200"><code>post-gc-hooks</code></a>: <a href="#iklib-guardians-api">iklib guardians api</a></li>
<li><a href="#index-pretty_002dprint-154"><code>pretty-print</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-pretty_002dwidth-156"><code>pretty-width</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-print_002dgensym-167"><code>print-gensym</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-print_002dgraph-161"><code>print-graph</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-print_002dunicode-164"><code>print-unicode</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-printf-159"><code>printf</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-process-240"><code>process</code></a>: <a href="#iklib-io-process">iklib io process</a></li>
<li><a href="#index-process_002dnonblocking-241"><code>process-nonblocking</code></a>: <a href="#iklib-io-process">iklib io process</a></li>
<li><a href="#index-property_002dlist-132"><code>property-list</code></a>: <a href="#iklib-symbols-plists">iklib symbols plists</a></li>
<li><a href="#index-putprop-129"><code>putprop</code></a>: <a href="#iklib-symbols-plists">iklib symbols plists</a></li>
<li><a href="#index-ratnum_003f-134"><code>ratnum?</code></a>: <a href="#iklib-numerics-preds">iklib numerics preds</a></li>
<li><a href="#index-read_002ddirectory_002dstream-342"><code>read-directory-stream</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-ref-520"><code>ref</code></a>: <a href="#objects-int-refs">objects int refs</a></li>
<li><a href="#index-register_002dcallback-251"><code>register-callback</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-remprop-131"><code>remprop</code></a>: <a href="#iklib-symbols-plists">iklib symbols plists</a></li>
<li><a href="#index-s16b_002dlist_002d_003ebytevector-85"><code>s16b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s16l_002dlist_002d_003ebytevector-84"><code>s16l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s16n_002dlist_002d_003ebytevector-86"><code>s16n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s32b_002dlist_002d_003ebytevector-97"><code>s32b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s32l_002dlist_002d_003ebytevector-96"><code>s32l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s32n_002dlist_002d_003ebytevector-98"><code>s32n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s64b_002dlist_002d_003ebytevector-109"><code>s64b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s64l_002dlist_002d_003ebytevector-108"><code>s64l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s64n_002dlist_002d_003ebytevector-110"><code>s64n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s8_002dlist_002d_003ebytevector-83"><code>s8-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-set_002dport_002dmode_0021-24"><code>set-port-mode!</code></a>: <a href="#iklib-reader-mode">iklib reader mode</a></li>
<li><a href="#index-set_002drtd_002dprinter_0021-63"><code>set-rtd-printer!</code></a>: <a href="#iklib-structs-rtd">iklib structs rtd</a></li>
<li><a href="#index-source_002dposition_002dcharacter-17"><code>source-position-character</code></a>: <a href="#iklib-conditions-spos">iklib conditions spos</a></li>
<li><a href="#index-source_002dposition_002dcondition_003f-15"><code>source-position-condition?</code></a>: <a href="#iklib-conditions-spos">iklib conditions spos</a></li>
<li><a href="#index-source_002dposition_002dport_002did-16"><code>source-position-port-id</code></a>: <a href="#iklib-conditions-spos">iklib conditions spos</a></li>
<li><a href="#index-stats_002dbytes_002dmajor-197"><code>stats-bytes-major</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dbytes_002dminor-196"><code>stats-bytes-minor</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dcollection_002did-189"><code>stats-collection-id</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dgc_002dreal_002dsecs-194"><code>stats-gc-real-secs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dgc_002dreal_002dusecs-195"><code>stats-gc-real-usecs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dgc_002dsys_002dsecs-192"><code>stats-gc-sys-secs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dgc_002dsys_002dusecs-193"><code>stats-gc-sys-usecs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dgc_002duser_002dsecs-190"><code>stats-gc-user-secs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dgc_002duser_002dusecs-191"><code>stats-gc-user-usecs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dreal_002dsecs-187"><code>stats-real-secs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dreal_002dusecs-188"><code>stats-real-usecs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dsys_002dsecs-185"><code>stats-sys-secs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dsys_002dusecs-186"><code>stats-sys-usecs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002duser_002dsecs-183"><code>stats-user-secs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002duser_002dusecs-184"><code>stats-user-usecs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_003f-182"><code>stats?</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-strerror-346"><code>strerror</code></a>: <a href="#posix-misc">posix misc</a></li>
<li><a href="#index-string_002d_003efilename_002dfunc-201"><code>string-&gt;filename-func</code></a>: <a href="#iklib-io-filename">iklib io filename</a></li>
<li><a href="#index-string_002d_003elatin1-121"><code>string-&gt;latin1</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-string_002d_003eutf16be-124"><code>string-&gt;utf16be</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-string_002d_003eutf16le-123"><code>string-&gt;utf16le</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-string_002d_003eutf16n-125"><code>string-&gt;utf16n</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-string_002dport_002dbuffer_002dsize-228"><code>string-port-buffer-size</code></a>: <a href="#iklib-io-buffer">iklib io buffer</a></li>
<li><a href="#index-struct_002dconstructor-64"><code>struct-constructor</code></a>: <a href="#iklib-structs-using">iklib structs using</a></li>
<li><a href="#index-struct_002dfield_002daccessor-66"><code>struct-field-accessor</code></a>: <a href="#iklib-structs-using">iklib structs using</a></li>
<li><a href="#index-struct_002dfield_002dmutator-67"><code>struct-field-mutator</code></a>: <a href="#iklib-structs-using">iklib structs using</a></li>
<li><a href="#index-struct_002dlength-71"><code>struct-length</code></a>: <a href="#iklib-structs-inspect">iklib structs inspect</a></li>
<li><a href="#index-struct_002dname-72"><code>struct-name</code></a>: <a href="#iklib-structs-inspect">iklib structs inspect</a></li>
<li><a href="#index-struct_002dpredicate-65"><code>struct-predicate</code></a>: <a href="#iklib-structs-using">iklib structs using</a></li>
<li><a href="#index-struct_002dprinter-73"><code>struct-printer</code></a>: <a href="#iklib-structs-inspect">iklib structs inspect</a></li>
<li><a href="#index-struct_002dref-74"><code>struct-ref</code></a>: <a href="#iklib-structs-inspect">iklib structs inspect</a></li>
<li><a href="#index-struct_002drtd-70"><code>struct-rtd</code></a>: <a href="#iklib-structs-inspect">iklib structs inspect</a></li>
<li><a href="#index-struct_002dset_0021-75"><code>struct-set!</code></a>: <a href="#iklib-structs-inspect">iklib structs inspect</a></li>
<li><a href="#index-struct_002dtype_002dfield_002dnames-62"><code>struct-type-field-names</code></a>: <a href="#iklib-structs-rtd">iklib structs rtd</a></li>
<li><a href="#index-struct_002dtype_002dname-60"><code>struct-type-name</code></a>: <a href="#iklib-structs-rtd">iklib structs rtd</a></li>
<li><a href="#index-struct_002dtype_002dsymbol-61"><code>struct-type-symbol</code></a>: <a href="#iklib-structs-rtd">iklib structs rtd</a></li>
<li><a href="#index-struct_003f-68"><code>struct?</code></a>: <a href="#iklib-structs-inspect">iklib structs inspect</a></li>
<li><a href="#index-subbytevector_002ds8-79"><code>subbytevector-s8</code></a>: <a href="#iklib-bytevectors-sub">iklib bytevectors sub</a></li>
<li><a href="#index-subbytevector_002ds8_002fcount-81"><code>subbytevector-s8/count</code></a>: <a href="#iklib-bytevectors-sub">iklib bytevectors sub</a></li>
<li><a href="#index-subbytevector_002du8-76"><code>subbytevector-u8</code></a>: <a href="#iklib-bytevectors-sub">iklib bytevectors sub</a></li>
<li><a href="#index-subbytevector_002du8_002fcount-78"><code>subbytevector-u8/count</code></a>: <a href="#iklib-bytevectors-sub">iklib bytevectors sub</a></li>
<li><a href="#index-system-294"><code>system</code></a>: <a href="#posix-process">posix process</a></li>
<li><a href="#index-tagof-519"><code>tagof</code></a>: <a href="#objects-int-refs">objects int refs</a></li>
<li><a href="#index-tcp_002dconnect-242"><code>tcp-connect</code></a>: <a href="#iklib-io-socket-client">iklib io socket client</a></li>
<li><a href="#index-tcp_002dconnect_002dnonblocking-244"><code>tcp-connect-nonblocking</code></a>: <a href="#iklib-io-socket-client">iklib io socket client</a></li>
<li><a href="#index-tcp_002dserver_002dsocket-246"><code>tcp-server-socket</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-tcp_002dserver_002dsocket_002dnonblocking-247"><code>tcp-server-socket-nonblocking</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-time-179"><code>time</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-time_002dand_002dgather-181"><code>time-and-gather</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-time_002dit-180"><code>time-it</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-top_002dlevel_002dvalue-411"><code>top-level-value</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-trace_002ddefine-175"><code>trace-define</code></a>: <a href="#iklib-tracing">iklib tracing</a></li>
<li><a href="#index-trace_002dlambda-177"><code>trace-lambda</code></a>: <a href="#iklib-tracing">iklib tracing</a></li>
<li><a href="#index-true_005fobject-522"><code>true_object</code></a>: <a href="#objects-int-const">objects int const</a></li>
<li><a href="#index-u16b_002dlist_002d_003ebytevector-88"><code>u16b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u16l_002dlist_002d_003ebytevector-87"><code>u16l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u16n_002dlist_002d_003ebytevector-89"><code>u16n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u32b_002dlist_002d_003ebytevector-100"><code>u32b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u32l_002dlist_002d_003ebytevector-99"><code>u32l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u32n_002dlist_002d_003ebytevector-101"><code>u32n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u64b_002dlist_002d_003ebytevector-112"><code>u64b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u64l_002dlist_002d_003ebytevector-111"><code>u64l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u64n_002dlist_002d_003ebytevector-113"><code>u64n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-udp_002dconnect-243"><code>udp-connect</code></a>: <a href="#iklib-io-socket-client">iklib io socket client</a></li>
<li><a href="#index-udp_002dconnect_002dnonblocking-245"><code>udp-connect-nonblocking</code></a>: <a href="#iklib-io-socket-client">iklib io socket client</a></li>
<li><a href="#index-unfix-528"><code>unfix</code></a>: <a href="#objects-int-fixnum">objects int fixnum</a></li>
<li><a href="#index-utf_002d16be_002dcodec-211"><code>utf-16be-codec</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-utf_002d16le_002dcodec-210"><code>utf-16le-codec</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-utf_002d16n_002dcodec-212"><code>utf-16n-codec</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-utf_002dbom_002dcodec-213"><code>utf-bom-codec</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-utf16be_002d_003estring-127"><code>utf16be-&gt;string</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-utf16le_002d_003estring-126"><code>utf16le-&gt;string</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-utf16n_002d_003estring-128"><code>utf16n-&gt;string</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-vector_005ftag-535"><code>vector_tag</code></a>: <a href="#objects-int-vector">objects int vector</a></li>
<li><a href="#index-void-290"><code>void</code></a>: <a href="#iklib-misc">iklib misc</a></li>
<li><a href="#index-void_005fobject-524"><code>void_object</code></a>: <a href="#objects-int-const">objects int const</a></li>
<li><a href="#index-waitpid-295"><code>waitpid</code></a>: <a href="#posix-waitpid">posix waitpid</a></li>
<li><a href="#index-with_002dinput_002dfrom_002dfile-205"><code>with-input-from-file</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-with_002doutput_002dto_002dfile-208"><code>with-output-to-file</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-wstatus_002dexit_002dstatus-297"><code>wstatus-exit-status</code></a>: <a href="#posix-waitpid">posix waitpid</a></li>
<li><a href="#index-wstatus_002dpid-296"><code>wstatus-pid</code></a>: <a href="#posix-waitpid">posix waitpid</a></li>
<li><a href="#index-wstatus_002dreceived_002dsignal-298"><code>wstatus-received-signal</code></a>: <a href="#posix-waitpid">posix waitpid</a></li>
<li><a href="#index-g_t_007c_0040var_007bsymbol_007d_007c-44"><code>|</code><var>symbol</var><code>|</code></a>: <a href="#iklib-reader-stx">iklib reader stx</a></li>
   </ul><div class="node">
<a name="variable-index"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#type-index">type index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#function-index">function index</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix H An entry for each variable.</h2>



<ul class="index-vr" compact>
   </ul><div class="node">
<a name="type-index"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#g_t_0028libffi_0029">(libffi)</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#variable-index">variable index</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix I An entry for each type.</h2>



<ul class="index-tp" compact>
<li><a href="#index-g_t_0026i_002fo_002deagain-18"><code>&amp;i/o-eagain</code></a>: <a href="#iklib-conditions-eagain">iklib conditions eagain</a></li>
<li><a href="#index-g_t_0026source_002dposition-13"><code>&amp;source-position</code></a>: <a href="#iklib-conditions-spos">iklib conditions spos</a></li>
<li><a href="#index-ikptr-518"><code>ikptr</code></a>: <a href="#objects-int-refs">objects int refs</a></li>
   </ul><div class="footnote">
<hr>
<a name="texinfo-footnotes-in-document"></a><h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> The <samp><span class="command">configure</span></samp> command shown here is very
imposing, and anyone can easily make mistakes.  In general, it's a good
idea to create a shell script that has the sequence of
<samp><span class="command">configure</span></samp> and <samp><span class="command">make</span></samp> commands needed to configure,
build, and install a package; this not only allows us to re&ndash;install
easily, but also gives us a concrete indication of what options we used
to build the software the last time.  Of course, we should put this
script somewhere other than in the actual Vicare software
directory!</p>

   <p class="footnote"><small>[<a name="fn-2" href="#fnd-2">2</a>]</small> Parameters are found in many Scheme
implementations such as Chez Scheme and MzScheme.</p>

   <p class="footnote"><small>[<a name="fn-3" href="#fnd-3">3</a>]</small> The big endian <acronym>BOM</acronym>
for <acronym>UTF</acronym>-16 is the sequence of bytes <code>#xFE #xFF</code>; the little
endian <acronym>BOM</acronym> for <acronym>UTF</acronym>-16 is the sequence of bytes <code>#xFF
#xFE</code>.</p>

   <hr></div>

</body></html>

