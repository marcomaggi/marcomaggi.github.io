<html lang="en">
<head>
<title>Vicare Scheme User's Guide</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Vicare Scheme User's Guide">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This document describes version 0.2d6 of Vicare Scheme, an
R6RS compliant native compiler for the Scheme language producing
single threaded programs running on Intel x86 32-bit processors, with
experimental support for 64-bit machines.  _Vicare_ is pronounced
the etruscan way.

The Vicarus Scheme package is distributed under the terms of the GNU
General Public License (GPL) and can be downloaded from:

            `http://github.com/marcomaggi/vicare/downloads'


the home page of the project is at:

              `http://marcomaggi.github.com/vicare.html'


development takes place at:

                `http://github.com/marcomaggi/vicare/'


Copyright (C) 2010-2012 by Marco Maggi.

Copyright (C) 2006-2010 by Abdulaziz Ghuloum.

This document is derived from the original Ikarus documentation by the
Vicare Scheme contributors.

     This program is free software: you can redistribute it and/or
     modify it under the terms of the GNU General Public License
     version 3 as published by the Free Software Foundation.

     This program is distributed in the hope that it will be useful, but
     WITHOUT ANY WARRANTY; without even the implied warranty of
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
     General Public License for more details.

     You should have received a copy of the GNU General Public License
     along with this program.  If not, see
     `http://www.gnu.org/licenses/'.

Trademarks used herein are the property of their respective owners.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<h1 class="settitle">Vicare Scheme User's Guide</h1>
   <div class="shortcontents">
<h2>Short Contents</h2>
<ul>
<li><a href="#toc_Top">Vicare Scheme User's Guide</a></li>
<li><a href="#toc_overview">1 Overview of Vicare Scheme</a></li>
<li><a href="#toc_using">2 Using Vicare</a></li>
<li><a href="#toc_iklib">3 Extensions library</a></li>
<li><a href="#toc_ffi">4 Foreign functions interface</a></li>
<li><a href="#toc_posix">5 The <acronym>POSIX</acronym> interface</a></li>
<li><a href="#toc_glibc">6 The <acronym>GNU</acronym> C Library interface</a></li>
<li><a href="#toc_linux">7 The <acronym>GNU</acronym>+Linux interface</a></li>
<li><a href="#toc_syslib">8 Low level, fast, unsafe operations</a></li>
<li><a href="#toc_capi">9 C language programming interface</a></li>
<li><a href="#toc_gcc">10 A toy library interface to <acronym>GCC</acronym></a></li>
<li><a href="#toc_objects">11 Built in Scheme objects</a></li>
<li><a href="#toc_debug-int">12 Internals: debug mode</a></li>
<li><a href="#toc_compiler">13 Wild notes on the compiler internals</a></li>
<li><a href="#toc_missing">Appendix A Missing Features</a></li>
<li><a href="#toc_building">Appendix B Building infrastructure</a></li>
<li><a href="#toc_credits">Appendix C Credits for this document</a></li>
<li><a href="#toc_unicode">Appendix D On Unicode and <acronym>UTF</acronym> encodings</a></li>
<li><a href="#toc_fasl">Appendix E Handling <acronym>FASL</acronym> files</a></li>
<li><a href="#toc_cre2">Appendix F Binding to the library <acronym>CRE2</acronym></a></li>
<li><a href="#toc_package-license">Appendix G <acronym>GNU</acronym> General Public License</a></li>
<li><a href="#toc_references">Appendix H Bibliography and references</a></li>
<li><a href="#toc_concept-index">Appendix I An entry for each concept</a></li>
<li><a href="#toc_function-index">Appendix J An entry for each function</a></li>
<li><a href="#toc_variable-index">Appendix K An entry for each variable</a></li>
<li><a href="#toc_type-index">Appendix L An entry for each type</a></li>
</ul>
</div>



   <div class="contents">
<h2>Table of Contents</h2>
<ul>
<li><a name="toc_Top" href="#Top">Vicare Scheme User's Guide</a>
<li><a name="toc_overview" href="#overview">1 Overview of Vicare Scheme</a>
<ul>
<li><a href="#overview-original">1.1 Original Ikarus Scheme</a>
<li><a href="#overview-tech">1.2 Technology overview</a>
<li><a href="#overview-resources">1.3 Resources</a>
<li><a href="#overview-system">1.4 System requirements</a>
<ul>
<li><a href="#overview-system-hardware">1.4.1 Hardware requirements</a>
<li><a href="#overview-system-software">1.4.2 Software requirements</a>
</li></ul>
<li><a href="#overview-install">1.5 Installation and uninstallation</a>
<ul>
<li><a href="#overview-install-quick">1.5.1 Quick installation guide</a>
<li><a href="#overview-install-prerequisites">1.5.2 Installing the prerequisites</a>
<li><a href="#overview-install-details">1.5.3 Installation details</a>
<li><a href="#overview-install-uninstall">1.5.4 Uninstalling Vicare</a>
</li></ul>
<li><a href="#overview-restrictions">1.6 Implementation restrictions</a>
<li><a href="#overview-repl">1.7 The read-eval-print loop</a>
<li><a href="#overview-foreign">1.8 Built in interface to external libraries</a>
<ul>
<li><a href="#overview-foreign-cre2">1.8.1 Interface to <acronym>CRE2</acronym></a>
</li></ul>
</li></ul>
<li><a name="toc_using" href="#using">2 Using Vicare</a>
<ul>
<li><a href="#using-interactive">2.1 Interactive sessions</a>
<li><a href="#using-invoking">2.2 Command line arguments</a>
<li><a href="#using-script">2.3 Using <samp><span class="command">scheme-script</span></samp></a>
<li><a href="#using-libraries">2.4 <acronym>R6RS</acronym> libraries</a>
<ul>
<li><a href="#using-libraries-intro">2.4.1 Introduction to libraries</a>
<li><a href="#using-libraries-searching">2.4.2 How Vicare finds libraries</a>
<li><a href="#using-libraries-summary">2.4.3 Library search algorithm summary</a>
<li><a href="#using-libraries-examples">2.4.4 Examples of library usage</a>
</li></ul>
</li></ul>
<li><a name="toc_iklib" href="#iklib">3 Extensions library</a>
<ul>
<li><a href="#iklib-conditions">3.1 Additional condition types</a>
<ul>
<li><a href="#iklib-conditions-spos">3.1.1 Scheme source code position</a>
<li><a href="#iklib-conditions-eagain">3.1.2 Reporting <code>EAGAIN</code> exceptions</a>
</li></ul>
<li><a href="#iklib-reader">3.2 Reader</a>
<ul>
<li><a href="#iklib-reader-mode">3.2.1 Textual input port modes</a>
<li><a href="#iklib-reader-bv">3.2.2 Additional bytevector syntaxes</a>
<li><a href="#iklib-reader-stx">3.2.3 Miscellaneous additional syntaxes</a>
<li><a href="#iklib-reader-fun">3.2.4 Additional reader functions</a>
</li></ul>
<li><a href="#iklib-expander">3.3 Interface to the expander</a>
<li><a href="#iklib-shared">3.4 Shared structures graph notation</a>
<li><a href="#iklib-environment">3.5 Environments</a>
<li><a href="#iklib-cafe">3.6 Cafe</a>
<li><a href="#iklib-structs">3.7 Structures and type descriptors</a>
<ul>
<li><a href="#iklib-structs-rtd">3.7.1 Structure type descriptors</a>
<li><a href="#iklib-structs-using">3.7.2 Using data structures</a>
<li><a href="#iklib-structs-inspect">3.7.3 Inspecting data structures</a>
</li></ul>
<li><a href="#iklib-lists">3.8 Additional list functions</a>
<ul>
<li><a href="#iklib-lists-weak">3.8.1 Weak pairs</a>
</li></ul>
<li><a href="#iklib-bytevectors">3.9 Additional bytevector functions</a>
<ul>
<li><a href="#iklib-bytevectors-sub">3.9.1 Building subbytevectors</a>
<li><a href="#iklib-bytevectors-conv">3.9.2 Converting bytevectors</a>
<li><a href="#iklib-bytevectors-generic">3.9.3 Generic bytevectors operations</a>
</li></ul>
<li><a href="#iklib-strings">3.10 Additional string functions</a>
<li><a href="#iklib-vectors">3.11 Additional vector functions</a>
<li><a href="#iklib-symbols">3.12 Additional symbol functions</a>
<ul>
<li><a href="#iklib-symbols-value">3.12.1 Symbol values</a>
<li><a href="#iklib-symbols-plists">3.12.2 Property lists</a>
</li></ul>
<li><a href="#iklib-numerics">3.13 Additional functions on numbers</a>
<ul>
<li><a href="#iklib-numerics-preds">3.13.1 Additional numeric predicates</a>
<li><a href="#iklib-numerics-flonums">3.13.2 Additional flonum functions</a>
<li><a href="#iklib-numerics-math">3.13.3 Additional math functions</a>
</li></ul>
<li><a href="#iklib-load">3.14 Loading source files</a>
<li><a href="#iklib-import">3.15 Local library imports</a>
<li><a href="#iklib-modules">3.16 Local modules</a>
<ul>
<li><a href="#iklib-modules-examples">3.16.1 Usage example for modules</a>
<ul>
<li><a href="#iklib-modules-examples-anonymous">3.16.1.1 Anonymous modules</a>
<li><a href="#iklib-modules-examples-named">3.16.1.2 Named modules</a>
<li><a href="#iklib-modules-examples-utils">3.16.1.3 Utilities examples</a>
</li></ul>
<li><a href="#iklib-modules-api">3.16.2 Modules programming interface</a>
</li></ul>
<li><a href="#iklib-parameters">3.17 Parameters</a>
<li><a href="#iklib-gensym">3.18 Gensyms</a>
<ul>
<li><a href="#iklib-gensym">3.18.1 An example</a>
</li></ul>
<li><a href="#iklib-printing">3.19 Printing</a>
<li><a href="#iklib-tracing">3.20 Tracing</a>
<li><a href="#iklib-timing">3.21 Timing</a>
<li><a href="#iklib-guardians">3.22 Guardians and garbage collection</a>
<ul>
<li><a href="#iklib-guardians-examples">3.22.1 Usage examples for guardians</a>
<li><a href="#iklib-guardians-api">3.22.2 Guardians programming interface</a>
</li></ul>
<li><a href="#iklib-io">3.23 Input/output library</a>
<ul>
<li><a href="#iklib-io-filename">3.23.1 File pathname handling</a>
<li><a href="#iklib-io-codecs">3.23.2 Transcoders and additional codecs</a>
<li><a href="#iklib-io-binary">3.23.3 Additional binary port features</a>
<li><a href="#iklib-io-textual">3.23.4 Additional textual port features</a>
<li><a href="#iklib-io-buffer">3.23.5 Buffer size customisation</a>
<li><a href="#iklib-io-socket">3.23.6 Using network sockets</a>
<ul>
<li><a href="#iklib-io-socket-client">3.23.6.1 Establishing client network connections</a>
<li><a href="#iklib-io-socket-server">3.23.6.2 Opening server network services</a>
</li></ul>
<li><a href="#iklib-io-non_002dblock">3.23.7 Non&ndash;blocking mode for ports</a>
<li><a href="#iklib-io-misc">3.23.8 Miscellaneous port functions</a>
</li></ul>
<li><a href="#iklib-misc">3.24 Miscellaneous functions</a>
</li></ul>
<li><a name="toc_ffi" href="#ffi">4 Foreign functions interface</a>
<ul>
<li><a href="#ffi-libffi">4.1 Installing and using Libffi</a>
<li><a href="#ffi-memory">4.2 Memory management</a>
<ul>
<li><a href="#ffi-memory-intro">4.2.1 Introduction to managing memory</a>
<li><a href="#ffi-memory-pointer">4.2.2 Handling pointer values</a>
<li><a href="#ffi-memory-alloc">4.2.3 Allocating and freeing memory</a>
<li><a href="#ffi-memory-poke">4.2.4 Poking values</a>
<li><a href="#ffi-memory-peek">4.2.5 Peeking values</a>
<li><a href="#ffi-memory-ops">4.2.6 Memory operations</a>
</li></ul>
<li><a href="#ffi-cstrings">4.3 Raw C strings</a>
<li><a href="#ffi-dl">4.4 Accessing foreign objects from Scheme</a>
<li><a href="#ffi-call">4.5 Callouts and callbacks</a>
<ul>
<li><a href="#ffi-call-intro">4.5.1 Overview of <acronym>FFI</acronym> function calls</a>
<li><a href="#ffi-call-out">4.5.2 Calling out to foreign procedures</a>
<li><a href="#ffi-call-back">4.5.3 Calling back to Scheme</a>
<li><a href="#ffi-call-types">4.5.4 Specifying native types</a>
</li></ul>
<li><a href="#ffi-errno">4.6 Interface to <code>errno</code></a>
</li></ul>
<li><a name="toc_posix" href="#posix">5 The <acronym>POSIX</acronym> interface</a>
<ul>
<li><a href="#posix-conventions">5.1 Conventions about the <acronym>POSIX</acronym> <acronym>API</acronym></a>
<li><a href="#posix-conditions">5.2 Condition object types</a>
<li><a href="#posix-env">5.3 Interfacing with the execution environment</a>
<li><a href="#posix-pid">5.4 Process identifier functions</a>
<li><a href="#posix-process">5.5 Spawning processes and the like</a>
<li><a href="#posix-status">5.6 Process termination status.</a>
<li><a href="#posix-signal">5.7 Delivering signals to processes</a>
<li><a href="#posix-stat">5.8 File system inspection</a>
<li><a href="#posix-file">5.9 Interfacing with the file system</a>
<li><a href="#posix-link">5.10 Hard and symbolic links</a>
<li><a href="#posix-dir">5.11 File system directories</a>
<li><a href="#posix-fd">5.12 File descriptors</a>
<li><a href="#posix-socket">5.13 Network sockets</a>
<ul>
<li><a href="#posix-socket-addresses">5.13.1 Network address structures</a>
<ul>
<li><a href="#posix-socket-addresses-local">5.13.1.1 Local addresses</a>
<li><a href="#posix-socket-addresses-in">5.13.1.2 <acronym>IP</acronym>v4 addresses</a>
<li><a href="#posix-socket-addresses-in6">5.13.1.3 <acronym>IP</acronym>v6 addresses</a>
<li><a href="#posix-socket-addresses-rep">5.13.1.4 <acronym>ASCII</acronym> address representations</a>
<li><a href="#posix-socket-addresses-info">5.13.1.5 Host address informations</a>
</li></ul>
<li><a href="#posix-socket-hosts">5.13.2 Network hosts database</a>
<li><a href="#posix-socket-protocols">5.13.3 Network protocols database</a>
<li><a href="#posix-socket-services">5.13.4 Network services database</a>
<li><a href="#posix-socket-networks">5.13.5 Networks database</a>
<li><a href="#posix-socket-socket">5.13.6 Network sockets operations</a>
<li><a href="#posix-socket-misc">5.13.7 Error and miscellaneous functions</a>
<li><a href="#posix-socket-examples">5.13.8 Examples of clients and servers</a>
<li><a href="#posix-socket-oob">5.13.9 Notes on transmission of <acronym>OOB</acronym> data</a>
</li></ul>
<li><a href="#posix-users">5.14 Users and groups</a>
<li><a href="#posix-job">5.15 Job control</a>
<li><a href="#posix-time">5.16 Date and time</a>
<ul>
<li><a href="#posix-time-timeval">5.16.1 Data structure <code>struct-timeval</code></a>
<li><a href="#posix-time-timespec">5.16.2 Data structure <code>struct-timespec</code></a>
<li><a href="#posix-time-tms">5.16.3 Data structure <code>struct-tms</code></a>
<li><a href="#posix-time-tm">5.16.4 Data structure <code>struct-tm</code></a>
<li><a href="#posix-time-functions">5.16.5 Date and time functions</a>
</li></ul>
<li><a href="#posix-misc">5.17 Miscellaneous functions</a>
</li></ul>
<li><a name="toc_glibc" href="#glibc">6 The <acronym>GNU</acronym> C Library interface</a>
<ul>
<li><a href="#glibc-env">6.1 Operating system environment variables</a>
<li><a href="#glibc-dir">6.2 File system directories</a>
<li><a href="#glibc-temp">6.3 Temporary files and directories</a>
<li><a href="#glibc-sync">6.4 File system synchronisation</a>
<li><a href="#glibc-socket">6.5 Network sockets</a>
<li><a href="#glibc-math">6.6 Mathematics</a>
<li><a href="#glibc-random">6.7 Pseudo&ndash;random numbers</a>
<li><a href="#glibc-match">6.8 Pattern matching, globbing and regular expressions</a>
<li><a href="#glibc-word">6.9 Performing word expansion</a>
<li><a href="#glibc-config">6.10 System configuration</a>
<li><a href="#glibc-iconv">6.11 Generic character set conversion</a>
<ul>
<li><a href="#glibc-iconv-set">6.11.1 Encoding enumeration sets</a>
<li><a href="#glibc-iconv-conv">6.11.2 Conversion functions</a>
</li></ul>
</li></ul>
<li><a name="toc_linux" href="#linux">7 The <acronym>GNU</acronym>+Linux interface</a>
<ul>
<li><a href="#linux-env">7.1 Operating system environment variables</a>
<li><a href="#linux-status">7.2 Process termination status</a>
</li></ul>
<li><a name="toc_syslib" href="#syslib">8 Low level, fast, unsafe operations</a>
<ul>
<li><a href="#syslib-symbols">8.1 Low level symbol operations</a>
<li><a href="#syslib-fixnums">8.2 Low level fixnum operations</a>
<li><a href="#syslib-bignums">8.3 Low level bignum operations</a>
<li><a href="#syslib-flonums">8.4 Low level flonum operations</a>
<li><a href="#syslib-ratnums">8.5 Low level ratnum operations</a>
<li><a href="#syslib-compnums">8.6 Low level compnum operations</a>
<li><a href="#syslib-cflonums">8.7 Low level cflonum operations</a>
<li><a href="#syslib-chars">8.8 Low level character operations</a>
<li><a href="#syslib-pairs">8.9 Low level pair operations</a>
<li><a href="#syslib-structs">8.10 Low level structure operations</a>
<li><a href="#syslib-vectors">8.11 Low level vector operations</a>
<li><a href="#syslib-bytevectors">8.12 Low level bytevector operations</a>
<li><a href="#syslib-strings">8.13 Low level string operations</a>
<li><a href="#syslib-ports">8.14 Low level port structures</a>
<li><a href="#syslib-transcoders">8.15 Low level transcoder operations</a>
<li><a href="#syslib-pointers">8.16 Low level pointer operations</a>
</li></ul>
<li><a name="toc_capi" href="#capi">9 C language programming interface</a>
<ul>
<li><a href="#capi-ffi">9.1 C language level <acronym>FFI</acronym></a>
<ul>
<li><a href="#capi-ffi-accessors">9.1.1 Raw memory accessors</a>
<li><a href="#capi-ffi-mutators">9.1.2 Raw memory mutators</a>
</li></ul>
<li><a href="#capi-posix">9.2 C language level <acronym>POSIX</acronym> interface</a>
<ul>
<li><a href="#capi-posix-adding">9.2.1 How to add a <acronym>POSIX</acronym> primitive</a>
<li><a href="#capi-posix-errno">9.2.2 Handling <code>errno</code> codes</a>
<li><a href="#capi-posix-env">9.2.3 Accessing environment variables</a>
<li><a href="#capi-posix-port">9.2.4 File descriptors and Scheme ports</a>
<ul>
<li><a href="#capi-posix-port-open">9.2.4.1 Opening and closing file descriptors</a>
<li><a href="#capi-posix-port-seek">9.2.4.2 Handling file descriptor cursor</a>
<li><a href="#capi-posix-port-rw">9.2.4.3 Reading and writing</a>
<li><a href="#capi-posix-port-event">9.2.4.4 Handling file descriptor events</a>
<li><a href="#capi-posix-port-net">9.2.4.5 Handling sockets</a>
</li></ul>
<li><a href="#capi-posix-pid">9.2.5 Process identifier functions</a>
<li><a href="#capi-posix-process">9.2.6 Forking and executing processes</a>
<li><a href="#capi-posix-status">9.2.7 Process termination status</a>
<li><a href="#capi-posix-signals">9.2.8 Delivering interprocess signals</a>
<li><a href="#capi-posix-stat">9.2.9 File system inspection</a>
<li><a href="#capi-posix-file">9.2.10 File system interface</a>
<li><a href="#capi-posix-link">9.2.11 Hard and symbolic links</a>
<li><a href="#capi-posix-dir">9.2.12 File system directories</a>
<li><a href="#capi-posix-fd">9.2.13 File descriptors at low level</a>
<li><a href="#capi-posix-socket">9.2.14 Network sockets</a>
<li><a href="#capi-posix-users">9.2.15 Users and groups</a>
<li><a href="#capi-posix-job">9.2.16 Job control</a>
<li><a href="#capi-posix-time">9.2.17 Date and time</a>
</li></ul>
<li><a href="#capi-linux">9.3 C language level <acronym>GNU</acronym>+Linux interface</a>
<ul>
<li><a href="#capi-linux-status">9.3.1 Process termination status</a>
</li></ul>
<li><a href="#capi-glibc">9.4 C language level <acronym>GNU</acronym> C Library interface</a>
<ul>
<li><a href="#capi-glibc-env">9.4.1 Operating system environment variables</a>
<li><a href="#capi-glibc-dir">9.4.2 File system directories</a>
<li><a href="#capi-glibc-temp">9.4.3 Temporary files and directories</a>
<li><a href="#capi-glibc-sync">9.4.4 File system synchronisation</a>
<li><a href="#capi-glibc-socket">9.4.5 Network sockets</a>
</li></ul>
</li></ul>
<li><a name="toc_gcc" href="#gcc">10 A toy library interface to <acronym>GCC</acronym></a>
<li><a name="toc_objects" href="#objects">11 Built in Scheme objects</a>
<ul>
<li><a href="#objects-refs">11.1 Built in object references</a>
<li><a href="#objects-memory">11.2 Memory allocation and collection</a>
<li><a href="#objects-fixnums">11.3 Fixnum objects</a>
<li><a href="#objects-pairs">11.4 Pair objects and lists</a>
<li><a href="#objects-bytevectors">11.5 Bytevector objects</a>
<li><a href="#objects-vectors">11.6 Vector objects</a>
<li><a href="#objects-structs">11.7 Struct objects</a>
<li><a href="#objects-chars">11.8 Character objects</a>
<li><a href="#objects-strings">11.9 String objects</a>
<li><a href="#objects-symbols">11.10 Symbol objects</a>
<li><a href="#objects-bignums">11.11 Bignum objects</a>
<li><a href="#objects-ratnums">11.12 Ratnum objects</a>
<li><a href="#objects-flonums">11.13 Flonum objects</a>
<li><a href="#objects-compnums">11.14 Compnum objects</a>
<li><a href="#objects-cflonums">11.15 Cflonum objects</a>
<li><a href="#objects-ports">11.16 Port objects</a>
<li><a href="#objects-misc">11.17 Miscellaneous functions</a>
<li><a href="#objects-pointers">11.18 Pointer objects</a>
<li><a href="#objects-transcoders">11.19 Transcoder objects</a>
</li></ul>
<li><a name="toc_debug-int" href="#debug-int">12 Internals: debug mode</a>
<ul>
<li><a href="#debug-int-intro">12.1 Introduction to debug mode</a>
</li></ul>
<li><a name="toc_compiler" href="#compiler">13 Wild notes on the compiler internals</a>
<ul>
<li><a href="#compiler-intro">13.1 Introduction to the compiler</a>
<li><a href="#compiler-conventions">13.2 Coding conventions in the compiler code</a>
<li><a href="#compiler-cogen">13.3 Stuff in <samp><span class="file">ikarus.compiler.altcogen.ss</span></samp></a>
</li></ul>
<li><a name="toc_missing" href="#missing">Appendix A Missing Features</a>
<li><a name="toc_building" href="#building">Appendix B Building infrastructure</a>
<ul>
<li><a href="#building-revision">B.1 Package revision in the banner</a>
</li></ul>
<li><a name="toc_credits" href="#credits">Appendix C Credits for this document</a>
<li><a name="toc_unicode" href="#unicode">Appendix D On Unicode and <acronym>UTF</acronym> encodings</a>
<li><a name="toc_fasl" href="#fasl">Appendix E Handling <acronym>FASL</acronym> files</a>
<ul>
<li><a href="#fasl-format">E.1 Binary format of a <acronym>FASL</acronym> file</a>
<li><a href="#fasl-api">E.2 <acronym>FASL</acronym> files <acronym>API</acronym></a>
<li><a href="#fasl-foreign">E.3 Associating foreign libraries to <acronym>FASL</acronym> files</a>
</li></ul>
<li><a name="toc_cre2" href="#cre2">Appendix F Binding to the library <acronym>CRE2</acronym></a>
<ul>
<li><a href="#cre2-version">F.1 Version functions</a>
<li><a href="#cre2-regexps">F.2 Precompiled regular expressions construction</a>
<li><a href="#cre2-options">F.3 Matching configuration</a>
<li><a href="#cre2-match">F.4 Matching regular expressions</a>
</li></ul>
<li><a name="toc_package-license" href="#package-license">Appendix G <acronym>GNU</acronym> General Public License</a>
<li><a name="toc_references" href="#references">Appendix H Bibliography and references</a>
<li><a name="toc_concept-index" href="#concept-index">Appendix I An entry for each concept</a>
<li><a name="toc_function-index" href="#function-index">Appendix J An entry for each function</a>
<li><a name="toc_variable-index" href="#variable-index">Appendix K An entry for each variable</a>
<li><a name="toc_type-index" href="#type-index">Appendix L An entry for each type</a>
</li></ul>
</div>

<!--  -->
<!--  -->
<!-- page -->
<div class="node">
<a name="Top"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview">overview</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dir">(dir)</a>

</div>

<h2 class="unnumbered">Vicare Scheme User's Guide</h2>

<p class="noindent">This document describes version 0.2d6 of Vicare Scheme, an
<acronym>R6RS</acronym> compliant native compiler for the Scheme language producing
single threaded programs running on Intel x86 32-bit processors, with
experimental support for 64-bit machines.  <em>Vicare</em> is pronounced
the etruscan way.

   <p>The Vicarus Scheme package is distributed under the terms of the <acronym>GNU</acronym>
General Public License (<acronym>GPL</acronym>) and can be downloaded from:

<div align="center"><a href="http://github.com/marcomaggi/vicare/downloads">http://github.com/marcomaggi/vicare/downloads</a></div>

<p class="noindent">the home page of the project is at:

<div align="center"><a href="http://marcomaggi.github.com/vicare.html">http://marcomaggi.github.com/vicare.html</a></div>

<p class="noindent">development takes place at:

<div align="center"><a href="http://github.com/marcomaggi/vicare/">http://github.com/marcomaggi/vicare/</a></div>

<p class="noindent">Copyright &copy; 2010-2012 by Marco Maggi.<br>
Copyright &copy; 2006-2010 by Abdulaziz Ghuloum.

   <p>This document is derived from the original Ikarus documentation by the
Vicare Scheme contributors.

   <blockquote>
This program is free software: you can redistribute it and/or modify it
under the terms of the <acronym>GNU</acronym> General Public License version 3 as
published by the Free Software Foundation.

   <p>This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
General Public License for more details.

   <p>You should have received a copy of the <acronym>GNU</acronym> General Public License
along with this program.  If not, see
<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. 
</blockquote>

   <p>Trademarks used herein are the property of their respective owners.

<ul class="menu">
<li><a accesskey="1" href="#overview">overview</a>:                     Overview of Vicare Scheme. 
<li><a accesskey="2" href="#using">using</a>:                        Using the program. 
<li><a accesskey="3" href="#iklib">iklib</a>:                        Extensions library. 
<li><a accesskey="4" href="#ffi">ffi</a>:                          Foreign functions interface. 
<li><a accesskey="5" href="#posix">posix</a>:                        The <acronym>POSIX</acronym> interface. 
<li><a accesskey="6" href="#glibc">glibc</a>:                        The <acronym>GNU</acronym> C Library interface. 
<li><a accesskey="7" href="#linux">linux</a>:                        The <acronym>GNU</acronym>+Linux interface. 
<li><a accesskey="8" href="#syslib">syslib</a>:                       Low level, fast, unsafe operations. 
<li><a accesskey="9" href="#capi">capi</a>:                         C language programming interface. 
<li><a href="#gcc">gcc</a>:                          A toy library interface to <acronym>GCC</acronym>.

</li></ul>
<p>Internals

</p>
<ul class="menu">
<li><a href="#objects">objects</a>:                      Built in Scheme objects. 
<li><a href="#debug-int">debug int</a>:                    Debug mode. 
<li><a href="#compiler">compiler</a>:                     Wild notes on the compiler internals.

</li></ul>
<p>Appendices

</p>
<ul class="menu">
<li><a href="#missing">missing</a>:                      Missing Features. 
<li><a href="#building">building</a>:                     Building infrastructure. 
<li><a href="#credits">credits</a>:                      Credits for this document. 
<li><a href="#unicode">unicode</a>:                      On Unicode and <acronym>UTF</acronym> encodings. 
<li><a href="#fasl">fasl</a>:                         Handling <acronym>FASL</acronym> files. 
<li><a href="#cre2">cre2</a>:                         Binding to the library <acronym>CRE2</acronym>. 
<li><a href="#package-license">package license</a>:              <acronym>GNU</acronym> General Public License. 
<li><a href="#references">references</a>:                   Bibliography and references.

</li></ul>
<p>Indexes

</p>
<ul class="menu">
<li><a href="#concept-index">concept index</a>:                An entry for each concept. 
<li><a href="#function-index">function index</a>:               An entry for each function. 
<li><a href="#variable-index">variable index</a>:               An entry for each variable. 
<li><a href="#type-index">type index</a>:                   An entry for each type.

</li></ul>
<p>External documents

</p>
<ul class="menu">
<li><a href="#g_t_0028libffi_0029">libffi</a>:              Libffi documentation.

   </ul>

<!-- page -->
<div class="node">
<a name="overview"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#using">using</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">1 Overview of Vicare Scheme</h2>

<p>Scheme is a statically scoped and properly tail&ndash;recursive dialect of
the Lisp programming language invented by Guy Lewis Steele Jr.  and
Gerald Jay Sussman.  It was designed to have an exceptionally clear and
simple semantics and few different ways to form expressions.

   <p>The &ldquo;Revised^6 Report on the Algorithmic Language Scheme&rdquo; (<acronym>R6RS</acronym>)
gives a defining description of the programming language Scheme.  The
report is the work of many people in the course of many years; revision
6 was edited by Michael Sperber, R. Kent Dybvig, Matthew Flatt and Anton
Van Straaten.

   <p>Ikarus Scheme is an almost <acronym>R6RS</acronym> compliant implementation of the
Scheme programming language; it is the creation of Abdulaziz Ghuloum.

   <p>Vicare Scheme is an <acronym>R6RS</acronym> compliant fork of Ikarus Scheme, aiming at
becoming a native compiler producing single threaded programs running on
Intel x86 32-bit processors, with experimental support for 64-bit
machines.  <em>Vicare</em> is pronounced the etruscan way.

<ul class="menu">
<li><a accesskey="1" href="#overview-original">overview original</a>:            Original Ikarus Scheme. 
<li><a accesskey="2" href="#overview-tech">overview tech</a>:                Technology overview. 
<li><a accesskey="3" href="#overview-resources">overview resources</a>:           Resources. 
<li><a accesskey="4" href="#overview-system">overview system</a>:              System requirements. 
<li><a accesskey="5" href="#overview-install">overview install</a>:             Installation and uninstallation. 
<li><a accesskey="6" href="#overview-restrictions">overview restrictions</a>:        Implementation restrictions. 
<li><a accesskey="7" href="#overview-repl">overview repl</a>:                The read-eval-print loop. 
<li><a accesskey="8" href="#overview-foreign">overview foreign</a>:             Built in interface to external
                                libraries. 
</ul>

<!-- page -->
<div class="node">
<a name="overview-original"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-tech">overview tech</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview">overview</a>

</div>

<h3 class="section">1.1 Original Ikarus Scheme</h3>

<p>The original Ikarus Scheme package is distributed under the terms of the
<acronym>GNU</acronym> General Public License (<acronym>GPL</acronym>) and can be downloaded from:

<div align="center"><a href="http://www.ikarus-scheme.org/">http://www.ikarus-scheme.org/</a></div>

<p class="noindent">or:

<div align="center"><a href="https://launchpad.net/ikarus">https://launchpad.net/ikarus</a></div>

   <p>It was developed by Abdulaziz Ghuloum until the beginning of year 2010;
at that time the Vicare fork was started.

<!-- page -->
<div class="node">
<a name="overview-tech"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-resources">overview resources</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-original">overview original</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview">overview</a>

</div>

<h3 class="section">1.2 Technology overview</h3>

<p>Vicare Scheme provides the programmer with many advantages:

     <dl>
<dt><strong>Optimizing code generator</strong><dd>The compiler's backend employs state of the art technologies in code
generation that produce fast, efficient, machine code.  When developing
computationally intensive programs, one is not constrained by using a
slow interpreter.

     <br><dt><strong>Fast incremental compilation</strong><dd>Every library and script is quickly compiled to native machine code. 
When developing large software, one is not constrained by how slow the
batch compiler runs.

     <br><dt><strong>Robust and fine&ndash;tuned standard libraries</strong><dd>The standard libraries are written such that they perform as much error
checking as required to provide a safe and fast runtime environment.

     <br><dt><strong>Multi&ndash;generational garbage collector</strong><dd>The BiBOP based garbage collector used in Vicare allows the runtime
system to expand its memory footprint as needed.  The entire 32-bit
virtual address space could be used and unneeded memory is released back
to the operating system.

     <br><dt><strong>Supports many operating systems</strong><dd>Vicare runs on the most popular and widely used operating systems for
servers and personal computers.  The supported systems include Mac OS X,
<acronym>GNU</acronym>+Linux, FreeBSD, NetBSD, and Microsoft Windows (under Cygwin). 
</dl>

<!-- page -->
<div class="node">
<a name="overview-resources"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-system">overview system</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-tech">overview tech</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview">overview</a>

</div>

<h3 class="section">1.3 Resources</h3>

<p>The Vicare Scheme package is distributed under the terms of the <acronym>GNU</acronym>
General Public License (<acronym>GPL</acronym>) and can be downloaded from:

<div align="center"><a href="http://github.com/marcomaggi/vicare/downloads">http://github.com/marcomaggi/vicare/downloads</a></div>

<p class="noindent">the home page of the project is at:

<div align="center"><a href="http://marcomaggi.github.com/vicare.html">http://marcomaggi.github.com/vicare.html</a></div>

<p class="noindent">development takes place at:

<div align="center"><a href="http://github.com/marcomaggi/vicare/">http://github.com/marcomaggi/vicare/</a></div>

   <p>Newcomers to Scheme should refer to <a href="http://www.schemers.org">http://www.schemers.org</a>,
which contains listings of tutorials and books that are helpful in
learning the language.

   <p>This document is a supplement to the <em>Revised^6 Report on the
Algorithmic Language Scheme</em>, found at <a href="http://www.r6rs.org">http://www.r6rs.org</a>. 
Kent Dybvig's <em>The Scheme Programming Language</em>, Fourth Edition, is
an excellent tutorial and reference for <acronym>R6RS</acronym>.  Some extended
features of Vicare have been inspired by similar features in
<em>Chez Scheme</em>; the <em>Chez Scheme User's Guide</em> can be found at
the same site.

<!-- page -->
<div class="node">
<a name="overview-system"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-install">overview install</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-resources">overview resources</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview">overview</a>

</div>

<h3 class="section">1.4 System requirements</h3>

<p>To run Vicare Scheme, we will need a system with a relatively recent
Intel <em>x86</em> processor; Vicare requires a Unix/Linux
operating system (or emulation), and some prerequisite libraries.

<ul class="menu">
<li><a accesskey="1" href="#overview-system-hardware">overview system hardware</a>:     Hardware requirements. 
<li><a accesskey="2" href="#overview-system-software">overview system software</a>:     Software requirements. 
</ul>

<!-- page -->
<div class="node">
<a name="overview-system-hardware"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-system-software">overview system software</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview-system">overview system</a>

</div>

<h4 class="subsection">1.4.1 Hardware requirements</h4>

<p>Vicare Scheme runs on the IA-32 (<em>x86</em>) architecture supporting
<acronym>SSE2</acronym> extensions.  This includes the Athlon 64, Sempron 64, and
Turion 64 processors from <acronym>AMD</acronym> and the Pentium 4, Xeon,
Celeron, Pentium M, Core, and Core2 processors from Intel.  The system
does not run on Intel Pentium III or earlier processors.

   <p>The Vicare compiler generates <acronym>SSE2</acronym> instructions to
handle Scheme's <acronym>IEEE</acronym> floating point representation
(<em>flonums</em>) for inexact numbers.

<h5 class="subsubheading">Operating systems</h5>

<p>Vicare is tested under the following operating systems; in
general, any later version of one of these systems should be usable:

     <ul>
<li>Mac OS X version 10.4 and 10.5.

     <li>Linux 2.6.18 (Debian, Fedora, Gentoo, and Ubuntu).

     <li>FreeBSD version 6.2.

     <li>NetBSD version 3.1.

     <li>Microsoft Windows XP, using Cygwin 1.5.24 (<a href="http://cygwin.org">http://cygwin.org</a>). 
</ul>

<!-- page -->
<div class="node">
<a name="overview-system-software"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-system-hardware">overview system hardware</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview-system">overview system</a>

</div>

<h4 class="subsection">1.4.2 Software requirements</h4>

<p>We will need some additional libraries and tools to build
Vicare Scheme.

     <dl>
<dt><strong>GMP</strong><dd>Vicare uses the <acronym>GNU</acronym> Multiple Precision Arithmetic Library
(<acronym>GMP</acronym>) for some bignum arithmetic operations.  To build
Vicare from scratch, <acronym>GMP</acronym> version 4.2 or better must be
installed along with the required header files.  Pre&ndash;built <acronym>GMP</acronym>
packages are available for most operating systems.  Alternatively,
<acronym>GMP</acronym> can be downloaded from <a href="http://gmplib.org/">http://gmplib.org/</a>.

     <p>The <acronym>GMP</acronym> web page points out that <acronym>GMP</acronym> has revealed subtle bugs in
many C compilers.  Although the <acronym>GMP</acronym> build process includes a
comprehensive self&ndash;test (which we absolutely must run if building it
ourselves), we may still prefer to obtain a prebuilt binary version for
our system, if one is available.

     <blockquote>
<strong>NOTE</strong> Vicare runs in 32-bit mode only.  To run it in
64-bit environments, we will have to obtain the 32-bit version of
<acronym>GMP</acronym>, or compile it ourselves after adding <code>ABI=32</code> to its
configuration options. 
</blockquote>

     <br><dt><strong>libffi</strong><dd>We will probably need <code>libffi</code>, a C library that simplifies
run&ndash;time calls to arbitrary C functions.  Vicare will operate
without <code>libffi</code>, but will not be able to call foreign procedures
(those written in C).  <code>libffi</code> can be downloaded from
<a href="http://sourceware.org/libffi">http://sourceware.org/libffi</a>.

     <br><dt><strong>GCC</strong><dd>The <acronym>GNU</acronym> C Compiler is required to build the Vicare
executable (e.g. the garbage collector, loader, and OS&ndash;related
runtime).  <acronym>GCC</acronym> versions 4.1 and 4.2 were successfully used to build
Vicare.  It may be possible to build Vicare using
other C compilers.

     <br><dt><strong>Autoconf and Automake</strong><dd>The <acronym>GNU</acronym> Autoconf (version 2.61) and <acronym>GNU</acronym> Automake (version 1.10)
tools are required if one wishes to modify the Vicare source
base.  They are not required to build the official release of
Vicare.

     <p>Prebuilt packages for these tools have been created for most Unix/Linux
systems; if we prefer, we can download the source code from
<a href="http://www.gnu.org/software/autoconf">http://www.gnu.org/software/autoconf</a> and
<a href="http://www.gnu.org/software/automake">http://www.gnu.org/software/automake</a> respectively, and build
them ourselves.

     <br><dt><strong>Texinfo</strong><dd>This document is provided in Texinfo format.  Texinfo is available as an
installable package for most Unix/Linux systems.  Alternatively, we can
download the source package
<a href="http://www.gnu.org/software/texinfo">http://www.gnu.org/software/texinfo</a>. 
</dl>

<!-- page -->
<div class="node">
<a name="overview-install"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-restrictions">overview restrictions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-system">overview system</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview">overview</a>

</div>

<h3 class="section">1.5 Installation and uninstallation</h3>

<p><a name="index-Installing-_0040value_007bPRJNAME_007d-1"></a><a name="index-Uninstalling-_0040value_007bPRJNAME_007d-2"></a><a name="index-Disinstalling-_0040value_007bPRJNAME_007d-3"></a><a name="index-g_t_0040value_007bPRJNAME_007d_002c-installing-4"></a><a name="index-g_t_0040value_007bPRJNAME_007d_002c-uninstalling-5"></a><a name="index-g_t_0040value_007bPRJNAME_007d_002c-disinstalling-6"></a>

   <p>There are two ways to install Vicare Scheme on our system: we can
either install a prebuilt package, if one is available for our operating
system, or we can build it from source.  There are two reasons to prefer
the &ldquo;build from source&rdquo; approach: first, not all Unix/Linux package
repositories have an Vicare Scheme package at all; second, prebuilt
packages often lag current revisions to the system by a considerable
amount.  Therefore, the version we install from a package repository
might not even have some of the features documented in this manual.

   <p>We will assume in this section that we are building Vicare Scheme
ourselves.  Vicare uses the standard installation method found
in most other Unix software.  Thus we will follow the usual steps.

     <ol type=1 start=1>
<li>Download the software.

     <li>Set configuration options.

     <li>Build and install
        </ol>

<ul class="menu">
<li><a accesskey="1" href="#overview-install-quick">overview install quick</a>:               Quick installation guide. 
<li><a accesskey="2" href="#overview-install-prerequisites">overview install prerequisites</a>:       Installing the prerequisites. 
<li><a accesskey="3" href="#overview-install-details">overview install details</a>:             Installation details. 
<li><a accesskey="4" href="#overview-install-uninstall">overview install uninstall</a>:           Uninstalling Vicare. 
</ul>

<!-- page -->
<div class="node">
<a name="overview-install-quick"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-install-prerequisites">overview install prerequisites</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview-install">overview install</a>

</div>

<h4 class="subsection">1.5.1 Quick installation guide</h4>

<p>If familiar with installing Unix software on our system, then all we
need to know is that Vicare uses the standard installation
method found in most other Unix software.  Simply run the following
commands from the shell:

<pre class="example">     $ tar -xvzf vicare-n.n.n.tar.gz
     $ cd vicare-n.n.n
     $ ./configure [--prefix=path] [CFLAGS=-I/dir] [LDFLAGS=-L/dir]
     $ make
     $ make install
</pre>
   <p class="noindent"><a href="#overview-install-details">overview install details</a> for how to enable the foreign functions
interface.

   <p>To uninstall Vicare Scheme, use the following steps:

<pre class="example">     $ cd path/to/vicare-n.n.n
     $ make uninstall
</pre>
   <p>The rest of this section gives more detail on building, installing, and
uninstalling Vicare Scheme.

<!-- page -->
<div class="node">
<a name="overview-install-prerequisites"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-install-details">overview install details</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-install-quick">overview install quick</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview-install">overview install</a>

</div>

<h4 class="subsection">1.5.2 Installing the prerequisites</h4>

<p>The first step is to ensure that we have <acronym>GMP</acronym> and Libffi installed; we
should generally use our system's package manager for these.  Note where
the include (<code>.h</code>) and library (<code>.a</code>) files for each of these
packages are installed.  (Typically this will be in either
<samp><span class="file">/usr/include</span></samp> and <samp><span class="file">/usr/lib</span></samp>, or
<samp><span class="file">/usr/local/include</span></samp> and <samp><span class="file">/usr/local/lib</span></samp>.)

   <p>If we choose to download these as source and build them ourselves, refer
to the installation instructions found in each package.  If we are
installing <acronym>GMP</acronym> from source, it is <em>essential</em> that we run the
self&ndash;tests after building, and verify that no errors were detected.  We
do this by issuing the command <samp><span class="command">make check</span></samp>; see the
documentation for details.

<!-- page -->
<div class="node">
<a name="overview-install-details"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-install-uninstall">overview install uninstall</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-install-prerequisites">overview install prerequisites</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview-install">overview install</a>

</div>

<h4 class="subsection">1.5.3 Installation details</h4>

<p>We have two choices for downloading the Vicare Scheme source: we can
either download a distribution from:

<div align="center"><a href="http://github.com/marcomaggi/vicare/downloads">http://github.com/marcomaggi/vicare/downloads</a></div>

<p class="noindent">or we can checkout a revision from the GitHub repository:

<div align="center"><a href="http://github.com/marcomaggi/vicare/">http://github.com/marcomaggi/vicare/</a></div>

     <ul>
<li>Vicare Scheme source distributions are tarballs named
<samp><span class="file">vicare-</span><var>n.n.n</var><span class="file">.tar.gz</span></samp>, where <samp><var>n.n.n</var></samp> is a
3&ndash;component ID indicating the current revision.

     <p>If we downloaded a distribution, unpack it.  From the shell prompt:

     <pre class="example">          $ tar -xvzf vicare-<var>n.n.n</var>.tar.gz
</pre>
     <p class="noindent">this creates the base directory <samp><span class="file">vicare-</span><var>n.n.n</var></samp>.

     <li>If we downloaded a bleeding&ndash;edge snapshot, no unpacking is needed. 
</ul>

   <p>We configure the build system by running the <samp><span class="command">configure</span></samp> script
located in the base directory.  To do this, type the following commands:

<pre class="example">     $ cd vicare-<var>n.n.n</var>
     $ ./configure
     checking build system type... i386-apple-darwin8.10.1
     checking host system type... i386-apple-darwin8.10.1
     ...
     configure: creating ./config.status
     config.status: creating Makefile
     config.status: creating src/Makefile
     config.status: creating scheme/Makefile
     config.status: creating doc/Makefile
     config.status: executing depfiles commands
</pre>
   <p>This configures the system to be built then installed in the
system&ndash;wide location (binaries are normally installed in
<samp><span class="file">/usr/local/bin</span></samp>).  To install it in another location (e.g. in
your home directory), provide a <samp><span class="option">--prefix</span></samp> location to
<samp><span class="command">configure</span></samp> as follows:

<pre class="example">     $ ./configure --prefix=/opt/sw
</pre>
   <p class="noindent">this will install the executable in <samp><span class="file">/opt/sw/bin</span></samp>, libraries in
<samp><span class="file">/opt/sw/lib/ikarus</span></samp>, and documentation in
<samp><span class="file">/opt/sw/share/doc/ikarus</span></samp>.

   <p>To install Vicare Scheme for personal use (thus not requiring root
permissions to install), specify <code>--prefix=$HOME/local</code>, which
installs everything in a <samp><span class="file">local</span></samp> directory of our home directory.

   <p><samp><span class="command">configure</span></samp> allows us to fine&ndash;tune where things are installed,
though this is rarely necessary or useful.  Do
<code>./configure&nbsp;--help</code> for a full list of options.

   <p>The most common <samp><span class="command">configure</span></samp> options are as follows.

     <dl>
<dt><samp><span class="option">--prefix</span></samp><dd>Specify the location in the file system where Vicare Scheme will be
installed.

     <br><dt><samp><span class="option">--enable-ffi</span></samp><dd>Include Vicare Scheme's Foreign Function Interface, so that
Vicare code can invoke C code, and vice versa; requires Libffi.

     <br><dt><samp><span class="option">--disable-arguments-validation</span></samp><dd>Disable arguments validation for the functions in Vicare's boot image;
use with care: an invalid argument will cause undefined behaviour (most
likely a process crash).

     <br><dt><samp><span class="env">CFLAGS</span></samp><dd>Specify options to be used while compiling Vicare's C code.

     <br><dt><samp><span class="env">CPPFLAGS</span></samp><dd>Specify options to be used while preprocessing Vicare's C code.

     <br><dt><samp><span class="env">LDFLAGS</span></samp><dd>Specify options to be used while linking Vicare. 
</dl>

   <p><samp><span class="command">configure</span></samp> will fail if it cannot find the location where
<acronym>GMP</acronym> is installed.  The script will also fail if we have specified
<samp><span class="option">--enable-ffi</span></samp> and it can't find Libffi.  If running
<samp><span class="command">configure</span></samp> fails to locate either of these libraries, we will
need to provide their locations.  Use the <samp><span class="env">CPPFLAGS</span></samp> and
<samp><span class="env">LDFLAGS</span></samp> options to specify the locations of the header and library
files.

   <p>For example, assume that we have installed <acronym>GMP</acronym> and Libffi in
subdirectories of <samp><span class="file">/opt/sw</span></samp>, and we wish to support foreign
functions.<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a>

<pre class="example">     ./configure                                                  \
       --prefix=$HOME/local                                       \
       --enable-ffi                                               \
       CPPFLAGS="-I/opt/sw/gmp/include -I/opt/sw/libffi/include"  \
       LDFLAGS="-L/opt/sw/gmp/lib -L/opt/sw/libffi/lib"
</pre>
   <p>We can use the <samp><span class="env">CFLAGS</span></samp> and <samp><span class="env">LDFLAGS</span></samp> variables to select more
specialized compilation and linking options; refer to the compiler
documentation for more details.

   <p>We can now build the system by running the command <samp><span class="command">make</span></samp>, with
no arguments; this performs two tasks:

     <ol type=1 start=1>
<li>It builds the <samp><span class="command">vicare</span></samp> executable from the C files located in
the <samp><span class="file">src</span></samp> directory.

     <li>It uses the <samp><span class="command">vicare</span></samp> executable and the pre&ndash;built
<samp><span class="file">ikarus.boot.orig</span></samp> boot file to rebuild the Scheme boot image file
<samp><span class="file">vicare.boot</span></samp> from the Scheme sources located in the <samp><span class="file">scheme</span></samp>
directory.
        </ol>

   <p>The final stage is to install Vicare via the command
<samp><span class="command">make install</span></samp>.  If we're installing Vicare in a
system&ndash;wide location, we probably need to have administrator privileges
(use the <samp><span class="command">sudo</span></samp> or <samp><span class="command">su</span></samp> commands); if that's not
feasible, then we need to reconfigure to install within a directory tree
under our home directory.

   <p>Finally, try a small session, to verify that everything installed
properly.

<pre class="example">     $ vicare
     Vicare Scheme version 0.1d0+ \
       (revision master/d844c006eb9ada1a047be3893d0dd40f8ae6204a, \
       build 2010-05-02)
     Copyright (c) 2006-2010 Abdulaziz Ghuloum and contributors
     
     &gt; (display "hello, world!\n")
     hello, world!
     &gt; (define twice (lambda (f) (lambda (x) (f (f x)))))
     &gt; ((twice add1) 3)
     5
</pre>
   <p>If we get the first <code>&gt;</code> prompt, then Vicare was
successfully installed on the system.  We may need to update the
<samp><span class="env">PATH</span></samp> variable in environment to contain the directory in which the
<samp><span class="command">vicare</span></samp> executable was installed.

   <p>Finally, do <samp><span class="command">make clean</span></samp> to get rid of executables, object
files, and other build products in the <samp><span class="file">vicare-</span><var>n.n.n</var></samp>
directory.  Do not delete the directory itself: it will be needed if we
ever want to uninstall Vicare.

<!-- page -->
<div class="node">
<a name="overview-install-uninstall"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-install-details">overview install details</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview-install">overview install</a>

</div>

<h4 class="subsection">1.5.4 Uninstalling Vicare</h4>

<p><a name="index-g_t_0040value_007bPRJNAME_007d_002c-uninstalling-7"></a><a name="index-g_t_0040value_007bPRJNAME_007d_002c-disinstalling-8"></a><a name="index-Disinstalling-_0040value_007bPRJNAME_007d-9"></a><a name="index-Uninstalling-_0040value_007bPRJNAME_007d-10"></a>

   <p>To uninstall Vicare Scheme, go to the directory we built
Vicare in (not the directory where you installed it), and do
<samp><span class="command">make uninstall</span></samp>.

<pre class="example">     $ cd path/to/vicare-<var>n.n.n</var>
     $ make uninstall
</pre>
   <!-- page -->
<div class="node">
<a name="overview-restrictions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-repl">overview repl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-install">overview install</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview">overview</a>

</div>

<h3 class="section">1.6 Implementation restrictions</h3>

<p>Here is a list of implementations constraints which may be
non&ndash;compliant with <acronym>R6RS</acronym>.

     <ol type=1 start=1>
<li>Scheme strings can hold at most <code>(greatest-fixnum)</code> characters; the
length of a string and all the valid indexes into strings are
representable as fixnums.

     <li>Scheme bytevectors can hold at most <code>(greatest-fixnum)</code> bytes; the
length of a bytevector and all the valid indexes into bytevectors are
representable as fixnums.

     <li>The last argument to <code>apply</code> can be a list of at most 8192
values.  This is an artificially set limit to avoid problems with huge
values (it could be greater than this).  As comparison: LispWorks for
Unix sets this value to 300, LispWorks for Windows and LispWorks for
Linux set this value to 255 (last verified from its online documenattion
in November, 2011).
        </ol>

<!-- page -->
<div class="node">
<a name="overview-repl"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#overview-foreign">overview foreign</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-restrictions">overview restrictions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview">overview</a>

</div>

<h3 class="section">1.7 The read-eval-print loop</h3>

<p>Scheme implementations compliant with <acronym>R6RS</acronym> live in a somewhat uneasy
tension with a standard Scheme <acronym>REPL</acronym> (read&ndash;eval&ndash;print loop),
which the Report effectively does not define.

   <p>In particular, the effect of reimporting a module, as you might do when
reloading and rerunning a program, isn't well&ndash;defined by <acronym>R6RS</acronym>. 
This is a limitation caused by the particular design choices made in
<acronym>R6RS</acronym>.

   <p>Accordingly, the interactive mode is intended for quick experimenting
with the built in features.  It is intended neither for developing
applications nor for writing any substantial piece of code.

<!-- page -->
<div class="node">
<a name="overview-foreign"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview-repl">overview repl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#overview">overview</a>

</div>

<h3 class="section">1.8 Built in interface to external libraries</h3>

<p>Vicare comes with some interface to external libraries built
into the <samp><span class="command">vicare</span></samp> C language executable itself; this is done
only for some particular libraries which especially benefit from a
dedicated interface inconvenient to implement with the <acronym>FFI</acronym>.  At the
Scheme level the <acronym>API</acronym> is exported by libraries <strong>not</strong> included
in Vicare's boot image.

   <p>Such interfaces are excluded by default, they must be explicitly
requested at installation&ndash;time with command line options for the
<samp><span class="command">configure</span></samp> script.

<ul class="menu">
<li><a accesskey="1" href="#overview-foreign-cre2">overview foreign cre2</a>:        Interface to <acronym>CRE2</acronym>. 
</ul>

<!-- page -->
<div class="node">
<a name="overview-foreign-cre2"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#overview-foreign">overview foreign</a>

</div>

<h4 class="subsection">1.8.1 Interface to <acronym>CRE2</acronym></h4>

<p><acronym>CRE2</acronym> is a C language wrapper for the <acronym>RE2</acronym> library, which is
implemented in C++.  <acronym>RE2</acronym> is a fast, safe, thread&ndash;friendly
alternative to backtracking regular expression engines like those used
in PCRE, Perl, and Python; it is a Google project found at:

<div align="center"><a href="http://code.google.com/p/re2/">http://code.google.com/p/re2/</a></div>

<p class="noindent">while <acronym>CRE2</acronym> is available at:

<div align="center"><a href="http://github.com/marcomaggi/cre2/">http://github.com/marcomaggi/cre2/</a></div>

   <p>Vicare interface to <acronym>CRE2</acronym> can be included at package
configuration time by giving the <samp><span class="option">--with-cre2</span></samp> option to the
<samp><span class="command">configure</span></samp> script.  <a href="#cre2">cre2</a> for the <acronym>API</acronym> documentation.

<!-- page -->
<div class="node">
<a name="using"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib">iklib</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#overview">overview</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">2 Using Vicare</h2>

<p>Once Vicare Scheme is properly installed, we can invoke it either in
an interactive terminal session or as the interpreter for invoking a
script.

   <p><a name="index-Command-line-11"></a><a name="index-Invoking-_0040value_007bPRJNAME_007d-12"></a>

<ul class="menu">
<li><a accesskey="1" href="#using-interactive">using interactive</a>:            Interactive sessions. 
<li><a accesskey="2" href="#using-invoking">using invoking</a>:               Command line arguments. 
<li><a accesskey="3" href="#using-script">using script</a>:                 Using <samp><span class="command">scheme-script</span></samp>. 
<li><a accesskey="4" href="#using-libraries">using libraries</a>:              <acronym>R6RS</acronym> libraries. 
</ul>

<!-- page -->
<div class="node">
<a name="using-interactive"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#using-invoking">using invoking</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using">using</a>

</div>

<h3 class="section">2.1 Interactive sessions</h3>

<p>If we want an interactive session, use a bare <samp><span class="command">vicare</span></samp>
command, with no options.

<pre class="example">     $ vicare
     Vicare Scheme version 0.1d0+ \
       (revision master/d844c006eb9ada1a047be3893d0dd40f8ae6204a, \
        build 2010-05-02)
     Copyright (c) 2006-2010 Abdulaziz Ghuloum and contributors
     
     &gt; (+ 2 2)
     4
</pre>
   <p class="noindent">end&ndash;of&ndash;file (&lt;Ctrl-D&gt; in a typical terminal window) will terminate
the session.

<!-- page -->
<div class="node">
<a name="using-invoking"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#using-script">using script</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#using-interactive">using interactive</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using">using</a>

</div>

<h3 class="section">2.2 Command line arguments</h3>

<p>The synopsis of the <samp><span class="command">vicare</span></samp> program is as follows:

<pre class="smallexample">     vicare [<var>OPTIONS</var>] [PROGRAM]                      [-- [<var>PROGRAM OPTS</var>]]
     vicare [<var>OPTIONS</var>] --r6rs-script PROGRAM          [-- [<var>PROGRAM OPTS</var>]]
     vicare [<var>OPTIONS</var>] --r6rs-repl PROGRAM            [-- [<var>PROGRAM OPTS</var>]]
     vicare [<var>OPTIONS</var>] --script CODE                  [-- [<var>PROGRAM OPTS</var>]]
     vicare [<var>OPTIONS</var>] --compile-dependencies PROGRAM [-- [<var>PROGRAM OPTS</var>]]
</pre>
   <p class="noindent">the <var>OPTIONS</var> are interpreted by <samp><span class="command">vicare</span></samp>, <var>PROGRAM
OPTS</var> can be obtained using the <code>command-line</code> procedure in the
<code>(rnrs programs)</code> library; when running the <acronym>REPL</acronym>: the first
element of the returned list will be the string &lsquo;<samp><span class="samp">*interactive*</span></samp>&rsquo;,
corresponding to the script name in <acronym>R6RS</acronym>&ndash;script mode.

   <p>Some options cause code to be evaluated in the interaction environment:
it initially contains all the bindings exported from the
<code>(ikarus)</code> library.

   <p>The <samp><span class="command">vicare</span></samp> executable recognises a few command line switches
that influence how Vicare Scheme starts; the following are the main
options, driving the execution mode.  It is an error to put on the
command line two or more of these options.

     <dl>
<dt><code>--r6rs-script </code><var>PROGRAM</var><dd>Start Vicare in <acronym>R6RS</acronym>&ndash;script mode.  The <var>PROGRAM</var> file is handled
as an <acronym>R6RS</acronym> program.  Example:

     <pre class="example">          $ cat test.sps
          (import (rnrs))
          (write (command-line))
          (newline)
          
          $ vicare --r6rs-script test.sps hi there
          ("test.sps" "hi" "there")
</pre>
     <br><dt><code>--r6rs-repl </code><var>PROGRAM</var><dd>Start Vicare in <acronym>R6RS</acronym>-script mode.  Act as if the
<samp><span class="option">--r6rs-script</span></samp> option had been used but, after the program
execution, enter the <acronym>REPL</acronym> rather than exiting.  This allows
inspection of bindings and state left behind by the program.

     <br><dt><code>--script </code><var>CODEFILE</var><dd>Start Vicare in evaluation mode.  The <var>CODEFILE</var> is handled as a
sequence of <acronym>R6RS</acronym> expressions: such expressions are used as first
argument for <code>eval</code> under the interaction environment.  Example:

     <pre class="example">          $ cat test.sps
          (write (command-line))
          (newline)
          
          $ vicare --script test.sps hi there
          ("test.sps" "hi" "there")
</pre>
     <br><dt><code>--compile-dependencies </code><var>IMPORTS-FILE</var><dd>Load the <acronym>R6RS</acronym> program <var>IMPORTS-FILE</var>, compile all the libraries
upon which it depends and store them in the FASL repository. 
<var>IMPORTS-FILE</var> itself is not evaluated. 
</dl>

   <p>When none of these options is given, but a standalone <var>PROGRAM</var>
argument is present on the command line: act as if the
<samp><span class="option">--r6rs-script</span></samp> option had been used with the given file name. 
If no standalone <var>PROGRAM</var> argument is present: enter the <acronym>REPL</acronym>.

   <p>The rest of the command line arguments are recognised by the standard
Scheme run time system.

     <dl>
<dt><code>-b path/to/boot/file.boot</code><dt><code>--boot path/to/boot/file.boot</code><dd>Use the specified boot file as the initial system boot file.  The boot
file is a binary file that contains all the code and data of the Scheme
system.  In the absence of the <samp><span class="option">-b</span></samp> flag, the executable will use
the default boot file.  Running <samp><span class="command">vicare</span></samp> with the <samp><span class="option">-h</span></samp>
option shows the location where the default boot file was installed.

     <br><dt><code>--no-rcfile</code><dd>Disable loading of run&ndash;command files.

     <br><dt><code>--rcfile </code><var>FILE</var><dd>Load and evaluate <var>FILE</var> as an <acronym>R6RS</acronym> program at startup, before
loading libraries, evaluating codes and running the main script.  This
option can be used multiple times.

     <br><dt><code>-l </code><var>LIBFILE</var><dt><code>--load-library </code><var>LIBFILE</var><dd>Load <var>libfile</var> expecting it to contain one or more <acronym>R6RS</acronym>
libraries; after executing the RC files, load the libraries in the
internal collection, but do not add them to any environment.  This
option can be used multiple times.

     <br><dt><code>-f </code><var>CODEFILE</var><dt><code>--eval-file </code><var>CODEFILE</var><dd>Load <var>CODEFILE</var> expecting it to contain valid <acronym>R6RS</acronym> expressions;
after instantiating the libraries hand the code to <code>eval</code> under the
interaction environment.  Bindings left behind by this code are
available if we enter the <acronym>REPL</acronym>.  This option can be used multiple
times.

     <br><dt><code>-e </code><var>EXPRESSION</var><dt><code>--eval-expr </code><var>EXPRESSION</var><dd>After instantiating the libraries hand the <var>EXPRESSION</var> to
<code>eval</code> under the interaction environment.  Bindings left behind by
this code are available if we enter the <acronym>REPL</acronym>. This option can be used
multiple times.

     <br><dt><code>-L </code><var>DIRECTORY</var><dt><code>--search-path </code><var>DIRECTORY</var><dd>Add <var>directory</var> to the library search path.  This option can be used
multiple times.

     <br><dt><code>--more-file-extensions</code><dd>Rather than searching only libraries with extension &lsquo;<samp><span class="samp">.vicare.sls</span></samp>&rsquo;
and &lsquo;<samp><span class="samp">.sls</span></samp>&rsquo;, search also for &lsquo;<samp><span class="samp">.vicare.ss</span></samp>&rsquo;, &lsquo;<samp><span class="samp">.ss</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">.vicare.scm</span></samp>&rsquo;, &lsquo;<samp><span class="samp">.scm</span></samp>&rsquo; and the &lsquo;<samp><span class="samp">main</span></samp>&rsquo; file.  <a href="#using-libraries-searching">using libraries searching</a> for more details.

     <br><dt><code>--prompt </code><var>STRING</var><dd>Use <var>STRING</var> as prompt for the <acronym>REPL</acronym>.  Defaults to &lsquo;<samp><span class="samp">vicare</span></samp>&rsquo;,
to which the character &lsquo;<samp><span class="samp">&gt;</span></samp>&rsquo; is appended for each nested <acronym>REPL</acronym>
level.  <a href="#iklib-cafe">iklib cafe</a> for more details.

     <br><dt><code>-d</code><dt><code>--debug</code><dd>Turn on debugging mode.  With this unhandled exceptions in the program
will result in starting the debugger, which allows stack trace
inspection.

     <br><dt><code>-nd</code><dt><code>--no-debug</code><dd>Turn off debugging mode.

     <br><dt><code>-O0</code><dt><code>-O1</code><dt><code>-O2</code><dd>Turn on various levels of compile optimisations (currently unsupported).

     <br><dt><code>--print-assembly</code><dd>Print to the current error port the assembly instructions generated when
compiling code.

     <br><dt><code>--print-optimizer</code><dt><code>--print-optimiser</code><dd>Print to the current error port a symbolic expression which results from
running the optimiser.

     <br><dt><code>-V</code><dt><code>--version</code><dd>Display the version message then exit.

     <br><dt><code>--version-only</code><dd>Display only the version number on the standard error port, followed by
a newline, then exit.

     <br><dt><code>--license</code><dd>Display the license message then exit.

     <br><dt><code>-h</code><dd>Display the help message then exit.

     <br><dt><code>--</code><dd>Mark the end of <samp><span class="command">vicare</span></samp> options; all the arguments after this
marker can be obtained by calling the <code>command-line</code> procedure. 
</dl>

   <p><a name="index-g_t_0040env_007bVICARE_005fRC_005fFILES_007d-13"></a>If neither the <samp><span class="option">--no-rcfile</span></samp> nor the <samp><span class="option">--rcfile</span></samp> options
are used: a list of run&ndash;command files is read from the environment
variable <samp><span class="env">VICARE_RC_FILES</span></samp>, which must contain a colon separated
list of pathnames.  If the enviroment variable is empty or unset, by
default the file <samp><span class="file">.vicarerc</span></samp> is used searching it in the directory
selected by the <samp><span class="env">HOME</span></samp> environment variable.

<!-- page -->
<div class="node">
<a name="using-script"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#using-libraries">using libraries</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#using-invoking">using invoking</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using">using</a>

</div>

<h3 class="section">2.3 Using <samp><span class="command">scheme-script</span></samp></h3>

<p>Scheme scripts can be executed using the following command:

<pre class="example">     vicare <var>PROGRAM</var>
</pre>
   <p class="noindent">Vicare Scheme does <strong>not</strong> follow the <acronym>R6RS</acronym> recommendations
and does not install a wrapper program called <samp><span class="command">scheme-script</span></samp> to
avoid conflicts with other Scheme implementations.

   <p>Here is a sample script (Pig Latin&mdash;&ldquo;Igpay Atinlay&rdquo;&mdash;is a code that
was at one time popular among very young North American children).

<pre class="example">     (import (rnrs))
     
     ;;; Convert a string to its Pig Latin equivalent.
     ;;;
     ;;; If the first character is a vowel, append "yay".
     ;;; "egg" -&gt; "eggyay"
     ;;;
     ;;; If the first character is a consonant, remove it,
     ;;; and append it plus "ay" to the string.
     ;;; "foo" -&gt; "oofay"
     
     (define pig-latin
       (lambda (str)
         (let ((first (string-ref str 0)))
           (if (memv first '(#\a #\e #\i #\o #\u))
     	  (string-append str "yay")
     	  (string-append
      	    (substring str 1 (string-length str))
     	    (string first) "ay")))))
     
     (display
      (map pig-latin
          (cdr (command-line))))
     (newline)
</pre>
   <p>Assuming we have stored the script in the file <samp><span class="file">demo.sps</span></samp>, we can
invoke this script via <samp><span class="command">vicare</span></samp>:

<pre class="example">     $ vicare --r6rs-script demo.sps ice cream after dinner
     (iceyay reamcay afteryay innerday)
</pre>
   <p>On Unix/Linux systems, scripts generally start with a &ldquo;shebang&rdquo; line
(<em>sh</em>arp plus <em>bang</em>) which names an interpreter for the
script.  All modern systems have the <samp><span class="command">env</span></samp> command which
searches for a command in the user's path.

<pre class="example">     #!/usr/bin/env vicare --r6rs-script
     (import (rnrs))
     
     ...
</pre>
   <p>Now we can make the file executable, and use it directly.

<pre class="example">     $ chmod +x demo.sps
     $ ./demo.sps ice cream after dinner
     (iceyay reamcay afteryay innerday)
</pre>
   <p>There are a few fine points.

     <ul>
<li>If the first two bytes of a script represent the sequence &lsquo;<samp><span class="samp">#!</span></samp>&rsquo; in
<acronym>ASCII</acronym> encoding: the first line is discarded and not parsed as Scheme
code.  This allows scripts on Unix systems to start with the command
line needed to use them; notice that this will discard valid sharp&ndash;bang
comments (like <code>#!r6rs</code>) if the are at the very beginning of a
file.

     <li>Under Mac OS X, if a script name ends with the <code>.command</code>
extension, then it can be executed from the Finder by double&ndash;clicking
on it.  This brings up a terminal window in which the script is
executed.  The <code>.command</code> extension can be hidden from the
<em>Get Info</em> item from the Finder's File menu. 
</ul>

<!-- page -->
<div class="node">
<a name="using-libraries"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#using-script">using script</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using">using</a>

</div>

<h3 class="section">2.4 <acronym>R6RS</acronym> libraries</h3>

<p>A library exports features that can be imported into programs; a library
is named by a list, e.g., <code>(yoyodyne
block-transfer-computations)</code>.  The core features of the language is
provided in the library <code>(rnrs)</code>.

<ul class="menu">
<li><a accesskey="1" href="#using-libraries-intro">using libraries intro</a>:        Introduction to Vicare libraries. 
<li><a accesskey="2" href="#using-libraries-searching">using libraries searching</a>:    How Vicare finds libraries. 
<li><a accesskey="3" href="#using-libraries-summary">using libraries summary</a>:      Library search summary. 
<li><a accesskey="4" href="#using-libraries-examples">using libraries examples</a>:     Examples of libraries usage. 
</ul>

<!-- page -->
<div class="node">
<a name="using-libraries-intro"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#using-libraries-searching">using libraries searching</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using-libraries">using libraries</a>

</div>

<h4 class="subsection">2.4.1 Introduction to libraries</h4>

<p>A library consists of a &ldquo;file&rdquo; (some assemblage of text) that contains
a library form, which might look like this:

<pre class="example">     (library (sample)
       (export cube)
       (import (rnrs))
       (define cube
         (lambda (x)
           (* x x x))))
</pre>
   <p class="noindent">notice the <code>import</code> clause; libraries have no predefined namespace,
and therefore at least <code>(rnrs)</code> must be imported.

   <p>We can import <code>(sample)</code> into another library, a script, or a
Vicare top&ndash;level session:

<pre class="example">     &gt; (import (sample))
     &gt; (cube 3)
     27
</pre>
   <p>Library names are lists, thus allowing the writer of one or more
libraries to group related libraries together.  For example, as well as
<code>(yoyodyne block-transfer-computations)</code>, we might also have
<code>(yoyodyne tardis navigation)</code> and <code>(yoyodyne tardis
diagnostics)</code>.  Leaving the parentheses off a single&ndash;component library
name is a common error.

<!-- page -->
<div class="node">
<a name="using-libraries-searching"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#using-libraries-summary">using libraries summary</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#using-libraries-intro">using libraries intro</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using-libraries">using libraries</a>

</div>

<h4 class="subsection">2.4.2 How Vicare finds libraries</h4>

<p>In Vicare, a library is a file with the same name as the last
component of the library name.  For example, the library
<code>(sample)</code> will correspond to a file named <samp><span class="file">sample.sls</span></samp>
somewhere in the file system.  The file extension <code>.sls</code> stands for
&ldquo;Scheme library source&rdquo;; although Vicare will also accept the
extensions <code>.ss</code> and <code>.scm</code> when the command line option
<samp><span class="option">--more-file-extensions</span></samp> is used, these really indicate scripts
rather than libraries.

   <p>Vicare has a search algorithm for libraries that is similar to
those used in other languages.  Its search path comprises a series of
directories.  When we try to import a library whose name contains just
one component, Vicare will examine each directory in the search
path for a file with a matching name.  Importing a library whose name is
a list of components causes Vicare to match to a series of
subdirectories with matching names.

   <p>Here is an example of each case:

     <ul>
<li>Importing <code>(sample)</code> causes Vicare to look in each
directory on the path for a file named <samp><span class="file">sample.sls</span></samp>.

     <li>Importing <code>(yoyodyne sample)</code> causes Vicare to look in
each directory on the path for a directory named <samp><span class="file">yoyodyne</span></samp>, and
within that a file named <samp><span class="file">sample.sls</span></samp>.  The <code>library</code> form for
this library must still specify the library name as <code>(yoyodyne
sample)</code>, not <code>(sample)</code>. 
</ul>

   <p><a name="index-g_t_0040env_007bVICARE_005fLIBRARY_005fPATH_007d-14"></a>Vicare always places its own libraries at the end of the search
path.  Other library directories can be added to the search path in two
ways: by modifying an environment variable, or by setting
Vicare's <code>library-path</code> parameter.  Vicare
consults the environment variable <samp><span class="env">VICARE_LIBRARY_PATH</span></samp> at the
beginning of execution, and places each of the directories there into
its search path.  The search path is then set to the value of the
parameter <code>library-path</code>, which can be updated as necessary.

<pre class="example">     $ export VICARE_LIBRARY_PATH=$HOME/scheme:/tmp/library
     $ echo $VICARE_LIBRARY_PATH
     /home/someuser/scheme:/tmp/library
     $ vicare
     ...
     
     &gt; (library-path)
     ("/home/someuser/scheme" "/tmp/library"
       "/home/someuser/local/lib/vicare")
     &gt; (library-path (cons "/opt/sw/extra-libraries" (library-path)))
     &gt; (library-path)
     ("/opt/sw/extra-libraries" "/home/someuser/scheme"
       "/tmp/library" "/home/someuser/local/lib/vicare")
</pre>
   <p class="noindent">In this example, the user sets <samp><span class="env">VICARE_LIBRARY_PATH</span></samp> before the
session; the settings are reflected in the value of
<code>(library-path)</code>.  A further directory is then set during the
session.

   <p>In programs intended to be distributed, you should resist the urge to
set <code>(library-path)</code>, as the user's file hierarchies might not
match yours.  For most libraries, simply telling the user to install the
library in one of the libraries on the search path is good enough.

   <p>There are two refinements of the library search algorithm, which are
performed when the <samp><span class="option">--more-file-extensions</span></samp> command line option
is used.

     <ul>
<li>A common pattern is to distribute a main library along with a number of
additional extensions: we might have a main library named <code>(lib)</code>,
and additional optional extensions named <code>(lib extras)</code> and
<code>(lib frills)</code>.

     <p>Although the previous packaging method can be used, Vicare
allows you to use a simpler technique where the main library is stored
in <samp><span class="file">lib/main.sls</span></samp>, and the extensions are stored in
<samp><span class="file">lib/extras.sls</span></samp> and <samp><span class="file">lib/frills.sls</span></samp>, respectively.

     <li>Vicare will also look in <samp><span class="file">lib/main.vicare.sls</span></samp> before
trying <samp><span class="file">lib/main.sls</span></samp>.  This allows you to provide a
Vicare&ndash;specific implementation as well as a generic
implementation. 
</ul>

<!-- page -->
<div class="node">
<a name="using-libraries-summary"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#using-libraries-examples">using libraries examples</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#using-libraries-searching">using libraries searching</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using-libraries">using libraries</a>

</div>

<h4 class="subsection">2.4.3 Library search algorithm summary</h4>

<p>By default, Vicare attempts to import the library <code>(a b
c)</code> as follows, for each directory in the search path:

     <ol type=1 start=1>
<li>Build the rootname <samp><span class="file">a/b/c</span></samp>.

     <li>Append each of the following strings to the rootname, in order, until a
matching file is found:

     <pre class="example">          .vicare.sls
          .sls
</pre>
     </ol>

   <p>When the the command line option <samp><span class="option">--more-file-extensions</span></samp> is
used, for each directory in the search path:

     <ol type=1 start=1>
<li>Build the rootname <samp><span class="file">a/b/c</span></samp>.

     <li>Append each of the following strings to the rootname, in order, until a
matching file is found:

     <pre class="example">          /main.vicare.sls
          /main.vicare.ss
          /main.vicare.scm
          /main.sls
          /main.ss
          /main.scm
          .vicare.sls
          .vicare.ss
          .vicare.scm
          .sls
          .ss
          .scm
</pre>
     </ol>

   <p>If there is no match, then the import request is in error.

<!-- page -->
<div class="node">
<a name="using-libraries-examples"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#using-libraries-summary">using libraries summary</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#using-libraries">using libraries</a>

</div>

<h4 class="subsection">2.4.4 Examples of library usage</h4>

<p>Consider a program using <code>pretty-print</code> procedure to format some
code, and suppose further that pretty printing is just a nice add&ndash;on
(e.g. using <samp><span class="file">write</span></samp> suffices, but pretty&ndash;printing is <em>just
prettier</em>).

   <p>Vicare exports a good pretty&ndash;printing facility in its
<code>(ikarus)</code> library.  However, since <code>pretty-print</code> is not a
standard procedure, a program that uses it would be rendered unportable
to other <acronym>R6RS</acronym> Scheme implementations.

   <p>The programmer can put the <code>.vicare.*</code> extensions to use in this
situation, by writing two versions of a <code>(pretty-printing)</code>
library: one for use by Vicare, and one portable for other
implementations.

<pre class="example">     ;; pretty-printing.vicare.ss --
     ;;
     ;; Can be used only by Vicare Scheme.
     
     (library (pretty-printing)
       (export pretty-print)
       (import (only (ikarus) pretty-print)))
     
     ;;; end of file
</pre>
   <pre class="example">     ;; pretty-printing.sls --
     ;;
     ;; For any other Scheme implementation, portable though
     ;; not very pretty.
     
     (library (pretty-printing)
       (export pretty-print)
       (import (rnrs))
       (define (pretty-print x port)
         (write x port)
         (newline port)))
     
     ;;; end of file
</pre>
   <!-- page -->
<div class="node">
<a name="iklib"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ffi">ffi</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#using">using</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">3 Extensions library</h2>

<p>In addition to the libraries listed in the <acronym>R6RS</acronym> standard,
Vicare offers the <code>(ikarus)</code> and <code>(vicare)</code>
libraries which provide additional features; <code>(ikarus)</code> is a
composite library, it exports a superset of all the supported bindings
of <acronym>R6RS</acronym>; <code>(vicare)</code> exports the same bindings of
<code>(ikarus)</code>.

<ul class="menu">
<li><a accesskey="1" href="#iklib-conditions">iklib conditions</a>:             Additional condition types. 
<li><a accesskey="2" href="#iklib-reader">iklib reader</a>:                 Extensions to the reader. 
<li><a accesskey="3" href="#iklib-expander">iklib expander</a>:               Interface to the expander. 
<li><a accesskey="4" href="#iklib-shared">iklib shared</a>:                 Shared structures graph notation. 
<li><a accesskey="5" href="#iklib-environment">iklib environment</a>:            Environments. 
<li><a accesskey="6" href="#iklib-cafe">iklib cafe</a>:                   Cafe. 
<li><a accesskey="7" href="#iklib-structs">iklib structs</a>:                Structures and type descriptors. 
<li><a accesskey="8" href="#iklib-lists">iklib lists</a>:                  Additional list functions. 
<li><a accesskey="9" href="#iklib-bytevectors">iklib bytevectors</a>:            Additional bytevector functions. 
<li><a href="#iklib-strings">iklib strings</a>:                Additional string functions. 
<li><a href="#iklib-vectors">iklib vectors</a>:                Additional vector functions. 
<li><a href="#iklib-symbols">iklib symbols</a>:                Additional symbol functions. 
<li><a href="#iklib-numerics">iklib numerics</a>:               Additional functions on numbers. 
<li><a href="#iklib-load">iklib load</a>:                   Loading source files. 
<li><a href="#iklib-import">iklib import</a>:                 Local library imports. 
<li><a href="#iklib-modules">iklib modules</a>:                Local modules. 
<li><a href="#iklib-parameters">iklib parameters</a>:             Parameters. 
<li><a href="#iklib-gensym">iklib gensym</a>:                 Gensyms. 
<li><a href="#iklib-printing">iklib printing</a>:               Printing. 
<li><a href="#iklib-tracing">iklib tracing</a>:                Tracing. 
<li><a href="#iklib-timing">iklib timing</a>:                 Timing. 
<li><a href="#iklib-guardians">iklib guardians</a>:              Guardians and garbage collection. 
<li><a href="#iklib-io">iklib io</a>:                     Input/output library. 
<li><a href="#iklib-misc">iklib misc</a>:                   Miscellaneous functions. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-conditions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-reader">iklib reader</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.1 Additional condition types</h3>

<ul class="menu">
<li><a accesskey="1" href="#iklib-conditions-spos">iklib conditions spos</a>:        Scheme source code position. 
<li><a accesskey="2" href="#iklib-conditions-eagain">iklib conditions eagain</a>:      Reporting <code>EAGAIN</code> exceptions. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-conditions-spos"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-conditions-eagain">iklib conditions eagain</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-conditions">iklib conditions</a>

</div>

<h4 class="subsection">3.1.1 Scheme source code position</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Condition Type: <b>&amp;source-position</b><var><a name="index-g_t_0026source_002dposition-15"></a></var><br>
<blockquote><p>Condition type used to represent a position in Scheme source code read
from a textual input port; it is derived from <code>&amp;condition</code>.  It
has the following fields:

          <dl>
<dt><code>port-id</code><dd>A Scheme string representing the port identifier, for example the file
name.

          <br><dt><code>byte</code><dd>An exact non&ndash;negative zero&ndash;based integer representing the byte offset
of the position in the source.

          <br><dt><code>character</code><dd>An exact non&ndash;negative zero&ndash;based integer representing the character
offset of the position in the source.

          <br><dt><code>line</code><dd>An exact non&ndash;negative one&ndash;based integer representing the line offset
of the position in the source.

          <br><dt><code>column</code><dd>An exact non&ndash;negative one&ndash;based integer representing the column offset
of the position in the source. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-source-position-condition</b><var> port-id character<a name="index-make_002dsource_002dposition_002dcondition-16"></a></var><br>
<blockquote><p>Build and return a new condition object of type
<code>&amp;source-position</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>source-position-condition?</b><var> obj<a name="index-source_002dposition_002dcondition_003f-17"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a condition object with type
<code>&amp;source-position</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>source-position-port-id</b><var> spos<a name="index-source_002dposition_002dport_002did-18"></a></var><br>
&mdash; Function: <b>source-position-character</b><var> spos<a name="index-source_002dposition_002dcharacter-19"></a></var><br>
<blockquote><p>Accessors for the fields of condition objects of type
<code>&amp;source-position</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-conditions-eagain"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-conditions-spos">iklib conditions spos</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-conditions">iklib conditions</a>

</div>

<h4 class="subsection">3.1.2 Reporting <code>EAGAIN</code> exceptions</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Condition Type: <b>&amp;i/o-eagain</b><var><a name="index-g_t_0026i_002fo_002deagain-20"></a></var><br>
<blockquote><p>Used to signal that a system call returned with <code>errno</code> set to
<code>EAGAIN</code>.  It is derived from <code>&amp;i/o</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-i/o-eagain</b><var><a name="index-make_002di_002fo_002deagain-21"></a></var><br>
<blockquote><p>Return a new condition object of type <code>&amp;i/o-eagain</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>i/o-again-error?</b><var> obj<a name="index-i_002fo_002dagain_002derror_003f-22"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>obj</var> is a condition object of type
<code>&amp;i/o-eagain</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-reader"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-expander">iklib expander</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-conditions">iklib conditions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.2 Reader</h3>

<ul class="menu">
<li><a accesskey="1" href="#iklib-reader-mode">iklib reader mode</a>:            Textual input port modes. 
<li><a accesskey="2" href="#iklib-reader-bv">iklib reader bv</a>:              Additional bytevector syntaxes. 
<li><a accesskey="3" href="#iklib-reader-stx">iklib reader stx</a>:             Miscellaneous additional syntaxes. 
<li><a accesskey="4" href="#iklib-reader-fun">iklib reader fun</a>:             Additional reader functions. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-reader-mode"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-reader-bv">iklib reader bv</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-reader">iklib reader</a>

</div>

<h4 class="subsection">3.2.1 Textual input port modes</h4>

<div class="defun">
&mdash; Reader Syntax: <b>#!vicare</b><var><a name="index-g_t_0023_0021vicare-23"></a></var><br>
&mdash; Reader Syntax: <b>#!ikarus</b><var><a name="index-g_t_0023_0021ikarus-24"></a></var><br>
<blockquote><p>Vicare extends Scheme's lexical syntax (<acronym>R6RS</acronym> Chapter 4) in
a variety of ways including:

          <ul>
<li>End&ndash;of&ndash;file marker, <code>#!eof</code>.

          <li>Gensym syntax, <code>#{gensym}</code>.

          <li>Shared structures graph notation: <code>#nn=</code>, <code>#nn#</code>. 
</ul>

        <p>The syntax extensions are made available by default on all input ports,
until the <code>#!r6rs</code> token is read.  Thus, reading the <code>#!r6rs</code>
token disables all extensions to the lexical syntax on the specific
port, and the <code>#!vicare</code> enables them again.

        <p>When writing code that is intended to be portable across different
Scheme implementations, we should add the <code>#!r6rs</code> token to the top
of every script and library that we write; this allows Vicare
to alert us when using non&ndash;portable features.  When writing code that's
intended to be Vicare&ndash;specific, we should add the
<code>#!vicare</code> token in order to get an immediate error when the code
is run under other implementations.

        <p>The comment <code>#!ikarus</code> is accepted for backwards compatibility with
Ikarus Scheme. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>port-mode</b><var> input-port<a name="index-port_002dmode-25"></a></var><br>
<blockquote><p>Accept an input port as argument and return a symbol among: <code>r6rs</code>,
<code>vicare</code>.  All input ports start under <code>vicare</code> mode and thus
accept Vicare&ndash;specific reader extensions.  When the
<code>#!r6rs</code> token is read from a port, its mode changes to
<code>r6rs</code>.

     <pre class="example">          &gt; (port-mode (current-input-port))
          vicare
          &gt; #!r6rs (port-mode (current-input-port))
          r6rs
          &gt; #!vicare (port-mode (current-input-port))
          vicare
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>set-port-mode!</b><var> input-port mode<a name="index-set_002dport_002dmode_0021-26"></a></var><br>
<blockquote><p>Modifiy the lexical syntax accepted by subsequent calls to <code>read</code>
on the input port.  The mode is a symbol among <code>r6rs</code> and
<code>vicare</code>.  The effect of setting the port mode is similar to
that of reading the <code>#!r6rs</code> or <code>#!vicare</code> token from that
port.

     <pre class="example">          &gt; (set-port-mode! (current-input-port) 'r6rs)
          &gt; (port-mode (current-input-port))
          r6rs
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-reader-bv"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-reader-stx">iklib reader stx</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-reader-mode">iklib reader mode</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-reader">iklib reader</a>

</div>

<h4 class="subsection">3.2.2 Additional bytevector syntaxes</h4>

<p>The following syntaxes are available only when the input port mode is
set to <code>vicare</code>.

<div class="defun">
&mdash; Reader Syntax: <b>#vs8(</b><var>byte</var><b> ...)</b><var><a name="index-g_t_0023vs8_0028_0040var_007bbyte_007d-_002e_002e_002e_0029-27"></a></var><br>
<blockquote><p>Read a bytevector as <code>#vu8(</code><var>octect</var><code> ...)</code> would do, but allow
<var>byte</var> to be in the range [-128, 127]. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vu16l(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu16l_0028_0040var_007bword_007d-_002e_002e_002e_0029-28"></a></var><br>
&mdash; Reader Syntax: <b>#vu16b(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu16b_0028_0040var_007bword_007d-_002e_002e_002e_0029-29"></a></var><br>
&mdash; Reader Syntax: <b>#vu16n(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu16n_0028_0040var_007bword_007d-_002e_002e_002e_0029-30"></a></var><br>
<blockquote><p>Read a bytevector of 16-bit unsigned words stored in little, big and
native endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vs16l(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs16l_0028_0040var_007bword_007d-_002e_002e_002e_0029-31"></a></var><br>
&mdash; Reader Syntax: <b>#vs16b(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs16b_0028_0040var_007bword_007d-_002e_002e_002e_0029-32"></a></var><br>
&mdash; Reader Syntax: <b>#vs16n(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs16n_0028_0040var_007bword_007d-_002e_002e_002e_0029-33"></a></var><br>
<blockquote><p>Read a bytevector of 16-bit signed words stored in little, big and
native endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vu32l(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu32l_0028_0040var_007bword_007d-_002e_002e_002e_0029-34"></a></var><br>
&mdash; Reader Syntax: <b>#vu32b(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu32b_0028_0040var_007bword_007d-_002e_002e_002e_0029-35"></a></var><br>
&mdash; Reader Syntax: <b>#vu32n(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu32n_0028_0040var_007bword_007d-_002e_002e_002e_0029-36"></a></var><br>
<blockquote><p>Read a bytevector of 32-bit unsigned words stored in little, big and
native endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vs32l(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs32l_0028_0040var_007bword_007d-_002e_002e_002e_0029-37"></a></var><br>
&mdash; Reader Syntax: <b>#vs32b(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs32b_0028_0040var_007bword_007d-_002e_002e_002e_0029-38"></a></var><br>
&mdash; Reader Syntax: <b>#vs32n(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs32n_0028_0040var_007bword_007d-_002e_002e_002e_0029-39"></a></var><br>
<blockquote><p>Read a bytevector of 32-bit signed words stored in little, big and
native endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vu64l(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu64l_0028_0040var_007bword_007d-_002e_002e_002e_0029-40"></a></var><br>
&mdash; Reader Syntax: <b>#vu64b(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu64b_0028_0040var_007bword_007d-_002e_002e_002e_0029-41"></a></var><br>
&mdash; Reader Syntax: <b>#vu64n(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vu64n_0028_0040var_007bword_007d-_002e_002e_002e_0029-42"></a></var><br>
<blockquote><p>Read a bytevector of 64-bit unsigned words stored in little, big and
native endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vs64l(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs64l_0028_0040var_007bword_007d-_002e_002e_002e_0029-43"></a></var><br>
&mdash; Reader Syntax: <b>#vs64b(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs64b_0028_0040var_007bword_007d-_002e_002e_002e_0029-44"></a></var><br>
&mdash; Reader Syntax: <b>#vs64n(</b><var>word</var><b> ...)</b><var><a name="index-g_t_0023vs64n_0028_0040var_007bword_007d-_002e_002e_002e_0029-45"></a></var><br>
<blockquote><p>Read a bytevector of 64-bit signed words stored in little, big and
native endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vf4l(</b><var>flonum</var><b> ...)</b><var><a name="index-g_t_0023vf4l_0028_0040var_007bflonum_007d-_002e_002e_002e_0029-46"></a></var><br>
&mdash; Reader Syntax: <b>#vf4b(</b><var>flonum</var><b> ...)</b><var><a name="index-g_t_0023vf4b_0028_0040var_007bflonum_007d-_002e_002e_002e_0029-47"></a></var><br>
&mdash; Reader Syntax: <b>#vf4n(</b><var>flonum</var><b> ...)</b><var><a name="index-g_t_0023vf4n_0028_0040var_007bflonum_007d-_002e_002e_002e_0029-48"></a></var><br>
<blockquote><p>Read a bytevector of single&ndash;precision flonums stored in little, big and
native endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vf8l(</b><var>flonum</var><b> ...)</b><var><a name="index-g_t_0023vf8l_0028_0040var_007bflonum_007d-_002e_002e_002e_0029-49"></a></var><br>
&mdash; Reader Syntax: <b>#vf8b(</b><var>flonum</var><b> ...)</b><var><a name="index-g_t_0023vf8b_0028_0040var_007bflonum_007d-_002e_002e_002e_0029-50"></a></var><br>
&mdash; Reader Syntax: <b>#vf8n(</b><var>flonum</var><b> ...)</b><var><a name="index-g_t_0023vf8n_0028_0040var_007bflonum_007d-_002e_002e_002e_0029-51"></a></var><br>
<blockquote><p>Read a bytevector of double&ndash;precision flonums stored in little, big and
native endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vc4l(</b><var>cflonum</var><b> ...)</b><var><a name="index-g_t_0023vc4l_0028_0040var_007bcflonum_007d-_002e_002e_002e_0029-52"></a></var><br>
&mdash; Reader Syntax: <b>#vc4b(</b><var>cflonum</var><b> ...)</b><var><a name="index-g_t_0023vc4b_0028_0040var_007bcflonum_007d-_002e_002e_002e_0029-53"></a></var><br>
&mdash; Reader Syntax: <b>#vc4n(</b><var>cflonum</var><b> ...)</b><var><a name="index-g_t_0023vc4n_0028_0040var_007bcflonum_007d-_002e_002e_002e_0029-54"></a></var><br>
<blockquote><p>Read a bytevector of single&ndash;precision cflonums stored in little, big
and native endianness, real part first. 
</p></blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#vc8l(</b><var>cflonum</var><b> ...)</b><var><a name="index-g_t_0023vc8l_0028_0040var_007bcflonum_007d-_002e_002e_002e_0029-55"></a></var><br>
&mdash; Reader Syntax: <b>#vc8b(</b><var>cflonum</var><b> ...)</b><var><a name="index-g_t_0023vc8b_0028_0040var_007bcflonum_007d-_002e_002e_002e_0029-56"></a></var><br>
&mdash; Reader Syntax: <b>#vc8n(</b><var>cflonum</var><b> ...)</b><var><a name="index-g_t_0023vc8n_0028_0040var_007bcflonum_007d-_002e_002e_002e_0029-57"></a></var><br>
<blockquote><p>Read a bytevector of double&ndash;precision cflonums stored in little, big
and native endianness, real part first. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-reader-stx"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-reader-fun">iklib reader fun</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-reader-bv">iklib reader bv</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-reader">iklib reader</a>

</div>

<h4 class="subsection">3.2.3 Miscellaneous additional syntaxes</h4>

<p>The following syntaxes are available only when the input port mode is
set to <code>vicare</code>.

<div class="defun">
&mdash; Reader Syntax: <b>|</b><var>symbol</var><b>|</b><var><a name="index-g_t_007c_0040var_007bsymbol_007d_007c-58"></a></var><br>
<blockquote><p>The vertical bars can be used to specify symbols whose name do not
comply with the <acronym>R6RS</acronym> specifications; this syntax is available only
when the port mode is <code>#!vicare</code>.  Examples:

     <pre class="example">          (define port (open-string-input-port "|123|"))
          (set-port-mode! port 'vicare)
          (define sym (read port))
          
          (symbol? sym)           &rArr; #t
          (symbol-&gt;string sym)    &rArr; "123"
</pre>
        <p class="noindent">backslash sequences are allowed in bar symbols:

     <pre class="example">          (define port (open-string-input-port "|123-\x41;\x42;\x43;|"))
          (set-port-mode! port 'vicare)
          (define sym (read port))
          
          (symbol? sym)           &rArr; #t
          (symbol-&gt;string sym)    &rArr; "123-\x41;\x42;\x43;"
</pre>
        <p class="noindent">notice that the sequence of characters <code>|ciao|hello|</code> is split into
<code>ciao</code>, <code>hello</code>, <code>|</code> and the ending vertical bar would
cause an error if read:

     <pre class="example">          (define port (open-string-input-port "|ciao|hello|"))
          (set-port-mode! port 'vicare)
          
          (read port)             &rArr; ciao
          (read port)             &rArr; hello
          (port-eof? port)        &rArr; #f
          (get-char port)         &rArr; #\|
          (port-eof? port)        &rArr; #t
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#!eof</b><var><a name="index-g_t_0023_0021eof-59"></a></var><br>
<blockquote><p>The end&ndash;of&ndash;file marker, <code>#!eof</code>, is an extension to the <acronym>R6RS</acronym>
syntax.  The primary utility of the <code>#!eof</code> marker is to stop the
reader (e.g. <code>read</code> and <code>get-datum</code>) from reading the rest of
the file.

     <pre class="example">          (import (ikarus))
          &lt;some code&gt;
          (display "goodbye\n")
          
          #!eof
          &lt;some junk&gt;
</pre>
        <p>The <code>#!eof</code> marker also serves as a datum in Vicare, much
like <code>#t</code> and <code>#f</code>, when it is found inside other expressions.

     <pre class="example">          &gt; (eof-object)
          #!eof
          &gt; (read (open-input-string ""))
          #!eof
          &gt; (read (open-input-string "#!eof"))
          #!eof
          &gt; (quote #!eof)
          #!eof
          &gt; (eof-object? '#!eof)
          #t
          &gt; #!r6rs #!eof
          Unhandled exception
          Condition components:
            1. &amp;error
            2. &amp;who: tokenize
            3. &amp;message: "invalid syntax: #!e"
          &gt; #!vicare #!eof
          $
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-reader-fun"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-reader-stx">iklib reader stx</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-reader">iklib reader</a>

</div>

<h4 class="subsection">3.2.4 Additional reader functions</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>get-annotated-datum</b><var> port<a name="index-get_002dannotated_002ddatum-60"></a></var><br>
<blockquote><p>Like <code>get-datum</code>, but rather than returning a datum return a
hierarchy of <code>annotation</code> objects with the same hierarchy of the
datum and embedding the datum itself. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-expander"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-shared">iklib shared</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-reader">iklib reader</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.3 Interface to the expander</h3>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>expand</b><var><a name="index-expand-61"></a></var><br>
<blockquote><p>Undocumented. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>core-expand</b><var><a name="index-core_002dexpand-62"></a></var><br>
<blockquote><p>Undocumented. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>expand/optimize</b><var><a name="index-expand_002foptimize-63"></a></var><br>
<blockquote><p>Undocumented. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>expand/scc-letrec</b><var><a name="index-expand_002fscc_002dletrec-64"></a></var><br>
<blockquote><p>Undocumented. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-shared"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-environment">iklib environment</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-expander">iklib expander</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.4 Shared structures graph notation</h3>

<p>This feature of the reader is derived from the <acronym>SRFI</acronym> 38 &ldquo;External
Representation for Data With Shared Structure&rdquo;:

<div align="center"><a href="http://srfi.schemers.org/srfi-38/srfi-38.html">http://srfi.schemers.org/srfi-38/srfi-38.html</a></div>

   <p>This graph notation allows the reader to build symbolic expressions with
graph structure including cycles.  <strong>Shared structures must always
be used inside quoted datums</strong>; if we create a cycle in a symbolic
expression passed as code to the expander: the result will be an
infinite loop.  Graph notation is available only when the textual input
port is configured in <code>#!vicare</code> mode.

   <p>Graph notation extends the <acronym>R6RS</acronym> syntax with these additional cases:

<pre class="example">     &lt;lexeme&gt;                -&gt; &lt;r6rs lexeme&gt;
                              | &lt;defining datum&gt;
                              | &lt;defined datum&gt;
     &lt;defining datum&gt;        -&gt; #&lt;indexnum&gt;=&lt;r6rs lexeme&gt;
     &lt;defined datum&gt;         -&gt; #&lt;indexnum&gt;#
     &lt;indexnum&gt;              -&gt; &lt;digit&gt;+
</pre>
   <p class="noindent">where <code>&lt;r6rs lexeme&gt;</code> is the lexeme definition in <acronym>R6RS</acronym>.

<div class="defun">
&mdash; Parameter: <b>print-graph</b><var><a name="index-print_002dgraph-65"></a></var><br>
&mdash; Parameter: <b>print-graph</b><var> #t<a name="index-print_002dgraph-66"></a></var><br>
&mdash; Parameter: <b>print-graph</b><var> #f<a name="index-print_002dgraph-67"></a></var><br>
<blockquote><p>The graph notation is a way of marking and referencing parts of a data
structure and, consequently, creating shared and cyclic data structures
at read time instead of resorting to explicit mutation at run time.  The
<code>#n=</code> marks the following data structure with mark <var>n</var>, where
<var>n</var> is a nonnegative integer.  The <code>#n#</code> references the data
structure marked <var>n</var>.  Marks can be assigned and referenced in any
order but each mark must be assigned to exactly once in an expression.

     <pre class="example">          &gt; (let ([x '#0=(1 2 3)])
              (eq? x '#0#))
          #t
          &gt; (let ([x '#0#] [y '#0=(1 2 3)])
              (eq? x y))
          #t
          &gt; (eq? (cdr '(12 . #1#)) '#1=(1 2 3))
          #t
          &gt; (let ([x '#1=(#1# . #1#)])
              (and (eq? x (car x))
                   (eq? x (cdr x))))
          #t
</pre>
        <p>The <code>print-graph</code> parameter controls how the writers (e.g. 
<code>pretty-print</code> and <code>write</code>) handle shared and cyclic data
structures.  In Vicare, all writers detect cyclic data structures and
they all terminate on all input, cyclic or otherwise.

        <p>If the value of <code>print-graph</code> is set to <code>#f</code> (the default),
then the writers do not attempt to detect shared data structures.  Any
part of the input that is shared is printed as if no sharing is present. 
If the value of <code>print-graph</code> is set to <code>#t</code>, all sharing of
data structures is marked using the <code>#n=</code> and <code>#n#</code> notation.

     <pre class="example">          &gt; (parameterize ([print-graph #f])
              (let ([x (list 1 2 3 4)])
                (pretty-print (list x x x))))
          ((1 2 3 4) (1 2 3 4) (1 2 3 4))
          
          &gt; (parameterize ([print-graph #t])
              (let ([x (list 1 2 3 4)])
                (pretty-print (list x x x))))
          (#0=(1 2 3 4) #0# #0#)
          
          &gt; (parameterize ([print-graph #f])
              (let ([x (list 1 2)])
                (let ([y (list x x x x)])
                  (set-car! (last-pair y) y)
                  (pretty-print (list y y)))))
          (#0=((1 2) (1 2) (1 2) #0#) #0#)
          
          &gt; (parameterize ([print-graph #t])
              (let ([x (list 1 2)])
                (let ([y (list x x x x)])
                  (set-car! (last-pair y) y)
                  (pretty-print (list y y)))))
          (#0=(#1=(1 2) #1# #1# #0#) #0#)
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-environment"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-cafe">iklib cafe</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-shared">iklib shared</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.5 Environments</h3>

<p><a name="index-Environment_002c-interaction-68"></a>

   <p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>environment?</b><var><a name="index-environment_003f-69"></a></var><br>
<blockquote><p>Undocumented. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>interaction-environment</b><var><a name="index-interaction_002denvironment-70"></a></var><br>
<blockquote><p>Return an environment object representing the environment active at the
<acronym>REPL</acronym>.  To be used as argument for <code>eval</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>new-interaction-environment</b><var><a name="index-new_002dinteraction_002denvironment-71"></a></var><br>
<blockquote><p>Undocumented. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>environment-symbols</b><var><a name="index-environment_002dsymbols-72"></a></var><br>
<blockquote><p>Undocumented. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-cafe"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-structs">iklib structs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-environment">iklib environment</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.6 Cafe</h3>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>new-cafe</b><var><a name="index-new_002dcafe-73"></a></var><br>
&mdash; Function: <b>new-cafe</b><var> eval<a name="index-new_002dcafe-74"></a></var><br>
<blockquote><p>Start a new read&ndash;eval&ndash;print loop (<acronym>REPL</acronym>) inside the current cafe (if
one exists).  It prompts the user for an expression, evaluates it,
prints the result back, and repeats the process.  If <code>new-cafe</code> is
called with an argument, <var>eval</var>, then that argument must be a
procedure that takes a single argument.  The <var>eval</var> procedure will
be used to evaluate the expressions.

        <p>Every time a new cafe is started, the prompt is changed to reflect the
depth of the current cafe (i.e. how many eof objects is takes to exit
the outermost cafe).

        <p>Input and output performed by the cafe can be changed by the
<code>console-input-port</code> and <code>console-output-port</code> parameters.

        <p>If an error occurs during reading, evaluating, or printing an
expression, then the error message is printed to the error&ndash;port and the
operations of the cafe resume as normal.

        <p>To exit from a cafe we can write the <acronym>EOF</acronym> object. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-structs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-lists">iklib lists</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-cafe">iklib cafe</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.7 Structures and type descriptors</h3>

<p>A data structure is like a lightweight record as defined by <acronym>R6RS</acronym>. 
<a href="#objects-structs">objects structs</a> for more informations on the internals of data
structures.

<ul class="menu">
<li><a accesskey="1" href="#iklib-structs-rtd">iklib structs rtd</a>:            Structure type descriptors. 
<li><a accesskey="2" href="#iklib-structs-using">iklib structs using</a>:          Using data structures. 
<li><a accesskey="3" href="#iklib-structs-inspect">iklib structs inspect</a>:        Inspecting data structures. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-structs-rtd"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-structs-using">iklib structs using</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-structs">iklib structs</a>

</div>

<h4 class="subsection">3.7.1 Structure type descriptors</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Syntax: <b>define-struct</b><var> &lt;name&gt; </var>(<var>&lt;field&gt; ...</var>)<var><a name="index-define_002dstruct-75"></a></var><br>
<blockquote><p>Define a new data structure type.  This macro is embedded in the
expander.

        <p>&lt;name&gt; must be a symbol representing the name of the structure; it
is used to build names for the constructor, predicate, field accessors
and mutators.  The &lt;field&gt; values must be symbols representing the
names of the fields; they are used to build names for the accessors and
mutators.

        <p>The following definition:

     <pre class="example">          (define-struct color
            (red green blue))
</pre>
        <p class="noindent">expands to the definition of the following bindings:

          <dl>
<dt><code>color</code><dd>An identifier syntax bound to a pair whose car is the symbol &lsquo;<samp><span class="samp">$rtd</span></samp>&rsquo;
and whose cdr is the return value of <code>make-struct-type</code> applied to
the name of the structure and the list of fields.

          <br><dt><code>make-color </code><var>red</var> <var>green</var> <var>blue</var><dd>A structure constructor accepting as much arguments as there are fields. 
The constructor makes use of the <code>$struct</code> low level operation.

          <br><dt><code>color? </code><var>obj</var><dd>A predicate to distinguish between references to <code>color</code> structures
and other values.  This predicate makes use of the <code>$struct/rtd?</code>
low level operation.

          <br><dt><code>color-red </code><var>stru</var><dt><code>color-green </code><var>stru</var><dt><code>color-blue </code><var>stru</var><dd>Accessors for the fields of the structure.  These accessors make use of
the <code>$struct/rtd?</code> low level operation to validate the argument and
if successful they use <code>$struct-ref</code> to extract the value; if the
argument is of invalid type: an assertion violation is raised.

          <br><dt><code>set-color-red! </code><var>stru</var> <var>red</var><dt><code>set-color-green! </code><var>stru</var> <var>green</var><dt><code>set-color-blue! </code><var>stru</var> <var>blue</var><dd>Mutators for the fields of the structure.  These mutators make use of
the <code>$struct/rtd?</code> low level operation to validate the argument and
if successful they use <code>$struct-set!</code> to extract the value; if the
argument is of invalid type: an assertion violation is raised. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-struct-type</b><var> name fields<a name="index-make_002dstruct_002dtype-76"></a></var><br>
&mdash; Function: <b>make-struct-type</b><var> name fields uid<a name="index-make_002dstruct_002dtype-77"></a></var><br>
<blockquote><p>Build and return a new structure type descriptor.  <var>name</var> must be a
string representing the type name.  <var>fields</var> must be a list of
symbols representing the field names.

        <p>The optional <var>uid</var> argument must be a symbol uniquely identifying
this type; when not supplied, a symbol is automatically generated.  The
<code>$symbol-value</code> field of <var>uid</var> is set to the newly created RTD;
if <var>uid</var> already has a symbol value: such value must be a struct
descriptor equal to the newly created RTD. 
</p></blockquote></div>

<div class="defun">
&mdash; Syntax: <b>type-descriptor</b><var> &lt;name&gt;<a name="index-type_002ddescriptor-78"></a></var><br>
<blockquote><p>Evaluate to the type descriptor of the data structure &lt;name&gt;, which
must be the first argument to a previous use of <code>define-struct</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-type-name</b><var> rtd<a name="index-struct_002dtype_002dname-79"></a></var><br>
<blockquote><p>Return a string represnting the name of structures of type <var>rtd</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-type-symbol</b><var> rtd<a name="index-struct_002dtype_002dsymbol-80"></a></var><br>
<blockquote><p>Return a symbol uniquely identifying the data structure type <var>RTD</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-type-field-names</b><var> rtd<a name="index-struct_002dtype_002dfield_002dnames-81"></a></var><br>
<blockquote><p>Return a list of symbols representing the names of fields in structures
of type <var>rtd</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>set-rtd-printer!</b><var> rtd printer<a name="index-set_002drtd_002dprinter_0021-82"></a></var><br>
<blockquote><p>Select the procedure <var>printer</var> as printer for data structures of
type <var>rtd</var>.  The printer accepts as 3 arguments: the
structure to be printed, the port to which write a string represention
of the structure with <code>display</code>, a function to be optionally
applied to the field values to print them. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-structs-using"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-structs-inspect">iklib structs inspect</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-structs-rtd">iklib structs rtd</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-structs">iklib structs</a>

</div>

<h4 class="subsection">3.7.2 Using data structures</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>struct-constructor</b><var> rtd<a name="index-struct_002dconstructor-83"></a></var><br>
<blockquote><p>Return a constructor function for data structures of type <var>rtd</var>. 
The constructor accepts as many arguments as fields defined by <var>rtd</var>
and returns a new structure instance. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-predicate</b><var> rtd<a name="index-struct_002dpredicate-84"></a></var><br>
<blockquote><p>Return a predicate function for structures of type <var>rtd</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-field-accessor</b><var> rtd index<a name="index-struct_002dfield_002daccessor-85"></a></var><br>
<blockquote><p>Return an accessor function for the field at <var>index</var> of data
structures of type <var>rtd</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-field-mutator</b><var> rtd index<a name="index-struct_002dfield_002dmutator-86"></a></var><br>
<blockquote><p>Return a mutator function for the field at <var>index</var> of data
structures of type <var>rtd</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-structs-inspect"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-structs-using">iklib structs using</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-structs">iklib structs</a>

</div>

<h4 class="subsection">3.7.3 Inspecting data structures</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>struct?</b><var> stru<a name="index-struct_003f-87"></a></var><br>
&mdash; Function: <b>struct?</b><var> stru rtd<a name="index-struct_003f-88"></a></var><br>
<blockquote><p>When no <var>rtd</var> argument is given return true if <var>stru</var> is a data
structure.  When <var>rtd</var> is given: return true if <var>stru</var> is a data
structure and it is of type <var>rtd</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-rtd</b><var> stru<a name="index-struct_002drtd-89"></a></var><br>
<blockquote><p>Return the <var>rtd</var> of the data structure <var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-length</b><var> stru<a name="index-struct_002dlength-90"></a></var><br>
<blockquote><p>Return the number of fields in the data structure <var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-name</b><var> stru<a name="index-struct_002dname-91"></a></var><br>
<blockquote><p>Return a string representing the name of the data structure <var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-printer</b><var> stru<a name="index-struct_002dprinter-92"></a></var><br>
<blockquote><p>Return the procedure being the printer function for the data structure
<var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-ref</b><var> stru index<a name="index-struct_002dref-93"></a></var><br>
<blockquote><p>Return the value of field at <var>index</var> in the data structure
<var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-set!</b><var> stru index value<a name="index-struct_002dset_0021-94"></a></var><br>
<blockquote><p>Store <var>value</var> in the field at <var>index</var> in the data structure
<var>stru</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-lists"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-bytevectors">iklib bytevectors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-structs">iklib structs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.8 Additional list functions</h3>

<ul class="menu">
<li><a accesskey="1" href="#iklib-lists-weak">iklib lists weak</a>:             Weak pairs. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-lists-weak"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-lists">iklib lists</a>

</div>

<h4 class="subsection">3.8.1 Weak pairs</h4>

<p>Weak references do not cause the referenced value to be considered used
by the garbage collector.  The following bindings are exported by the
<code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>weak-cons</b><var> A D<a name="index-weak_002dcons-95"></a></var><br>
<blockquote><p>Like <code>cons</code> build and return a new pair, but holding weak
references to <var>A</var>; notice that the reference to <var>D</var> is not weak. 
This function allows to build a non&ndash;weak list spine holding weak
references to values. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>weak-pair?</b><var> obj<a name="index-weak_002dpair_003f-96"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a weak pair. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>bwp-obejct?</b><var> obj<a name="index-bwp_002dobejct_003f-97"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a weak reference to a value which has been
already garbage collected.  Example:

     <pre class="example">          vicare&gt; (define x (weak-cons (cons 1 2) #f))
          vicare&gt; x
          ((1 . 2) . #f)
          vicare&gt; (bwp-object? (car x))
          #f
          vicare&gt; (collect)
          vicare&gt; x
           (#!bwp . #f)
          vicare&gt; (bwp-object? (car x))
          #t
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-bytevectors"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-strings">iklib strings</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-lists">iklib lists</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.9 Additional bytevector functions</h3>

<p>The description of bytevectors uses the term <em>byte</em> for an exact
integer object in the interval (-128, <small class="dots">...</small>, 127) and the term
<em>octet</em> for an exact integer object in the interval (0,
<small class="dots">...</small>, 255).  A byte corresponds to its two's complement
representation as an octet.

<ul class="menu">
<li><a accesskey="1" href="#iklib-bytevectors-sub">iklib bytevectors sub</a>:        Building subbytevectors. 
<li><a accesskey="2" href="#iklib-bytevectors-conv">iklib bytevectors conv</a>:       Converting bytevectors. 
<li><a accesskey="3" href="#iklib-bytevectors-generic">iklib bytevectors generic</a>:    Generic bytevectors operations. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-bytevectors-sub"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-bytevectors-conv">iklib bytevectors conv</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-bytevectors">iklib bytevectors</a>

</div>

<h4 class="subsection">3.9.1 Building subbytevectors</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>subbytevector-u8</b><var> bv start<a name="index-subbytevector_002du8-98"></a></var><br>
&mdash; Function: <b>subbytevector-u8</b><var> bv start end<a name="index-subbytevector_002du8-99"></a></var><br>
<blockquote><p>Build and return a new bytevector holding the bytes in <var>bv</var> from
index <var>start</var> (inclusive) to index <var>end</var> (exclusive).  The start
and end indexes must be such that:

     <pre class="example">          0 &lt;= <var>start</var> &lt;= <var>end</var> &lt;= (bytevector-length <var>bv</var>)
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>subbytevector-u8/count</b><var> bv start count<a name="index-subbytevector_002du8_002fcount-100"></a></var><br>
<blockquote><p>Build and return a new bytevector holding <var>count</var> bytes in <var>bv</var>
from index <var>start</var> (inclusive).  The start index and the byte count
must be such that:

     <pre class="example">          0 &lt;= <var>start</var> &lt;= <var>start</var> + <var>count</var> &lt;= (bytevector-length <var>bv</var>)
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>subbytevector-s8</b><var> bv start<a name="index-subbytevector_002ds8-101"></a></var><br>
&mdash; Function: <b>subbytevector-s8</b><var> bv start end<a name="index-subbytevector_002ds8-102"></a></var><br>
<blockquote><p>Build and return a new bytevector holding the bytes in <var>bv</var> from
index <var>start</var> (inclusive) to index <var>end</var> (exclusive).  The start
and end indexes must be such that:

     <pre class="example">          0 &lt;= <var>start</var> &lt;= <var>end</var> &lt;= (bytevector-length <var>bv</var>)
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>subbytevector-s8/count</b><var> bv start count<a name="index-subbytevector_002ds8_002fcount-103"></a></var><br>
<blockquote><p>Build and return a new bytevector holding <var>count</var> bytes in <var>bv</var>
from index <var>start</var> (inclusive).  The start index and the byte count
must be such that:

     <pre class="example">          0 &lt;= <var>start</var> &lt;= <var>start</var> + <var>count</var> &lt;= (bytevector-length <var>bv</var>)
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-bytevectors-conv"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-bytevectors-generic">iklib bytevectors generic</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-bytevectors-sub">iklib bytevectors sub</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-bytevectors">iklib bytevectors</a>

</div>

<h4 class="subsection">3.9.2 Converting bytevectors</h4>

<p>These conversion functions work like <code>bytevector-&gt;u8-list</code> and
<code>u8-list-&gt;bytevector</code>.  The following bindings are exported by the
<code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>bytevector-&gt;s8-list</b><var> bytevector<a name="index-bytevector_002d_003es8_002dlist-104"></a></var><br>
&mdash; Function: <b>s8-list-&gt;bytevector</b><var> list<a name="index-s8_002dlist_002d_003ebytevector-105"></a></var><br>
<blockquote><p>Convert between a list of signed bytes and a bytevector. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>s16l-list-&gt;bytevector</b><var> list<a name="index-s16l_002dlist_002d_003ebytevector-106"></a></var><br>
&mdash; Function: <b>s16b-list-&gt;bytevector</b><var> list<a name="index-s16b_002dlist_002d_003ebytevector-107"></a></var><br>
&mdash; Function: <b>s16n-list-&gt;bytevector</b><var> list<a name="index-s16n_002dlist_002d_003ebytevector-108"></a></var><br>
&mdash; Function: <b>u16l-list-&gt;bytevector</b><var> list<a name="index-u16l_002dlist_002d_003ebytevector-109"></a></var><br>
&mdash; Function: <b>u16b-list-&gt;bytevector</b><var> list<a name="index-u16b_002dlist_002d_003ebytevector-110"></a></var><br>
&mdash; Function: <b>u16n-list-&gt;bytevector</b><var> list<a name="index-u16n_002dlist_002d_003ebytevector-111"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s16l-list</b><var> bytevector<a name="index-bytevector_002d_003es16l_002dlist-112"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s16b-list</b><var> bytevector<a name="index-bytevector_002d_003es16b_002dlist-113"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s16n-list</b><var> bytevector<a name="index-bytevector_002d_003es16n_002dlist-114"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u16l-list</b><var> bytevector<a name="index-bytevector_002d_003eu16l_002dlist-115"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u16b-list</b><var> bytevector<a name="index-bytevector_002d_003eu16b_002dlist-116"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u16n-list</b><var> bytevector<a name="index-bytevector_002d_003eu16n_002dlist-117"></a></var><br>
<blockquote><p>Convert between a list of signed or unsigned 16-bit words and a
bytevector in which the words are stored in little, big or native
endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>s32l-list-&gt;bytevector</b><var> list<a name="index-s32l_002dlist_002d_003ebytevector-118"></a></var><br>
&mdash; Function: <b>s32b-list-&gt;bytevector</b><var> list<a name="index-s32b_002dlist_002d_003ebytevector-119"></a></var><br>
&mdash; Function: <b>s32n-list-&gt;bytevector</b><var> list<a name="index-s32n_002dlist_002d_003ebytevector-120"></a></var><br>
&mdash; Function: <b>u32l-list-&gt;bytevector</b><var> list<a name="index-u32l_002dlist_002d_003ebytevector-121"></a></var><br>
&mdash; Function: <b>u32b-list-&gt;bytevector</b><var> list<a name="index-u32b_002dlist_002d_003ebytevector-122"></a></var><br>
&mdash; Function: <b>u32n-list-&gt;bytevector</b><var> list<a name="index-u32n_002dlist_002d_003ebytevector-123"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s32l-list</b><var> bytevector<a name="index-bytevector_002d_003es32l_002dlist-124"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s32b-list</b><var> bytevector<a name="index-bytevector_002d_003es32b_002dlist-125"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s32n-list</b><var> bytevector<a name="index-bytevector_002d_003es32n_002dlist-126"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u32l-list</b><var> bytevector<a name="index-bytevector_002d_003eu32l_002dlist-127"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u32b-list</b><var> bytevector<a name="index-bytevector_002d_003eu32b_002dlist-128"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u32n-list</b><var> bytevector<a name="index-bytevector_002d_003eu32n_002dlist-129"></a></var><br>
<blockquote><p>Convert between a list of signed or unsigned 32-bit words and a
bytevector in which the words are stored in little, big or native
endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>s64l-list-&gt;bytevector</b><var> list<a name="index-s64l_002dlist_002d_003ebytevector-130"></a></var><br>
&mdash; Function: <b>s64b-list-&gt;bytevector</b><var> list<a name="index-s64b_002dlist_002d_003ebytevector-131"></a></var><br>
&mdash; Function: <b>s64n-list-&gt;bytevector</b><var> list<a name="index-s64n_002dlist_002d_003ebytevector-132"></a></var><br>
&mdash; Function: <b>u64l-list-&gt;bytevector</b><var> list<a name="index-u64l_002dlist_002d_003ebytevector-133"></a></var><br>
&mdash; Function: <b>u64b-list-&gt;bytevector</b><var> list<a name="index-u64b_002dlist_002d_003ebytevector-134"></a></var><br>
&mdash; Function: <b>u64n-list-&gt;bytevector</b><var> list<a name="index-u64n_002dlist_002d_003ebytevector-135"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s64l-list</b><var> bytevector<a name="index-bytevector_002d_003es64l_002dlist-136"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s64b-list</b><var> bytevector<a name="index-bytevector_002d_003es64b_002dlist-137"></a></var><br>
&mdash; Function: <b>bytevector-&gt;s64n-list</b><var> bytevector<a name="index-bytevector_002d_003es64n_002dlist-138"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u64l-list</b><var> bytevector<a name="index-bytevector_002d_003eu64l_002dlist-139"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u64b-list</b><var> bytevector<a name="index-bytevector_002d_003eu64b_002dlist-140"></a></var><br>
&mdash; Function: <b>bytevector-&gt;u64n-list</b><var> bytevector<a name="index-bytevector_002d_003eu64n_002dlist-141"></a></var><br>
<blockquote><p>Convert between a list of signed or unsigned 64-bit words and a
bytevector in which the words are stored in little, big or native
endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>f4l-list-&gt;bytevector</b><var> list<a name="index-f4l_002dlist_002d_003ebytevector-142"></a></var><br>
&mdash; Function: <b>f4b-list-&gt;bytevector</b><var> list<a name="index-f4b_002dlist_002d_003ebytevector-143"></a></var><br>
&mdash; Function: <b>f4n-list-&gt;bytevector</b><var> list<a name="index-f4n_002dlist_002d_003ebytevector-144"></a></var><br>
&mdash; Function: <b>bytevector-&gt;f4l-list</b><var> bytevector<a name="index-bytevector_002d_003ef4l_002dlist-145"></a></var><br>
&mdash; Function: <b>bytevector-&gt;f4b-list</b><var> bytevector<a name="index-bytevector_002d_003ef4b_002dlist-146"></a></var><br>
&mdash; Function: <b>bytevector-&gt;f4n-list</b><var> bytevector<a name="index-bytevector_002d_003ef4n_002dlist-147"></a></var><br>
<blockquote><p>Convert between a list of single&ndash;precision flonums and a bytevector in
which the flonums are stored in little, big or native endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>f8l-list-&gt;bytevector</b><var> list<a name="index-f8l_002dlist_002d_003ebytevector-148"></a></var><br>
&mdash; Function: <b>f8b-list-&gt;bytevector</b><var> list<a name="index-f8b_002dlist_002d_003ebytevector-149"></a></var><br>
&mdash; Function: <b>f8n-list-&gt;bytevector</b><var> list<a name="index-f8n_002dlist_002d_003ebytevector-150"></a></var><br>
&mdash; Function: <b>bytevector-&gt;f8l-list</b><var> bytevector<a name="index-bytevector_002d_003ef8l_002dlist-151"></a></var><br>
&mdash; Function: <b>bytevector-&gt;f8b-list</b><var> bytevector<a name="index-bytevector_002d_003ef8b_002dlist-152"></a></var><br>
&mdash; Function: <b>bytevector-&gt;f8n-list</b><var> bytevector<a name="index-bytevector_002d_003ef8n_002dlist-153"></a></var><br>
<blockquote><p>Convert between a list of double&ndash;precision flonums and a bytevector in
which the flonums are stored in little, big or native endianness. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>c4l-list-&gt;bytevector</b><var> list<a name="index-c4l_002dlist_002d_003ebytevector-154"></a></var><br>
&mdash; Function: <b>c4b-list-&gt;bytevector</b><var> list<a name="index-c4b_002dlist_002d_003ebytevector-155"></a></var><br>
&mdash; Function: <b>c4n-list-&gt;bytevector</b><var> list<a name="index-c4n_002dlist_002d_003ebytevector-156"></a></var><br>
&mdash; Function: <b>bytevector-&gt;c4l-list</b><var> bytevector<a name="index-bytevector_002d_003ec4l_002dlist-157"></a></var><br>
&mdash; Function: <b>bytevector-&gt;c4b-list</b><var> bytevector<a name="index-bytevector_002d_003ec4b_002dlist-158"></a></var><br>
&mdash; Function: <b>bytevector-&gt;c4n-list</b><var> bytevector<a name="index-bytevector_002d_003ec4n_002dlist-159"></a></var><br>
<blockquote><p>Convert between a list of single&ndash;precision cflonums and a bytevector in
which the cflonums are stored in little, big or native endianness, real
part first. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>c8l-list-&gt;bytevector</b><var> list<a name="index-c8l_002dlist_002d_003ebytevector-160"></a></var><br>
&mdash; Function: <b>c8b-list-&gt;bytevector</b><var> list<a name="index-c8b_002dlist_002d_003ebytevector-161"></a></var><br>
&mdash; Function: <b>c8n-list-&gt;bytevector</b><var> list<a name="index-c8n_002dlist_002d_003ebytevector-162"></a></var><br>
&mdash; Function: <b>bytevector-&gt;c8l-list</b><var> bytevector<a name="index-bytevector_002d_003ec8l_002dlist-163"></a></var><br>
&mdash; Function: <b>bytevector-&gt;c8b-list</b><var> bytevector<a name="index-bytevector_002d_003ec8b_002dlist-164"></a></var><br>
&mdash; Function: <b>bytevector-&gt;c8n-list</b><var> bytevector<a name="index-bytevector_002d_003ec8n_002dlist-165"></a></var><br>
<blockquote><p>Convert between a list of double&ndash;precision cflonums and a bytevector in
which the flonums are stored in little, big or native endianness, real
part first. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-bytevectors-generic"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-bytevectors-conv">iklib bytevectors conv</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-bytevectors">iklib bytevectors</a>

</div>

<h4 class="subsection">3.9.3 Generic bytevectors operations</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>bytevector-append</b><var> bytevector ...<a name="index-bytevector_002dappend-166"></a></var><br>
<blockquote><p>Concatenate the bytevector arguments and return the result.  If no
arguments are given: return the empty bytevector. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-strings"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-vectors">iklib vectors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-bytevectors">iklib bytevectors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.10 Additional string functions</h3>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>string-copy!</b><var> src.str src.start dst.str dst.start count<a name="index-string_002dcopy_0021-167"></a></var><br>
<blockquote><p>Copy <var>count</var> characters from <var>src.str</var> starting at
<var>src.start</var> (inclusive) to <var>dst.str</var> starting at
<var>dst.start</var>.  Return unspecified values. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>string-&gt;latin1</b><var> string<a name="index-string_002d_003elatin1-168"></a></var><br>
&mdash; Function: <b>latin1-&gt;string</b><var> bytevevctor<a name="index-latin1_002d_003estring-169"></a></var><br>
<blockquote><p>Convert to and from a Scheme string and a Scheme bytevector holding the
Latin-1 encoding of the characters. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>string-&gt;utf16le</b><var> string<a name="index-string_002d_003eutf16le-170"></a></var><br>
&mdash; Function: <b>string-&gt;utf16be</b><var> string<a name="index-string_002d_003eutf16be-171"></a></var><br>
&mdash; Function: <b>string-&gt;utf16n</b><var> string<a name="index-string_002d_003eutf16n-172"></a></var><br>
&mdash; Function: <b>utf16le-&gt;string</b><var> bytevector<a name="index-utf16le_002d_003estring-173"></a></var><br>
&mdash; Function: <b>utf16be-&gt;string</b><var> bytevector<a name="index-utf16be_002d_003estring-174"></a></var><br>
&mdash; Function: <b>utf16n-&gt;string</b><var> bytevector<a name="index-utf16n_002d_003estring-175"></a></var><br>
<blockquote><p>Convert to and from a Scheme string and a Scheme bytevector holding the
<acronym>UTF</acronym>-16 encoding of the characters under little, big or native
endianness respectively. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>uuid</b><var><a name="index-uuid-176"></a></var><br>
<blockquote><p>Attempt to build a unique string and return it.  If an internal error
occurs because of impossible generation: raise an error. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-vectors"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-symbols">iklib symbols</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-strings">iklib strings</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.11 Additional vector functions</h3>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>subvector</b><var> vec start end<a name="index-subvector-177"></a></var><br>
<blockquote><p><var>vec</var> must be a vector, and <var>start</var> and <var>end</var> must be exact
integer objects satisfying:

     <pre class="example">          0 &lt;= <var>start</var> &lt;= <var>end</var> &lt;= (vector-length <var>vec</var>)
</pre>
        <p>Return a newly allocated vector formed from the items of <var>vec</var>
beginning with index <var>start</var> (inclusive) and ending with index
<var>end</var> (exclusive). 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>vector-append</b><var> vec ...<a name="index-vector_002dappend-178"></a></var><br>
<blockquote><p>Return a newly allocated vector whose items form the concatenation of
the given vectors. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>vector-copy</b><var> vec<a name="index-vector_002dcopy-179"></a></var><br>
<blockquote><p>Return a newly allocated copy of the given vector. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>vector-copy!</b><var> src.vec src.start dst.vec dst.start count<a name="index-vector_002dcopy_0021-180"></a></var><br>
<blockquote><p>Copy <var>count</var> items from <var>src.vec</var> starting at <var>src.start</var>
(inclusive) to <var>dst.vec</var> starting at <var>dst.start</var>.  Return
unspecified values. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>vector-for-all</b><var> proc vec1 vec2 <small class="dots">...</small> vecn<a name="index-vector_002dfor_002dall-181"></a></var><br>
&mdash; Procedure: <b>vector-exists</b><var> proc vec1 vec2 <small class="dots">...</small> vecn<a name="index-vector_002dexists-182"></a></var><br>
<blockquote><p>The <var>vec</var>s should all have the same length, and <var>proc</var> should
accept N arguments and return a single value.  <var>proc</var> should
not mutate the <var>vec</var> arguments.

        <p>For natural numbers i = 0, 1, <small class="dots">...</small>, the <code>vector-for-all</code>
procedure successively applies <var>proc</var> to arguments x_i^1
<small class="dots">...</small> x_i^N, where x_i^j is the i-th element of
<var>vecj</var>, until <code>#f</code> is returned.

        <p>If <var>proc</var> returns true values for all but the last element of
<var>vec1</var>, <code>vector-for-all</code> performs a tail call of <var>proc</var> on
the k-th elements, where k is the length of <var>vec1</var>. 
If <var>proc</var> returns <code>#f</code> on any set of elements,
<code>vector-for-all</code> returns <code>#f</code> after the first such application
of <var>proc</var>.  If the <var>vec</var>s are all empty, <code>vector-for-all</code>
returns <code>#t</code>.

        <p>For natural numbers i = 0, 1, <small class="dots">...</small>, the <code>vector-exists</code>
procedure applies <var>proc</var> successively to arguments x_i^1
<small class="dots">...</small> x_i^n, where x_i^j is the i-th element of
<var>vecj</var>, until a true value is returned.

        <p>If <var>proc</var> returns <code>#f</code> for all but the last elements of the
<var>vec</var>s, <code>vector-exists</code> performs a tail call of <var>proc</var> on
the k-th elements, where k is the length of <var>vec1</var>. 
If <var>proc</var> returns a true value on any set of elements,
<code>vector-exists</code> returns that value after the first such application
of <var>proc</var>.  If the <var>vec</var>s are all empty, <code>vector-exists</code>
returns <code>#f</code>.

        <p><var>proc</var> is always called in the same dynamic environment as
<code>vector-for-all</code> or, respectively, <code>vector-exists</code> itself. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-symbols"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-numerics">iklib numerics</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-vectors">iklib vectors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.12 Additional symbol functions</h3>

<ul class="menu">
<li><a accesskey="1" href="#iklib-symbols-value">iklib symbols value</a>:          Symbol values. 
<li><a accesskey="2" href="#iklib-symbols-plists">iklib symbols plists</a>:         Property lists. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-symbols-value"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-symbols-plists">iklib symbols plists</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-symbols">iklib symbols</a>

</div>

<h4 class="subsection">3.12.1 Symbol values</h4>

<p>Symbol values have miscellaneous uses: when a symbol is the unique
identifier for a data structure, its symbol value field is set to the
type descriptor of the data structure; when a symbol is the unique label
of a binding in the expander, its symbol value is a reference to the
binding.  <a href="#syslib-symbols">syslib symbols</a> for more details on symbol values.

   <p>The following bindings are exported by the <code>(ikarus)</code> and the
<code>(ikarus symbols)</code> libraries.

<div class="defun">
&mdash; Function: <b>set-symbol-value!</b><var> sym value<a name="index-set_002dsymbol_002dvalue_0021-183"></a></var><br>
<blockquote><p>Store <var>value</var> in the <code>$symbol-value</code> field of the symbol
<var>sym</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>symbol-value</b><var> sym<a name="index-symbol_002dvalue-184"></a></var><br>
<blockquote><p>Return the value in the <code>$symbol-value</code> field of the symbol
<var>sym</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>symbol-bound?</b><var> sym<a name="index-symbol_002dbound_003f-185"></a></var><br>
<blockquote><p>Return true if <var>sym</var> is a symbol and its <code>$symbol-value</code> field
is set to the special &ldquo;unbound&rdquo; machine word value. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-symbols-plists"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-symbols-value">iklib symbols value</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-symbols">iklib symbols</a>

</div>

<h4 class="subsection">3.12.2 Property lists</h4>

<p>Property lists are associations key/value that can be attached to any
Scheme symbol.  The following bindings are exported by the
<code>(ikarus)</code> and the <code>(ikarus symbols)</code> libraries.

<pre class="example">     #!ikarus
     (import (ikarus))
     
     (putprop 'ciao 'british 'hello)
     (putprop 'ciao 'spanish 'hola)
     
     (getprop 'ciao 'british)        &rArr; hello
     (getprop 'ciao 'spanish)        &rArr; hola
     
     (remprop 'ciao 'british)
     (getprop 'ciao 'british)        &rArr; #f
     
     (property-list 'ciao)           &rArr; ((spanish . hola))
</pre>
   <div class="defun">
&mdash; Function: <b>putprop</b><var> symbol key value<a name="index-putprop-186"></a></var><br>
<blockquote><p>Add a new property <var>key</var> with <var>value</var> to the property list of
<var>symbol</var>.  <var>key</var> must be a symbol, <var>value</var> can be any value.

        <p>If <var>key</var> is already set: the old entry is mutated to reference the
new <var>value</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getprop</b><var> symbol key<a name="index-getprop-187"></a></var><br>
<blockquote><p>Return the value of the property <var>key</var> in the property list of
<var>symbol</var>; if <var>key</var> is not set return false.  <var>key</var> must be a
symbol. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>remprop</b><var> symbol key<a name="index-remprop-188"></a></var><br>
<blockquote><p>Remove property <var>key</var> from the list associated to <var>symbol</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>property-list</b><var> symbol<a name="index-property_002dlist-189"></a></var><br>
<blockquote><p>Return a new association list representing the property list of
<var>symbol</var>.  The order of the entries is the same as the property
creation order. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-numerics"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-load">iklib load</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-symbols">iklib symbols</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.13 Additional functions on numbers</h3>

<ul class="menu">
<li><a accesskey="1" href="#iklib-numerics-preds">iklib numerics preds</a>:         Additional numeric predicates. 
<li><a accesskey="2" href="#iklib-numerics-flonums">iklib numerics flonums</a>:       Additional flonum functions. 
<li><a accesskey="3" href="#iklib-numerics-math">iklib numerics math</a>:          Additional math functions. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-numerics-preds"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-numerics-flonums">iklib numerics flonums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-numerics">iklib numerics</a>

</div>

<h4 class="subsection">3.13.1 Additional numeric predicates</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> and
<code>(vicare)</code> libraries.

<div class="defun">
&mdash; Function: <b>bignum?</b><var> obj<a name="index-bignum_003f-190"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is an exact integer represented by a big
number. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ratnum?</b><var> obj<a name="index-ratnum_003f-191"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is an exact rational number. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>cflonum?</b><var> obj<a name="index-cflonum_003f-192"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a complex number having flonums as both real
and imaginary parts. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>compnum?</b><var> obj<a name="index-compnum_003f-193"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a complex number having any possible
combination of number representations as real and imaginary parts, but
not both flonums. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-numerics-flonums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-numerics-math">iklib numerics math</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-numerics-preds">iklib numerics preds</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-numerics">iklib numerics</a>

</div>

<h4 class="subsection">3.13.2 Additional flonum functions</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> and
<code>(vicare)</code> libraries.

<!--  -->
<h5 class="subsubheading">Exponents and logarithms</h5>

<div class="defun">
&mdash; Function: <b>fllog1p</b><var> fl<a name="index-fllog1p-194"></a></var><br>
<blockquote><p>Return a flonum equivalent to log(1 + <var>fl</var>). 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>flexpm1</b><var> fl<a name="index-flexpm1-195"></a></var><br>
<blockquote><p>Return a flonum equivalent to exp(<var>fl</var>) - 1. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-numerics-math"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-numerics-flonums">iklib numerics flonums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-numerics">iklib numerics</a>

</div>

<h4 class="subsection">3.13.3 Additional math functions</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> and
<code>(vicare)</code> libraries.

<!--  -->
<h5 class="subsubheading">Hyperbolic functions</h5>

<p>The <var>num</var> operand must be a real or complex number.

<div class="defun">
&mdash; Function: <b>sinh</b><var> num<a name="index-sinh-196"></a></var><br>
&mdash; Function: <b>cosh</b><var> num<a name="index-cosh-197"></a></var><br>
&mdash; Function: <b>tanh</b><var> num<a name="index-tanh-198"></a></var><br>
<blockquote><p>Hyperbolic functions. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>asinh</b><var> num<a name="index-asinh-199"></a></var><br>
&mdash; Function: <b>acosh</b><var> num<a name="index-acosh-200"></a></var><br>
&mdash; Function: <b>atanh</b><var> num<a name="index-atanh-201"></a></var><br>
<blockquote><p>Inverse hyperbolic functions. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-load"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-import">iklib import</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-numerics">iklib numerics</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.14 Loading source files</h3>

<p>Loading of source files can be done explicitly or by requesting a
library with the <code>import</code> form.  Here we see how to load files by
specifying their pathname on the file system.

<div class="defun">
&mdash; Function: <b>load</b><var> pathname<a name="index-load-202"></a></var><br>
&mdash; Function: <b>load</b><var> pathname eval-proc<a name="index-load-203"></a></var><br>
<blockquote><p>Read and evaluate the file selected by the string <var>pathname</var>.

        <p>If <var>eval-proc</var> is given: it must be a procedure that takes a single
argument, an annotated form, and evaluates it.  The default
<var>eval-proc</var> looks like this:

     <pre class="example">          (define (load-handler x)
            (eval x (interaction-environment)))
</pre>
        <p>The format of the annotated source is the one which is comprehensible by
<code>eval</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-import"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-modules">iklib modules</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-load">iklib load</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.15 Local library imports</h3>

<div class="defun">
&mdash; Syntax: <b>import</b><var> import-spec* ...<a name="index-import-204"></a></var><br>
<blockquote><p>The <code>import</code> keyword which is exported from the <code>(ikarus)</code>
library can be used anywhere definitions can occur: at a script body,
library's top&ndash;level, or in internal definitions context.  The syntax of
the local <code>import</code> form is similar to the <code>import</code> that
appears at the top of a library or a script form, and carries with it
the same restrictions: no identifier name may be imported twice unless
it denotes the same identifier; no identifier may be both imported and
defined; and imported identifiers are immutable.

        <p>Local <code>import</code> forms are useful for two reasons: (1) they minimize
the namespace clutter that usually occurs when many libraries are
imported at the top level, and (2) they limit the scope of the import
and thus help modularize a library's dependencies.

        <p>Suppose you are constructing a large library and at some point you
realize that one of your procedures needs to make use of some other
library for performing a specific task.  Importing that library at top
level makes it available for the entire library.  Consequently, even if
that library is no longer used anywhere in the code (say when the code
that uses it is deleted), it becomes very hard to delete the import
without first examiniming the entire library body for potential usage
leaks.  By locally importing a library into the appropriate scope, we
gain the ability to delete the <code>import</code> form when the procedure
that was using it is deleted. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-modules"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-parameters">iklib parameters</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-import">iklib import</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.16 Local modules</h3>

<p>Modules are somewhat like libraries in that they define a set of
bindings in a &ldquo;private namespace&rdquo;; bindings can be exported from a
module and imported into other modules and libraries.  The main
difference between modules and <acronym>R6RS</acronym> libraries is that modules are
defined in a single form nested into a library; so, in a way, they are
sub&ndash;libraries.

   <blockquote>
<strong>NOTE</strong> In the official documentation of Vicare 0.0.3+
(revision 1648) modules are yet not documented.  Please refer to Section
10.5 of Chez Scheme User's Guide, Chapter 3 of Oscar Waddel's Ph.D
Thesis, and its POPL99 paper for details on using the <code>module</code> and
<code>import</code> keywords.  Vicare's internal module system is
similar in spirit to that of Chez Scheme. 
</blockquote>

<ul class="menu">
<li><a accesskey="1" href="#iklib-modules-examples">iklib modules examples</a>:       Usage example for modules. 
<li><a accesskey="2" href="#iklib-modules-api">iklib modules api</a>:            Modules programming interface. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-modules-examples"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-modules-api">iklib modules api</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-modules">iklib modules</a>

</div>

<h4 class="subsection">3.16.1 Usage example for modules</h4>

<ul class="menu">
<li><a accesskey="1" href="#iklib-modules-examples-anonymous">iklib modules examples anonymous</a>:  Anonymous modules. 
<li><a accesskey="2" href="#iklib-modules-examples-named">iklib modules examples named</a>:      Named modules. 
<li><a accesskey="3" href="#iklib-modules-examples-utils">iklib modules examples utils</a>:      Utilities examples. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-modules-examples-anonymous"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-modules-examples-named">iklib modules examples named</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-modules-examples">iklib modules examples</a>

</div>

<h5 class="subsubsection">3.16.1.1 Anonymous modules</h5>

<p>The following example defines an anonymous module, without expressions,
and invokes its functions from the enclosing environment (which is the
top level):

<pre class="example">     (import (ikarus))
     
     (module (one two three)
         (define (one)       'one)
         (define (two)       'two)
         (define (three)     (cons 'three (hidden)))
         (define (hidden)    'hidden))
     
     (printf "calling anonymous: ~s ~s ~s~%" (one) (two) (three))
</pre>
   <p class="noindent">notice that the <code>hidden</code> function is visible inside the module but
not in the enclosing environment.

   <p>The following example defines a module, with expressions, and invokes
its functions from the enclosing environment (which is the top level):

<pre class="example">     (import (ikarus))
     
     (module (one two three)
         (define (one)       'one)
         (define (two)       'two)
         (define (three)     (cons 'three (hidden)))
         (define (hidden)    'hidden)
     
         (printf "defining an anonymous module~%"))
     
     (printf "calling anonymous: ~s ~s ~s~%" (one) (two) (three))
</pre>
   <p class="noindent">notice that when the enclosing environment is the top level: the
expressions at the end of a module are evaluated <strong>after</strong> the
expressions at the top level; so the output from the example is:

<pre class="example">     calling anonymous: one two (three . hidden)
     defining an anonymous module
</pre>
   <p class="noindent">this can lead to undesired results if the module's expressions are meant
to initialise the state of the module, and the expressions at the top
level invoke the module's functions (before initialisation).  On the
other hand: this behaviour allows the module to access definitions from
the enclosing environment and the top level environment despite their
placement in the file; see below for an example.  The same behaviour is
shown by named modules.

   <p>The following example defines a module, with expressions, and invokes
its functions from the enclosing environment (which is a <code>let</code>
form):

<pre class="example">     (import (ikarus))
     
     (let ()
       (module (one two three)
           (define (one)       'one)
           (define (two)       'two)
           (define (three)     (cons 'three (hidden)))
           (define (hidden)    'hidden)
     
           (printf "defining an anonymous module~%"))
     
       (printf "calling anonymous: ~s ~s ~s~%" (one) (two) (three)))
</pre>
   <p class="noindent">notice that when the enclosing environment is <strong>not</strong> the top
level: the expressions at the end of a module are evaluated
<strong>before</strong> the expressions in the body of the enclosing
environment; so the output from the example is:

<pre class="example">     defining an anonymous module
     calling anonymous: one two (three . hidden)
</pre>
   <p class="noindent">so the state of the module can be correctly initialised before its
functions are invoked.  The same behaviour is shown by named modules.

   <p>The following example shows that bindings from the enclosing environment
and the top level environment are accessible from the modules:

<pre class="example">     (import (ikarus))
     
     (define (top-level-before) 'top-level-before)
     
     (let ()
     
       (define (outer-before) 'outer-before)
     
       (module (one two three)
         (define (one)       'one)
         (define (two)       'two)
         (define (three)     (list 'three
                                   (outer-before)
                                   (outer-after)
                                   (top-level-before)
                                   (top-level-after))))
     
       (define (outer-after) 'outer-after)
     
       (printf "calling anonymous: ~s ~s ~s~%" (one) (two) (three)))
     
     (define (top-level-after) 'top-level-after)
</pre>
   <p class="noindent">this happens both when the enclosing environment is the top level and
when the enclosing environment is not the top level.  The same behaviour
is shown by named modules.

<!-- page -->
<div class="node">
<a name="iklib-modules-examples-named"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-modules-examples-utils">iklib modules examples utils</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-modules-examples-anonymous">iklib modules examples anonymous</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-modules-examples">iklib modules examples</a>

</div>

<h5 class="subsubsection">3.16.1.2 Named modules</h5>

<p>The following example defines a module named <code>blue</code> and invokes
functions from it in the top level environment:

<pre class="example">     (import (ikarus))
     
     [module blue (blue-one blue-two blue-three)
         (define (blue-one)          'blue-one)
         (define (blue-two)          'blue-two)
         (define (blue-three)        (cons 'blue-three (hidden)))
         (define (hidden)            'blue-hidden)]
     
     (import blue)
     (printf "calling blue: ~s ~s ~s~%"
             (blue-one) (blue-two) (blue-three))
</pre>
   <p class="noindent">notice that bindings from a named module are accessible only if imported
in the enclosing environment.

   <p>The following example defines two modules named <code>green</code> and
<code>red</code>, then it imports their bindings in different environments:

<pre class="example">     (import (ikarus))
     
     (let ()
     
       [module green (one two three)
         (define (one)       'green-one)
         (define (two)       'green-two)
         (define (three)     (cons 'green-three (hidden)))
         (define (hidden)    'green-hidden)]
     
       [module red (one two three)
         (define (one)       'red-one)
         (define (two)       'red-two)
         (define (three)     (cons 'red-three (hidden)))
         (define (hidden)    'red-hidden)]
     
       (import green)
     
       [let ()
         (import red)
         (printf "calling red: ~s ~s ~s~%" (one) (two) (three))]
     
       (printf "calling green: ~s ~s ~s~%" (one) (two) (three)))
</pre>
   <p>The following example shows that modules in the same enclosing
environment can import their bindings:

<pre class="example">     (import (ikarus))
     
     (let ()
     
       [module green (one two)
         (define (one)       'one)
         (define (two)       'two)]
     
       [module red (f g)
         (import green)
         (define (f)         (cons 'f (one)))
         (define (g)         (cons 'g (two)))]
     
       (import red)
       (printf "calling red: ~s ~s~%" (f) (g)))
</pre>
   <p class="noindent">while the following example shows that bindings from an anonymous module
are automatically available in modules defined in the same enclosing
environment:

<pre class="example">     (import (ikarus))
     
     (let ()
     
       [module (one two)
         (define (one)       'one)
         (define (two)       'two)]
     
       [module red (f g)
         (define (f)         (cons 'f (one)))
         (define (g)         (cons 'g (two)))]
     
       (import red)
       (printf "calling red: ~s ~s~%" (f) (g)))
</pre>
   <p class="noindent">and the following example shows that the order of module definitions
does not matter in determining visibility of bindings from
<strong>anonymous</strong> modules:

<pre class="example">     (import (ikarus))
     
     (let ()
     
       [module red (f g)
         (define (f)         (cons 'f (one)))
         (define (g)         (cons 'g (two)))]
     
       [module (one two)
         (define (one)       'one)
         (define (two)       'two)]
     
       (import red)
       (printf "calling red: ~s ~s~%" (f) (g)))
</pre>
   <p class="noindent">the following is an <strong>error</strong> because it tries to import bindings
from a <strong>named</strong> module before its definition:

<pre class="example">     (import (ikarus))
     
     (let ()
     
       [module red (f g)
         (import green)
         (define (f)         (cons 'f (one)))
         (define (g)         (cons 'g (two)))]
     
       [module green (one two)
         (define (one)       'one)
         (define (two)       'two)]
     
       (import red)
       (printf "calling red: ~s ~s~%" (f) (g)))
</pre>
   <!-- page -->
<div class="node">
<a name="iklib-modules-examples-utils"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-modules-examples-named">iklib modules examples named</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-modules-examples">iklib modules examples</a>

</div>

<h5 class="subsubsection">3.16.1.3 Utilities examples</h5>

<p>The following example shows how syntactic abstractions can be used to
access definitions in a module without using the <code>import</code> form:

<pre class="example">     (import (ikarus))
     
     (let ()
     
       (define-syntax in-module
         (syntax-rules ()
           [(_ ?module ?expr ...)
            (let () (import ?module) ?expr ...)]))
     
       [module red (one two)
         (define (one arg)   (cons 'red-one arg))
         (define (two arg)   (cons 'red-two arg))]
     
       [module green (one two)
         (define (one arg)   (cons 'green-one arg))
         (define (two arg)   (cons 'green-two arg))]
     
       (printf "calling ones: ~s ~s~%"
               [(in-module red one)   123]
               [(in-module green one) 456]))
</pre>
   <!-- page -->
<div class="node">
<a name="iklib-modules-api"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-modules-examples">iklib modules examples</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-modules">iklib modules</a>

</div>

<h4 class="subsection">3.16.2 Modules programming interface</h4>

<div class="defun">
&mdash; Syntax: <b>module</b><var> interface definitions ... expressions ...<a name="index-module-205"></a></var><br>
&mdash; Syntax: <b>module</b><var> name interface definitions ... expressions ...<a name="index-module-206"></a></var><br>
<blockquote><p>Define a new local module.  The first form defines an <em>anonymous</em>
module, while the second form defines a <em>named</em> module called
<var>name</var>, which must be a symbol.

        <p><var>interface</var> is a list of symbols that select bindings from this
module to be exported.  Every listed symbol must be bound in this
module's <var>definitions</var>, otherwise an error is raised.

        <p><var>definitions</var> is a set of bindings like the one that may appear at
the beginning of a <code>let</code> body, with the addition of <code>import</code>
forms that may import bindings from libraries and other modules.

        <p><var>expressions</var> is a set of expressions that is evaluated at module's
definition time.

        <p>Modules &ldquo;exist&rdquo; only in the enclosing region, bindings exported from a
module are not accessible outside of the enclosing region.  Modules can
be nested and import/export relations are possible according to the
regions nesting hierarchy.

        <p>Bindings in the <var>interface</var> declared by anonymous modules are
imported by default in the enclosing region: there is no need to use
<code>import</code>.  Bindings in the <var>interface</var> declared by named
modules are visible only in regions that <code>import</code> the module.

        <p><var>definitions</var> and <var>expressions</var> have no default access to the
bindings in the enclosing region; only imported bindings are visible
from the module. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-parameters"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-gensym">iklib gensym</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-modules">iklib modules</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.17 Parameters</h3>

<p>Parameters in Vicare<a rel="footnote" href="#fn-2" name="fnd-2"><sup>2</sup></a> are intended for
customizing the behavior of a procedure during the dynamic execution of
some piece of code.  Parameters are first class entities (represented as
procedures) that hold the parameter value.  A parameter procedure
accepts either zero or one argument.  If given no arguments, it returns
the current value of the parameter.  If given a single argument, it must
set the state to the value of the argument.

   <p>Parameters replace the older concept of using starred <code>*global*</code>
customization variables.  For example, instead of writing:

<pre class="example">     (define *screen-width* 72)
</pre>
   <p class="noindent">and then mutating the variable <code>*screen-width*</code> with <code>set!</code>,
we could wrap the variable <code>*screen-width*</code> with a
<code>screen-width</code> parameter as follows:

<pre class="example">     (define *screen-width* 72)
     (define screen-width
        (case-lambda
          [()  *screen-width*]
          [(x) (set! *screen-width* x)]))
</pre>
   <p>The value of <code>screen-width</code> can now be passed as argument, returned
as a value, and exported from libraries.

<div class="defun">
&mdash; Procedure: <b>make-parameter</b><var> x<a name="index-make_002dparameter-207"></a></var><br>
&mdash; Procedure: <b>make-parameter</b><var> x f<a name="index-make_002dparameter-208"></a></var><br>
<blockquote><p>As parameters are common in Vicare, the procedure <code>make-parameter</code>
is defined to model the common usage pattern of parameter construction.

        <p><code>(make-parameter x)</code> constructs a parameter with <var>x</var> as the
initial value.  For example, the code above could be written succinctly
as:

     <pre class="example">          (define screen-width (make-parameter 72))
</pre>
        <p><code>(make-parameter x f)</code> constructs a parameter which filters the
assigned values through the procedure <var>f</var>.  The initial value of the
parameter is the result of calling <code>(f x)</code>.  Typical uses of the
filter procedure include checking some constraints on the passed
argument or converting it to a different data type.  The
<code>screen-width</code> parameter may be constructed more robustly as:

     <pre class="example">          (define screen-width
            (make-parameter 72
              (lambda (w)
                (assert (and (integer? w) (exact? w)))
                (max w 1))))
</pre>
        <p>This definition ensures, through <code>assert</code>, that the argument passed
is an exact integer.  It also ensures, through <code>max</code> that the
assigned value is always positive. 
</p></blockquote></div>

<div class="defun">
&mdash; Syntax: <b>parameterize</b> ([<var>lhs* rhs*</var>]<var> ...</var>)<var> body body* ...<a name="index-parameterize-209"></a></var><br>
<blockquote><p>Parameters can be assigned to by simply calling the parameter procedure
with a single argument.  The <code>parameterize</code> syntax is used to set
the value of a parameter within the dynamic extent of the <code>body
body* ...</code> expressions.

        <p>The <code>lhs* ...</code> are expressions, each of which must evaluate to a
parameter.  Such parameters are not necessarily constructed by
<code>make-parameter</code>&mdash;any procedure that follows the parameters
protocol works.

        <p>The advantage of using <code>parameterize</code> over explicitly assigning to
parameters (same argument applies to global variables) is that you're
guaranteed that whenever control exits the body of a <code>parameterize</code>
expression, the value of the parameter is reset back to what it was
before the body expressions were entered.  This is true even in the
presence of <code>call/cc</code>, errors, and exceptions.

        <p>The following example shows how to set the text property of a terminal
window.  The parameter <code>terminal-property</code> sends an <acronym>ANSI</acronym> escape
sequence to the terminal whenever the parameter value is changed.  The
use of <code>terminal-property</code> within <code>parameterize</code> changes the
property before <code>(display "RED!")</code> is called and resets it back to
normal when the body returns.

     <pre class="example">          (define terminal-property
            (make-parameter "0"
              (lambda (x)
                (display "\x1b;[")
                (display x)
                (display "m")
                x)))
          
          (display "Normal and ")
          (parameterize ([terminal-property "41;37"])
            (display "RED!"))
          (newline)
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-gensym"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-printing">iklib printing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-parameters">iklib parameters</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.18 Gensyms</h3>

<p>Gensym stands for <em>generated symbol</em>&mdash;a fresh symbol that is
generated at run time and is guaranteed to be <em>not</em> <code>eq?</code> to
any other symbol present in the system.  Gensyms are useful in many
applications including expanders, compilers, and interpreters when
generating an arbitrary number of unique names is needed.

   <p>Vicare is similar to Chez Scheme in that the readers (including the
<code>read</code> procedure) and writers (including <code>write</code> and
<code>pretty-print</code>) maintain the read/write invariance on gensyms. 
When a gensym is written to an output port, the system automatically
generates a random unique identifier for the gensym.  When the gensym is
read back though the <code>#{gensym}</code> read syntax, a new gensym is
<em>not</em> regenerated, but instead, it is looked up in the global
symbol table.

   <p>A gensym's name is composed of two parts: a <em>pretty</em> string and a
<em>unique</em> string.  The Scheme procedure <code>symbol-&gt;string</code>
returns the pretty string of the gensym and not its unique string. 
Gensyms are printed by default as <code>#{pretty-string unique-string}</code>.

<div class="defun">
&mdash; Procedure: <b>gensym</b><var><a name="index-gensym-210"></a></var><br>
&mdash; Procedure: <b>gensym</b><var> string<a name="index-gensym-211"></a></var><br>
&mdash; Procedure: <b>gensym</b><var> symbol<a name="index-gensym-212"></a></var><br>
<blockquote><p>Construct a new gensym.  If passed no arguments, construct a gensym with
no pretty name.  The pretty name is constructed when and if the pretty
name of the resulting gensym is needed.  If <code>gensym</code> is passed a
string, that string is used as the pretty name.  If <code>gensym</code> is
passed a symbol, the pretty name of the symbol is used as the pretty
name of the returned gensym.  See <code>gensym-prefix</code> and
<code>gensym-count</code> for details.

     <pre class="example">          &gt; (gensym)
          #{g0 |y0zf&gt;GlFvcTJE0xw|}
          &gt; (gensym)
          #{g1 |U%X&amp;sF6kX!YC8LW=|}
          &gt; (eq? (gensym) (gensym))
          #f
</pre>
        <p><code>(gensym string)</code> constructs a new gensym with <var>string</var> as its
pretty name.  Similarly, <code>(gensym symbol)</code> constructs a new gensym
with the pretty name of <var>symbol</var>, if it has one, as its pretty name.

     <pre class="example">          &gt; (gensym "foo")
          #{foo |&gt;VgOllCM&amp;$dSvRN=|}
          &gt; (gensym 'foo)
          #{foo |!TqQLmtw2hoEYfU&gt;|}
          &gt; (gensym (gensym 'foo))
          #{foo |N2C&gt;5O0&gt;C?OROUBU|}
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>gensym?</b><var> x<a name="index-gensym_003f-213"></a></var><br>
<blockquote><p>Return <code>#t</code> if its argument is a gensym, return <code>#f</code> otherwise.

     <pre class="example">          &gt; (gensym? (gensym))
          #t
          &gt; (gensym? 'foo)
          #f
          &gt; (gensym? 12)
          #f
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>gensym-&gt;unique-string</b><var> gensym<a name="index-gensym_002d_003eunique_002dstring-214"></a></var><br>
<blockquote><p>Return the unique name associated with the gensym argument.

     <pre class="example">          &gt; (gensym-&gt;unique-string (gensym))
          "YukrolLMgP?%ElcR"
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Reader Syntax: <b>#{gensym}</b><var><a name="index-g_t_0023_0040_007bgensym_0040_007d-215"></a></var><br>
&mdash; Reader Syntax: <b>#{unique-name}</b><var><a name="index-g_t_0023_0040_007bunique_002dname_0040_007d-216"></a></var><br>
&mdash; Reader Syntax: <b>#{pretty-name unique-name}</b><var><a name="index-g_t_0023_0040_007bpretty_002dname-unique_002dname_0040_007d-217"></a></var><br>
&mdash; Reader Syntax: <b>#:pretty-name</b><var><a name="index-g_t_0023_003apretty_002dname-218"></a></var><br>
<blockquote><p>Vicare's <code>read</code> and <code>write</code> procedures extend the lexical
syntax of Scheme by the ability to read and write gensyms using one of
these three forms.

        <p><code>#{unique-name}</code> constructs, at read time, a gensym whose unique
name is the one specified.  If a gensym with the same unique name
already exists in the system's symbol table, that gensym is returned.

     <pre class="example">          &gt; '#{some-long-name}
          #{g0 |some-long-name|}
          &gt; (gensym? '#{some-long-unique-name})
          #t
          &gt; (eq? '#{another-unique-name} '#{another-unique-name})
          #t
</pre>
        <p>The two&ndash;part <code>#{pretty-name unique-name}</code> gensym syntax is
similar to the syntax shown above with the exception that if a new
gensym is constructed (that is, if the gensym did not already exist in
the symbol table), the pretty name of the constructed gensym is set to
<code>pretty-name</code>.

     <pre class="example">          &gt; '#{foo unique-identifier}
          #{foo |unique-identifier|}
          &gt; '#{unique-identifier}
          #{foo |unique-identifier|}
          &gt; '#{bar unique-identifier}
          #{foo |unique-identifier|}
</pre>
        <p>The <code>#:pretty-name</code> form constructs, at read time, a gensym whose
pretty name is <code>pretty-name</code> and whose unique name is fresh.  This
form guarantees that the resulting gensym is not <code>eq?</code> to any other
symbol in the system.

     <pre class="example">          &gt; '#:foo
          #{foo |j=qTGlEwS/Zlp2Dj|}
          &gt; (eq? '#:foo '#:foo)
          #f
</pre>
        </blockquote></div>

<!--  -->
<h4 class="subsection">3.18.1 An example</h4>

<p class="noindent">The <code>(rnrs syntax-case)</code> library provides a
<code>generate-temporaries</code> procedure, which takes a syntax object
(representing a list of things) and returns a list of fresh identifiers. 
Using <code>gensym</code>, that procedure can be defined as follows:

<pre class="example">     (define (generate-temporaries* stx)
       (syntax-case stx ()
         [(x* ...)
          (map (lambda (x)
                 (datum-&gt;syntax #'unimportant
                   (gensym
                     (if (identifier? x)
                         (syntax-&gt;datum x)
                         't))))
               #'(x* ...))]))
</pre>
   <p>The above definition works by taking the input <var>stx</var> and
destructuring it into the list of syntax objects <code>x* ...</code>.  The
inner procedure maps each <var>x</var> into a new syntax object (constructed
with <code>datum-&gt;syntax</code>).  The datum is a gensym, whose name is the
same name as <var>x</var> if <var>x</var> is an identifier, or the symbol <code>t</code>
if <var>x</var> is not an identifier.  The output of
<code>generate-temporaries*</code> generates names similar to their input
counterpart:

<pre class="example">     &gt; (print-gensym #f)
     &gt; (generate-temporaries* #'(x y z 1 2))
     (#&lt;syntax x&gt; #&lt;syntax y&gt; #&lt;syntax z&gt; #&lt;syntax t&gt; #&lt;syntax t&gt;)
</pre>
   <!-- page -->
<div class="node">
<a name="iklib-printing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-tracing">iklib tracing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-gensym">iklib gensym</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.19 Printing</h3>

<div class="defun">
&mdash; Procedure: <b>pretty-print</b><var> datum<a name="index-pretty_002dprint-219"></a></var><br>
&mdash; Procedure: <b>pretty-print</b><var> datum output-port<a name="index-pretty_002dprint-220"></a></var><br>
<blockquote><p>The procedure <code>pretty-print</code> is intended for printing Scheme data,
typically Scheme programs, in a format close to how a Scheme programmer
would write it.  Unlike <code>write</code>, which writes its input all in one
line, <code>pretty-print</code> inserts spaces and new lines in order to
produce more pleasant output.

     <pre class="example">          (define fact-code
            '(letrec ([fact (lambda (n)
                              (if (zero? n)
                                  1
                                (* n (fact (- n 1)))))])
               (fact 5)))
          
          &gt; (pretty-print fact-code)
          (letrec ((fact
                    (lambda (n) (if (zero? n) 1 (* n (fact (- n 1)))))))
            (fact 5))
</pre>
        <p>The second argument to <code>pretty-print</code>, if supplied, must be an
output port.  If not supplied, the <code>current-output-port</code> is used.

        <blockquote>
<em>Limitations:</em> As shown in the output above, the current
implementation of <code>pretty-print</code> does not handle printing of square
brackets properly. 
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>pretty-width</b><var><a name="index-pretty_002dwidth-221"></a></var><br>
&mdash; Parameter: <b>pretty-width</b><var> n<a name="index-pretty_002dwidth-222"></a></var><br>
<blockquote><p>The parameter <code>pretty-width</code> controls the number of characters
after which the <code>pretty-print</code> starts breaking long lines into
multiple lines.  The initial value of <code>pretty-width</code> is set to 60
characters, which is suitable for most terminals and printed material.

     <pre class="example">          &gt; (parameterize ([pretty-width 40])
               (pretty-print fact-code))
          (letrec ((fact
                    (lambda (n)
                      (if (zero? n)
                          1
                          (* n (fact (- n 1)))))))
            (fact 5))
</pre>
        <p>Note that <code>pretty-width</code> does not guarantee that the output will
not extend beyond the specified number.  Very long symbols, for
examples, cannot be split into multiple lines and may force the printer
to go beyond the value of <code>pretty-width</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>format</b><var> fmt-string args ...<a name="index-format-223"></a></var><br>
<blockquote><p>The procedure <code>format</code> produces a string formatted according to
<code>fmt-string</code> and the supplied arguments.  The format string
contains markers in which the string representation of each argument is
placed.  The markers include:

          <dl>
<dt><code>~s</code><dd>instructs the formatter to place the next argument as if the procedure
<code>write</code> has printed it; if the argument contains a string, the
string will be quoted and all quotes and backslashes in the string will
be escaped; similarly, characters will be printed using the <code>#\x</code>
notation;

          <br><dt><code>~a</code><dd>instructs the formatter to place the next argument as if the procedure
<code>display</code> has printed it; strings and characters are placed as they
are in the output;

          <br><dt><code>~b</code><dd>instructs the formatter to convert the next argument to its binary (base
2) representation; the argument must be an exact number;

          <br><dt><code>~o</code><dd>is similar to <code>~b</code> except that the number is printed in octal (base
8);

          <br><dt><code>~x</code><dd>is similar to <code>~b</code> except that the number is printed in hexadecimal
(base 16);

          <br><dt><code>~d</code><dd>outputs the next argument, which can be an exact or inexact number, in
its decimal (base 10) representation;

          <br><dt><code>~~</code><dd>instructs the formatter to place a tilde character, <code>~</code>, in the
output without consuming an argument;

          <br><dt><code>~%</code><dd>instructs the formatter to place a newline character in the output
without consuming an argument. 
</dl>

        <p>Note that the <code>#b</code>, <code>#o</code>, and <code>#x</code> numeric prefixes are
not added to the output when <code>~b</code>, <code>~o</code>, and <code>~x</code> are
used.

     <pre class="example">          &gt; (format "message: ~s, ~s, and ~s" 'symbol "string" #\c)
          "message: symbol, \"string\", and #\\c"
          
          &gt; (format "message: ~a, ~a, and ~a" 'symbol "string" #\c)
          "message: symbol, string, and c"
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>printf</b><var> fmt-string args ...<a name="index-printf-224"></a></var><br>
<blockquote><p>The procedure <code>printf</code> is similar to <code>format</code> except that the
output is sent to the <code>current-output-port</code> instead of being
collected in a string.

     <pre class="example">          &gt; (let ([n (+ (expt 2 32) #b11001)])
              (printf "~d = #b~b = #x~x\n" n n n))
          4294967321 = #b100000000000000000000000000011001 = #x100000019
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Procedure: <b>fprintf</b><var> output-port fmt-string args ...<a name="index-fprintf-225"></a></var><br>
<blockquote><p>The procedure <code>fprintf</code> is similar to <code>printf</code> except that the
output port to which the output is sent is specified as the first
argument. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>print-unicode</b><var><a name="index-print_002dunicode-226"></a></var><br>
&mdash; Parameter: <b>print-unicode</b><var> #t<a name="index-print_002dunicode-227"></a></var><br>
&mdash; Parameter: <b>print-unicode</b><var> #f<a name="index-print_002dunicode-228"></a></var><br>
<blockquote><p>If set to true: print Scheme Unicode characters outside of the printable
<acronym>ASCII</acronym> range in hex format, else print them using the encoding of the
output port.  The default is false. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>print-gensym</b><var><a name="index-print_002dgensym-229"></a></var><br>
&mdash; Parameter: <b>print-gensym</b><var> #t<a name="index-print_002dgensym-230"></a></var><br>
&mdash; Parameter: <b>print-gensym</b><var> #f<a name="index-print_002dgensym-231"></a></var><br>
&mdash; Parameter: <b>print-gensym</b><var> 'pretty<a name="index-print_002dgensym-232"></a></var><br>
<blockquote><p>The parameter <code>print-gensym</code> controls how gensyms are printed by
the various writers.

        <p>If the value of <code>print-gensym</code> is <code>#f</code>, then gensym syntax is
suppressed by the writers and only the gensyms' pretty names are
printed.  If the value of <code>print-gensym</code> is <code>#t</code>, then the full
<code>#{pretty unique}</code> syntax is printed.  Finally, if the value of
<code>print-gensym</code> is the symbol <code>pretty</code>, then gensyms are
printed using the <code>#:pretty</code> notation.

     <pre class="example">          &gt; (parameterize ([print-gensym #f])
              (pretty-print (list (gensym) (gensym))))
          (g0 g1)
          
          &gt; (parameterize ([print-gensym #t])
              (pretty-print (list (gensym) (gensym))))
          (#{g2 |KR1M2&amp;CTt1&lt;B0n/m|} #{g3 |FBAb&amp;7NC6&amp;=c82!O|})
          
          &gt; (parameterize ([print-gensym 'pretty])
              (pretty-print (list (gensym) (gensym))))
          (#:g4 #:g5)
</pre>
        <p>The initial value of <code>print-gensym</code> is <code>#t</code>.

        </blockquote></div>

<div class="defun">
&mdash; Parameter: <b>gensym-prefix</b><var><a name="index-gensym_002dprefix-233"></a></var><br>
&mdash; Parameter: <b>gensym-prefix</b><var> string<a name="index-gensym_002dprefix-234"></a></var><br>
<blockquote><p>The parameter <code>gensym-prefix</code> specifies the string to be used as
the prefix to generated pretty names.  The default value of
<code>gensym-prefix</code> is the string <code>g</code>, which causes generated
strings to have pretty names in the sequence <code>g0</code>, <code>g1</code>,
<code>g2</code>, etc.

     <pre class="example">          &gt; (parameterize ([gensym-prefix "var"]
                           [print-gensym #f])
               (pretty-print (list (gensym) (gensym) (gensym))))
          (var0 var1 var2)
</pre>
        <p>Beware that the <code>gensym-prefix</code> controls how pretty names are
generated, and has nothing to do with how <code>gensym</code> constructs a new
gensym.  In particular, notice the difference between the output in the
first example with the output of the examples below:

     <pre class="example">          &gt; (pretty-print
              (parameterize ([gensym-prefix "var"] [print-gensym #f])
                (list (gensym) (gensym) (gensym))))
          (g3 g4 g5)
          
          &gt; (let ([ls (list (gensym) (gensym) (gensym))])
              (parameterize ([gensym-prefix "var"] [print-gensym #f])
                (pretty-print ls)))
          (var5 var6 var7)
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Parameter: <b>gensym-count</b><var><a name="index-gensym_002dcount-235"></a></var><br>
&mdash; Parameter: <b>gensym-count</b><var> n<a name="index-gensym_002dcount-236"></a></var><br>
<blockquote><p>The parameter <code>gensym-count</code> determines the number which is
attached to the <code>gensym-prefix</code> when gensyms' pretty names are
generated.  The initial value of <code>gensym-count</code> is 0 and is
incremented every time a pretty name is generated.  It might be set to
any non-negative integer value.

     <pre class="example">          &gt; (let ([x (gensym)])
              (parameterize ([gensym-count 100] [print-gensym #f])
                (pretty-print (list (gensym) x (gensym)))))
          (g100 g101 g102)
</pre>
        </blockquote></div>

   <p>Notice from all the examples so far that pretty names are generated in
the order at which the gensyms are printed, not in the order in which
gensyms were created.

<!-- page -->
<div class="node">
<a name="iklib-tracing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-timing">iklib timing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-printing">iklib printing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.20 Tracing</h3>

<div class="defun">
&mdash; Syntax: <b>trace-define</b> (<var>name . args</var>)<var> body body* ...<a name="index-trace_002ddefine-237"></a></var><br>
&mdash; Syntax: <b>trace-define</b><var> name expression<a name="index-trace_002ddefine-238"></a></var><br>
<blockquote><p>The <code>trace-define</code> syntax is similar to <code>define</code> except that
the bound value, which must be a procedure, becomes a traced procedure. 
A traced procedure prints its arguments when it is called and prints its
values when it returns.

     <pre class="example">          &gt; (trace-define (fact n)
              (if (zero? n) 1 (* n (fact (- n 1)))))
          &gt; (fact 5)
          |(fact 5)
          | (fact 4)
          | |(fact 3)
          | | (fact 2)
          | | |(fact 1)
          | | | (fact 0)
          | | | 1
          | | |1
          | | 2
          | |6
          | 24
          |120
          120
</pre>
        <p>The tracing facility in Vicare preserves and shows tail recursion and
distinguishes it from non&ndash;tail recursion by showing tail calls starting
at the same line in which their parent was called.

     <pre class="example">          &gt; (trace-define (fact n)
              (trace-define (fact-aux n m)
                (if (zero? n) m (fact-aux (- n 1) (* n m))))
              (fact-aux n 1))
          &gt; (fact 5)
          |(fact 5)
          |(fact-aux 5 1)
          |(fact-aux 4 5)
          |(fact-aux 3 20)
          |(fact-aux 2 60)
          |(fact-aux 1 120)
          |(fact-aux 0 120)
          |120
          120
</pre>
        <p>Moreover, the tracing facility interacts well with continuations and
exceptions.

     <pre class="example">          &gt; (call/cc
              (lambda (k)
                (trace-define (loop n)
                  (if (zero? n)
                      (k 'done)
                      (+ (loop (- n 1)) 1)))
                (loop 5)))
          |(loop 5)
          | (loop 4)
          | |(loop 3)
          | | (loop 2)
          | | |(loop 1)
          | | | (loop 0)
          done
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Syntax: <b>trace-lambda</b><var> name args body body* ...<a name="index-trace_002dlambda-239"></a></var><br>
<blockquote><p>The <code>trace-lambda</code> macro is similar to <code>lambda</code> except that
the resulting procedure is traced: it prints the arguments it receives
and the results it returns. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>make-traced-procedure</b><var> name proc<a name="index-make_002dtraced_002dprocedure-240"></a></var><br>
<blockquote><p>The procedure <code>make-traced-procedure</code> takes a name (typically a
symbol) and a procedure.  It returns a procedure similar to <var>proc</var>
except that it traces its arguments and values.

     <pre class="example">          &gt; (define (fact n)
              (if (zero? n)
                  (lambda (k) (k 1))
                  (lambda (k)
                    ((fact (- n 1))
                     (make-traced-procedure `(k ,n)
                       (lambda (v)
                         (k (* v n))))))))
          &gt; (call/cc
              (lambda (k)
                ((fact 5) (make-traced-procedure 'K k))))
          |((k 1) 1)
          |((k 2) 1)
          |((k 3) 2)
          |((k 4) 6)
          |((k 5) 24)
          |(K 120)
          120
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-timing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-guardians">iklib guardians</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-tracing">iklib tracing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.21 Timing</h3>

<p>This section describes some of Vicare's timing facilities which may be
useful for benchmarking and performance tuning.

<div class="defun">
&mdash; Syntax: <b>time</b><var> expression<a name="index-time-241"></a></var><br>
<blockquote><p>The <code>time</code> macro performs the following: it evaluates
<var>expression</var>, then prints a summary of the run time statistics, then
returns the values returned by <var>expression</var>.  The run&ndash;time summary
includes the number of bytes allocated, the number of garbage collection
runs, and the time spent in both the mutator and the collector.

     <pre class="example">          &gt; (let ()                                   ;;; 10 million
              (define ls (time (vector-&gt;list (make-vector 10000000))))
              (time (append ls ls))
              (values))
          running stats for (vector-&gt;list (make-vector 10000000)):
              3 collections
              672 ms elapsed cpu time, including 547 ms collecting
              674 ms elapsed real time, including 549 ms collecting
              120012328 bytes allocated
          running stats for (append ls ls):
              4 collections
              1536 ms elapsed cpu time, including 1336 ms collecting
              1538 ms elapsed real time, including 1337 ms collecting
              160000040 bytes allocated
</pre>
        <blockquote>
<em>Note:</em> The output listed above is <em>just a sample</em> that was
taken at some point on some machine.  The output on your machine at the
time you read this may vary. 
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>time-it</b><var> who thunk<a name="index-time_002dit-242"></a></var><br>
<blockquote><p>The procedure <code>time-it</code> takes a datum denoting the name of the
computation and a thunk (i.e. a procedure with no arguments), invokes
the thunk, prints the stats, and returns the values obtained from
invoking the thunk.  If the value of <var>who</var> is non&ndash;false, <var>who</var>
is used when displaying the run&ndash;time statistics.  If the value of
<var>who</var> is <code>#f</code>, then no name for the computation is displayed.

     <pre class="example">          &gt; (time-it "a very fast computation"
              (lambda () (values 1 2 3)))
          running stats for a very fast computation:
              no collections
              0 ms elapsed cpu time, including 0 ms collecting
              0 ms elapsed real time, including 0 ms collecting
              24 bytes allocated
          1
          2
          3
          
          &gt; (time-it #f (lambda () 12))
          running stats:
              no collections
              0 ms elapsed cpu time, including 0 ms collecting
              0 ms elapsed real time, including 0 ms collecting
              0 bytes allocated
          12
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>time-and-gather</b><var> gather thunk<a name="index-time_002dand_002dgather-243"></a></var><br>
<blockquote><p>Like <code>time-it</code> evaluate the procedure <var>thunk</var> timing its
execution; return the return values of <var>thunk</var>.  Build two objects
of type <code>stats</code> and apply the procedure <var>gather</var> to them: the
first represents the statistics before <var>thunk</var> evaluation, the
second represents the statistics after <var>thunk</var> evaluation. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats?</b><var> obj<a name="index-stats_003f-244"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is an object of type <code>stats</code>. 
</p></blockquote></div>

   <p>All the fields of a <code>stats</code> object hold fixnums.

<div class="defun">
&mdash; Function: <b>stats-user-secs</b><var> stats<a name="index-stats_002duser_002dsecs-245"></a></var><br>
<blockquote><p>Return the user seconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-user-usecs</b><var> stats<a name="index-stats_002duser_002dusecs-246"></a></var><br>
<blockquote><p>Return the user microseconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-sys-secs</b><var> stats<a name="index-stats_002dsys_002dsecs-247"></a></var><br>
<blockquote><p>Return the system seconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-sys-usecs</b><var> stats<a name="index-stats_002dsys_002dusecs-248"></a></var><br>
<blockquote><p>Return the system microseconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-real-secs</b><var> stats<a name="index-stats_002dreal_002dsecs-249"></a></var><br>
<blockquote><p>Return the real seconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-real-usecs</b><var> stats<a name="index-stats_002dreal_002dusecs-250"></a></var><br>
<blockquote><p>Return the real microseconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-collection-id</b><var> stats<a name="index-stats_002dcollection_002did-251"></a></var><br>
<blockquote><p>Return the collection identifier field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-gc-user-secs</b><var> stats<a name="index-stats_002dgc_002duser_002dsecs-252"></a></var><br>
<blockquote><p>Return the garbage collection user seconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-gc-user-usecs</b><var> stats<a name="index-stats_002dgc_002duser_002dusecs-253"></a></var><br>
<blockquote><p>Return the garbage collection user microseconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-gc-sys-secs</b><var> stats<a name="index-stats_002dgc_002dsys_002dsecs-254"></a></var><br>
<blockquote><p>Return the garbage collection system seconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-gc-sys-usecs</b><var> stats<a name="index-stats_002dgc_002dsys_002dusecs-255"></a></var><br>
<blockquote><p>Return the garbage collection system microseconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-gc-real-secs</b><var> stats<a name="index-stats_002dgc_002dreal_002dsecs-256"></a></var><br>
<blockquote><p>Return the garbage collection real seconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-gc-real-usecs</b><var> stats<a name="index-stats_002dgc_002dreal_002dusecs-257"></a></var><br>
<blockquote><p>Return the garbage collection real microseconds field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-bytes-minor</b><var> stats<a name="index-stats_002dbytes_002dminor-258"></a></var><br>
<blockquote><p>Return the garbage collection bytes minor field of <var>stats</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stats-bytes-major</b><var> stats<a name="index-stats_002dbytes_002dmajor-259"></a></var><br>
<blockquote><p>Return the garbage collection bytes major field of <var>stats</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-guardians"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io">iklib io</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-timing">iklib timing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.22 Guardians and garbage collection</h3>

<p>Guardians are available in the <code>(ikarus)</code> library; quoting
<code>[DYBGUA]</code>:

   <blockquote>
Guardians provide a means to protect objects from destruction by the
garbage collector.  A guardian is an object with which objects can be
registered for preservation and from which objects actually saved from
destruction can be retrieved, one at a time, at the convenience of the
program. 
</blockquote>

<div class="defun">
&mdash; Function: <b>collect</b><var><a name="index-collect-260"></a></var><br>
<blockquote><p>Run the garbage collector.  If post&ndash;garbage collection hooks are
registered, they are run.  This binding is exported by the
<code>(ikarus)</code> library. 
</p></blockquote></div>

<ul class="menu">
<li><a accesskey="1" href="#iklib-guardians-examples">iklib guardians examples</a>:     Usage examples for guardians. 
<li><a accesskey="2" href="#iklib-guardians-api">iklib guardians api</a>:          Guardians programming interface. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-guardians-examples"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-guardians-api">iklib guardians api</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-guardians">iklib guardians</a>

</div>

<h4 class="subsection">3.22.1 Usage examples for guardians</h4>

<p>Let's say that we use the Vicare <acronym>FFI</acronym> to handle some memory
block (<a href="#ffi">ffi</a> for details on the <acronym>FFI</acronym>); memory blocks allocated
with <code>malloc</code> are not released by the Vicare garbage
collector: we have to explicitly apply <code>free</code> to the pointer value
referencing them.

   <p>If we use the blocks synchronously with the evaluation of forms, we do
(assuming we do not use continuations, so this use of
<code>dynamic-wind</code> is fine):

<pre class="example">     (import (ikarus)
       (vicare ffi))
     
     (define (do-something-with . args)
       (display args)
       (newline))
     
     (let ((p        #f)
           (size     4096))
       (dynamic-wind
           (lambda ()
             (set! p (malloc size))
             (unless p (error #f "memory allocation")))
           (lambda ()
             (do-something-with p))
           (lambda ()
             (free p))))
</pre>
   <p class="noindent">and we can define a syntax for it:

<pre class="example">     (import (ikarus)
       (vicare ffi))
     
     (define (do-something-with . args)
       (display args)
       (newline))
     
     (define-syntax with-block
       (syntax-rules ()
         ((_ ?pointer ?size ?body ...)
          (let ((?pointer    #f))
            (dynamic-wind
                (lambda ()
                  (set! ?pointer (malloc ?size))
                  (unless ?pointer (error #f "memory allocation")))
                (lambda ()
                  ?body ...)
                (lambda ()
                  (free ?pointer)))))))
     
     (with-block p 2048
       (do-something-with p))
     
     (with-block p 4096
       (do-something-with p))
     
     (with-block p 8192
       (do-something-with p))
</pre>
   <p>If we need the block in an event driven program: we will probably need
to use it asynchronously with the evaluation of forms.  For example, we
store the pointer value that references a block in a thunk (a closure
that takes no arguments):

<pre class="example">     (import (ikarus)
       (vicare ffi))
     
     (define *event-source* '())
     
     (define (enqueue-event event)
       (set! *event-source*
             (reverse (cons event (reverse *event-source*)))))
     
     (define (pop-event)
       (if (null? *event-source*)
           #f
         (let ((event (car *event-source*)))
           (set! *event-source* (cdr *event-source*))
           event)))
     
     ;; Usage:
     
     (define (do-something-with . args)
       (display args)
       (newline))
     
     (let ((p (malloc 4096)))
       (unless p (error #f "memory allocation"))
       (enqueue-event (lambda ()
                        (do-something-with p)))
       (enqueue-event (lambda ()
                        (do-something-with 123)))
       (enqueue-event (lambda ()
                        (do-something-with p))))
     
     (do ((event (pop-event) (pop-event)))
         ((not event))
       (event))
</pre>
   <p class="noindent">once the thunks have been evaluated, the pointer value is garbage
collected, but the allocated memory block becomes leaked memory.  We
need a way to be notified of the pointer value garbage collection, so
that we can apply <code>free</code> to it; this is the job for guardians.

   <p>The following script shows the usage of a guardian to free a memory
block:

<pre class="example">     (import (ikarus)
       (vicare ffi))
     
     (define g (make-guardian))
     
     (let ((a (malloc (expt 2 20))))
       (unless p (error #f "memory allocation"))
       (g a)
       (printf "value ~s~%" a))
     
     (printf "value from guardian ~s~%" (g))
     
     ;; This triggers a garbage collection.
     (collect)
     
     (let ((p (g)))
       (printf "value from guardian ~s~%" p)
       (free p))
</pre>
   <p>In an event driven program what we have to do is to register the pointer
into the guardian, and then periodically enqueue as event a call to the
guardian:

<pre class="example">     (import (ikarus)
       (vicare ffi))
     
     ;; Event source handling.
     
     (define *event-source* '())
     
     (define (enqueue-event event)
       (set! *event-source*
             (reverse (cons event (reverse *event-source*)))))
     
     (define (pop-event)
       (if (null? *event-source*)
           #f
         (let ((event (car *event-source*)))
           (set! *event-source* (cdr *event-source*))
           event)))
     
     ;; Block guardian.
     
     (define block-guardian (make-guardian))
     
     (define (run-block-guardian)
       (do ((p (block-guardian) (block-guardian)))
           ((not p))
         (printf "collecting ~s~%" p)
         (free p)))
     
     ;; Application follows.
     
     (define (do-something-with . args)
       (display args)
       (newline))
     
     (let ((p (malloc (expt 2 20))))
       (unless p (error #f "memory allocation"))
       (block-guardian p)
       (enqueue-event (lambda () (do-something-with p)))
       (enqueue-event (lambda () (do-something-with 123)))
       (enqueue-event (lambda () (do-something-with p)))
       (enqueue-event (lambda () (do-something-with 456))))
     
     (do ((event (pop-event) (pop-event))
          (i 1 (+ i 1)))
         ((= i 20))
       (when event
         (event))
       (when (= 0 (modulo i 10))
         (collect)
         (enqueue-event run-block-guardian)))
</pre>
   <!-- page -->
<div class="node">
<a name="iklib-guardians-api"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-guardians-examples">iklib guardians examples</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-guardians">iklib guardians</a>

</div>

<h4 class="subsection">3.22.2 Guardians programming interface</h4>

<div class="defun">
&mdash; Function: <b>make-guardian</b><var><a name="index-make_002dguardian-261"></a></var><br>
<blockquote><p>Build and return a new guardian object: a closure that can be called
with one or zero arguments, and that is interfaced with the garbage
collector of Vicare in a non&ndash;portable way.

        <p>The guardian work like this:

          <ul>
<li>When the closure is called with one argument: it adds the argument to an
internal set of &ldquo;guarded values&rdquo;, accessible to the garbage collector;
the return value if the argument itself.

          <li>When the garbage collector detects no other references to a value in the
set of guarded values: the guardian removes it from the set and appends
it to an internal queue (<acronym>FIFO</acronym>).

          <li>When the closure is called with zero arguments: it removes the first
value from the internal queue and returns it; if no values are in the
queue it returns <code>#f</code>. 
</ul>

        <p>After an object has been returned by the guardian, it is no more
&ldquo;guarded&rdquo; so it will be garbage collected when it will become
inaccessible (unless it is again registered in a guardian).

        <blockquote>
<strong>NOTE</strong> It is possible to register an object in more than one
guardian; when the object is found inaccessible all the guardian
closures that have it will return it to the caller.  This may lead to
invalid finalisation operations, it is the responsibility of the
programmer to avoid this. 
</blockquote>

        <blockquote>
<strong>NOTE</strong> It is possible to register an object multiple times in the
same guardian; when the object is found inaccessible the guardian
closure that has it will return it to the caller multiple times.  This
may lead to invalid finalisation operations, it is the responsibility of
the programmer to avoid this. 
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>post-gc-hooks</b><var><a name="index-post_002dgc_002dhooks-262"></a></var><br>
<blockquote><p>Hold a list of thunks evaluated after each garbage collection run.  It
can be used to run a guardian cleanup function like this (using the
example in the previous section):

     <pre class="example">          (define (run-block-guardian)
            (do ((p (block-guardian) (block-guardian)))
                ((not p))
              (free p)))
          
          (post-gc-hooks
           (cons run-block-guardian
            (post-gc-hooks)))
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-misc">iklib misc</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-guardians">iklib guardians</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.23 Input/output library</h3>

<ul class="menu">
<li><a accesskey="1" href="#iklib-io-filename">iklib io filename</a>:            File pathname handling. 
<li><a accesskey="2" href="#iklib-io-codecs">iklib io codecs</a>:              Transcoders and additional codecs. 
<li><a accesskey="3" href="#iklib-io-binary">iklib io binary</a>:              Additional binary port features. 
<li><a accesskey="4" href="#iklib-io-textual">iklib io textual</a>:             Additional textual port features. 
<li><a accesskey="5" href="#iklib-io-buffer">iklib io buffer</a>:              Buffer size customisation. 
<li><a accesskey="6" href="#iklib-io-socket">iklib io socket</a>:              Using network sockets. 
<li><a accesskey="7" href="#iklib-io-non_002dblock">iklib io non-block</a>:           Non--blocking mode for ports. 
<li><a accesskey="8" href="#iklib-io-misc">iklib io misc</a>:                Miscellaneous port functions. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-io-filename"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-codecs">iklib io codecs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.23.1 File pathname handling</h4>

<p>All the file&ndash;related functions defined by <acronym>R6RS</acronym> accept a Scheme
string as representing a file pathname; internally such string is
converted to a bytevector to be handed to the underlying operating
system.  The following bindings are exported by the <code>(ikarus)</code>
library.

<div class="defun">
&mdash; Parameter: <b>string-&gt;filename-func</b><var><a name="index-string_002d_003efilename_002dfunc-263"></a></var><br>
<blockquote><p>In Vicare the string&ndash;to&ndash;filename conversion is performed by
the function returned by <code>string-&gt;filename-func</code>, which defaults to
<code>string-&gt;utf8</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>filename-&gt;string-func</b><var><a name="index-filename_002d_003estring_002dfunc-264"></a></var><br>
<blockquote><p>In Vicare the filename&ndash;to&ndash;string conversion is performed by
the function returned by <code>filename-&gt;string-func</code>, which defaults to
<code>utf8-&gt;string</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io-codecs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-binary">iklib io binary</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-filename">iklib io filename</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.23.2 Transcoders and additional codecs</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Parameter: <b>native-transcoder</b><var><a name="index-native_002dtranscoder-265"></a></var><br>
<blockquote><p><a name="index-open_002dinput_002dfile-266"></a><a name="index-with_002dinput_002dfrom_002dfile-267"></a><a name="index-call_002dwith_002dinput_002dfile-268"></a><a name="index-open_002doutput_002dfile-269"></a><a name="index-with_002doutput_002dto_002dfile-270"></a><a name="index-call_002dwith_002doutput_002dfile-271"></a>The function <code>native-transcoder</code> defined by <acronym>R6RS</acronym> returns a
transcoder representing acceptable defaults for the platform on which
the Scheme implementation is running.  Under Vicare such
default is:

     <pre class="example">          (make-transcoder (utf-8-codec) 'none 'replace)
</pre>
        <p class="noindent">and additionally the function is a parameter, so the default can be
configured.  Notice that the following functions create Scheme ports
using the transcoder returned by <code>native-transcoder</code>:

     <pre class="example">          open-input-file         open-output-file
          with-input-from-file    with-output-to-file
          call-with-input-file    call-with-output-file
</pre>
        </blockquote></div>

   <p>The codec returned by <code>utf-16-codec</code>, defined by <acronym>R6RS</acronym>, has
different semantics depending upon the type of the port:

     <ul>
<li>For output and input/output ports it defaults to <acronym>UTF</acronym>-16 big endian
(which seems mandated by the Unicode Consortium).

     <li>For input ports the endianness is left unspecified until the first bytes
are read: such bytes must be a valid <acronym>UTF</acronym>-16 Byte Order Mark which
dynamically configures the port.<a rel="footnote" href="#fn-3" name="fnd-3"><sup>3</sup></a>
</ul>

<div class="defun">
&mdash; Procedure: <b>utf-16le-codec</b><var><a name="index-utf_002d16le_002dcodec-272"></a></var><br>
&mdash; Procedure: <b>utf-16be-codec</b><var><a name="index-utf_002d16be_002dcodec-273"></a></var><br>
<blockquote><p>Codecs for the <acronym>UTF</acronym>-16 encoding schemes, little endian and big endian. 
A call to any of these procedures returns a value that is equal in the
sense of <code>eqv?</code> to the result of any other call to the same
procedure. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>utf-16n-codec</b><var><a name="index-utf_002d16n_002dcodec-274"></a></var><br>
<blockquote><p>Return a codec for the <acronym>UTF</acronym>-16 encoding scheme, with endianness equal
to the one returned by <code>(native-endianness)</code>.  A call to this
procedure returns a value that is equal in the sense of <code>eqv?</code> to
the result of any other call to the same procedure. 
</p></blockquote></div>

<div class="defun">
&mdash; Procedure: <b>utf-bom-codec</b><var><a name="index-utf_002dbom_002dcodec-275"></a></var><br>
<blockquote><p>Codec for <acronym>UTF</acronym> encoding schemes whose data open with a Byte Order
Mark.  A call to this procedure returns a value that is equal in the
sense of <code>eqv?</code> to the result of any other call to the same
procedure.

        <p>At present this codec is supported only by input ports. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io-binary"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-textual">iklib io textual</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-codecs">iklib io codecs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.23.3 Additional binary port features</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>lookahead-two-u8</b><var> port<a name="index-lookahead_002dtwo_002du8-276"></a></var><br>
<blockquote><p>Like <code>lookahead-u8</code> but peeks at 2 octets and return two
values: the <acronym>EOF</acronym> object or a fixnum representing first octet, the
<acronym>EOF</acronym> object or a fixnum representing the second octet. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>console-input-port</b><var><a name="index-console_002dinput_002dport-277"></a></var><br>
<blockquote><p>Return the default value of the <code>current-input-port</code> parameter.  It
is used by the <acronym>REPL</acronym> and the debugger. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>console-output-port</b><var><a name="index-console_002doutput_002dport-278"></a></var><br>
<blockquote><p>Return the default value of the <code>current-outptu-port</code> parameter. 
It is used by the <acronym>REPL</acronym> and the debugger. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>console-error-port</b><var><a name="index-console_002derror_002dport-279"></a></var><br>
<blockquote><p>Return the default value of the <code>current-error-port</code> parameter.  It
is used by the <acronym>REPL</acronym> and the debugger. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-binary-file-descriptor-input-port</b><var> fd identifier<a name="index-make_002dbinary_002dfile_002ddescriptor_002dinput_002dport-280"></a></var><br>
&mdash; Function: <b>make-binary-file-descriptor-output-port</b><var> fd identifier<a name="index-make_002dbinary_002dfile_002ddescriptor_002doutput_002dport-281"></a></var><br>
&mdash; Function: <b>make-binary-file-descriptor-input/output-port</b><var> fd identifier<a name="index-make_002dbinary_002dfile_002ddescriptor_002dinput_002foutput_002dport-282"></a></var><br>
<blockquote><p>Build and return binary Scheme ports using the platform file descriptor
<var>fd</var> as device.  <var>identifier</var> must be a string used for better
error reporting.  Closing the Scheme ports will close the file
descriptors too. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-binary-file-descriptor-input-port*</b><var> fd identifier<a name="index-make_002dbinary_002dfile_002ddescriptor_002dinput_002dport_002a-283"></a></var><br>
&mdash; Function: <b>make-binary-file-descriptor-output-port*</b><var> fd identifier<a name="index-make_002dbinary_002dfile_002ddescriptor_002doutput_002dport_002a-284"></a></var><br>
&mdash; Function: <b>make-binary-file-descriptor-input/output-port*</b><var> fd identifier<a name="index-make_002dbinary_002dfile_002ddescriptor_002dinput_002foutput_002dport_002a-285"></a></var><br>
<blockquote><p>Build and return binary Scheme ports using the platform file descriptor
<var>fd</var> as device.  <var>identifier</var> must be a string used for better
error reporting.  Closing the Scheme ports will <strong>not</strong> close the
file descriptors. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-binary-socket-input/output-port</b><var> sock identifier<a name="index-make_002dbinary_002dsocket_002dinput_002foutput_002dport-286"></a></var><br>
<blockquote><p>Build and return a binary Scheme port using the platform socket
descriptor <var>sock</var> as device.  <var>identifier</var> must be a string used
for better error reporting.  Closing the Scheme port will close the
socket descriptor too. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-binary-socket-input/output-port*</b><var> sock identifier<a name="index-make_002dbinary_002dsocket_002dinput_002foutput_002dport_002a-287"></a></var><br>
<blockquote><p>Build and return a binary Scheme port using the platform socket
descriptor <var>sock</var> as device.  <var>identifier</var> must be a string used
for better error reporting.  Closing the Scheme port will <strong>not</strong>
close the socket descriptor. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io-textual"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-buffer">iklib io buffer</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-binary">iklib io binary</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.23.4 Additional textual port features</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>open-string-input-port</b><var> string<a name="index-open_002dstring_002dinput_002dport-288"></a></var><br>
&mdash; Function: <b>open-string-input-port</b><var> string eol-style<a name="index-open_002dstring_002dinput_002dport-289"></a></var><br>
<blockquote><p>As defined by <acronym>R6RS</acronym>: return a textual input port whose characters are
drawn from <var>string</var>.  When <var>eol-style</var> is given: it must be a
symbol selecting an end&ndash;of&ndash;line style conversion, as accepted by
<code>eol-style</code>; such conversion is applied to the characters drawn
from <var>string</var>.

        <p>If <var>string</var> is modified after <code>open-string-input-port</code> has been
called, the effect on the returned port is unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>open-string-input-port/id</b><var> string id<a name="index-open_002dstring_002dinput_002dport_002fid-290"></a></var><br>
&mdash; Function: <b>open-string-input-port/id</b><var> string id eol-style<a name="index-open_002dstring_002dinput_002dport_002fid-291"></a></var><br>
<blockquote><p>Like <code>open-string-input-port</code> but allows the specification of a
customised port identifier <var>id</var>, which must be a Scheme string. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>open-string-output-port</b><var><a name="index-open_002dstring_002doutput_002dport-292"></a></var><br>
&mdash; Function: <b>open-string-output-port</b><var> eol-style<a name="index-open_002dstring_002doutput_002dport-293"></a></var><br>
<blockquote><p>As defined by <acronym>R6RS</acronym>, return two values: a textual output port and an
extraction procedure; the output port accumulates the characters written
to it for later extraction by the procedure.

        <p>As a Vicare extension, when <var>eol-style</var> is given: it must
be a symbol selecting an end&ndash;of&ndash;line style conversion, as accepted by
<code>eol-style</code>; such conversion is applied to the characters written
to the port. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>get-output-string</b><var> port<a name="index-get_002doutput_002dstring-294"></a></var><br>
<blockquote><p>Return the string accumulated in the <var>port</var> opened by
<code>open-string-output-port</code>.  This function can be called also when
the port has been closed. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>get-char-and-track-textual-position</b><var> port<a name="index-get_002dchar_002dand_002dtrack_002dtextual_002dposition-295"></a></var><br>
<blockquote><p>Like <code>get-char</code> but track the textual position.  Recognise only
linefeed characters as line-ending. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>port-textual-position</b><var> port<a name="index-port_002dtextual_002dposition-296"></a></var><br>
<blockquote><p>Given a textual port, return the current textual position as a condition
object of type <code>&amp;source-position</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-textual-file-descriptor-input-port</b><var> fd identifier transcoder<a name="index-make_002dtextual_002dfile_002ddescriptor_002dinput_002dport-297"></a></var><br>
&mdash; Function: <b>make-textual-file-descriptor-output-port</b><var> fd identifier transcoder<a name="index-make_002dtextual_002dfile_002ddescriptor_002doutput_002dport-298"></a></var><br>
&mdash; Function: <b>make-textual-file-descriptor-input/output-port</b><var> fd identifier transcoder<a name="index-make_002dtextual_002dfile_002ddescriptor_002dinput_002foutput_002dport-299"></a></var><br>
<blockquote><p>Build and return textual Scheme ports using the platform file descriptor
<var>fd</var> as device.  <var>identifier</var> must be a string used for better
error reporting.  <var>transcoder</var> must be a transcoder object.  Closing
the Scheme ports will close the file descriptors too. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-textual-file-descriptor-input-port*</b><var> fd identifier transcoder<a name="index-make_002dtextual_002dfile_002ddescriptor_002dinput_002dport_002a-300"></a></var><br>
&mdash; Function: <b>make-textual-file-descriptor-output-port*</b><var> fd identifier transcoder<a name="index-make_002dtextual_002dfile_002ddescriptor_002doutput_002dport_002a-301"></a></var><br>
&mdash; Function: <b>make-textual-file-descriptor-input/output-port*</b><var> fd identifier transcoder<a name="index-make_002dtextual_002dfile_002ddescriptor_002dinput_002foutput_002dport_002a-302"></a></var><br>
<blockquote><p>Build and return textual Scheme ports using the platform file descriptor
<var>fd</var> as device.  <var>identifier</var> must be a string used for better
error reporting.  <var>transcoder</var> must be a transcoder object.  Closing
the Scheme ports will <strong>not</strong> close the file descriptors. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-textual-socket-input/output-port</b><var> sock identifier transcoder<a name="index-make_002dtextual_002dsocket_002dinput_002foutput_002dport-303"></a></var><br>
<blockquote><p>Build and return a textual Scheme port using the platform socket
descriptor <var>sock</var> as device.  <var>identifier</var> must be a string used
for better error reporting.  <var>transcoder</var> must be a transcoder
object.  Closing the Scheme port will close the socket descriptor too. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-textual-socket-input/output-port*</b><var> sock identifier transcoder<a name="index-make_002dtextual_002dsocket_002dinput_002foutput_002dport_002a-304"></a></var><br>
<blockquote><p>Build and return a textual Scheme port using the platform socket
descriptor <var>sock</var> as device.  <var>identifier</var> must be a string used
for better error reporting.  <var>transcoder</var> must be a transcoder
object.  Closing the Scheme port will <strong>not</strong> close the socket
descriptor. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io-buffer"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-socket">iklib io socket</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-textual">iklib io textual</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.23.5 Buffer size customisation</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Parameter: <b>bytevector-port-buffer-size</b><var><a name="index-bytevector_002dport_002dbuffer_002dsize-305"></a></var><br>
&mdash; Parameter: <b>bytevector-port-buffer-size</b><var> fixnum<a name="index-bytevector_002dport_002dbuffer_002dsize-306"></a></var><br>
<blockquote><p>Hold the buffer size for bytevector ports, like the one returned by
<code>open-bytevector-output-port</code>.  It is initialised to 16384. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>string-port-buffer-size</b><var><a name="index-string_002dport_002dbuffer_002dsize-307"></a></var><br>
&mdash; Parameter: <b>string-port-buffer-size</b><var> fixnum<a name="index-string_002dport_002dbuffer_002dsize-308"></a></var><br>
<blockquote><p>Hold the buffer size for string ports, like the one returned by
<code>open-string-output-port</code>.  It is initialised to 256. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>input-file-buffer-size</b><var><a name="index-input_002dfile_002dbuffer_002dsize-309"></a></var><br>
&mdash; Parameter: <b>input-file-buffer-size</b><var> fixnum<a name="index-input_002dfile_002dbuffer_002dsize-310"></a></var><br>
<blockquote><p>Hold the buffer size for input file ports, like the one returned by
<code>open-input-file</code>.  It is initialised to 16384. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>output-file-buffer-size</b><var><a name="index-output_002dfile_002dbuffer_002dsize-311"></a></var><br>
&mdash; Parameter: <b>output-file-buffer-size</b><var> fixnum<a name="index-output_002dfile_002dbuffer_002dsize-312"></a></var><br>
<blockquote><p>Hold the buffer size for output file ports, like the one returned by
<code>open-output-file</code>.  It is initialised to 16384. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>input/output-file-buffer-size</b><var><a name="index-input_002foutput_002dfile_002dbuffer_002dsize-313"></a></var><br>
&mdash; Parameter: <b>input/output-file-buffer-size</b><var> fixnum<a name="index-input_002foutput_002dfile_002dbuffer_002dsize-314"></a></var><br>
<blockquote><p>Hold the buffer size for input/output file ports, like the one returned
by <code>open-file-input/output-prot</code>.  It is initialised to
16384. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>input/output-socket-buffer-size</b><var><a name="index-input_002foutput_002dsocket_002dbuffer_002dsize-315"></a></var><br>
&mdash; Parameter: <b>input/output-socket-buffer-size</b><var> fixnum<a name="index-input_002foutput_002dsocket_002dbuffer_002dsize-316"></a></var><br>
<blockquote><p>Hold the buffer size for socket ports.  It is initialised to
16384. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io-socket"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-non_002dblock">iklib io non-block</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-buffer">iklib io buffer</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.23.6 Using network sockets</h4>

<ul class="menu">
<li><a accesskey="1" href="#iklib-io-socket-client">iklib io socket client</a>:       Establishing client network
                                connections. 
<li><a accesskey="2" href="#iklib-io-socket-server">iklib io socket server</a>:       Opening server network services. 
</ul>

<!-- page -->
<div class="node">
<a name="iklib-io-socket-client"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-socket-server">iklib io socket server</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io-socket">iklib io socket</a>

</div>

<h5 class="subsubsection">3.23.6.1 Establishing client network connections</h5>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>tcp-connect</b><var> hostname service<a name="index-tcp_002dconnect-317"></a></var><br>
&mdash; Function: <b>udp-connect</b><var> hostname service<a name="index-udp_002dconnect-318"></a></var><br>
&mdash; Function: <b>tcp-connect-nonblocking</b><var> hostname service<a name="index-tcp_002dconnect_002dnonblocking-319"></a></var><br>
&mdash; Function: <b>udp-connect-nonblocking</b><var> hostname service<a name="index-udp_002dconnect_002dnonblocking-320"></a></var><br>
<blockquote><p>Establish a network connection using the <acronym>TCP</acronym> or <acronym>UDP</acronym> protocol, to
the host selected by the string <var>hostname</var>, port/service selected by
the string <var>service</var>.  The <code>-nonblocking</code> version sets the
underlying socket descriptor to non&ndash;blocking mode (<a href="#iklib-io-non_002dblock">iklib io non-block</a>).  Upon success, return a port; if an error occurs an
exception is raised.

        <p><var>hostname</var> can be a dotted decimal address for IPv4, or a
hexadecimal string for IPv6, or a network address.

        <p><var>service</var> can be a numerical string representing the port, or the
&ldquo;official&rdquo; name of a service, like <code>smtp</code> or <code>pop3</code>.

        <blockquote>
<strong>Unix:</strong> These functions use of the <code>socket()</code>, <code>connect()</code>
and <code>getaddrinfo()</code> system functions.

        <p><a href="libc.html#Creating-a-Socket">Creating a Socket</a><br>
<a href="libc.html#Connecting">Making a Connection</a><br>
See the <code>getaddrinfo()</code> manual page.<br>
See the <samp><span class="file">/etc/services</span></samp> configuration file. 
</blockquote>
        </p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io-socket-server"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-socket-client">iklib io socket client</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io-socket">iklib io socket</a>

</div>

<h5 class="subsubsection">3.23.6.2 Opening server network services</h5>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>tcp-server-socket</b><var> server-port-number<a name="index-tcp_002dserver_002dsocket-321"></a></var><br>
&mdash; Function: <b>tcp-server-socket-nonblocking</b><var> server-port-number<a name="index-tcp_002dserver_002dsocket_002dnonblocking-322"></a></var><br>
<blockquote><p>Build a new <acronym>TCP</acronym> server object for the selected port number (which
must be an exact integer).  The <code>-nonblocking</code> versions set the
underlying socket descriptor to non&ndash;blocking mode (<a href="#iklib-io-non_002dblock">iklib io non-block</a>).  Upon success, return a server&ndash;object; if an error occurs
an exception is raised.

        <blockquote>
<strong>Unix:</strong> These functions make use of the <code>socket()</code>,
<code>setsockopt()</code>, <code>bind()</code> and <code>listen()</code> system functions. 
The socket is configured with the <code>AF_INET</code>, <code>INADDR_ANY</code>,
<code>SO_REUSEADDR</code> values and options (Vicare version 0.0.3+, checkout
1468).

        <p><a href="libc.html#Creating-a-Socket">Creating a Socket</a><br>
<a href="libc.html#Socket-Option-Functions">Socket Option Functions</a><br>
<a href="libc.html#Setting-Address">Setting the Address of a Socket</a><br>
<a href="libc.html#Listening">Listening for Connections</a>
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>accept-connection</b><var> server-object<a name="index-accept_002dconnection-323"></a></var><br>
&mdash; Function: <b>accept-connection-nonblocking</b><var> server-object<a name="index-accept_002dconnection_002dnonblocking-324"></a></var><br>
<blockquote><p>Accept the next incoming connection to the selected server.  If success
return two values:

          <ol type=1 start=1>
<li>an output port to be used to send data;

          <li>an input port to be used to receive data;
             </ol>

     <p class="noindent">if an error occurs: an exception is raised.  The <code>-nonblocking</code>
versions set the underlying socket descriptor to non&ndash;blocking mode
(<a href="#iklib-io-non_002dblock">iklib io non-block</a>).

        <p>If the server socket was configured as blocking: this function suspends
the process waiting for an incoming connection.

        <blockquote>
<strong>FIXME: What happens when the server socket is configured as
non&ndash;blocking?</strong>
</blockquote>

        <blockquote>
<strong>Unix:</strong> These functions make use of the <code>accept()</code> system call.

        <p><a href="libc.html#Accepting-Connections">Accepting Connections</a>
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>close-tcp-server-socket</b><var> server-object<a name="index-close_002dtcp_002dserver_002dsocket-325"></a></var><br>
<blockquote><p>Close a server socket causing it to stop listening.

        <blockquote>
<strong>Unix:</strong> this function makes use of the <code>shutdown()</code> system
function.

        <p><a href="libc.html#Closing-a-Socket">Closing a Socket</a>
See also the <code>shutdown()</code> manual page. 
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>register-callback</b><var> server-object proc<a name="index-register_002dcallback-326"></a></var><br>
<blockquote><p>Register a callback function to be invoked whenever a new incoming
connection request happens on <var>server-object</var>.  The callback will be
invoked by the Vicare event loop.

        <blockquote>
<strong>FIXME: What are the parameters that get passed to </strong><var>proc</var><strong>?  Look for
</strong><code>make-t</code><strong> and </strong><code>t-proc</code><strong> in </strong><samp><span class="file">ikarus.io.sls</span></samp><strong>.</strong>
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>input-socket-buffer-size</b><var><a name="index-input_002dsocket_002dbuffer_002dsize-327"></a></var><br>
<blockquote><p>Select the size in bytes of the input buffer for server sockets.  The
value must be a fixnum greater or equal to 128. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>output-socket-buffer-size</b><var><a name="index-output_002dsocket_002dbuffer_002dsize-328"></a></var><br>
<blockquote><p>Select the size in bytes of the output buffer for server sockets.  The
value must be a fixnum greater than zero. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-io-non-block"></a>
<a name="iklib-io-non_002dblock"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#iklib-io-misc">iklib io misc</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-socket">iklib io socket</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.23.7 Non&ndash;blocking mode for ports</h4>

<p><strong>Unix:</strong> Non&ndash;blocking mode is setup with a call like:

<pre class="example">     fcntl(fd, F_SETFL, O_NONBLOCK);
</pre>
   <p class="noindent"><a href="libc.html#Control-Operations">Control Operations</a><br>
<a href="libc.html#Open_002dtime-Flags">Open-time Flags</a>

<!-- page -->
<div class="node">
<a name="iklib-io-misc"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io-non_002dblock">iklib io non-block</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib-io">iklib io</a>

</div>

<h4 class="subsection">3.23.8 Miscellaneous port functions</h4>

<p>The following bindings are exported by the <code>(ikarus)</code> library.

<div class="defun">
&mdash; Function: <b>port-fd</b><var> port<a name="index-port_002dfd-329"></a></var><br>
<blockquote><p>If <var>port</var> is a port with a file descriptor as device: return a
fixnum representing the device, else return <code>#f</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>port-id</b><var> port<a name="index-port_002did-330"></a></var><br>
<blockquote><p>Return a Scheme string representing the identifier of <var>port</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>set-port-buffer-mode!</b><var> port buffer-mode<a name="index-set_002dport_002dbuffer_002dmode_0021-331"></a></var><br>
<blockquote><p>Reset the port buffer mode to <var>buffer-mode</var>, which must be one of
the arguments accepted by <code>buffer-mode</code>.  It is an error to select
<code>line</code> mode if <var>port</var> is a binary port. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>port-dump-status</b><var> port<a name="index-port_002ddump_002dstatus-332"></a></var><br>
<blockquote><p>To be used for debugging purposes.  Write to the current error port some
informations on the internals of <var>port</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="iklib-misc"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib-io">iklib io</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#iklib">iklib</a>

</div>

<h3 class="section">3.24 Miscellaneous functions</h3>

<div class="defun">
&mdash; Function: <b>void</b><var><a name="index-void-333"></a></var><br>
<blockquote><p>Return the void value.  It is the value returned by forms that do not
return a meaningful value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>host-info</b><var><a name="index-host_002dinfo-334"></a></var><br>
<blockquote><p>Return a string being the value <acronym>GNU</acronym> Autoconf assigned to the
<code>target</code> variable.  Example: <code>i686-pc-linux-gnu</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>apropos</b><var> key<a name="index-apropos-335"></a></var><br>
<blockquote><p>Given a string or symbol <var>key</var>, search among the internally
installed libraries all the exported bindings having <var>key</var> as
substring of their name and print a report to the standard output port. 
Useful when using the <acronym>REPL</acronym>.  Example:

     <pre class="example">          vicare&gt; (apropos "-length")
          *** in library (ikarus):
          (bitwise-length bytevector-length string-length
            struct-length vector-length)
          
          *** in library (rnrs):
          (bitwise-length bytevector-length string-length
            vector-length)
          
          *** in library (rnrs arithmetic bitwise):
          (bitwise-length)
          
          *** in library (rnrs base):
          (string-length vector-length)
          
          *** in library (rnrs bytevectors):
          (bytevector-length)
          
          *** in library (vicare):
          (bitwise-length bytevector-length string-length
            struct-length vector-length)
          
          vicare&gt;
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="ffi"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix">posix</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#iklib">iklib</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">4 Foreign functions interface</h2>

<p>The library <code>(vicare ffi)</code> interfaces with the host operating
system and other external libraries exposing a C language interface; it
is suggested to import the <acronym>FFI</acronym> library with the prefix <code>ffi.</code>,
as in the following prelude:

<pre class="example">     #!r6rs
     (import (rnrs)
       (prefix (vicare ffi) ffi.))
</pre>
   <p>The facilities of the <code>(vicare ffi)</code> give the Scheme program
unrestricted access to the computer memory, allowing one to allocate,
access, modify, and free memory as needed.  The facilities also allow
the Scheme program to <dfn>call out</dfn> to system procedures as well as
allow the native procedures to <dfn>call back</dfn> into Scheme.

<ul class="menu">
<li><a accesskey="1" href="#ffi-libffi">ffi libffi</a>:                   Installing and using Libffi. 
<li><a accesskey="2" href="#ffi-memory">ffi memory</a>:                   Memory management. 
<li><a accesskey="3" href="#ffi-cstrings">ffi cstrings</a>:                 Raw C strings. 
<li><a accesskey="4" href="#ffi-dl">ffi dl</a>:                       Accessing shared libraries. 
<li><a accesskey="5" href="#ffi-call">ffi call</a>:                     Callouts and callbacks. 
<li><a accesskey="6" href="#ffi-errno">ffi errno</a>:                    Interface to <code>errno</code>. 
</ul>

<!-- page -->
<div class="node">
<a name="ffi-libffi"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ffi-memory">ffi memory</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi">ffi</a>

</div>

<h3 class="section">4.1 Installing and using Libffi</h3>

<p>Currently Vicare implements the foreign&ndash;functions interface
(<acronym>FFI</acronym>) using an extenal library: Libffi, originally by Anthony Green. 
Libffi can be found at:

<div align="center"><a href="http://sourceware.org/libffi/">http://sourceware.org/libffi/</a></div>

<p class="noindent">and it is distributed under a liberal license (look for it at the site,
basically we can do everything but remove the original copyright
notice).

   <p>On Unix&ndash;like systems, we can install Libffi with the traditional
sequence:

<pre class="example">     $ ./configure [options]
     $ make
     $ make install
</pre>
   <p class="noindent">and the makefile supports the <samp><span class="env">DESTDIR</span></samp> environment variable for
installation under a different directory prefix.

   <blockquote>
<em>Note:</em> Libffi version 3.0.10 installs its header files under:

<pre class="example">     ${prefix}/lib/libffi-3.0.10/include
</pre>
   <p class="noindent">and trying to use the <samp><span class="option">--includedir</span></samp> option to
<samp><span class="command">configure</span></samp> will <strong>not</strong> work in changing this.  It means
that when configuring Vicare for installation we have to specify where
the Libffi headers are to be found; <a href="#overview-install">overview install</a> for details. 
</blockquote>

<!-- page -->
<div class="node">
<a name="ffi-memory"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ffi-cstrings">ffi cstrings</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ffi-libffi">ffi libffi</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi">ffi</a>

</div>

<h3 class="section">4.2 Memory management</h3>

<ul class="menu">
<li><a accesskey="1" href="#ffi-memory-intro">ffi memory intro</a>:             Introduction to managing memory. 
<li><a accesskey="2" href="#ffi-memory-pointer">ffi memory pointer</a>:           Handling pointer values. 
<li><a accesskey="3" href="#ffi-memory-alloc">ffi memory alloc</a>:             Allocating and freeing memory. 
<li><a accesskey="4" href="#ffi-memory-poke">ffi memory poke</a>:              Poking values. 
<li><a accesskey="5" href="#ffi-memory-peek">ffi memory peek</a>:              Peeking values. 
<li><a accesskey="6" href="#ffi-memory-ops">ffi memory ops</a>:               Memory operations. 
</ul>

<!-- page -->
<div class="node">
<a name="ffi-memory-intro"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ffi-memory-pointer">ffi memory pointer</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi-memory">ffi memory</a>

</div>

<h4 class="subsection">4.2.1 Introduction to managing memory</h4>

<p>Vicare Scheme is a managed environment: Scheme objects are
allocated in a special memory region (the Scheme heap) and have
type&ndash;specific object layouts; this allows the run time system to
distinguish object types and the garbage collector to locate all
potentially live objects, and reclaim the memory of dead objects.

   <p>Scheme objects are also <em>opaque</em> in the sense that the data
structures used to represent Scheme objects are not exposed, at the
Scheme level, to the programmer who can only interact with objects
through an interface.

   <p>Unmanaged environments, such as the operating system on which
Vicare runs, require that the programmer manages the allocation
and deallocation of system resources herself.  Memory regions, file
handles, external devices, the screen, etc., are all examples of
resources whose management must be coordinated among the different parts
of the system, and this becomes the responsibility of the programmer who
is wiring the different subsystems together.

   <p>The procedures in the <code>(vicare ffi)</code> library are meant to provide
a way to interface with the low level memory operations such as setting
and getting bytes from specific locations in memory.

<!-- page -->
<div class="node">
<a name="ffi-memory-pointer"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ffi-memory-alloc">ffi memory alloc</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ffi-memory-intro">ffi memory intro</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi-memory">ffi memory</a>

</div>

<h4 class="subsection">4.2.2 Handling pointer values</h4>

<p>Pointer objects are a disjoint type identified by the <code>pointer?</code>
predicate.  When applied to pointer objects:

     <ul>
<li>The result of calling <code>eq?</code> is true only if the two arguments are
both pointers and they refer to the same Scheme storage location.

     <li>The result of calling <code>eqv?</code> and <code>equal?</code> is true only if the
two arguments are both pointers and they reference the same raw memory
location. 
</ul>

<p class="noindent">pointers also have <code>pointer=?</code> as specialised comparison predicate.

<div class="defun">
&mdash; Function: <b>pointer?</b><var> obj<a name="index-pointer_003f-336"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>obj</var> is a pointer object, return <code>#f</code>
otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-&gt;integer</b><var> pointer<a name="index-pointer_002d_003einteger-337"></a></var><br>
<blockquote><p>Convert the value of <var>pointer</var> to an exact integer value.  The
result may be a fixnum or a bignum depending on the pointer. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>integer-&gt;pointer</b><var> exact-integer<a name="index-integer_002d_003epointer-338"></a></var><br>
<blockquote><p>Convert <var>exact-integer</var> to a pointer value.  The argument must be
non&ndash;negative and in the appropriate range for 32-bit or 64-bit
platforms.  It is guaranteed that:

     <pre class="example">          (integer-&gt;pointer (pointer-&gt;integer p))
</pre>
        <p class="noindent">points to the same address as <var>p</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>null-pointer</b><var><a name="index-null_002dpointer-339"></a></var><br>
<blockquote><p>Return a pointer object representing <code>NULL</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-null?</b><var> obj<a name="index-pointer_002dnull_003f-340"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a pointer object and it represents <code>NULL</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-diff</b><var> ptr1 ptr2<a name="index-pointer_002ddiff-341"></a></var><br>
<blockquote><p>Return an exact integer representing the difference between the two
pointer objects <var>ptr1</var> and <var>ptr2</var>.  The returned value is such
that:

     <pre class="example">          (pointer=? P (pointer-add Q (pointer-diff P Q)))
          &rArr; #t
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-add</b><var> ptr diff<a name="index-pointer_002dadd-342"></a></var><br>
<blockquote><p>Return a new pointer object holding the memory reference resulting from
adding <var>diff</var>, which must be an exact integer, to <var>ptr</var>.  If the
addition would cause an overflow or underflow in machine words: raise an
assertion violation. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer=?</b><var> ptr1 ptr2<a name="index-pointer_003d_003f-343"></a></var><br>
&mdash; Function: <b>pointer&lt;&gt;?</b><var> ptr1 ptr2<a name="index-pointer_003c_003e_003f-344"></a></var><br>
&mdash; Function: <b>pointer&lt;?</b><var> ptr1 ptr2<a name="index-pointer_003c_003f-345"></a></var><br>
&mdash; Function: <b>pointer&gt;?</b><var> ptr1 ptr2<a name="index-pointer_003e_003f-346"></a></var><br>
&mdash; Function: <b>pointer&lt;=?</b><var> ptr1 ptr2<a name="index-pointer_003c_003d_003f-347"></a></var><br>
&mdash; Function: <b>pointer&gt;=?</b><var> ptr1 ptr2<a name="index-pointer_003e_003d_003f-348"></a></var><br>
<blockquote><p>Comparison functions for pointers.  Return <code>#t</code> if the arguments
satisfy the predicate, else return <code>#f</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="ffi-memory-alloc"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ffi-memory-poke">ffi memory poke</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ffi-memory-pointer">ffi memory pointer</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi-memory">ffi memory</a>

</div>

<h4 class="subsection">4.2.3 Allocating and freeing memory</h4>

<div class="defun">
&mdash; Function: <b>malloc</b><var> number-of-bytes<a name="index-malloc-349"></a></var><br>
&mdash; Function: <b>guarded-malloc</b><var> number-of-bytes<a name="index-guarded_002dmalloc-350"></a></var><br>
<blockquote><p>Interface to the C function <code>malloc()</code>, <a href="libc.html#Basic-Allocation">malloc</a>.  Allocate a block of memory <var>number-of-bytes</var> wide;
<var>number-of-bytes</var> must be a non&ndash;negative fixnum.  If successful
return a pointer object, else return <code>#f</code>.

        <p>Memory allocated by <code>malloc</code> must be released by <code>free</code>;
memory allocated by <code>guarded-malloc</code> is automatically released
whenever the returned pointer object is garbage collected. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>realloc</b><var> pointer number-of-bytes<a name="index-realloc-351"></a></var><br>
&mdash; Function: <b>guarded-realloc</b><var> pointer number-of-bytes<a name="index-guarded_002drealloc-352"></a></var><br>
<blockquote><p>Interface to the C function <code>realloc()</code>, <a href="libc.html#Changing-Block-Size">realloc</a>.  Reallocate the block of memory referenced by
<var>pointer</var> to the new size <var>number-of-bytes</var>, which must be a
non&ndash;negative fixnum.

        <p>If successful: mutate <var>pointer</var> to reference a the new memory block
and return <var>pointer</var> itself.  If an error occurs: return <code>#f</code>
and leave untouched both <var>pointer</var> and its referenced memory.

        <p>Memory allocated by <code>realloc</code> must be released by <code>free</code>;
memory allocated by <code>guarded-realloc</code> is automatically released
whenever the returned pointer object is garbage collected. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>calloc</b><var> number-of-elements element-size<a name="index-calloc-353"></a></var><br>
&mdash; Function: <b>guarded-calloc</b><var> number-of-elements element-size<a name="index-guarded_002dcalloc-354"></a></var><br>
<blockquote><p>Interface to the C function <code>calloc()</code>, <a href="libc.html#Allocating-Cleared-Space">calloc</a>.  Allocate and clear to zero a block of memory capable of
holding <var>number-of-elements</var> each <var>element-size</var> wide; both the
arguments must be non&ndash;negative fixnums.  If successful return a pointer
object, else return <code>#f</code>.

        <p>Memory allocated by <code>calloc</code> must be released by <code>free</code>;
memory allocated by <code>guarded-calloc</code> is automatically released
whenever the returned pointer object is garbage collected. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>free</b><var> pointer<a name="index-free-355"></a></var><br>
<blockquote><p>Release the memory referenced by <var>pointer</var>, which must be the return
value of <code>malloc()</code>, <code>realloc()</code>, <code>calloc()</code> or a similar
system procedure.  <var>pointer</var> is mutated to reference the <code>NULL</code>
pointer.

        <p>If memory allocated by a guarding function is released by <code>free</code>:
Vicare will <strong>not</strong> try to automatically release the old
memory again.

        <p>If <var>pointer</var> is <code>NULL</code> nothing happens. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>with-local-storage</b><var> lengths proc<a name="index-with_002dlocal_002dstorage-356"></a></var><br>
<blockquote><p>Call <var>proc</var> with arguments being pointers to memory blocks allocated
just for the dynamic extent of <var>proc</var>.  The number and size of the
memory blocks is determined by <var>lengths</var>, which must be a vector of
non&ndash;negative fixnums.

        <p><strong>NOTE</strong> We must not let control flow go through a call to
<code>with-local-storage</code> with an escaping continuation.

     <pre class="example">          #!r6rs
          (import (rnrs)
            (prefix (vicare ffi) ffi.))
          
          ;; no allocated memory
          (let ((a 1) (b 2))
            (ffi.with-local-storage '#()
              (lambda ()
                (+ a b 4))))
          &rArr; 7
          
          ;; allocate a single block of 4 bytes
          (let ((a 1) (b 2))
            (ffi.with-local-storage '#(4)
              (lambda (&amp;int32)
                (ffi.pointer-set-c-sint32! &amp;int32 0 4)
                (+ a b (ffi.pointer-ref-c-sint32 &amp;int32 0)))))
          &rArr; 7
          
          ;; allocate two blocks of 4 and 8 bytes
          (let ((a 1) (b 2))
            (ffi.with-local-storage '#(4 8)
              (lambda (&amp;int32 &amp;int64)
                (ffi.pointer-set-c-sint32! &amp;int32 0 4)
                (ffi.pointer-set-c-sint64! &amp;int64 0 8)
                (+ a b
                   (ffi.pointer-ref-c-sint32 &amp;int32 0)
                   (ffi.pointer-ref-c-sint64 &amp;int64 0)))))
          &rArr; 15
</pre>
        <p>The memory blocks are actually allocated on the stack of
Vicare's runtime. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="ffi-memory-poke"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ffi-memory-peek">ffi memory peek</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ffi-memory-alloc">ffi memory alloc</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi-memory">ffi memory</a>

</div>

<h4 class="subsection">4.2.4 Poking values</h4>

<p>With all the following functions: the <var>pointer</var> argument must be a
valid pointer object; the <var>offset</var> argument must be a fixnum.  When
adding an offset to a pointer: all the following functions <strong>do
not</strong> scale the offset to the size of the poked value; pointer
arithmetics is performed with byte offsets.

<!--  -->
<h5 class="subsubheading">Poking bitwise sized exact integers</h5>

<p>The following functions store signed and unsigned exact integers in raw
memory location selecting the size with the number of bits required to
represent the value.

<div class="defun">
&mdash; Function: <b>pointer-set-c-sint8!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dsint8_0021-357"></a></var><br>
&mdash; Function: <b>pointer-set-c-uint8!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002duint8_0021-358"></a></var><br>
<blockquote><p>Set to <var>value</var> the single byte of memory located at <var>offset</var> from
<var>pointer</var>.  <var>VALUE</var> must be an exact integer in the range
representable by 8 bits. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-set-c-sint16!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dsint16_0021-359"></a></var><br>
&mdash; Function: <b>pointer-set-c-uint16!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002duint16_0021-360"></a></var><br>
<blockquote><p>Set to <var>value</var> the two bytes of memory located at <var>offset</var> from
<var>pointer</var>.  <var>VALUE</var> must be an exact integer in the range
representable by 16 bits. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-set-c-sint32!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dsint32_0021-361"></a></var><br>
&mdash; Function: <b>pointer-set-c-uint32!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002duint32_0021-362"></a></var><br>
<blockquote><p>Set to <var>value</var> the two bytes of memory located at <var>offset</var> from
<var>pointer</var>.  <var>VALUE</var> must be an exact integer in the range
representable by 32 bits. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-set-c-sint64!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dsint64_0021-363"></a></var><br>
&mdash; Function: <b>pointer-set-c-uint64!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002duint64_0021-364"></a></var><br>
<blockquote><p>Set to <var>value</var> the two bytes of memory located at <var>offset</var> from
<var>pointer</var>.  <var>VALUE</var> must be an exact integer in the range
representable by 64 bits. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Poking C language exact integers</h5>

<p>The following functions store signed and unsigned exact integers in raw
memory locations selecting the size according to the one used by the C
language implementation.

<div class="defun">
&mdash; Function: <b>pointer-set-c-signed-char!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dsigned_002dchar_0021-365"></a></var><br>
&mdash; Function: <b>pointer-set-c-unsigned-char!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dunsigned_002dchar_0021-366"></a></var><br>
<blockquote><p>Set to <var>value</var> a number of bytes corresponding to the <code>signed
char</code> or <code>unsigned char</code> type located at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-set-c-signed-short!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dsigned_002dshort_0021-367"></a></var><br>
&mdash; Function: <b>pointer-set-c-unsigned-short!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dunsigned_002dshort_0021-368"></a></var><br>
<blockquote><p>Set to <var>value</var> a number of bytes corresponding to the <code>signed
short int</code> or <code>unsigned short int</code> type located at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-set-c-signed-int!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dsigned_002dint_0021-369"></a></var><br>
&mdash; Function: <b>pointer-set-c-unsigned-int!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dunsigned_002dint_0021-370"></a></var><br>
<blockquote><p>Set to <var>value</var> a number of bytes corresponding to the <code>signed
int</code> or <code>unsigned int</code> type located at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-set-c-signed-long!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dsigned_002dlong_0021-371"></a></var><br>
&mdash; Function: <b>pointer-set-c-unsigned-long!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dunsigned_002dlong_0021-372"></a></var><br>
<blockquote><p>Set to <var>value</var> a number of bytes corresponding to the <code>signed
long</code> or <code>unsigned long</code> type located at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-set-c-signed-long-long!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dsigned_002dlong_002dlong_0021-373"></a></var><br>
&mdash; Function: <b>pointer-set-c-unsigned-long-long!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dunsigned_002dlong_002dlong_0021-374"></a></var><br>
<blockquote><p>Set to <var>value</var> a number of bytes corresponding to the <code>signed
long long</code> or <code>unsigned long long</code> type located at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Poking floating point numbers</h5>

<div class="defun">
&mdash; Function: <b>pointer-set-c-float!</b><var> pointer offset flonum<a name="index-pointer_002dset_002dc_002dfloat_0021-375"></a></var><br>
<blockquote><p>Convert the Scheme floating point number <var>flonum</var> (represented in
Vicare as an <acronym>IEEE</acronym> 754 double precision floating point number) to a
float (an <acronym>IEEE</acronym> 754 single precision floating point number) and store
the result in the four bytes at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-set-c-double!</b><var> pointer offset flonum<a name="index-pointer_002dset_002dc_002ddouble_0021-376"></a></var><br>
<blockquote><p>Store the double precision <acronym>IEEE</acronym> 754 floating point value of the
Scheme <var>flonum</var> in the eight bytes at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Poking pointers</h5>

<div class="defun">
&mdash; Function: <b>pointer-set-c-pointer!</b><var> pointer offset value<a name="index-pointer_002dset_002dc_002dpointer_0021-377"></a></var><br>
<blockquote><p>Store address of the raw memory location referenced by the pointer
<var>value</var> at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="ffi-memory-peek"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ffi-memory-ops">ffi memory ops</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ffi-memory-poke">ffi memory poke</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi-memory">ffi memory</a>

</div>

<h4 class="subsection">4.2.5 Peeking values</h4>

<p>With all the following functions: the <var>pointer</var> argument must be a
valid pointer object; the <var>offset</var> argument must be a fixnum.  When
adding an offset to a pointer: all the following functions <strong>do
not</strong> scale the offset to the size of the poked value; pointer
arithmetics is performed with byte offsets.

<!--  -->
<h5 class="subsubheading">Peeking bitwise sized exact integers</h5>

<p>The following functions retrieve signed and unsigned exact integers from
raw memory location selecting the size with the number of bits required
to represent the value.

<div class="defun">
&mdash; Function: <b>pointer-ref-c-sint8</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dsint8-378"></a></var><br>
&mdash; Function: <b>pointer-ref-c-uint8</b><var> pointer offset<a name="index-pointer_002dref_002dc_002duint8-379"></a></var><br>
<blockquote><p>Peek the 8 bits located at <var>offset</var> from <var>pointer</var> and
return them as signed or unsigned exact integer. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-ref-c-sint16</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dsint16-380"></a></var><br>
&mdash; Function: <b>pointer-ref-c-uint16</b><var> pointer offset<a name="index-pointer_002dref_002dc_002duint16-381"></a></var><br>
<blockquote><p>Peek the 16 bits located at <var>offset</var> from <var>pointer</var> and
return them as signed or unsigned exact integer. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-ref-c-sint32</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dsint32-382"></a></var><br>
&mdash; Function: <b>pointer-ref-c-uint32</b><var> pointer offset<a name="index-pointer_002dref_002dc_002duint32-383"></a></var><br>
<blockquote><p>Peek the 32 bits located at <var>offset</var> from <var>pointer</var> and
return them as signed or unsigned exact integer. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-ref-c-sint64</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dsint64-384"></a></var><br>
&mdash; Function: <b>pointer-ref-c-uint64</b><var> pointer offset<a name="index-pointer_002dref_002dc_002duint64-385"></a></var><br>
<blockquote><p>Peek the 64 bits located at <var>offset</var> from <var>pointer</var> and
return them as signed or unsigned exact integer. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Peeking C language exact integers</h5>

<p>The following functions store signed and unsigned exact integers from
raw memory locations selecting the size according to the one used by the
C language implementation.

<div class="defun">
&mdash; Function: <b>pointer-ref-c-signed-char</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dsigned_002dchar-386"></a></var><br>
&mdash; Function: <b>pointer-ref-c-signed-char</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dsigned_002dchar-387"></a></var><br>
<blockquote><p>Peek the <code>signed char</code> or <code>unsigned char</code> integer located
at <var>offset</var> from <var>pointer</var> and return it as signed or unsigned
exact integer. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-ref-c-signed-short</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dsigned_002dshort-388"></a></var><br>
&mdash; Function: <b>pointer-ref-c-unsigned-short</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dunsigned_002dshort-389"></a></var><br>
<blockquote><p>Peek the <code>signed short int</code> or <code>unsigned short int</code> integer located
at <var>offset</var> from <var>pointer</var> and return it as signed or unsigned
exact integer. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-ref-c-signed-int</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dsigned_002dint-390"></a></var><br>
&mdash; Function: <b>pointer-ref-c-unsigned-int</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dunsigned_002dint-391"></a></var><br>
<blockquote><p>Peek the <code>signed int</code> or <code>unsigned int</code> integer located
at <var>offset</var> from <var>pointer</var> and return it as signed or unsigned
exact integer. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-ref-c-signed-long</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dsigned_002dlong-392"></a></var><br>
&mdash; Function: <b>pointer-ref-c-unsigned-long</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dunsigned_002dlong-393"></a></var><br>
<blockquote><p>Peek the <code>signed long</code> or <code>unsigned long</code> integer located
at <var>offset</var> from <var>pointer</var> and return it as signed or unsigned
exact integer. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-ref-c-signed-long-long</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dsigned_002dlong_002dlong-394"></a></var><br>
&mdash; Function: <b>pointer-ref-c-unsigned-long-long</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dunsigned_002dlong_002dlong-395"></a></var><br>
<blockquote><p>Peek the <code>signed long long</code> or <code>unsigned long long</code> integer located
at <var>offset</var> from <var>pointer</var> and return it as signed or unsigned
exact integer. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Peeking floating point numbers</h5>

<div class="defun">
&mdash; Function: <b>pointer-ref-c-float</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dfloat-396"></a></var><br>
<blockquote><p>Return the four&ndash;byte float (represented as <acronym>IEEE</acronym> 754 single precision
floating point number) stored at <var>offset</var> from <var>pointer</var>.  The
value is extended to an <acronym>IEEE</acronym> 754 double precision floating point
number that Vicare uses to represent inexact numbers. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pointer-ref-c-double</b><var> pointer offset<a name="index-pointer_002dref_002dc_002ddouble-397"></a></var><br>
<blockquote><p>Return the eight&ndash;byte float (represented as <acronym>IEEE</acronym> 754 double
precision floating point number) stored at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Peeking pointers</h5>

<div class="defun">
&mdash; Function: <b>pointer-ref-c-pointer</b><var> pointer offset<a name="index-pointer_002dref_002dc_002dpointer-398"></a></var><br>
<blockquote><p>Return the pointer stored at <var>offset</var> from <var>pointer</var>.  The size
of the pointer (also the number of bytes loaded) depends on the
architecture: it is 4 bytes on 32-bit systems and 8 bytes on 64-bit
systems. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="ffi-memory-ops"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ffi-memory-peek">ffi memory peek</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi-memory">ffi memory</a>

</div>

<h4 class="subsection">4.2.6 Memory operations</h4>

<div class="defun">
&mdash; Function: <b>memcpy</b><var> dst src count<a name="index-memcpy-399"></a></var><br>
<blockquote><p>Interface to the C function <code>memcpy()</code>, <a href="libc.html#Copying-and-Concatenation">memcpy</a>.  Copy <var>count</var> bytes from the memory
referenced by the pointer <var>src</var> to the memory referenced by the
pointer <var>dst</var>; <var>count</var> must be a non&ndash;negative fixnum.  The two
memory regions must not overlap.  Return unspecified values. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>memmove</b><var> dst src count<a name="index-memmove-400"></a></var><br>
<blockquote><p>Interface to the C function <code>memmove()</code>, <a href="libc.html#Copying-and-Concatenation">memmove</a>.  Copy <var>count</var> bytes from the memory
referenced by the pointer <var>src</var> to the memory referenced by the
pointer <var>dst</var>; <var>count</var> must be a non&ndash;negative fixnum.  The two
memory regions can be overlapping.  Return unspecified values. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>memset</b><var> ptr value count<a name="index-memset-401"></a></var><br>
<blockquote><p>Interface to the C function <code>memset()</code>, <a href="libc.html#Copying-and-Concatenation">memset</a>.Set to <var>value</var> <var>count</var> bytes of the
memory referenced by the pointer <var>ptr</var>.  <var>count</var> must be a
non&ndash;negative fixnum, <var>value</var> must be an exact fixnum in the range
[-128, 255].  Return unspecified values. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>memcmp</b><var> pointer1 pointer2 count<a name="index-memcmp-402"></a></var><br>
<blockquote><p>Interface to the C function <code>memcmp()</code>, <a href="libc.html#String_002fArray-Comparison">memcmp</a>.  Compare <var>count</var> bytes in the memory blocks
referenced by <var>pointer1</var> and <var>pointer2</var>, return a fixnum
representing the classic comparison ternary result.  <var>count</var> must be
a non&ndash;negative fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>memory-copy</b><var> dst dst.start src src.start count<a name="index-memory_002dcopy-403"></a></var><br>
<blockquote><p>Copy <var>count</var> bytes from <var>src</var> starting at offset <var>src.start</var>
to <var>dst</var> starting at offset <var>dst.start</var>.  <var>src</var> and
<var>dst</var> can be pointers or bytevectors; <var>dst.start</var>,
<var>src.start</var> and <var>count</var> must be non&ndash;negative fixnums.  The two
memory regions must not overlap.  Return unspecified values. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>memory-&gt;bytevector</b><var> pointer number-of-bytes<a name="index-memory_002d_003ebytevector-404"></a></var><br>
<blockquote><p>Build and return a new bytevector object holding <var>number-of-bytes</var>
from the memory region starting at <var>pointer</var>.  <var>number-of-bytes</var>
must be a non&ndash;negative fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>bytevector-&gt;memory</b><var> bv<a name="index-bytevector_002d_003ememory-405"></a></var><br>
&mdash; Function: <b>bytevector-&gt;guarded-memory</b><var> bv<a name="index-bytevector_002d_003eguarded_002dmemory-406"></a></var><br>
<blockquote><p>Allocate a new raw memory block and copy into it the contents of
<var>bv</var>.  If successful return two values being the pointer object
referencing the memory and a fixnum representing the length of the
memory block; if allocating memory fails return <code>#f</code> and <code>#f</code>.

        <p>Memory allocated by <code>bytevector-&gt;memory</code> must be released by
<code>free</code>; memory allocated by <code>bytevector-&gt;guarded-malloc</code> is
automatically released whenever the returned pointer object is garbage
collected. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="ffi-cstrings"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ffi-dl">ffi dl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ffi-memory">ffi memory</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi">ffi</a>

</div>

<h3 class="section">4.3 Raw C strings</h3>

<p>The following functions perform operations on raw <acronym>ASCII</acronym> coded strings
terminated by a zero byte, for short <acronym>ASCIIZ</acronym> strings.

<div class="defun">
&mdash; Function: <b>bytevector-&gt;cstring</b><var> bv<a name="index-bytevector_002d_003ecstring-407"></a></var><br>
&mdash; Function: <b>bytevector-&gt;guarded-cstring</b><var> bv<a name="index-bytevector_002d_003eguarded_002dcstring-408"></a></var><br>
<blockquote><p>Convert from a Scheme bytevector to an <acronym>ASCIIZ</acronym> string.  If successful
return a pointer object referencing the string, else return <code>#f</code>.

        <p>Memory allocated by <code>bytevector-&gt;cstring</code> must be explicitly
released by <code>free</code>; memory allocated by
<code>bytevector-&gt;guarded-cstring</code> is automatically released by the
garbage collector whenever the returned pointer is garbage collected. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>cstring-&gt;bytevector</b><var> pointer<a name="index-cstring_002d_003ebytevector-409"></a></var><br>
&mdash; Function: <b>cstring-&gt;bytevector</b><var> pointer count<a name="index-cstring_002d_003ebytevector-410"></a></var><br>
<blockquote><p>Convert between an <acronym>ASCIIZ</acronym> string and a Scheme bytevector.  When used,
<var>count</var> must be a fixnum representing the number of bytes to include
in the bytevector. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>string-&gt;cstring</b><var> str<a name="index-string_002d_003ecstring-411"></a></var><br>
&mdash; Function: <b>string-&gt;guarded-cstring</b><var> str<a name="index-string_002d_003eguarded_002dcstring-412"></a></var><br>
<blockquote><p>Convert from a Scheme string to an <acronym>ASCIIZ</acronym> string.  If successful
return a pointer object referencing the string, else return <code>#f</code>.

        <p>The string argument must contain only characters with Unicode code
points in the range [0, 255].

        <p>Memory allocated by <code>string-&gt;cstring</code> must be explicitly
released by <code>free</code>; memory allocated by
<code>string-&gt;guarded-cstring</code> is automatically released by the
garbage collector whenever the returned pointer is garbage collected. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>cstring-&gt;string</b><var> pointer<a name="index-cstring_002d_003estring-413"></a></var><br>
&mdash; Function: <b>cstring-&gt;string</b><var> pointer count<a name="index-cstring_002d_003estring-414"></a></var><br>
<blockquote><p>Convert between an <acronym>ASCIIZ</acronym> string and a Scheme string.  When used,
<var>count</var> must be a fixnum representing the number of bytes to include
in the string. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>strlen</b><var> pointer<a name="index-strlen-415"></a></var><br>
<blockquote><p>Interface to the C function <code>strlen()</code>, <a href="libc.html#String-Length">strlen</a>.  Return an exact integer representing the length of the
<acronym>ASCIIZ</acronym> string referenced by <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>strcmp</b><var> pointer1 pointer2<a name="index-strcmp-416"></a></var><br>
<blockquote><p>Interface to the C function <code>strcmp()</code>, <a href="libc.html#String_002fArray-Comparison">strcmp</a>.  Return a fixnum representing the classic
comparison ternary result of comparing the <acronym>ASCIIZ</acronym> strings referenced
by <var>pointer1</var> and <var>pointer2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>strncmp</b><var> pointer1 pointer2 count<a name="index-strncmp-417"></a></var><br>
<blockquote><p>Interface to the C function <code>strncmp()</code>, <a href="libc.html#String_002fArray-Comparison">strncmp</a>.  Return a fixnum representing the classic
comparison ternary result of comparing the first <var>count</var> bytes in
the <acronym>ASCIIZ</acronym> strings referenced by <var>pointer1</var> and <var>pointer2</var>. 
<var>count</var> must be a fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>strdup</b><var> pointer<a name="index-strdup-418"></a></var><br>
&mdash; Function: <b>guarded-strdup</b><var> pointer<a name="index-guarded_002dstrdup-419"></a></var><br>
<blockquote><p>Interface to the C function <code>strdup()</code>, <a href="libc.html#Copying-and-Concatenation">strdup</a>.  Duplicate the <acronym>ASCIIZ</acronym> string referenced by
<var>pointer</var>; if successful return a new pointer object, else return
<code>#f</code>.

        <p>Memory allocated by <code>strdup</code> must be explicitly released by
<code>free</code>; memory allocated by <code>guarded-strdup</code> is automatically
released by the garbage collector whenever the returned pointer is
garbage collected. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>strndup</b><var> pointer count<a name="index-strndup-420"></a></var><br>
&mdash; Function: <b>guarded-strndup</b><var> pointer count<a name="index-guarded_002dstrndup-421"></a></var><br>
<blockquote><p>Interface to the C function <code>strndup()</code>, <a href="libc.html#Copying-and-Concatenation">strndup</a>.  Duplicate the first <var>count</var> bytes in the
<acronym>ASCIIZ</acronym> string referenced by <var>pointer</var>; if successful return a new
pointer object, else return <code>#f</code>.  <var>count</var> must be a fixnum.

        <p>Memory allocated by <code>strdup</code> must be explicitly released by
<code>free</code>; memory allocated by <code>guarded-strdup</code> is automatically
released by the garbage collector whenever the returned pointer is
garbage collected. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>bytevectors-&gt;argv</b><var> list-of-bytevectors<a name="index-bytevectors_002d_003eargv-422"></a></var><br>
&mdash; Function: <b>bytevectors-&gt;guarded-argv</b><var> list-of-bytevectors<a name="index-bytevectors_002d_003eguarded_002dargv-423"></a></var><br>
<blockquote><p>Given a list of bytevectors: convert them into <acronym>ASCIIZ</acronym> strings and
build a <code>NULL</code> terminated array of C pointers referencing the strings. 
Return a pointer to the array.  The strings and the array are stored in
a single memory block.

        <p>Memory allocated by <code>bytevectors-&gt;argv</code> must be explicitly released
by <code>free</code>; memory allocated by <code>bytevectors-&gt;guarded-argv</code> is
automatically released by the garbage collector whenever the returned
pointer is garbage collected. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>argv-&gt;bytevectors</b><var> pointer<a name="index-argv_002d_003ebytevectors-424"></a></var><br>
<blockquote><p>Given a pointer to a <code>NULL</code> terminated array of C pointers referencing
<acronym>ASCIIZ</acronym> strings: build and return a list of bytevectors holding the
same bytes of the strings. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>strings-&gt;argv</b><var> list-of-strings<a name="index-strings_002d_003eargv-425"></a></var><br>
&mdash; Function: <b>strings-&gt;guarded-argv</b><var> list-of-strings<a name="index-strings_002d_003eguarded_002dargv-426"></a></var><br>
<blockquote><p>Given a list of Scheme strings: convert them into <acronym>ASCIIZ</acronym> strings and
build a <code>NULL</code> terminated array of C pointers referencing the strings. 
Return a pointer to the array.  The strings and the array are stored in
a single memory block.

        <p>The string arguments must contain only characters with Unicode code
points in the range [0, 255].

        <p>Memory allocated by <code>strings-&gt;argv</code> must be explicitly released
by <code>free</code>; memory allocated by <code>strings-&gt;guarded-argv</code> is
automatically released by the garbage collector whenever the returned
pointer is garbage collected. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>argv-&gt;strings</b><var> pointer<a name="index-argv_002d_003estrings-427"></a></var><br>
<blockquote><p>Given a pointer to a <code>NULL</code> terminated array of C pointers referencing
<acronym>ASCIIZ</acronym> strings: build and return a list of strings holding the same
bytes of the strings. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>argv-length</b><var> argv<a name="index-argv_002dlength-428"></a></var><br>
<blockquote><p>Return the number of strings in the <code>NULL</code>&ndash;terminated array of
strings referenced by the <var>argv</var> pointer. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="ffi-dl"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ffi-call">ffi call</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ffi-cstrings">ffi cstrings</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi">ffi</a>

</div>

<h3 class="section">4.4 Accessing foreign objects from Scheme</h3>

<p>Most system implementations of dynamic loading employ reference counting
for <code>dlopen</code> and <code>dlclose</code> in that library resources are not
freed until the number of calls to <code>dlclose</code> matches the number of
calls to <code>dlopen</code>.

<div class="defun">
&mdash; Function: <b>dlopen</b><var><a name="index-dlopen-429"></a></var><br>
&mdash; Function: <b>dlopen</b><var> library-name<a name="index-dlopen-430"></a></var><br>
&mdash; Function: <b>dlopen</b><var> library-name lazy? global?<a name="index-dlopen-431"></a></var><br>
<blockquote><p>Interface to the C function <code>dlopen()</code>, see the manual page
<code>dlopen(3)</code>.  Load a platform shared library and return a pointer
object representing a handler for the library, which can be used as
argument for <code>dlsym</code> and <code>dlclose</code>.  If the library cannot be
loaded: return <code>#f</code> and the procedure <code>dlerror</code> can be used to
obtain the cause of the failure.

        <p>When no arguments are present: the returned pointer handler references
the current process and it can be used to retrieve pointers to functions
already loaded, for example the functions exported by the standard C
library.  The <var>lazy?</var> and <var>global?</var> arguments are meaningless in
this case.

        <p>When given: <var>library-name</var> must be a string or a bytevector
representing the name of the library; if it is a string: it is converted
to bytevector using the function referenced by
<code>filename-&gt;string-func</code>.

        <p>Library names are system&ndash;dependent and must include the appropriate
suffix (for exapmle <code>*.so</code> on Linux, <code>*.dylib</code> on Darwin and
<code>*.dll</code> on Cygwin).  <var>library-name</var> may include a full path
which identifies the location of the library, or it may just be the name
of the library in which case the system will lookup the library name
using the <samp><span class="env">LD_LIBRARY_PATH</span></samp> environment variable.

        <p>The argument <var>lazy?</var> specifies how library dependencies are loaded. 
If true, <code>dlopen</code> delays the resolution and loading of dependent
libraries until they are actually used.  If false, all library
dependencies are loaded before the call to <code>dlopen</code> returns. 
<var>lazy?</var> defaults to <code>#f</code>.

        <p>The argument <var>global?</var> specifies the scope of the symbols exported
from the loaded library.  If true, all exported symbols become part of
the running image, and subsequent <code>dlsym</code> calls may not need to
specify the library from which the symbol is loaded.  If false, the
exported symbols are not global and the library pointer needs to be
specified for <code>dlsym</code>.  <var>global?</var> defaults to <code>#f</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>dlclose</b><var> handle<a name="index-dlclose-432"></a></var><br>
<blockquote><p>Interface to the C function <code>dlclose()</code>, see the manual page
<code>dlclose(3)</code>.  Release the resources loaded from the library
referenced by the pointer handler <var>handle</var>.  If successful return
<code>#t</code>, else return <code>#f</code> and <code>dlerror</code> can be used to obtain
the cause of the error.

        <p>Closing a library renders all symbols and static data structures that
the library exports invalid and the program may crash or corrupt its
memory if such symbols are used after a library is closed. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>dlsym</b><var> handle name<a name="index-dlsym-433"></a></var><br>
<blockquote><p>Interface to the C function <code>dlsym()</code>, see the manual page
<code>dlsym(3)</code>.  Search the loaded library referenced by the pointer
<var>handle</var> for an exported symbol whose name is represented by the
string <var>name</var>.  If successful return a pointer object, else return
<code>#f</code> and <code>dlerror</code> can be used to obtain the cause of the
error.

        <p>If the returned value references a function: it can be used as argument
to the callout generators built by <code>make-c-callout-maker</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>dlerror</b><var><a name="index-dlerror-434"></a></var><br>
<blockquote><p>Interface to the C function <code>dlerror()</code>, see the manual page
<code>dlerror(3)</code>.  If any of the dynamic loading operations fails, the
cause of the error can be obtained by calling <code>dlerror</code> which
returns a string describing the error; return <code>#f</code> if there was no
dynamic loading error. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="ffi-call"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ffi-errno">ffi errno</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ffi-dl">ffi dl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi">ffi</a>

</div>

<h3 class="section">4.5 Callouts and callbacks</h3>

<p>Callouts allow Scheme code to invoke C functions in a foreign library;
callbacks allow foreign C code to call a Scheme function.  The following
example shows how Scheme code can call a callout which in turns calls a
callback:

<pre class="example">     #!r6rs
     (import (rnrs)
       (prefix (vicare ffi) ffi.))
     
     (define callout-maker
       (ffi.make-c-callout-maker  'unsigned-int '(unsigned-int)))
     
     (define callback-maker
       (ffi.make-c-callback-maker 'unsigned-int '(unsigned-int)))
     
     (define callback
       (callback-maker values))
     
     (define callout
       (callout-maker callback))
     
     (callout 123)   &rArr; 123
     
     (ffi.free-c-callback callback)
</pre>
   <ul class="menu">
<li><a accesskey="1" href="#ffi-call-intro">ffi call intro</a>:               Overview of <acronym>FFI</acronym> function calls. 
<li><a accesskey="2" href="#ffi-call-out">ffi call out</a>:                 Calling out to foreign procedures. 
<li><a accesskey="3" href="#ffi-call-back">ffi call back</a>:                Calling back to Scheme. 
<li><a accesskey="4" href="#ffi-call-types">ffi call types</a>:               Specifying native types. 
</ul>

<!-- page -->
<div class="node">
<a name="ffi-call-intro"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ffi-call-out">ffi call out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi-call">ffi call</a>

</div>

<h4 class="subsection">4.5.1 Overview of <acronym>FFI</acronym> function calls</h4>

<p>Both callouts and callbacks are built on top of function signatures
specifying the type of function arguments and returned value.  Libffi
allows us to specify such signatures through a Call InterFace (<acronym>CIF</acronym>)
data structure; Vicare internally extends such a structure with
additional data to speed up marshaling of values from Scheme to native
representation and back.

   <p>At present, <acronym>CIF</acronym> data structures are allocated with <code>malloc()</code> and
never released.  Callouts and callbacks make use of <acronym>CIF</acronym> structures of
the same format, so such structures are internally cached; a single
<acronym>CIF</acronym> associated to a given function signature is used by all the
callouts and callbacks having the same signature.

<!--  -->
<h5 class="subsubheading">Calling out to foreign functions</h5>

<p>Callouts require only a <acronym>CIF</acronym> structure and the address of the foreign
C function; no additional structure needs to be allocated and then
released.

   <p>Vicare organises the callout <acronym>API</acronym> by creating a callout maker
function, closed upon a <acronym>CIF</acronym> structure, which can build any number of
callout functions associating the <acronym>CIF</acronym> to foreign function pointers. 
Maker functions are cached internally, so only one maker function for a
given signature is created in a running process.

<!--  -->
<h5 class="subsubheading">Calling back to Scheme functions</h5>

<p>Callbacks require an additional data structure, because they must
generate at runtime callable machine code referenced by a pointer; such
additional data structure cannot be automatically released by the
garbage collector, but it can be explicitly freed by the program when
the callback is no longer needed.

   <p>We can think of the code handling a callback as organised like the
following pseudo&ndash;code:

<pre class="example">     cif_t  call_interface;
     
     int
     specific_callback (int a, long b, double c)
     {
       void *  args[3] = { &amp;a, &amp;b, &amp;c };
       int     result;
       generic_callback(&amp;call_interface, &amp;result, args);
       return result;
     }
     
     void
     generic_callback (cif_t * call_interface,
                       void * result, void * args)
     {
       scheme_value  s_a, s_b, s_c;
       scheme_value  s_result;
       s_a = native_to_scheme(call_interface, 0, args);
       s_b = native_to_scheme(call_interface, 1, args);
       s_c = native_to_scheme(call_interface, 2, args);
       s_result = scheme_callback(s_a, s_b, s_c);
       scheme_to_native(call_interface, result, s_result);
     }
     
     scheme_value
     scheme_callback (scheme_value s_a,
                      scheme_value s_b,
                      scheme_value s_c)
     {
       /* process arguments, return result */
     }
</pre>
   <p class="noindent">where: <code>specific_callback</code> is generated at runtime by Libffi;
<code>generic_callback</code>, <code>scheme_to_native</code> and
<code>native_to_scheme</code> are implemented by Vicare's runtime
(using generic operations); <code>scheme callback</code> is implemented by the
Scheme program.  A pointer to <code>specific_callback</code> is the one we
need to acquire when creating a callback from Scheme.

   <p>Vicare organises the callback <acronym>API</acronym> by creating a callback
maker function, closed upon a <acronym>CIF</acronym> structure, which can build any
number of callback functions associating the <acronym>CIF</acronym> to Scheme functions. 
Maker functions are cached internally, so only one maker function for
each given signature is created in a running process.

<!-- page -->
<div class="node">
<a name="ffi-call-out"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ffi-call-back">ffi call back</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ffi-call-intro">ffi call intro</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi-call">ffi call</a>

</div>

<h4 class="subsection">4.5.2 Calling out to foreign procedures</h4>

<p>In order to call out to a foreign procedure, we must provide two pieces
of information: the signature of the foreign procedure and the address
of the procedure in memory.  The signature must usually be hard&ndash;coded
into the program; the address is obtained using <code>dlsym</code>.

   <p>Using the signature, the <acronym>FFI</acronym> determines how Scheme values are
converted to and from native values; a signature is composed of two
parts: a Scheme symbol specifying the return type, a list of Scheme
symbols specifying the argument types.

   <p>Here is a simple example, without error checking, showing how to
interface to the C function <code>sinh()</code>:

<pre class="example">     #!r6rs
     (import (vicare)
       (prefix (vicare ffi) ffi.))
     
     (define libc
       (ffi.dlopen))
     
     (define sinh-address
       (ffi.dlsym libc "sinh"))
     
     (define callout-maker
       (ffi.make-c-callout-maker 'double '(double)))
     
     (define sinh
       (callout-maker sinh-address))
     
     (sinh 1.2)      &rArr; 1.5094613554121725
</pre>
   <p class="noindent">using the <acronym>FFI</acronym> we build a callout function generator which can be used
to create any number of callout functions having the same signature. 
Generated callout functions are garbage collected like any other Scheme
value.

<div class="defun">
&mdash; Function: <b>make-c-callout-maker</b><var> ret-type arg-types<a name="index-make_002dc_002dcallout_002dmaker-435"></a></var><br>
<blockquote><p>Build and return a function to be used to generate callout Scheme
functions wrapping foreign functions which follow the C language
conventions for calling, arguments and return values.

        <p>The returned generator function accepts as single argument a pointer
object representing the address of a foreign function; the value
returned by the generator function is a Scheme closure wrapping the
foreign function.  The wrapper Scheme closure takes care of marshaling
Scheme values as appropriate for the underlying platform.

        <p><var>ret-type</var> must be a Scheme symbol specifying the type of the
returned value; if the foreign function returns no value: <var>ret-type</var>
must be the symbol <code>void</code>.

        <p><var>arg-types</var> must be a list of Scheme symbols specifying the type of
the arguments; if the foreign function accepts no arguments:
<var>arg-types</var> must be nil or the list <code>(void)</code>.

        <p><a href="#ffi-call-types">ffi call types</a> for the specification of accepted type symbols. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-c-callout-maker/with-errno</b><var> ret-type arg-types<a name="index-make_002dc_002dcallout_002dmaker_002fwith_002derrno-436"></a></var><br>
<blockquote><p>Like <code>make-c-callout-maker</code>, but the generated callout closures
will return two values: the return value from the foreign function call
and the value of the C language variable <code>errno</code> right after the
foreign function call. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="ffi-call-back"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#ffi-call-types">ffi call types</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ffi-call-out">ffi call out</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi-call">ffi call</a>

</div>

<h4 class="subsection">4.5.3 Calling back to Scheme</h4>

<p>In order to arrange for a foreign library to callback to a Scheme
function we need a suitable Scheme function and the signature of the
procedure the foreign library expects.  The signature must usually be
hard&ndash;coded in the program.

   <p>Using the signature, the <acronym>FFI</acronym> determines how native values are
converted to and from Scheme values; a signature is composed of two
parts: a Scheme symbol specifying the return type, a list of Scheme
symbols specifying the argument types.  The signature format is the same
as the one used for callouts; <a href="#ffi-call-out">ffi call out</a> for details.

   <p>Note that a callback function is indistinguishable from other native
procedures whose address is obtained using <code>dlsym</code> or similar
means.  In particular, such native pointers can be passed to callout
generators resulting in a Scheme procedure that calls out to the native
procedure that in turn calls back into Scheme.

   <p>The following example shows how to create an identity function for
native integers composed by a Scheme function calling out to a foreign
function, calling back to the Scheme function <code>values</code>:

<pre class="example">     #!r6rs
     (import (vicare)
       (prefix (vicare ffi) ffi.))
     
     (define callout-maker
       (ffi.make-c-callout-maker  'unsigned-int '(unsigned-int)))
     
     (define callback-maker
       (ffi.make-c-callback-maker 'unsigned-int '(unsigned-int)))
     
     (define identity
       (callout-maker (callback-maker values)))
     
     (identity 123)  &rArr; 123
</pre>
   <p class="noindent">using the <acronym>FFI</acronym> we build a callback function generator which can be
used to create any number of callback functions having the same
signature.  Generated callback functions are <strong>not</strong> garbage
collected like the other Scheme values.

<div class="defun">
&mdash; Function: <b>make-c-callback-maker</b><var> ret-type arg-types<a name="index-make_002dc_002dcallback_002dmaker-437"></a></var><br>
<blockquote><p>Build and return a function to be used to generate callback functions
following the C language conventions for calling, arguments and return
values and wrapping Scheme functions.

        <p>The returned generator function accepts as single argument the Scheme
function to be wrapped; the value returned by the generator function is
a pointer object referencing a native function.  The wrapper native
function takes care of marshaling Scheme values as appropriate for the
underlying platform.

        <p><var>ret-type</var> must be a Scheme symbol specifying the type of the
returned value; if the callback function must return no value:
<var>ret-type</var> must be the symbol <code>void</code>.

        <p><var>arg-types</var> must be a list of Scheme symbols specifying the type of
the arguments; if the callback function must accept no arguments:
<var>arg-types</var> must be nil or the list <code>(void)</code>.

        <p><a href="#ffi-call-types">ffi call types</a> for the specification of accepted type symbols. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>free-c-callback</b><var> c-callback-pointer<a name="index-free_002dc_002dcallback-438"></a></var><br>
<blockquote><p>Release the resources associated to the given C pointer referencing a
callback function.  If the pointer is not a callback pointer: raise an
assertion violation. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="ffi-call-types"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ffi-call-back">ffi call back</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi-call">ffi call</a>

</div>

<h4 class="subsection">4.5.4 Specifying native types</h4>

<p>The following is a list of Scheme symbols used to specify native types
for both callouts and callbacks.  If a type is not available on a
platform: the callout and callback generators will raise an error if the
associated type specifier is used.

     <dl>
<dt><code>signed-char</code><dt><code>unsigned-char</code><dd>Exact integers in the range for <code>char</code> and <code>unsigned char</code>.

     <br><dt><code>signed-short</code><dt><code>unsigned-short</code><dd>Exact integers in the range for <code>short int</code> and <code>unsigned short
int</code>.

     <br><dt><code>signed-int</code><dt><code>unsigned-int</code><dd>Exact integers in the range for <code>int</code> and <code>unsigned int</code>.

     <br><dt><code>signed-long</code><dt><code>unsigned-long</code><dd>Exact integers in the range for <code>long</code> and <code>unsigned long</code>.

     <br><dt><code>signed-long-long</code><dt><code>unsigned-long-long</code><dd>Exact integers in the range for <code>long long</code> and <code>unsigned long
long</code>.

     <br><dt><code>float</code><dt><code>double</code><dd>Flonum.

     <br><dt><code>pointer</code><dt><code>callback</code><dd>Pointer object.  The symbol <code>callback</code> can be used to specify a
pointer to a callback, but it is a full synonym of <code>pointer</code>.

     <br><dt><code>int8_t</code><dt><code>uint8_t</code><dd>Exact integers in the range for <code>int8_t</code> and <code>uint8_t</code>.

     <br><dt><code>int16_t</code><dt><code>uint16_t</code><dd>Exact integers in the range for <code>int16_t</code> and <code>uint16_t</code>.

     <br><dt><code>int32_t</code><dt><code>uint32_t</code><dd>Exact integers in the range for <code>int32_t</code> and <code>uint32_t</code>.

     <br><dt><code>int64_t</code><dt><code>uint64_t</code><dd>Exact integers in the range for <code>int64_t</code> and <code>uint64_t</code>. 
</dl>

<!-- page -->
<div class="node">
<a name="ffi-errno"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ffi-call">ffi call</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#ffi">ffi</a>

</div>

<h3 class="section">4.6 Interface to <code>errno</code></h3>

<p>Values for the C language variable <code>errno</code> are encoded as negated
fixnum values; for example: if <code>EPERM</code> is defined to <code>1</code> at
the C language level, Vicare defines it as the fixnum
<code>-1</code>.  One syntax identifier binding for each known <code>errno</code>
value is exported by the library <code>(vicare platform-constants)</code>; if
some error codes are not defined on a platform: the corresponding
binding evaluates to <code>#t</code>.

   <p>The Scheme code accessing <code>errno</code> values should be agnostic with
respect to the actual error codes; for this to happen we should use the
following facilities exported by the library <code>(vicare ffi)</code>.  In
addition, <code>(vicare ffi)</code> exports the following bindings also
exported by <code>(vicare posix)</code>:

<pre class="example">     &amp;errno            make-errno-condition
     errno-condition?  condition-errno
     strerror
</pre>
   <div class="defun">
&mdash; Function: <b>errno</b><var><a name="index-errno-439"></a></var><br>
&mdash; Function: <b>errno</b><var> code<a name="index-errno-440"></a></var><br>
<blockquote><p>Interface to the C language level <code>errno</code> variable.  When called
with no values return the value of the C variable <code>errno</code> right
after the last call to a C function performed by the current process. 
When called with one argument: set the C variable <code>errno</code> of the
current process to <var>code</var>, appropriately handling the coding of the
value.

        <p>As special cases: when the C variable <code>errno</code> is set to zero,
<code>errno</code> returns <code>#f</code>; when <var>code</var> is <code>#f</code>, the C
variable <code>errno</code> is set to zero; when <var>code</var> is <code>#t</code>, the C
variable <code>errno</code> is set to <code>EFAULT</code>.

        <p>The mechanism is such that the following form:

     <pre class="example">          (let ((rv (call-foreign-function)))
            (values rv (errno)))
</pre>
        <p class="noindent">performs a foreign&ndash;function call and evaluates to two values: the
return value from the foreign function and the value of the C variable
<code>errno</code> right after the foreign call. 
</p></blockquote></div>

<div class="defun">
&mdash; Syntax: <b>errno-code</b><var> &lt;symbol&gt;<a name="index-errno_002dcode-441"></a></var><br>
<blockquote><p>Verify that &lt;symbol&gt; is one of the symbolic names of <code>errno</code>;
if successful expand to an expression evaluating to the coded
<code>errno</code> value, else raise a syntax violation. 
</p></blockquote></div>

<div class="defun">
&mdash; Syntax: <b>case-errno</b><var> &lt;errno&gt; </var>((<var>&lt;code0&gt; &lt;code&gt; ...</var>)<var> . &lt;cbody&gt;</var>)<var> ...<a name="index-case_002derrno-442"></a></var><br>
&mdash; Syntax: <b>case-errno</b><var> &lt;errno&gt; </var>((<var>&lt;code0&gt; &lt;code&gt; ...</var>)<var> . &lt;cbody&gt;</var>)<var> ... </var>(<var>else . &lt;ebody&gt;</var>)<var><a name="index-case_002derrno-443"></a></var><br>
&mdash; Auxiliary Syntax: <b>else</b><var><a name="index-else-444"></a></var><br>
<blockquote><p>Specialised <code>case</code> macro for <code>errno</code> values.  <code>else</code> is
the auxiliary keyword exported by <code>(rnrs)</code>.  Example:

     <pre class="example">          #!r6rs
          (import (rnrs)
            (vicare ffi))
          
          (define identifier "some-port")
          
          (case-errno (errno)
            ((EACCES EFAULT)
             (make-i/o-file-protection-error identifier))
            ((EROFS)
             (make-i/o-file-is-read-only-error identifier))
            ((EEXIST)
             (make-i/o-file-already-exists-error identifier))
            ((EIO)
             (make-i/o-error))
            ((ENOENT)
             (make-i/o-file-does-not-exist-error identifier))
            (else
             (make-irritants-condition (list identifier))))
</pre>
        <p>The &lt;code&gt; must be symbols representing <code>errno</code> codes, they
are <strong>not</strong> meant to be binding identifiers. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#glibc">glibc</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#ffi">ffi</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">5 The <acronym>POSIX</acronym> interface</h2>

<p>The <acronym>POSIX</acronym> functions are exported by the <code>(vicare posix)</code>,
<code>(ikarus)</code> and <code>(vicare)</code> libraries.  The <acronym>API</acronym> attempts to
create a one&ndash;to&ndash;one Scheme functions mapping towards <acronym>POSIX</acronym>
functions, keeping the same semantics as much as possible; the
platform's own documentation is relevant at the Scheme level.

   <p>All the constants needed to use the interface are available as
identifier syntaxes exported by the <code>(vicare platform-constants)</code>
library; if a constant value is not exported file a feature request for
the project.  If a constant is not defined on a platform: its value is
set to <code>#f</code>.

<ul class="menu">
<li><a accesskey="1" href="#posix-conventions">posix conventions</a>:            Conventions about the <acronym>POSIX</acronym> <acronym>API</acronym>. 
<li><a accesskey="2" href="#posix-conditions">posix conditions</a>:             Condition object types. 
<li><a accesskey="3" href="#posix-env">posix env</a>:                    Operating system environment variables. 
<li><a accesskey="4" href="#posix-pid">posix pid</a>:                    Process identifier functions. 
<li><a accesskey="5" href="#posix-process">posix process</a>:                Spawning processes and the like. 
<li><a accesskey="6" href="#posix-status">posix status</a>:                 Process termination status. 
<li><a accesskey="7" href="#posix-signal">posix signal</a>:                 Delivering signals to processes. 
<li><a accesskey="8" href="#posix-stat">posix stat</a>:                   File system inspection. 
<li><a accesskey="9" href="#posix-file">posix file</a>:                   Interfacing with the file system. 
<li><a href="#posix-link">posix link</a>:                   Hard and symbolic links. 
<li><a href="#posix-dir">posix dir</a>:                    File system directories. 
<li><a href="#posix-fd">posix fd</a>:                     File descriptors. 
<li><a href="#posix-socket">posix socket</a>:                 Network sockets. 
<li><a href="#posix-users">posix users</a>:                  Users and groups. 
<li><a href="#posix-job">posix job</a>:                    Job control. 
<li><a href="#posix-time">posix time</a>:                   Time related functions. 
<li><a href="#posix-misc">posix misc</a>:                   Miscellaneous functions. 
</ul>

<!-- page -->
<div class="node">
<a name="posix-conventions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-conditions">posix conditions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.1 Conventions about the <acronym>POSIX</acronym> <acronym>API</acronym></h3>

<p>The following common arguments are specified:

     <dl>
<dt><var>fd</var><dd>It must be a non&ndash;negative fixnum repsesenting a platform's file
descriptor.

     <br><dt><var>pathname</var><dt><var>filename</var><dt><var>dirname</var><dd>It must be a string or bytevector representing a file system entry.

     <br><dt><var>stat</var><dd>It must be an instance of <code>struct-stat</code> data structure, <a href="#posix-stat">posix stat</a> for details. 
</dl>

   <p>The proper data type for file system pathnames is the bytevector; all
the functions requiring a pathname as argument accept both a bytevector
and a string for convenience.  String pathnames are converted to and
from bytevectors using the functions referenced by the parameters
<code>string-&gt;filename-func</code> and <code>filename-&gt;string-func</code>.

   <p>Whenever a system call returns a file system pathname: two functions are
provided by the <acronym>POSIX</acronym> <acronym>API</acronym>, one returning a bytevector and one
returning a string; the one returning a string has name ending with the
suffix &lsquo;<samp><span class="samp">/string</span></samp>&rsquo;.

   <p>Whenever a function in the <acronym>POSIX</acronym> <acronym>API</acronym> fails: it raises an exception
with compound condition type <code>&amp;error</code>, <code>&amp;who</code>,
<code>&amp;message</code>, <code>&amp;irritants</code>; if the error is described by
an <code>errno</code> value, an additional <code>&amp;errno</code> component is
present; if the function involves a file, an additional type
<code>&amp;i/o-filename</code> is present.

   <p>Values of the <code>errno</code> C language variable are negated and encoded
as fixnums.  Values of the <code>h_errno</code> C language variable are
negated and encoded as fixnums.

<!-- page -->
<div class="node">
<a name="posix-conditions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-env">posix env</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-conventions">posix conventions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.2 Condition object types</h3>

<div class="defun">
&mdash; Condition Type: <b>&amp;errno</b><var><a name="index-g_t_0026errno-445"></a></var><br>
<blockquote><p>Condition object type representing system errors described by an encoded
<code>errno</code> value; it is derived from <code>&amp;condition</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-errno-condition</b><var> errno<a name="index-make_002derrno_002dcondition-446"></a></var><br>
<blockquote><p>Build and return a new <code>&amp;errno</code> condition object holding the
given encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>errno-condition?</b><var> obj<a name="index-errno_002dcondition_003f-447"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>obj</var> is an instance of <code>&amp;errno</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>condition-errno</b><var> obj<a name="index-condition_002derrno-448"></a></var><br>
<blockquote><p>Accessor for the encoded <code>errno</code> value in <var>obj</var>, which must be
an instance of <code>&amp;errno</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Condition Type: <b>&amp;h_errno</b><var><a name="index-g_t_0026h_005ferrno-449"></a></var><br>
<blockquote><p>Condition object type representing system errors described by an encoded
<code>h_errno</code> value; it is derived from <code>&amp;condition</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-h_errno-condition</b><var> h_errno<a name="index-make_002dh_005ferrno_002dcondition-450"></a></var><br>
<blockquote><p>Build and return a new <code>&amp;h_errno</code> condition object holding the
given encoded <code>h_errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>h_errno-condition?</b><var> obj<a name="index-h_005ferrno_002dcondition_003f-451"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>obj</var> is an instance of <code>&amp;h_errno</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>condition-h_errno</b><var> obj<a name="index-condition_002dh_005ferrno-452"></a></var><br>
<blockquote><p>Accessor for the encoded <code>h_errno</code> value in <var>obj</var>, which must be
an instance of <code>&amp;h_errno</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-env"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-pid">posix pid</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-conditions">posix conditions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.3 Interfacing with the execution environment</h3>

<p>The Scheme level representation of environment variables names and
values is a string, but internally it is a bytevector; strings are
internally converted to bytevectors using <code>string-&gt;utf8</code>.

<div class="defun">
&mdash; Function: <b>getenv</b><var> varname<a name="index-getenv-453"></a></var><br>
<blockquote><p>Interface to the C function <code>getenv()</code>, <a href="libc.html#Environment-Access">getenv</a>.  Retrieve the value of environment variables. 
<var>variable</var> must reference a string object representing the name of
the environment variable.  If the environment variable is set: return a
string representing its value; else return false.

     <pre class="example">          (getenv "PATH")
          &rArr; "/usr/local/bin:/usr/bin:/bin"
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>setenv</b><var> variable value overwrite<a name="index-setenv-454"></a></var><br>
<blockquote><p>Interface to the C function <code>setenv()</code>, <a href="libc.html#Environment-Access">setenv</a>.  Set a new value for an environment variable.

        <p><var>variable</var> must reference a string object representing the name of
the environment variable; <var>value</var> must reference a string object
representing the new value.  If <var>overwrite</var> is false and the
environment variable already exists: the environment variable is left
untouched; else the new value is set, either creating a new environment
variable or replacing the old value.

        <p>If successful return true, if an error occurs in <code>setenv()</code> return
false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>unsetenv</b><var> variable<a name="index-unsetenv-455"></a></var><br>
<blockquote><p>Interface to the C function <code>unsetenv()</code>, <a href="libc.html#Environment-Access">unsetenv</a>.  Unset an environment variable.  <var>variable</var> must
reference a string object representing the name of the environment
variable.  Return true if <var>variable</var> has the correct format, else
return false; there is no way to know if a variable was actually unset. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>environ</b><var><a name="index-environ-456"></a></var><br>
<blockquote><p>Interface to the global C variable <code>environ</code>, <a href="libc.html#Environment-Access">unsetenv</a>.  Retrieve the full environment.  Return a list of
strings representing the contents of the <code>environ</code> array; if the
environment is empty (no environment variables set) return nil. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>environ-table</b><var><a name="index-environ_002dtable-457"></a></var><br>
<blockquote><p>Internally invoke <code>environ</code> and convert the alist of strings into a
hashtable; return the hashtable.  Both keys and values are strings. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>environ-&gt;table</b><var> environ<a name="index-environ_002d_003etable-458"></a></var><br>
&mdash; Function: <b>table-&gt;environ</b><var> table<a name="index-table_002d_003eenviron-459"></a></var><br>
<blockquote><p>Convert between an alist in &ldquo;environ&rdquo; format and a hashtable. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-pid"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-process">posix process</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-env">posix env</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.4 Process identifier functions</h3>

<div class="defun">
&mdash; Function: <b>getpid</b><var><a name="index-getpid-460"></a></var><br>
<blockquote><p>Return the process identifier as a fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getppid</b><var><a name="index-getppid-461"></a></var><br>
<blockquote><p>Return the process identifier of the parent as a fixnum. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-process"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-status">posix status</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-pid">posix pid</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.5 Spawning processes and the like</h3>

<div class="defun">
&mdash; Function: <b>system</b><var> command<a name="index-system-462"></a></var><br>
<blockquote><p>Interface to the C function <code>system()</code>, <a href="libc.html#Running-a-Command">system</a>.  Execute a command through the system shell; <var>command</var> must
be a string holding the command to execute.  If successful return the
termination status of the executed process, <a href="#posix-status">posix status</a> for
details; if an error occurs: an exception is raised.

     <pre class="example">          (system "ls -l")
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>fork</b><var><a name="index-fork-463"></a></var><br>
&mdash; Function: <b>fork</b><var> parent-proc child-thunk<a name="index-fork-464"></a></var><br>
<blockquote><p>Interface to the C function <code>fork()</code>, <a href="libc.html#Creating-a-Process">fork</a>.

        <p>When called with no arguments: create a new process by forking the
current one; if successful return a non&ndash;negative fixnum representing
the the return value of <code>fork()</code>, else raise an exception.

        <p>When called with two arguments: create a new process by forking the
current one; if successful the parent process applies <var>parent-proc</var>
to a fixnum representing the child process pid and return its return
value; if successful: the child process evaluates the <var>child-thunk</var>
and returns its return value; if an error occurs: an exception is
raised.

     <pre class="example">          (fork
            (lambda (child-pid)
              (printf "in parent, child pid = ~s\n" child-pid))
            (lambda ()
              (printf "in child\n")
              (exit)))
          
          (printf "here we are in the parent\n")
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>execv</b><var> filename argv<a name="index-execv-465"></a></var><br>
<blockquote><p>Interface to the C function <code>execv()</code>, <a href="libc.html#Executing-a-File">execv</a>.  <var>filename</var> must be the pathname of an executable file;
<var>argv</var> must be a list of strings representing command line
arguments.  Execute the command; if the function returns: an error has
occurred, an exception is raised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>execve</b><var> filename argv env<a name="index-execve-466"></a></var><br>
<blockquote><p>Interface to the C function <code>execve()</code>, <a href="libc.html#Executing-a-File">execve</a>.  <var>filename</var> must the pathname of an executable file;
<var>argv</var> must be a list of strings representing command line
arguments; <var>env</var> must be a list of strings representing environment
variables assignments.  Execute the command; if the function returns: an
error has occurred, an exception is raised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>execvp</b><var> filename argv<a name="index-execvp-467"></a></var><br>
<blockquote><p>Interface to the C function <code>execvp()</code>, <a href="libc.html#Executing-a-File">execvp</a>.  <var>filename</var> must be the pathname of an executable file
reachable in the current <samp><span class="env">PATH</span></samp>; <var>argv</var> must be a list of
strings representing command line arguments.  Execute the command; if
the function returns: an error has occurred, an exception is raised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>execl</b><var> filename arg0 arg ...<a name="index-execl-468"></a></var><br>
<blockquote><p>Like <code>execv</code> but allows the arguments to be given expliticly. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>execle</b><var> filename argv env ...<a name="index-execle-469"></a></var><br>
<blockquote><p>Like <code>execve</code> but allows the environment to be given expliticly. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>execlp</b><var> filename arg0 arg ...<a name="index-execlp-470"></a></var><br>
<blockquote><p>Like <code>execvp</code> but allows the arguments to be given expliticly. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-status"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-signal">posix signal</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-process">posix process</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.6 Process termination status.</h3>

<div class="defun">
&mdash; Function: <b>waitpid</b><var> pid options<a name="index-waitpid-471"></a></var><br>
<blockquote><p>Interface to the C function <code>waitpid()</code>, <a href="libc.html#Process-Completion">waitpid</a>.  Request status informations on a process or group
of processes knowing the identifier.  If successful return a fixnum
representing the status; if an error occurs: an exception is raised.

        <p>The fixnum <var>pid</var> selects the target of the request; the fixnum
<var>options</var> must be the logical OR (<code>fxior</code>) of platform specific
constants specifying how to wait for the availability of the status. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>wait</b><var><a name="index-wait-472"></a></var><br>
<blockquote><p>Interface to the C function <code>wait()</code>, <a href="libc.html#Process-Completion">wait</a>.  Request status informations on any process or group of
processes.  If successful return a fixnum representing the status; if an
error occurs: an exception is raised. 
</p></blockquote></div>

   <p>The following functions accept as argument a fixnum representing the
process termination status, for example the return value of
<code>system</code> or the status acquired by <code>waitpid</code>.

<div class="defun">
&mdash; Function: <b>WIFEXITED</b><var> status<a name="index-WIFEXITED-473"></a></var><br>
<blockquote><p>Interface to the C macro <code>WIFEXITED()</code>, <a href="libc.html#Process-Completion-Status">WIFEXITED</a>.  Return true if the process terminated normally with
<code>exit()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>WEXITSTATUS</b><var> status<a name="index-WEXITSTATUS-474"></a></var><br>
<blockquote><p>Interface to the C macro <code>WEXITSTATUS()</code>, <a href="libc.html#Process-Completion-Status">WEXITSTATUS</a>.  If <code>WIFEXITED</code> applied to
<var>status</var> would return true: return the low&ndash;order 8 bits from
the exit status, which is the process exit status selected with
<code>exit()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>WIFSIGNALED</b><var> status<a name="index-WIFSIGNALED-475"></a></var><br>
<blockquote><p>Interface to the C macro <code>WIFSIGNALED()</code>, <a href="libc.html#Process-Completion-Status">WIFSIGNALED</a>.  Return true if the process terminated
because it received an interprocess signal which was not handled. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>WTERMSIG</b><var> status<a name="index-WTERMSIG-476"></a></var><br>
<blockquote><p>Interface to the C macro <code>WTERMSIG()</code>, <a href="libc.html#Process-Completion-Status">WTERMSIG</a>.  If <code>WIFSIGNALED</code> applied to <var>status</var> would
return true: return the number of the interprocess signal that
terminated the process. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>WCOREDUMP</b><var> status<a name="index-WCOREDUMP-477"></a></var><br>
<blockquote><p>Interface to the C macro <code>WCOREDUMP()</code>, <a href="libc.html#Process-Completion-Status">WCOREDUMP</a>.  Return true if the process terminated and produced
a core dump. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>WIFSTOPPED</b><var> status<a name="index-WIFSTOPPED-478"></a></var><br>
<blockquote><p>Interface to the C macro <code>WIFSTOPPED()</code>, <a href="libc.html#Process-Completion-Status">WIFSTOPPED</a>.  Return true if the process is stopped. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>WSTOPSIG</b><var> status<a name="index-WSTOPSIG-479"></a></var><br>
<blockquote><p>Interface to the C macro <code>WSTOPSIG()</code>, <a href="libc.html#Process-Completion-Status">WSTOPSIG</a>.  If <code>WIFSTOPPED</code> applied to <var>status</var> would
return true: return the number of the interprocess signal that caused
the process to stop. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-signal"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-stat">posix stat</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-status">posix status</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.7 Delivering signals to processes</h3>

<div class="defun">
&mdash; Function: <b>raise-signal</b><var> signum<a name="index-raise_002dsignal-480"></a></var><br>
<blockquote><p>Interface to the C function <code>raise()</code>, <a href="libc.html#Signaling-Yourself">raise</a>.  Send the selected signal to the calling process.  If successful
return zero, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>kill</b><var> pid signum<a name="index-kill-481"></a></var><br>
<blockquote><p>Interface to the C function <code>kill()</code>, <a href="libc.html#Signaling-Another-Process">kill</a>.  Send the selected signal to selected process.  If
successful return zero, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pause</b><var><a name="index-pause-482"></a></var><br>
<blockquote><p>Interface to the C function <code>pause()</code>, <a href="libc.html#Using-Pause">pause</a>.  Suspend the process until a signal is received; return the void
object. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-stat"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-file">posix file</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-signal">posix signal</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.8 File system inspection</h3>

<div class="defun">
&mdash; Data Structure: <b>struct-stat</b><var><a name="index-struct_002dstat-483"></a></var><br>
<blockquote><p>Data structure type representing at the Scheme level the C structure
<code>struct stat</code>, <a href="libc.html#Attribute-Meanings">stat</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-struct-stat</b><var> mode ino dev nlink uid gid size atime atime_usec mtime mtime_usec ctime ctime_usec blocks blksize<a name="index-make_002dstruct_002dstat-484"></a></var><br>
<blockquote><p>Build and return a new <code>struct-stat</code> instance. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-stat?</b><var> obj<a name="index-struct_002dstat_003f-485"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is an instance of <code>struct-stat</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-stat-st_mode</b><var> stat<a name="index-struct_002dstat_002dst_005fmode-486"></a></var><br>
&mdash; Function: <b>struct-stat-st_ino</b><var> stat<a name="index-struct_002dstat_002dst_005fino-487"></a></var><br>
&mdash; Function: <b>struct-stat-st_dev</b><var> stat<a name="index-struct_002dstat_002dst_005fdev-488"></a></var><br>
&mdash; Function: <b>struct-stat-st_nlink</b><var> stat<a name="index-struct_002dstat_002dst_005fnlink-489"></a></var><br>
&mdash; Function: <b>struct-stat-st_uid</b><var> stat<a name="index-struct_002dstat_002dst_005fuid-490"></a></var><br>
&mdash; Function: <b>struct-stat-st_gid</b><var> stat<a name="index-struct_002dstat_002dst_005fgid-491"></a></var><br>
&mdash; Function: <b>struct-stat-st_size</b><var> stat<a name="index-struct_002dstat_002dst_005fsize-492"></a></var><br>
&mdash; Function: <b>struct-stat-st_atime</b><var> stat<a name="index-struct_002dstat_002dst_005fatime-493"></a></var><br>
&mdash; Function: <b>struct-stat-st_atime_usec</b><var> stat<a name="index-struct_002dstat_002dst_005fatime_005fusec-494"></a></var><br>
&mdash; Function: <b>struct-stat-st_mtime</b><var> stat<a name="index-struct_002dstat_002dst_005fmtime-495"></a></var><br>
&mdash; Function: <b>struct-stat-st_mtime_usec</b><var> stat<a name="index-struct_002dstat_002dst_005fmtime_005fusec-496"></a></var><br>
&mdash; Function: <b>struct-stat-st_ctime</b><var> stat<a name="index-struct_002dstat_002dst_005fctime-497"></a></var><br>
&mdash; Function: <b>struct-stat-st_ctime_usec</b><var> stat<a name="index-struct_002dstat_002dst_005fctime_005fusec-498"></a></var><br>
&mdash; Function: <b>struct-stat-st_blocks</b><var> stat<a name="index-struct_002dstat_002dst_005fblocks-499"></a></var><br>
&mdash; Function: <b>struct-stat-st_blksize</b><var> stat<a name="index-struct_002dstat_002dst_005fblksize-500"></a></var><br>
<blockquote><p>Accessors for the field of <code>struct-stat</code> instances. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>stat</b><var> pathname<a name="index-stat-501"></a></var><br>
&mdash; Function: <b>lstat</b><var> pathname<a name="index-lstat-502"></a></var><br>
<blockquote><p>Interfaces to the C functions <code>stat()</code> and <code>lstat()</code>,
<a href="libc.html#Reading-Attributes">stat</a>.  Inspect the file system entry
selected by <var>pathname</var> and return an instance of <code>struct-stat</code>. 
If an error occurs: an exception is raised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>fstat</b><var> fd<a name="index-fstat-503"></a></var><br>
<blockquote><p>Interface to the C function <code>fstat()</code>, <a href="libc.html#Reading-Attributes">fstat</a>.  Inspect the file system entry associated to the file descriptor
<var>fd</var>, which must be a fixnum, and return an instance of
<code>struct-stat</code>.  If an error occurs: an exception is raised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>file-is-directory?</b><var> pathname follow-symlinks?<a name="index-file_002dis_002ddirectory_003f-504"></a></var><br>
&mdash; Function: <b>file-is-char-device?</b><var> pathname follow-symlinks?<a name="index-file_002dis_002dchar_002ddevice_003f-505"></a></var><br>
&mdash; Function: <b>file-is-block-device?</b><var> pathname follow-symlinks?<a name="index-file_002dis_002dblock_002ddevice_003f-506"></a></var><br>
&mdash; Function: <b>file-is-regular-file?</b><var> pathname follow-symlinks?<a name="index-file_002dis_002dregular_002dfile_003f-507"></a></var><br>
&mdash; Function: <b>file-is-symbolic-link?</b><var> pathname follow-symlinks?<a name="index-file_002dis_002dsymbolic_002dlink_003f-508"></a></var><br>
&mdash; Function: <b>file-is-socket?</b><var> pathname follow-symlinks?<a name="index-file_002dis_002dsocket_003f-509"></a></var><br>
&mdash; Function: <b>file-is-fifo?</b><var> pathname follow-symlinks?<a name="index-file_002dis_002dfifo_003f-510"></a></var><br>
&mdash; Function: <b>file-is-message-queue?</b><var> pathname follow-symlinks?<a name="index-file_002dis_002dmessage_002dqueue_003f-511"></a></var><br>
&mdash; Function: <b>file-is-semaphore?</b><var> pathname follow-symlinks?<a name="index-file_002dis_002dsemaphore_003f-512"></a></var><br>
&mdash; Function: <b>file-is-shared-memory?</b><var> pathname follow-symlinks?<a name="index-file_002dis_002dshared_002dmemory_003f-513"></a></var><br>
<blockquote><p>Return <code>#t</code> or <code>#f</code> if the file system entry selected by
<var>pathname</var> is of the specified type; if an error occurs: an
exception is raised.  When <var>follow-symlinks?</var> is true: <code>stat()</code>
is used to inspect the entry, else <code>lstat()</code> is used. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>S_ISDIR</b><var> st_mode<a name="index-S_005fISDIR-514"></a></var><br>
&mdash; Function: <b>S_ISCHR</b><var> st_mode<a name="index-S_005fISCHR-515"></a></var><br>
&mdash; Function: <b>S_ISBLK</b><var> st_mode<a name="index-S_005fISBLK-516"></a></var><br>
&mdash; Function: <b>S_ISREG</b><var> st_mode<a name="index-S_005fISREG-517"></a></var><br>
&mdash; Function: <b>S_ISLNK</b><var> st_mode<a name="index-S_005fISLNK-518"></a></var><br>
&mdash; Function: <b>S_ISSOCK</b><var> st_mode<a name="index-S_005fISSOCK-519"></a></var><br>
&mdash; Function: <b>S_ISFIFO</b><var> st_mode<a name="index-S_005fISFIFO-520"></a></var><br>
<blockquote><p>Return <code>#t</code> or <code>#f</code> if the argument is associated to a file
system entry of the specified type.  <var>st_mode</var> must be the value of
the <code>st_mode</code> field of a <code>struct-stat</code> instance. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>access</b><var> pathname how<a name="index-access-521"></a></var><br>
<blockquote><p>Interface to the C function <code>access()</code>, <a href="libc.html#Testing-File-Access">access</a>.  Test the access mode selected by <var>how</var>, which must
be a fixnum, for the file system entry selected by <var>pathname</var>. 
Return <code>#t</code> or <code>#f</code> if the access is possible or not; if an error
occurs: an exception is raised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>file-readable?</b><var> pathname<a name="index-file_002dreadable_003f-522"></a></var><br>
&mdash; Function: <b>file-writable?</b><var> pathname<a name="index-file_002dwritable_003f-523"></a></var><br>
&mdash; Function: <b>file-executable?</b><var> pathname<a name="index-file_002dexecutable_003f-524"></a></var><br>
<blockquote><p>Return <code>#t</code> or <code>#f</code> if the file system entry selected by
<var>pathname</var> is accessible in the specified mode.  These functions are
equivalent but slower, respectively, to the following calls:

     <pre class="example">          (access pathname R_OK)
          (access pathname W_OK)
          (access pathname X_OK)
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>file-size</b><var> filename<a name="index-file_002dsize-525"></a></var><br>
<blockquote><p>Determine the size of the file selected by <var>filename</var> relying on a
call to <code>stat()</code>.  If successful: return an exact integer
representing the size, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>file-atime</b><var> pathname<a name="index-file_002datime-526"></a></var><br>
&mdash; Function: <b>file-mtime</b><var> pathname<a name="index-file_002dmtime-527"></a></var><br>
&mdash; Function: <b>file-ctime</b><var> pathname<a name="index-file_002dctime-528"></a></var><br>
<blockquote><p>Return an exact integer representing the access, modification and
creation times for <var>pathname</var>.  If an error occurs: raise an
exception. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-file"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-link">posix link</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-stat">posix stat</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.9 Interfacing with the file system</h3>

<div class="defun">
&mdash; Function: <b>chown</b><var> pathname owner group<a name="index-chown-529"></a></var><br>
<blockquote><p>Interface to the C function <code>chown()</code>, <a href="libc.html#File-Owner">chown</a>. 
Changes the owner and group of the file system entry selected by
<var>pathname</var>.  <var>owner</var> and <var>group</var> must be fixnums.  If
successful return zero, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>fchown</b><var> fd owner group<a name="index-fchown-530"></a></var><br>
<blockquote><p>Interface to the C function <code>fchown()</code>, <a href="libc.html#File-Owner">fchown</a>.  Changes the owner and group of the file system entry selected
by <var>fd</var>, which must be a fixnum representing a platform file
descriptor.  <var>owner</var> and <var>group</var> must be fixnums.  If successful
return zero, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>chmod</b><var> pathname mode<a name="index-chmod-531"></a></var><br>
<blockquote><p>Interface to the C function <code>chmod()</code>, <a href="libc.html#Setting-Permissions">chmod</a>.  Change to <var>mode</var>, which must be a fixnum, the
access permissions for the file system entry selected by <var>pathname</var>. 
If successful return zero, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>fchmod</b><var> fd mode<a name="index-fchmod-532"></a></var><br>
<blockquote><p>Interface to the C function <code>fchmod()</code>, <a href="libc.html#Setting-Permissions">fchmod</a>.  Change to <var>mode</var>, which must be a fixnum, the
access permissions for the file system entry associated to <var>fd</var>,
which must be a fixnum representing a platform file descriptor.  If
successful return zero, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>umask</b><var> mask<a name="index-umask-533"></a></var><br>
<blockquote><p>Interface to the C function <code>umask()</code>, <a href="libc.html#Setting-Permissions">umask</a>.  Set the current file creation mask to <var>mask</var>,
which must be a fixnum, and return the previous mask as a fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getumask</b><var><a name="index-getumask-534"></a></var><br>
<blockquote><p>Interface to the C function <code>getumask()</code>, <a href="libc.html#Setting-Permissions">getumask</a>.  Return the current file creation mask as a
fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>utime</b><var> pathname atime_sec mtime_sec<a name="index-utime-535"></a></var><br>
<blockquote><p>Interface to the C function <code>utime()</code>, <a href="libc.html#File-Times">utime</a>. 
Set the access and modification times of the file system entry selected
by <var>pathname</var> to the specified counts of seconds; both
<var>atime_sec</var> and <var>mtime_sec</var> must be fixnums.  If successful
return zero, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>utimes</b><var> pathname atime_sec atime_usec mtime_sec mtime_usec<a name="index-utimes-536"></a></var><br>
&mdash; Function: <b>lutimes</b><var> pathname atime_sec atime_usec mtime_sec mtime_usec<a name="index-lutimes-537"></a></var><br>
<blockquote><p>Interface to the C functions <code>utimes()</code> and <code>lutimes()</code>,
<a href="libc.html#File-Times">utimes</a>.  Set the access and modification times of
the file system entry selected by <var>pathname</var> to the specified counts
of seconds and microseconds; all the numeric arguments must be fixnums. 
If successful return zero, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>futimes</b><var> fd atime_sec atime_usec mtime_sec mtime_usec<a name="index-futimes-538"></a></var><br>
<blockquote><p>Interface to the C function <code>futimes()</code>, <a href="libc.html#File-Times">futimes</a>.  Set the access and modification times of the file system
entry associated to <var>fd</var> to the specified counts of seconds and
microseconds; all the numeric arguments must be fixnums.  If successful
return zero, else raise an exception. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-link"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-dir">posix dir</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-file">posix file</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.10 Hard and symbolic links</h3>

<div class="defun">
&mdash; Function: <b>link</b><var> old_pathname new_pathname<a name="index-link-539"></a></var><br>
<blockquote><p>Interface to the C function <code>link()</code>, <a href="libc.html#Hard-Links">link</a>. 
Create a hard link <var>new_pathname</var> to the source file system entry
<var>old_pathname</var>.  If successful return zero, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>symlink</b><var> file_pathname link_pathname<a name="index-symlink-540"></a></var><br>
<blockquote><p>Interface to the C function <code>symlink()</code>, <a href="libc.html#Symbolic-Links">symlink</a>.  Create a symbolic link <var>link_pathname</var> to the source file
system entry <var>file_pathname</var>.  If successful return zero, else raise
an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>readlink</b><var> link_pathname<a name="index-readlink-541"></a></var><br>
&mdash; Function: <b>readlink/string</b><var> link_pathname<a name="index-readlink_002fstring-542"></a></var><br>
<blockquote><p>Interface to the C function <code>readlink()</code>, <a href="libc.html#Symbolic-Links">readlink</a>.  If <var>pathname</var> references a symbolic link: follow it once
and return the referenced pathname; if an error occurs raise an
exception.  <code>readlink</code> returns a bytevector; <code>readlink/string</code>
returns a string. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>realpath</b><var> pathname<a name="index-realpath-543"></a></var><br>
&mdash; Function: <b>realpath/string</b><var> pathname<a name="index-realpath_002fstring-544"></a></var><br>
<blockquote><p>Interface to the C function <code>realpath()</code>, <a href="libc.html#Symbolic-Links">realpath</a>.  If <var>pathname</var> references a symbolic link: follow it and
return the real canonicalised pathname; if an error occurs: an exception
is raised.  <code>realpath</code> returns a bytevector; <code>realpath/string</code>
returns a string. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>unlink</b><var> pathname<a name="index-unlink-545"></a></var><br>
<blockquote><p>Interface to the C function <code>unlink()</code>, <a href="libc.html#Deleting-Files">unlink</a>.  Delete the file system entry referenced by <var>pathname</var>,
which must reference a file.  If successful return unspecified values,
else raise an exception.

        <p>This function is the same of <code>delete-file</code> defined by <acronym>R6RS</acronym>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>posix-remove</b><var> pathname<a name="index-posix_002dremove-546"></a></var><br>
<blockquote><p>Interface to the C function <code>remove()</code>, <a href="libc.html#Deleting-Files">remove</a>.  Delete the file system entry referenced by <var>pathname</var>,
which can reference a file or directory.  If successful return
unspecified values, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>rename</b><var> old-pathname new-pathname<a name="index-rename-547"></a></var><br>
<blockquote><p>Interface to the C function <code>rename()</code>, <a href="libc.html#Renaming-Files">rename</a>.  Rename the file system entry <var>old-pathname</var> to
<var>new-pathname</var>.  If successful return unspecified values, else
return an encoded <code>errno</code> value. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-dir"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-fd">posix fd</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-link">posix link</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.11 File system directories</h3>

<div class="defun">
&mdash; Function: <b>mkdir</b><var> pathname mode<a name="index-mkdir-548"></a></var><br>
<blockquote><p>Interface to the C function <code>mkdir()</code>, <a href="libc.html#Creating-Directories">mkdir</a>.  Create a new directory file system entry with name
<var>pathname</var>; <var>mode</var> must be a fixnum specifying access
permissions.  If successful return unspecified values, else raise an
exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>mkdir/parents</b><var> pathname mode<a name="index-mkdir_002fparents-549"></a></var><br>
<blockquote><p>Create a new directory file system entry with name <var>pathname</var> and
all its parents if they do not exist; <var>mode</var> must be a fixnum
specifying access permissions for all the components.  If successful
return unspecified values, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>rmdir</b><var> pathname<a name="index-rmdir-550"></a></var><br>
<blockquote><p>Interface to the C function <code>rmdir()</code>, <a href="libc.html#Creating-Directories">rmdir</a>.  Remove the directory file system entry selected by
<var>pathname</var>.  If successful return unspecified values, else raise an
exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getcwd</b><var><a name="index-getcwd-551"></a></var><br>
&mdash; Function: <b>getcwd/string</b><var><a name="index-getcwd_002fstring-552"></a></var><br>
<blockquote><p>Interface to the C function <code>getcwd()</code>, <a href="libc.html#Working-Directory">getcwd</a>.  Acquire the pathname of the current working directory.  If
successful <code>getcwd</code> returns a bytevector holding the pathname,
<code>getcwd/string</code> returns a string holding the pathname; else an
exception is raised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>chdir</b><var> pathname<a name="index-chdir-553"></a></var><br>
<blockquote><p>Interface to the C function <code>chdir()</code>, <a href="libc.html#Working-Directory">chdir</a>.  Change the current working directory to the file system entry
selected by <var>pathname</var>.  If successful return unspecified values,
else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>fchdir</b><var> fd<a name="index-fchdir-554"></a></var><br>
<blockquote><p>Interface to the C function <code>fchdir()</code>, <a href="libc.html#Working-Directory">fchdir</a>.  Change the current working directory to the file system entry
associated to <var>fd</var>, which must be a fixnum representing a file
descriptor.  If successful return unspecified values, else raise an
exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Structure Type: <b>directory-stream</b><var><a name="index-directory_002dstream-555"></a></var><br>
<blockquote><p>Opaque data structure type used in the inspection of file system
directory entries.  Instances of this type can be destroyed by
<code>closedir</code>, but they are also automatically and correctly destroyed
by the garbage collector.  It has the following fields:

          <dl>
<dt><code>pathname</code><dd>False or a string representing the pathname.

          <br><dt><code>pointer</code><dd>A pointer object referencing the directory.

          <br><dt><code>fd</code><dd>False or a fixnum representing the file descriptor associated to the
directory.

          <br><dt><code>closed?</code><dd>A boolean, true if this stream has already been closed. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-directory-stream</b><var> pathname pointer fd closed?<a name="index-make_002ddirectory_002dstream-556"></a></var><br>
<blockquote><p>Constructor for <code>directory-stream</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>directory-stream?</b><var> obj<a name="index-directory_002dstream_003f-557"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is an instance of <code>directory-stream</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>directory-stream-pathname</b><var> stream<a name="index-directory_002dstream_002dpathname-558"></a></var><br>
&mdash; Function: <b>directory-stream-pointer</b><var> stream<a name="index-directory_002dstream_002dpointer-559"></a></var><br>
&mdash; Function: <b>directory-stream-fd</b><var> stream<a name="index-directory_002dstream_002dfd-560"></a></var><br>
&mdash; Function: <b>directory-stream-closed?</b><var> stream<a name="index-directory_002dstream_002dclosed_003f-561"></a></var><br>
<blockquote><p>Accessors for the fields of <code>directory-stream</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>opendir</b><var> pathname<a name="index-opendir-562"></a></var><br>
<blockquote><p>Interface to the C function <code>opendir()</code>, <a href="libc.html#Opening-a-Directory">opendir</a>.  Open a directory stream for the inspection of the
file system entry <var>pathname</var>.  If successful return an instance of
<code>directory-stream</code>, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>fdopendir</b><var> fd<a name="index-fdopendir-563"></a></var><br>
<blockquote><p>Interface to the C function <code>fdopendir()</code>, <a href="libc.html#Opening-a-Directory">fdopendir</a>.  Open a directory stream for the inspection of
the file system entry associated to <var>fd</var>, which must be a fixnum
representing a file descriptor.  If successful return an instance of
<code>directory-stream</code>, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>readdir</b><var> stream<a name="index-readdir-564"></a></var><br>
&mdash; Function: <b>readdir/string</b><var> stream<a name="index-readdir_002fstring-565"></a></var><br>
<blockquote><p>Interface to the C function <code>readdir()</code>, <a href="libc.html#Reading_002fClosing-Directory">readdir</a>.  Acquire the next entry from a directory stream
referenced by <var>stream</var>, which must be an instance of
<code>directory-stream</code>.  If successful and an entry is available:
<code>readdir</code> returns a pathname as a bytevector, <code>readdir/string</code>
returns a pathname as a string; if successful and no more entries are
available: return <code>#f</code>; else raise an exception.

        <p>When no more entries are available or an error occurs: the directory
stream is closed. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>closedir</b><var> stream<a name="index-closedir-566"></a></var><br>
<blockquote><p>Interface to the C function <code>closedir()</code>, <a href="libc.html#Reading_002fClosing-Directory">closedir</a>.  Close the directory stream referenced by
<var>stream</var>, which must be an instance of <code>directory-stream</code>.  If
successful return unspecified values, else raise an exception.

        <p>This function has no effect if <var>stream</var> has been already closed. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>rewinddir</b><var> stream<a name="index-rewinddir-567"></a></var><br>
<blockquote><p>Interface to the C function <code>rewinddir()</code>, <a href="libc.html#Random-Access-Directory">rewinddir</a>.  Rewind to the beginning the directory stream
referenced by <var>stream</var>, which must be an instance of
<code>directory-stream</code>.  Return unspecified values. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>telldir</b><var> stream<a name="index-telldir-568"></a></var><br>
<blockquote><p>Interface to the C function <code>telldir()</code>, <a href="libc.html#Random-Access-Directory">telldir</a>.  Return an exact integer representing the current
position in the directory stream referenced by <var>stream</var>, which must
be an instance of <code>directory-stream</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>seekdir</b><var> pointer pos<a name="index-seekdir-569"></a></var><br>
<blockquote><p>Interface to the C function <code>seekdir()</code>, <a href="libc.html#Random-Access-Directory">seekdir</a>.  Set to <var>pos</var> the position of the directory
stream referenced by <var>stream</var>, which must be an instance of
<code>directory-stream</code>; <var>pos</var> must be the return value of a
previous call to <code>telldir</code>.  Return unspecified values. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-fd"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-socket">posix socket</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-dir">posix dir</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.12 File descriptors</h3>

<div class="defun">
&mdash; Function: <b>open</b><var> pathname flags mode<a name="index-open-570"></a></var><br>
<blockquote><p>Interface to the C function <code>open()</code>, <a href="libc.html#Opening-and-Closing-Files">open</a>.  Open a file descriptor for the file system entry
<var>pathname</var>; <var>flags</var> and <var>mode</var> must be fixnums.  If
successful return a fixnum representing the file descriptor, else raise
an exception.

        <p>Example:

     <pre class="example">          #!r6rs
          (import (vicare)
            (vicare platform-constants))
          
          (define fd
            (open "name.ext"
                  (fxior O_CREAT O_EXCL O_RDWR)
                  (fxior S_IRUSR S_IWUSR)))
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>close</b><var> fd<a name="index-close-571"></a></var><br>
<blockquote><p>Interface to the C function <code>close()</code>, <a href="libc.html#Opening-and-Closing-Files">close</a>.  Close a file descriptor represented by <var>fd</var>, which
must be a fixnum.  If successful return unspecified values, else raise
an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>posix-read</b><var> fd buffer<a name="index-posix_002dread-572"></a></var><br>
&mdash; Function: <b>posix-read</b><var> fd buffer size<a name="index-posix_002dread-573"></a></var><br>
<blockquote><p>Interface to the C function <code>read()</code>, <a href="libc.html#I_002fO-Primitives">read</a>.  Read bytes from the file descriptor <var>fd</var> and store them in
the bytevector <var>buffer</var>; if <var>size</var> is a fixnum, read <var>size</var>
bytes; if <var>size</var> is false or not given, read a number of bytes equal
to the length of <var>buffer</var>.  If successful return a non&ndash;negative
fixnum representing the number of bytes read, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pread</b><var> fd buffer size off<a name="index-pread-574"></a></var><br>
<blockquote><p>Interface to the C function <code>pread()</code>, <a href="libc.html#I_002fO-Primitives">pread</a>.  Like <code>posix-read</code>, but start reading at offset <var>off</var>
from the start of the file; <var>off</var> must be a non&ndash;negative exact
integer. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>posix-write</b><var> fd buffer<a name="index-posix_002dwrite-575"></a></var><br>
&mdash; Function: <b>posix-write</b><var> fd buffer size<a name="index-posix_002dwrite-576"></a></var><br>
<blockquote><p>Interface to the C function <code>write()</code>, <a href="libc.html#I_002fO-Primitives">write</a>.  Write bytes to the file descriptor <var>fd</var> from the bytevector
<var>buffer</var>; if <var>size</var> is a fixnum, read <var>size</var> bytes; if
<var>size</var> is false or not given, read a number of bytes equal to the
length of <var>buffer</var>.  If successful return a non&ndash;negative fixnum
representing the number of written bytes, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pwrite</b><var> fd buffer size off<a name="index-pwrite-577"></a></var><br>
<blockquote><p>Interface to the C function <code>pwrite()</code>, <a href="libc.html#I_002fO-Primitives">pwrite</a>.  Like <code>posix-write</code>, but start writing at offset <var>off</var>
from the start of the file; <var>off</var> must be a non&ndash;negative exact
integer. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>lseek</b><var> fd off whence<a name="index-lseek-578"></a></var><br>
<blockquote><p>Interface to the C function <code>lseek()</code>, <a href="libc.html#File-Position-Primitive">lseek</a>.  Change the file position of the file descriptor
<var>fd</var> to <var>off</var> from <var>whence</var>; <var>whence</var> must a fixnum,
<var>off</var> must be an exact integer.  If successful return a
non&ndash;negative exact integer representing the number of bytes from the
beginning of the file, else raise an exception. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>readv</b><var> fd buffers<a name="index-readv-579"></a></var><br>
<blockquote><p>Interface to the C function <code>readv()</code>, <a href="libc.html#Scatter_002dGather">readv</a>.  Read bytes from the file descriptor <var>fd</var> and store them
into the list of bytevectors referenced by <var>buffers</var>.  If successful
return a non&ndash;negative exact integer representing the number of bytes
actually read, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>writev</b><var> fd buffers<a name="index-writev-580"></a></var><br>
<blockquote><p>Interface to the C function <code>writev()</code>, <a href="libc.html#Scatter_002dGather">writev</a>.  Write bytes to the file descriptor <var>fd</var> from the list of
bytevectors referenced by <var>buffers</var>.  If successful return a
non&ndash;negative exact integer representing the number of bytes actually
written, else raise an exception. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>select</b><var> nfds read-fds write-fds except-fds sec usec<a name="index-select-581"></a></var><br>
<blockquote><p>Interface to the C function <code>select()</code>, <a href="libc.html#Waiting-for-I_002fO">select</a>.  Wait for read, write or exceptional events on selected lists
of file descriptors.

        <p><var>nfds</var> must be false or a non&ndash;negative fixnum, when false it
defaults to the maximum file descriptor value in the given lists; it is
the maximum file descriptor number in the sets to be checked for events,
plus one.  <var>read-fds</var>, <var>write-fds</var> and <var>except-fds</var> must be
nil or lists of file descriptors to be checked for events.  <var>sec</var>
and <var>usec</var> must be fixnums representing timeout seconds and
microseconds.

        <p>If the timeout expires before any event arrives: return 3 values all
being nil.  If an error occurs: raise an exception.  Else return 3
values being lists of file descriptors, respectively, ready for reading,
writing or an exceptional condition. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>select-fd</b><var> fd sec usec<a name="index-select_002dfd-582"></a></var><br>
<blockquote><p>Interface to the C function <code>select()</code>, <a href="libc.html#Waiting-for-I_002fO">select</a>.  Wait for read, write or exceptional events on the single file
descriptor <var>fd</var>.  <var>sec</var> and <var>usec</var> must be fixnums
representing timeout seconds and microseconds.

        <p>If the timeout expires before any event arrives: return 3 values all
being false.  If an error occurs: raise an exception.  Else return 3
values being false or <var>fd</var>, respectively, if <var>fd</var> is ready for
reading, writing or an exceptional condition. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>fcntl</b><var> fd command<a name="index-fcntl-583"></a></var><br>
&mdash; Function: <b>fcntl</b><var> fd command arg<a name="index-fcntl-584"></a></var><br>
<blockquote><p>Interface to the C function <code>fcntl()</code>, <a href="libc.html#Control-Operations">fcntl</a>.  Perform the operation specified by <var>command</var> on the file
descriptor <var>fd</var> using <var>arg</var>; <var>fd</var> and <var>command</var> must be
fixnums; <var>arg</var> must be <code>#f</code>, a fixnum, a bytevector or a
pointer, if it is <code>#f</code> or not given no argument is handed to
<code>fcntl()</code>.  If successful return a fixnum representing the return
value of <code>fcntl()</code>, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>ioctl</b><var> fd command<a name="index-ioctl-585"></a></var><br>
&mdash; Function: <b>ioctl</b><var> fd command arg<a name="index-ioctl-586"></a></var><br>
<blockquote><p>Interface to the C function <code>ioctl()</code>, <a href="libc.html#IOCTLs">ioctl</a>. 
Perform the operation specified by <var>command</var> on the file descriptor
<var>fd</var> using <var>arg</var>; <var>fd</var> and <var>command</var> must be fixnums;
<var>arg</var> must be <code>#f</code>, a fixnum, a bytevector or a pointer, if it
is <code>#f</code> or not given no argument is handed to <code>ioctl()</code>.  If
successful return a fixnum representing the return value of
<code>ioctl()</code>, else raise an exception. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>dup</b><var> fd<a name="index-dup-587"></a></var><br>
<blockquote><p>Interface to the C function <code>dup()</code>, <a href="libc.html#Duplicating-Descriptors">dup</a>.  Duplicate the file descriptor <var>fd</var>.  If
successful return a non&ndash;negative fixnum representing the new
descriptor, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>dup2</b><var> old new<a name="index-dup2-588"></a></var><br>
<blockquote><p>Interface to the C function <code>dup2()</code>, <a href="libc.html#Duplicating-Descriptors">dup</a>.  Duplicate the file descriptor <var>old</var> to
<var>new</var>.  If successful return unspecified values, else raise an
exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pipe</b><var><a name="index-pipe-589"></a></var><br>
<blockquote><p>Interface to the C function <code>pipe()</code>, <a href="libc.html#Creating-a-Pipe">pipe</a>.  Create a pair of file descriptors connected through a pipe.  If
successful return two values being fixnums representing the file
descriptors, else raise an exception.

        <p>Simple example of process writing to itself through a pipe:

     <pre class="example">          #!r6rs
          (import (vicare))
          
          (let-values (((in ou) (pipe)))
            (posix-write ou '#vu8(1 2 3 4) 4)
            (let ((bv (make-bytevector 4)))
              (posix-read in bv 4)
              bv))
          &rArr; #vu8(1 2 3 4)
</pre>
        <p class="noindent">here is how to fork a process and setup stdin and stdout in the children
to use newly created pipe file descriptors to communicate with the
parent:

     <pre class="example">          #!r6rs
          (import (vicare))
          
          (let-values
              (((child-stdin       parent-to-child) (pipe))
               ((parent-from-child child-stdout)    (pipe)))
            (fork
          
              (lambda (pid) ;parent
                (let ((buf (make-bytevector 1)))
                  (posix-read  parent-from-child buf 1)
                  (posix-write parent-to-child '#vu8(2) 1)
                  buf))
          
              (lambda () ;child
                (begin ;setup stdin
                  (close-input-port (current-input-port))
                  (dup2 child-stdin 0)
                  (close child-stdin))
          
                (begin ;setup stdout
                  (close-output-port (current-output-port))
                  (dup2 child-stdout 1)
                  (close child-stdout))
          
                (let ((buf (make-bytevector 1)))
                  (posix-write 1 '#vu8(1) 1)
                  (posix-read  0 buf 1)
                  (exit 0)))))
          &rArr; #vu8(1)
</pre>
        <p class="noindent">here is how to fork a process and setup stdin and stdout in the children
to use newly created pipe file descriptors, through Scheme ports, to
communicate with the parent:

     <pre class="example">          #!r6rs
          (import (vicare))
          
          (let-values (((child-stdin       parent-to-child) (pipe))
                       ((parent-from-child child-stdout)    (pipe)))
            (fork
             (lambda (pid)        ;parent
               (let* ((inp (make-textual-file-descriptor-input-port
                            parent-from-child "in" (native-transcoder)))
                      (oup (make-textual-file-descriptor-output-port
                            parent-to-child "out" (native-transcoder)))
                      (buf (get-string-n inp 4)))
                 (display "hello" oup)
                 (flush-output-port oup)
                 buf))
          
             (lambda ()           ;child
          
               (begin      ;setup stdin
                 (close-input-port (current-input-port))
                 (current-input-port
                  (make-textual-file-descriptor-input-port
                   child-stdin "*stdin*" (native-transcoder))))
          
               (begin ;setup stdout
                 (close-output-port (current-output-port))
                 (current-output-port
                  (make-textual-file-descriptor-output-port
                   child-stdout "*stdout*" (native-transcoder))))
          
               (display "ciao")
               (flush-output-port (current-output-port))
               (get-string-n (current-input-port) 5)
               (exit 0))))
          &rArr; "ciao"
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>mkfifo</b><var> pathname mode<a name="index-mkfifo-590"></a></var><br>
<blockquote><p>Interface to the C function <code>mkfifo()</code>, <a href="libc.html#FIFO-Special-Files">mkfifo</a>.  Create a FIFO special file with name <var>pathname</var> and
mode <var>mode</var>, which must be a fixnum.  If successful return
unspecified values, else raise an exception. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-socket"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-users">posix users</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-fd">posix fd</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.13 Network sockets</h3>

<p>With the purpose of keeping at the Scheme level the same semantics of
the C level <acronym>POSIX</acronym> <acronym>API</acronym>, socket&ndash;related data structures are stored
in bytevectors; such raw manipulation can cause the process to crash if
we mishandle the values.

<ul class="menu">
<li><a accesskey="1" href="#posix-socket-addresses">posix socket addresses</a>:       Network address structures. 
<li><a accesskey="2" href="#posix-socket-hosts">posix socket hosts</a>:           Network hosts database. 
<li><a accesskey="3" href="#posix-socket-protocols">posix socket protocols</a>:       Network protocols database. 
<li><a accesskey="4" href="#posix-socket-services">posix socket services</a>:        Network services database. 
<li><a accesskey="5" href="#posix-socket-networks">posix socket networks</a>:        Networks database. 
<li><a accesskey="6" href="#posix-socket-socket">posix socket socket</a>:          Network sockets operations. 
<li><a accesskey="7" href="#posix-socket-misc">posix socket misc</a>:            Error and miscellaneous functions. 
<li><a accesskey="8" href="#posix-socket-examples">posix socket examples</a>:        Examples of clients and servers. 
<li><a accesskey="9" href="#posix-socket-oob">posix socket oob</a>:             Notes on transmission of <acronym>OOB</acronym> data. 
</ul>

<!-- page -->
<div class="node">
<a name="posix-socket-addresses"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-socket-hosts">posix socket hosts</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-socket">posix socket</a>

</div>

<h4 class="subsection">5.13.1 Network address structures</h4>

<ul class="menu">
<li><a accesskey="1" href="#posix-socket-addresses-local">posix socket addresses local</a>:  Local addresses. 
<li><a accesskey="2" href="#posix-socket-addresses-in">posix socket addresses in</a>:     <acronym>IP</acronym>v4 addresses. 
<li><a accesskey="3" href="#posix-socket-addresses-in6">posix socket addresses in6</a>:    <acronym>IP</acronym>v6 addresses. 
<li><a accesskey="4" href="#posix-socket-addresses-rep">posix socket addresses rep</a>:    <acronym>ASCII</acronym> address representations. 
<li><a accesskey="5" href="#posix-socket-addresses-info">posix socket addresses info</a>:   Host address informations. 
</ul>

<!-- page -->
<div class="node">
<a name="posix-socket-addresses-local"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-socket-addresses-in">posix socket addresses in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-socket-addresses">posix socket addresses</a>

</div>

<h5 class="subsubsection">5.13.1.1 Local addresses</h5>

<p>Instances of <code>struct sockaddr_un</code> can be handled at the Scheme
level as follows:

<pre class="example">     (import (vicare))
     
     (define sockaddr
       (make-sockaddr_un "/tmp/the-unix-socket"))
     
     (sockaddr_un.pathname/string sockaddr)
     &rArr; "/tmp/the-unix-socket"
</pre>
   <p class="noindent">care must be taken when handling such raw values.

<div class="defun">
&mdash; Function: <b>make-sockaddr_un</b><var> pathname<a name="index-make_002dsockaddr_005fun-591"></a></var><br>
<blockquote><p>Given a <var>pathname</var> representing the pathname of a local socket,
build and return a bytevector holding the <code>struct sockaddr_un</code>
representing it. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>sockaddr_un.pathname</b><var> socket_address<a name="index-sockaddr_005fun_002epathname-592"></a></var><br>
&mdash; Function: <b>sockaddr_un.pathname/string</b><var> socket_address<a name="index-sockaddr_005fun_002epathname_002fstring-593"></a></var><br>
<blockquote><p>Given a bytevector <var>socket_address</var>, which must be the return value
of a previous call to <code>make-sockaddr_un</code>, holding a <code>struct
sockaddr_un</code>: <code>sockaddr_un.pathname</code> builds and returns a
bytevector holding the corresponding socket pathname,
<code>sockaddr_un.pathname/string</code> builds and returns a string holding
the corresponding socket pathname.  If the data in <var>socket_address</var>
is invalid: an exception is raised. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-socket-addresses-in"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-socket-addresses-in6">posix socket addresses in6</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-socket-addresses-local">posix socket addresses local</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-socket-addresses">posix socket addresses</a>

</div>

<h5 class="subsubsection">5.13.1.2 <acronym>IP</acronym>v4 addresses</h5>

<p>Instances of <code>struct sockaddr_in</code> can be handled at the Scheme
level as follows:

<pre class="example">     (import (vicare))
     
     (define sockaddr
       (make-sockaddr_in '#vu8(1 2 3 4) 88))
     
     (sockaddr_in.in_addr sockaddr)  &rArr; #vu8(1 2 3 4)
     (sockaddr_in.in_port sockaddr)  &rArr; 88
</pre>
   <p class="noindent">and we can use constant values to initialise the fields:

<pre class="example">     (import (vicare)
       (vicare platform-constants))
     
     (define addr (make-bytevector 4))
     (bytevector-u32-set! bv 0 INADDR_LOOPBACK (endianness big))
     
     (define sockaddr (make-sockaddr_in addr 88))
     
     (sockaddr_in.in_addr sockaddr)  &rArr; #vu8(127 0 0 1)
     (sockaddr_in.in_port sockaddr)  &rArr; 88
</pre>
   <p class="noindent">care must be taken when handling such raw values.

<div class="defun">
&mdash; Function: <b>make-sockaddr_in</b><var> host-address port<a name="index-make_002dsockaddr_005fin-594"></a></var><br>
<blockquote><p>Given a bytevector <var>host-address</var> holding a <code>struct in_addr</code>
and a fixnum <var>port</var> representing a network port number, build and
return a bytevector holding a <code>struct sockaddr_in</code> initialised with
this data. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>sockaddr_in.in_addr</b><var> socket-address<a name="index-sockaddr_005fin_002ein_005faddr-595"></a></var><br>
&mdash; Function: <b>sockaddr_in.in_port</b><var> socket-address<a name="index-sockaddr_005fin_002ein_005fport-596"></a></var><br>
<blockquote><p>Given a bytevector <var>socket-address</var> holding a <code>struct
sockaddr_in</code>, extract the <code>in_addr</code> and <code>in_port</code> fields and
return them as bytevector holding the corresponding <code>struct
in_addr</code> and as fixnum.  If the data in <var>socket_address</var> is invalid:
an exception is raised. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-socket-addresses-in6"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-socket-addresses-rep">posix socket addresses rep</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-socket-addresses-in">posix socket addresses in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-socket-addresses">posix socket addresses</a>

</div>

<h5 class="subsubsection">5.13.1.3 <acronym>IP</acronym>v6 addresses</h5>

<p>Instances of <code>struct sockaddr_in6</code> can be handled at the Scheme
level as follows:

<pre class="example">     #!vicare
     (import (vicare))
     
     (define sockaddr
       (make-sockaddr_in6 '#vu16b(1 2 3 4  5 6 7 8) 88))
     
     (sockaddr_in6.in6_addr sockaddr) &rArr; #vu16b(1 2 3 4  5 6 7 8)
     (sockaddr_in6.in6_port sockaddr) &rArr; 88
</pre>
   <p class="noindent">care must be taken when handling such raw values.

<div class="defun">
&mdash; Function: <b>make-sockaddr_in6</b><var> host-address port<a name="index-make_002dsockaddr_005fin6-597"></a></var><br>
<blockquote><p>Given a bytevector <var>host-address</var> holding a <code>struct in6_addr</code>
and a fixnum <var>port</var> representing a network port number, build and
return a bytevector holding a <code>struct sockaddr_in6</code> initialised
with this data. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>sockaddr_in6.in6_addr</b><var> socket-address<a name="index-sockaddr_005fin6_002ein6_005faddr-598"></a></var><br>
&mdash; Function: <b>sockaddr_in6.in6_port</b><var> socket-address<a name="index-sockaddr_005fin6_002ein6_005fport-599"></a></var><br>
<blockquote><p>Given a bytevector <var>socket-address</var> holding a <code>struct
sockaddr_in6</code>, extract the <code>in6_addr</code> and <code>in6_port</code> fields
and return them as bytevector holding the corresponding <code>struct
in6_addr</code> and as fixnum.  If the data in <var>socket_address</var> is
invalid: an exception is raised. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>in6addr_loopback</b><var><a name="index-in6addr_005floopback-600"></a></var><br>
&mdash; Function: <b>in6addr_any</b><var><a name="index-in6addr_005fany-601"></a></var><br>
<blockquote><p>Build and return a bytevector holding the constant structures of type
<code>struct in6_addr</code> defined by <code>in6addr_loopback</code> and
<code>in6addr_any</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-socket-addresses-rep"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-socket-addresses-info">posix socket addresses info</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-socket-addresses-in6">posix socket addresses in6</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-socket-addresses">posix socket addresses</a>

</div>

<h5 class="subsubsection">5.13.1.4 <acronym>ASCII</acronym> address representations</h5>

<p>Dotted quad address representations can be handled as follows:

<pre class="example">     (import (vicare))
     
     (inet-aton "127.0.0.1") &rArr; #vu8(127 0 0 1)
     (inet-aton "ciao")      error--&gt; invalid argument
     
     (inet-ntoa/string '#vu8(127 0 0 1))
     &rArr; "127.0.0.1"
</pre>
   <p class="noindent">care must be taken when handling such raw values.

<div class="defun">
&mdash; Function: <b>inet-aton</b><var> dotted-quad<a name="index-inet_002daton-602"></a></var><br>
<blockquote><p><acronym>ASCII</acronym> to number.  Given the bytevector <var>dotted-quad</var> holding the
<acronym>ASCII</acronym> dotted quad representation of a host address, build and return
a bytevector holding the corresponding <code>struct in_addr</code>.  If
<var>dotted-quad</var> is invalid: an exception is raised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>inet-ntoa</b><var> host-address<a name="index-inet_002dntoa-603"></a></var><br>
&mdash; Function: <b>inet-ntoa/string</b><var> host-address<a name="index-inet_002dntoa_002fstring-604"></a></var><br>
<blockquote><p>Number to <acronym>ASCII</acronym>.  Given the bytevector <var>host-address</var> holding a
<code>struct in_addr</code>: <code>inet-ntoa</code> builds and returns a bytevector
holding the corresponding <acronym>ASCII</acronym> dotted quad representation,
<code>inet-ntoa/string</code> builds and returns a string holding the
corresponding <acronym>ASCII</acronym> dotted quad representation. 
</p></blockquote></div>

<!--  -->
   <p>Addresses in presentation format can be handled as follows:

<pre class="example">     #!vicare
     (import (vicare)
       (vicare platform-constants))
     
     (inet-pton AF_INET "127.0.0.1") &rArr; #vu8(127 0 0 1)
     (inet-pton AF_INET "ciao")      error--&gt; invalid arguments
     
     (inet-pton AF_INET6 "1:2:3:4:5:6:7:8")
     &rArr; #vu16b(1 2 3 4 5 6 7 8)
     
     (inet-ntop/string AF_INET '#vu8(127 0 0 1))
     &rArr; "127.0.0.1"
     
     (inet-ntop/string AF_INET6 '#vu16b(1 2 3 4 5 6 7 8))
     &rArr; "1:2:3:4:5:6:7:8"
</pre>
   <p class="noindent">care must be taken when handling such raw values.

<div class="defun">
&mdash; Function: <b>inet-pton</b><var> af presentation<a name="index-inet_002dpton-605"></a></var><br>
<blockquote><p>Given the fixnum <var>af</var>, being <code>AF_INET</code> or <code>AF_INET6</code>, and
the string or bytevector <var>presentation</var> holding the <acronym>ASCII</acronym>
presentation of an Internet address, build and return a bytevector
holding the corresponding <code>struct in_addr</code> or <code>struct
in6_addr</code>.  If either <var>af</var> or <var>presentation</var> is invalid: raise
an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>inet-ntop</b><var> af host-address<a name="index-inet_002dntop-606"></a></var><br>
&mdash; Function: <b>inet-ntop/string</b><var> af host-address<a name="index-inet_002dntop_002fstring-607"></a></var><br>
<blockquote><p>Given the fixnum <var>af</var>, being <code>AF_INET</code> or <code>AF_INET6</code>, and
the bytevector <var>host-address</var> holding a <code>struct in_addr</code> or
<code>struct in6_addr</code>: <code>inet-ntop</code> builds and returns a bytevector
holding the corresponding <acronym>ASCII</acronym> presentation of the Internet address,
<code>inet-ntop/string</code> builds and returns a string holding the
corresponding <acronym>ASCII</acronym> presentation of the Internet address.  If the
arguments are invalid: an exception is raised. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-socket-addresses-info"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-socket-addresses-rep">posix socket addresses rep</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-socket-addresses">posix socket addresses</a>

</div>

<h5 class="subsubsection">5.13.1.5 Host address informations</h5>

<div class="defun">
&mdash; Structure Type: <b>struct-addrinfo</b><var><a name="index-struct_002daddrinfo-608"></a></var><br>
<blockquote><p>Scheme level representation of <code>struct addrinfo</code>.  It has the
following fields:

          <dl>
<dt><code>ai_flags</code><dd>Fixnum.

          <br><dt><code>ai_family</code><dd>Fixnum, specifies the Internet address family; <code>AF_INET</code>,
<code>AF_INET6</code> of <code>AF_UNSPEC</code>.

          <br><dt><code>ai_socktype</code><dd>Fixnum, specifies the socket type; <code>SOCK_STREAM</code>, <code>SOCK_DGRAM</code>
or other <code>SOCK_</code> value.

          <br><dt><code>ai_protocol</code><dd>Fixnum, specifies the protocol of the socket address.

          <br><dt><code>ai_addrlen</code><dd>Fixnum, the number of bytes in the bytevector referenced by
<code>ai_addr</code>.

          <br><dt><code>ai_addr</code><dd>Bytevector, holds an instance of <code>struct sockaddr</code> of
<code>ai_addrlen</code> bytes.

          <br><dt><code>ai_canonname</code><dd>False or bytevector, represents the canoncal name of the host when
available. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-struct-addrinfo</b><var> flags family socktype protocol addrlen addr canonname<a name="index-make_002dstruct_002daddrinfo-609"></a></var><br>
<blockquote><p>Build and return an instance of <code>struct-addrinfo</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-addrinfo?</b><var> obj<a name="index-struct_002daddrinfo_003f-610"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is an instance of <code>struct-addrinfo</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-addrinfo-ai_flags</b><var> addrinfo<a name="index-struct_002daddrinfo_002dai_005fflags-611"></a></var><br>
&mdash; Function: <b>struct-addrinfo-ai_family</b><var> addrinfo<a name="index-struct_002daddrinfo_002dai_005ffamily-612"></a></var><br>
&mdash; Function: <b>struct-addrinfo-ai_socktype</b><var> addrinfo<a name="index-struct_002daddrinfo_002dai_005fsocktype-613"></a></var><br>
&mdash; Function: <b>struct-addrinfo-ai_protocol</b><var> addrinfo<a name="index-struct_002daddrinfo_002dai_005fprotocol-614"></a></var><br>
&mdash; Function: <b>struct-addrinfo-ai_addrlen</b><var> addrinfo<a name="index-struct_002daddrinfo_002dai_005faddrlen-615"></a></var><br>
&mdash; Function: <b>struct-addrinfo-ai_addr</b><var> addrinfo<a name="index-struct_002daddrinfo_002dai_005faddr-616"></a></var><br>
&mdash; Function: <b>struct-addrinfo-ai_canonname</b><var> addrinfo<a name="index-struct_002daddrinfo_002dai_005fcanonname-617"></a></var><br>
<blockquote><p>Accessors for the fields of <code>struct-addrinfo</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getaddrinfo</b><var> node service hints<a name="index-getaddrinfo-618"></a></var><br>
<blockquote><p>Interface to the C function <code>getaddrinfo()</code>, see the manual page
<code>getaddrinfo(3)</code>.  Given the strings or bytevectors <var>node</var> and
<var>service</var> identifying an Internet host and a service, build a list
of <code>struct-addrinfo</code> instances representing addresses to which
sockets can be bound or connected.

        <p>Both <var>node</var> and <var>service</var> can be false, in which case the
corresponding arguments handed to the C function are <code>NULL</code>. 
<var>hints</var> must be an instance of <code>struct-addrinfo</code> used to select
matching hosts.

        <p>If successful: return the list of data structures, else raise an
exception.

     <pre class="example">          (getaddrinfo "github.com" "smtp" #f)
          &rArr; (#["struct-addrinfo"
                  ai_flags=40             ai_family=AF_INET
                  ai_socktype=SOCK_DGRAM  ai_protocol=17
                  ai_addrlen=16
                  ai_addr=#vu8(2 0 0 25 207 97 227 239 0 0 0 0 0 0 0 0)
                  ai_canonname=#f]
              #["struct-addrinfo"
                  ai_flags=40             ai_family=AF_INET
                  ai_socktype=SOCK_STREAM ai_protocol=6
                  ai_addrlen=16
                  ai_addr=#vu8(2 0 0 25 207 97 227 239 0 0 0 0 0 0 0 0)
                  ai_canonname=#f])
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-socket-hosts"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-socket-protocols">posix socket protocols</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-socket-addresses">posix socket addresses</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-socket">posix socket</a>

</div>

<h4 class="subsection">5.13.2 Network hosts database</h4>

<div class="defun">
&mdash; Struct Type: <b>struct-hostent</b><var><a name="index-struct_002dhostent-619"></a></var><br>
<blockquote><p>Data structure type used to represent at the Scheme level <code>struct
hostent</code> values.  It has the following fields:

          <dl>
<dt><code>h_name</code><dd>Bytevector, the official host name.

          <br><dt><code>h_aliases</code><dd>List of bytevectors, host name aliases.

          <br><dt><code>h_addrtype</code><dd>Fixnum, <code>AF_INET</code> or <code>AF_INET6</code>.

          <br><dt><code>h_length</code><dd>Fixnum, number of bytes in each host address bytevector.

          <br><dt><code>h_addr_list</code><dd>List of bytevectors each holding <code>struct in_addr</code> or <code>struct
in6_addr</code>.

          <br><dt><code>h_addr</code><dd>Bytevector, it is the first in the list <code>h_addr_list</code>. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>gethostbyname</b><var> hostname<a name="index-gethostbyname-620"></a></var><br>
<blockquote><p>Interface to the C function <code>gethostbyname()</code>, <a href="libc.html#Host-Names">gethostbyname</a>.  Given the string or bytevector <var>hostname</var> holding
the <acronym>ASCII</acronym> representation of a host name, build and return an instance
of <code>struct-hostent</code>.  If an error occurs, return an encoded
<code>h_errno</code> value.

     <pre class="example">          (import (vicare))
          
          (gethostbyname "github.com")
          &rArr; #["struct-hostent"
                 h_name="github.com"
                 h_aliases=()
                 h_addrtype=AF_INET
                 h_length=4
                 h_addr_list=(#vu8(207 97 227 239))
                 h_addr=#vu8(207 97 227 239)]
          
          (gethostbyname "google.com")
          &rArr; #["struct-hostent"
                 h_name="google.com"
                 h_aliases=()
                 h_addrtype=AF_INET
                 h_length=4
                 h_addr_list=(#vu8(209 85 148 103)
                              #vu8(209 85 148 99)
                              #vu8(209 85 148 104)
                              #vu8(209 85 148 105)
                              #vu8(209 85 148 106)
                              #vu8(209 85 148 147))
                 h_addr=#vu8(209 85 148 103)]
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>gethostbyaddr</b><var> addr<a name="index-gethostbyaddr-621"></a></var><br>
<blockquote><p>Interface to the C function <code>gethostbyaddr()</code>, <a href="libc.html#Host-Names">gethostbyaddr</a>.  Given the bytevector <var>addr</var> holding a <code>struct
in_addr</code> or a <code>struct in6_addr</code>, build and return an instance of
<code>struct-hostent</code>; the type of address is automatically inferred
from the length of the bytevector.  If an error occurs: an exception is
raised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>host-entries</b><var><a name="index-host_002dentries-622"></a></var><br>
<blockquote><p>Interface to the C functions <code>sethostent()</code>, <code>gethostent()</code> and
<code>endhostent()</code>, <a href="libc.html#Host-Names">gethostbyaddr</a>.  Build and
return a list of <code>struct-hostent</code> representing the entries in the
hosts database. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-socket-protocols"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-socket-services">posix socket services</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-socket-hosts">posix socket hosts</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-socket">posix socket</a>

</div>

<h4 class="subsection">5.13.3 Network protocols database</h4>

<div class="defun">
&mdash; Structure Type: <b>struct-protoent</b><var><a name="index-struct_002dprotoent-623"></a></var><br>
<blockquote><p>Scheme level representation of <code>struct protoent</code>.  It has the
following fields:

          <dl>
<dt><code>p_name</code><dd>Bytevector, the <acronym>ASCII</acronym> coding of the official protocol name.

          <br><dt><code>p_aliases</code><dd>Null or list of bytevectors, the <acronym>ASCII</acronym> codings of protocol name
aliases.

          <br><dt><code>p_proto</code><dd>Fixnum, the protocol number. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-struct-protoent</b><var> name aliases proto<a name="index-make_002dstruct_002dprotoent-624"></a></var><br>
<blockquote><p>Build and return an instance of <code>struct-protoent</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-protoent-p_name</b><var> protoent<a name="index-struct_002dprotoent_002dp_005fname-625"></a></var><br>
&mdash; Function: <b>struct-protoent-p_aliases</b><var> protoent<a name="index-struct_002dprotoent_002dp_005faliases-626"></a></var><br>
&mdash; Function: <b>struct-protoent-p_proto</b><var> protoent<a name="index-struct_002dprotoent_002dp_005fproto-627"></a></var><br>
<blockquote><p>Accessors for the fields of <code>struct-protoent</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getprotobyname</b><var> name<a name="index-getprotobyname-628"></a></var><br>
<blockquote><p>Interface to the C function <code>getprotobyname()</code>, <a href="libc.html#Protocols-Database">getprotobyname</a>.  Given a string or bytevector <var>name</var>
holding the <acronym>ASCII</acronym> coding of a network protocol name, query the
network protocols database and build an instance of
<code>struct-protoent</code> mirroring the resulting <code>struct protoent</code>
entry.  If successful return the data structure, else raise an
exception.

     <pre class="example">          (getprotobyname "udp")
          &rArr; #["struct-protoent"
                  p_name="udp"
                  p_aliases=(UDP)
                  p_proto=17]
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>getprotobynumber</b><var> proto_num<a name="index-getprotobynumber-629"></a></var><br>
<blockquote><p>Interface to the C function <code>getprotobynumber()</code>,
<a href="libc.html#Protocols-Database">getprotobynumber</a>.  Given a fixnum
<var>proto_num</var> being the number of a network protocol, query the
network protocols database and build an instance of
<code>struct-protoent</code> mirroring the resulting <code>struct protoent</code>
entry.  If successful return the data structure, else raise an
exception.

     <pre class="example">          (getprotobynumber 17)
          &rArr; #["struct-protoent"
                  p_name="udp"
                  p_aliases=(UDP)
                  p_proto=17]
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>protocol-entries</b><var><a name="index-protocol_002dentries-630"></a></var><br>
<blockquote><p>Interface to the C functions <code>setprotoent()</code>, <code>getprotoent()</code>
and <code>endprotoent()</code>, <a href="libc.html#Protocols-Database">setprotoent</a>. 
Scan the network protocol database and build a list of
<code>struct-protoent</code> mirroring the resulting <code>struct protoent</code>
entries.  Return the list of structures. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-socket-services"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-socket-networks">posix socket networks</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-socket-protocols">posix socket protocols</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-socket">posix socket</a>

</div>

<h4 class="subsection">5.13.4 Network services database</h4>

<div class="defun">
&mdash; Structure Type: <b>struct-servent</b><var><a name="index-struct_002dservent-631"></a></var><br>
<blockquote><p>Scheme level representation of <code>struct servent</code>.  It has the
following fields:

          <dl>
<dt><code>s_name</code><dd>Bytevector, the <acronym>ASCII</acronym> coding of the official service name.

          <br><dt><code>s_aliases</code><dd>Null or list of bytevectors, the <acronym>ASCII</acronym> codings of service name
aliases.

          <br><dt><code>s_port</code><dd>Fixnum, the port number.

          <br><dt><code>s_proto</code><dd>Bytevector, <acronym>ASCII</acronym> coding of the associated protocol name. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-struct-servent</b><var> name aliases port proto<a name="index-make_002dstruct_002dservent-632"></a></var><br>
<blockquote><p>Build and return an instance of <code>struct-servent</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-servent-s_name</b><var> servent<a name="index-struct_002dservent_002ds_005fname-633"></a></var><br>
&mdash; Function: <b>struct-servent-s_aliases</b><var> servent<a name="index-struct_002dservent_002ds_005faliases-634"></a></var><br>
&mdash; Function: <b>struct-servent-s_proto</b><var> servent<a name="index-struct_002dservent_002ds_005fproto-635"></a></var><br>
&mdash; Function: <b>struct-servent-s_port</b><var> servent<a name="index-struct_002dservent_002ds_005fport-636"></a></var><br>
<blockquote><p>Accessors for the fields of <code>struct-servent</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getservbyname</b><var> name protocol<a name="index-getservbyname-637"></a></var><br>
<blockquote><p>Interface to the C function <code>getservbyname()</code>, <a href="libc.html#Services-Database">getservbyname</a>.  Given the strings or bytevectors <var>name</var>
and <var>protocol</var> holding the <acronym>ASCII</acronym> coding of a network service name
and protocol, query the network services database and build an instance
of <code>struct-servent</code> mirroring the resulting <code>struct servent</code>
entry.  If successful return the data structure, else raise an
exception.

     <pre class="example">          (getservbyname "smtp" "tcp")
          &rArr; #["struct-servent"
                  s_name="smtp"
                  s_aliases=(mail)
                  s_port=25
                  s_proto=tcp]
          
          (getservbyname "ntp" "udp")
          &rArr; #["struct-servent"
                  s_name="ntp"
                  s_aliases=()
                  s_port=123
                  s_proto=udp]
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>getservbynumber</b><var> port protocol<a name="index-getservbynumber-638"></a></var><br>
<blockquote><p>Interface to the C function <code>getservbynumber()</code>, <a href="libc.html#Services-Database">getservbynumber</a>.  Given a fixnum <var>port</var> and a string or
bytevector <var>protocol</var> being the port number and protocol name of a
network service, query the network services database and build an
instance of <code>struct-servent</code> mirroring the resulting <code>struct
servent</code> entry.  If successful return the data structure, else raise an
exception.

     <pre class="example">          (getservbyport 80 "tcp")
          &rArr; #["struct-servent"
                  s_name="http"
                  s_aliases=(www-http www)
                  s_port=80
                  s_proto=tcp]
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>service-entries</b><var><a name="index-service_002dentries-639"></a></var><br>
<blockquote><p>Interface to the C functions <code>setservent()</code>, <code>getservent()</code> and
<code>endservent()</code>, <a href="libc.html#Services-Database">setservent</a>.  Scan the
network service database and build a list of <code>struct-servent</code>
mirroring the resulting <code>struct servent</code> entries.  Return the list
of structures. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-socket-networks"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-socket-socket">posix socket socket</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-socket-services">posix socket services</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-socket">posix socket</a>

</div>

<h4 class="subsection">5.13.5 Networks database</h4>

<div class="defun">
&mdash; Structure Type: <b>struct-netent</b><var><a name="index-struct_002dnetent-640"></a></var><br>
<blockquote><p>Scheme level representation of <code>struct netent</code>.  It has the
following fields:

          <dl>
<dt><code>n_name</code><dd>Bytevector, <acronym>ASCII</acronym> coding of the official network name.

          <br><dt><code>n_aliases</code><dd>List of bytevectors, alias names for the network.

          <br><dt><code>n_addrtype</code><dd>Fixnum, the network type.

          <br><dt><code>n_net</code><dd>32-bit bytevector, the network number in network byte order. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-struct-netent</b><var> name aliases addrtype net<a name="index-make_002dstruct_002dnetent-641"></a></var><br>
<blockquote><p>Build and return a new instance of <code>struct-netent</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-netent-n_name</b><var> netent<a name="index-struct_002dnetent_002dn_005fname-642"></a></var><br>
&mdash; Function: <b>struct-netent-n_aliases</b><var> netent<a name="index-struct_002dnetent_002dn_005faliases-643"></a></var><br>
&mdash; Function: <b>struct-netent-n_addrtype</b><var> netent<a name="index-struct_002dnetent_002dn_005faddrtype-644"></a></var><br>
&mdash; Function: <b>struct-netent-n_net</b><var> netent<a name="index-struct_002dnetent_002dn_005fnet-645"></a></var><br>
<blockquote><p>Accessors for the fields of <code>struct-netent</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-netent?</b><var> obj<a name="index-struct_002dnetent_003f-646"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>obj</var> is an instance of <code>struct-netent</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getnetbyname</b><var> name<a name="index-getnetbyname-647"></a></var><br>
<blockquote><p>Interface to the C function <code>getnetbyname()</code>, <a href="libc.html#Networks-Database">getnetbyname</a>.  Given the bytevector <var>name</var> holding the
<acronym>ASCII</acronym> coding of a network name, query the networks database and build
an instance of <code>struct-netent</code> mirroring the resulting <code>struct
netent</code> entry.  If successful return the data structure, else raise an
exception.

     <pre class="example">          (getnetbyname "loopback")
          &rArr; #["struct-netent"
                  n_name="loopback"
                  n_aliases=()
                  n_addrtype=AF_INET
                  n_net=#vu8(127 0 0 0)]
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>getnetbyaddr</b><var> net type<a name="index-getnetbyaddr-648"></a></var><br>
<blockquote><p>Interface to the C function <code>getnetbyaddr()</code>, <a href="libc.html#Networks-Database">getnetbyaddr</a>.  Given an exact integer or bytevector <var>net</var>
representing a network number and the fixnum <var>type</var> representing a
network type, query the networks database and build an instance of
<code>struct-netent</code> mirroring the resulting <code>struct netent</code> entry. 
If successful return the data structure, else raise an exception.

     <pre class="example">          (getnetbyaddr '#vu8(127 0 0 0) AF_INET)
          &rArr; #["struct-netent"
                  n_name="loopback"
                  n_aliases=()
                  n_addrtype=AF_INET
                  n_net=#vu8(127 0 0 0)]
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>network-entries</b><var><a name="index-network_002dentries-649"></a></var><br>
<blockquote><p>Interface to the C functions <code>setnetent()</code>, <code>getnetent()</code> and
<code>endnetent()</code>, <a href="libc.html#Networks-Database">setnetent</a>.  Scan the
networks database and build a list of <code>struct-netent</code> mirroring the
resulting <code>struct netent</code> entries.  Return the list of structures. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-socket-socket"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-socket-misc">posix socket misc</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-socket-networks">posix socket networks</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-socket">posix socket</a>

</div>

<h4 class="subsection">5.13.6 Network sockets operations</h4>

<div class="defun">
&mdash; Function: <b>socket</b><var> namespace style protocol<a name="index-socket-650"></a></var><br>
<blockquote><p>Interface to the C function <code>socket()</code>, <a href="libc.html#Creating-a-Socket">socket</a>.  Create a new socket descriptor and return it as non&ndash;negative
fixnum; if an error occurs raise an exception.  All the arguments must
be fixnums. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>shutdown</b><var> sock how<a name="index-shutdown-651"></a></var><br>
<blockquote><p>Interface to the C function <code>shutdown()</code>, <a href="libc.html#Closing-a-Socket">shutdown</a>.  Close the socket <var>sock</var> according to <var>how</var>,
which can be one of the constants <code>SHUT_RD</code>, <code>SHUT_WR</code> or
<code>SHUT_RDWR</code>.  If successful return unspecified values, else raise
an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>socketpair</b><var> namespace style protocol<a name="index-socketpair-652"></a></var><br>
<blockquote><p>Interface to the C function <code>socketpair()</code>, <a href="libc.html#Socket-Pairs">socketpair</a>.  Create a pairs of connected sockets and return two values
being the descriptors as non&ndash;negative fixnums; if an error occurs raise
an exception.  All the arguments must be fixnums; <var>namespace</var> must
be <code>AF_LOCAL</code>.

     <pre class="example">          (import (rnrs)
            (prefix (vicare posix) px.)
            (vicare platform-constants))
          
          (let-values (((a b) (px.socketpair AF_LOCAL SOCK_DGRAM 0)))
            (px.posix-write a '#vu8(1 2 3 4) 4)
            (let ((buf (make-bytevector 4)))
              (px.posix-read b buf 4)
              (px.shutdown a SHUT_RDWR)
              (px.shutdown b SHUT_RDWR)
              buf))
          &rArr; #vu8(1 2 3 4)
</pre>
        </blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>connect</b><var> sock addr<a name="index-connect-653"></a></var><br>
<blockquote><p>Interface to the C function <code>connect()</code>, <a href="libc.html#Connecting">connect</a>.  Connect the socket <var>sock</var> to the address specified by the
bytevector <var>addr</var> which must hold a concrete instance of
<code>struct sockaddr</code>.  If successful return unspecified values, else
raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>listen</b><var> sock pending_conns<a name="index-listen-654"></a></var><br>
<blockquote><p>Interface to the C function <code>listen()</code>, <a href="libc.html#Listening">listen</a>.  Enable the socket <var>sock</var> to accept connections; the fixnum
<var>pending_conns</var> specifies the maximum length of the pending
connection requests queue.  If successful return unspecified values,
else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>accept</b><var> sock<a name="index-accept-655"></a></var><br>
<blockquote><p>Interface to the C function <code>accept()</code>, <a href="libc.html#Accepting-Connections">accept</a>.  Accept an incoming connection to the server
socket <var>sock</var>.

        <p>If successful and a connection is accepted return two values: a
non&ndash;negative fixnum representing the socket, a bytevector representing
the client address as <code>struct sockaddr</code>.

        <p>If successful and no connection is accepted return two values both being
false; this is the case of <code>accept()</code> returning <code>EWOULDBLOCK</code>
which means that <var>sock</var> is in non&ndash;blocking mode and no pending
connections exist.

        <p>If an error occurs raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>bind</b><var> sock sockaddr<a name="index-bind-656"></a></var><br>
<blockquote><p>Interface to the C function <code>bind()</code>, <a href="libc.html#Setting-Address">bind</a>.  Bind the socket descriptor <var>sock</var> to the address specified
by the <code>struct sockaddr</code> in the bytevector <var>sockaddr</var>.  If
successful return unspecified values, else raise an exception. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>getpeername</b><var> sock<a name="index-getpeername-657"></a></var><br>
<blockquote><p>Interface to the C function <code>getpeername()</code>, <a href="libc.html#Who-is-Connected">getpeername</a>.  Retrieve informations about the address of the
socket to which the <var>sock</var> socket is connected to.  If successful
return a bytevector holding a <code>struct sockaddr</code>, else raise an
exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getsockname</b><var> sock<a name="index-getsockname-658"></a></var><br>
<blockquote><p>Interface to the C function <code>getsockanme()</code>, <a href="libc.html#Setting-Address">getsockname</a>.  Retrieve informations about the address bound to
the socket descriptor <var>sock</var>.  If successful return a bytevector
holding the <code>struct sockaddr</code>, else raise an exception. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>send</b><var> sock buffer size flags<a name="index-send-659"></a></var><br>
<blockquote><p>Interface to the C function <code>send()</code>, <a href="libc.html#Sending-Data">send</a>. 
Like <code>write()</code> but with the additional argument <var>flags</var> which
must be a fixnum: write data from the bytevector <var>buffer</var> to the
socket <var>sock</var>; if <var>size</var> is a fixnum, write <var>size</var> bytes; if
<var>size</var> is false, write a number of bytes equal to the length of
<var>buffer</var>.  If successful return a non&ndash;negative fixnum representing
the number of bytes actually sent, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>recv</b><var> sock buffer size flags<a name="index-recv-660"></a></var><br>
<blockquote><p>Interface to the C function <code>recv()</code>, <a href="libc.html#Receiving-Data">recv</a>.  Like <code>read()</code> but with the additional argument <var>flags</var>
which must be a fixnum: read data from <var>sock</var> and store it in the
bytevector <var>buffer</var>; if <var>size</var> is a fixnum, read <var>size</var>
bytes; if <var>size</var> is false, read a number of bytes equal to the
length of <var>buffer</var>.  If successful return a non&ndash;negative fixnum
representing the number of bytes actually received, else raise an
exception. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>sendto</b><var> sock buffer size flags addr<a name="index-sendto-661"></a></var><br>
<blockquote><p>Interface to the C function <code>sendto()</code>, <a href="libc.html#Sending-Datagrams">sendto</a>.  Like <code>send()</code> but with the additional argument <var>addr</var>
which must be a bytevector holding a <code>struct sockaddr</code>: write data
from the bytevector <var>buffer</var> to the socket <var>sock</var> to the
destination specified by <var>addr</var>.

        <p>If <var>size</var> is a fixnum, write <var>size</var> bytes; if <var>size</var> is
false, write a number of bytes equal to the length of <var>buffer</var>.

        <p>If successful return a non&ndash;negative fixnum representing the number of
bytes actually sent, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>recvfrom</b><var> sock buffer size flags<a name="index-recvfrom-662"></a></var><br>
<blockquote><p>Interface to the C function <code>recvfrom()</code>, <a href="libc.html#Receiving-Datagrams">recvfrom</a>.  Like <code>recv()</code> but additionally retrieve
informations about the address of the sender: read data from <var>sock</var>
and store it in the bytevector <var>buffer</var>.

        <p>If <var>size</var> is a fixnum, read <var>size</var> bytes; if <var>size</var> is
false, read a number of bytes equal to the length of <var>buffer</var>.

        <p>If successful return two values: a non&ndash;negative fixnum representing the
number of bytes actually received, a bytevector holding a <code>struct
sockaddr</code> representing the address of the sender; else raise an
exception. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>getsockopt</b><var> sock level option optval<a name="index-getsockopt-663"></a></var><br>
<blockquote><p>Interface to the C function <code>getsockopt()</code>, <a href="libc.html#Socket-Option-Function">getsockopt</a>.  Retrieve the value of <var>option</var> of socket
<var>sock</var> at <var>level</var> and store it in the bytevector <var>optval</var>. 
<var>option</var> and <var>level</var> must be fixnums.  If successful return
unspecified values, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>setsockopt</b><var> sock level option optval<a name="index-setsockopt-664"></a></var><br>
<blockquote><p>Interface to the C function <code>setsockopt()</code>, <a href="libc.html#Socket-Option-Function">setsockopt</a>.  Set a new value for <var>option</var> of socket
<var>sock</var> at <var>level</var> reading it from the bytevector <var>optval</var>. 
<var>option</var> and <var>level</var> must be fixnums.  If successful return
unspecified values, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getsockopt/int</b><var> sock level option<a name="index-getsockopt_002fint-665"></a></var><br>
&mdash; Function: <b>setsockopt/int</b><var> sock level option optval<a name="index-setsockopt_002fint-666"></a></var><br>
<blockquote><p>Like <code>getsockopt</code> and <code>setsockopt</code> but specially handle the
case of an option with value represented by a C language <code>int</code>. 
<var>optval</var> must appropriately be a boolean or an exact integer
representable as a platform's C language <code>int</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getsockopt/size_t</b><var> sock level option<a name="index-getsockopt_002fsize_005ft-667"></a></var><br>
&mdash; Function: <b>setsockopt/size_t</b><var> sock level option optval<a name="index-setsockopt_002fsize_005ft-668"></a></var><br>
<blockquote><p>Like <code>getsockopt</code> and <code>setsockopt</code> but specially handle the
case of an option with value represented by a C language <code>size_t</code>. 
<var>optval</var> must be an exact integer representable as a platform's C
language <code>size_t</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-socket-misc"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-socket-examples">posix socket examples</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-socket-socket">posix socket socket</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-socket">posix socket</a>

</div>

<h4 class="subsection">5.13.7 Error and miscellaneous functions</h4>

<div class="defun">
&mdash; Function: <b>h_errno-&gt;string</b><var> h_errno-code<a name="index-h_005ferrno_002d_003estring-669"></a></var><br>
<blockquote><p>Convert an encoded <code>h_errno</code> value to the corresponding symbolic
string. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>h_strerror</b><var> h_errno-code<a name="index-h_005fstrerror-670"></a></var><br>
<blockquote><p>Convert an encoded <code>h_errno</code> value to the corresponding descriptive
error message string. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>gai-strerror</b><var> error-code<a name="index-gai_002dstrerror-671"></a></var><br>
<blockquote><p>Interface to the C function <code>gai_strerror()</code>, see the manual page
<code>gai_strerror(3)</code>.  Convert an <code>EAI_</code> error code into the
corresponding error message, return a string holding such message. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-socket-examples"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-socket-oob">posix socket oob</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-socket-misc">posix socket misc</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-socket">posix socket</a>

</div>

<h4 class="subsection">5.13.8 Examples of clients and servers</h4>

<p>Basically a <acronym>TCP</acronym>/<acronym>IP</acronym> server should do:

<pre class="example">     #!r6rs
     (import (rnrs)
       (prefix (vicare posix) px.)
       (vicare platform-constants))
     
     (let ((sockaddr    (make-sockaddr_in '#vu8(127 0 0 1) 8080))
           (server-sock (px.socket PF_INET SOCK_STREAM 0)))
       (px.bind   server-sock sockaddr)
       (px.listen server-sock 2)
       (let-values (((sock client-address)
                     (px.accept server-sock)))
         ;; ... talk with the client through SOCK ...
         (px.close sock))
       (px.close server-sock))
</pre>
   <p class="noindent">while a <acronym>TCP</acronym>/<acronym>IP</acronym> client should to:

<pre class="example">     #!r6rs
     (import (rnrs)
       (prefix (vicare posix) px.)
       (vicare platform-constants))
     
     (let ((sockaddr (make-sockaddr_in '#vu8(127 0 0 1) 8080))
           (sock     (px.socket PF_INET SOCK_STREAM 0)))
       (px.connect sock sockaddr)
       ;; ... talk to the server through SOCK ...
       (px.close sock))
</pre>
   <p>A <acronym>UDP</acronym>/<acronym>IP</acronym> &ldquo;server&rdquo; should do:

<pre class="example">     #!r6rs
     (import (rnrs)
       (prefix (vicare posix) px.)
       (vicare platform-constants))
     
     (let ((sockaddr   (make-sockaddr_in '#vu8(127 0 0 1) 8080))
           (sock       (px.socket PF_INET SOCK_DGRAM 0))
           (in-buffer  (make-bytevector 1024))
           (out-buffer (make-bytevector 1024)))
       (px.bind sock sockaddr)
       (let-values (((len sockaddr)
                     (px.recvfrom sock in-buffer #f 0)))
         ;; ... process the received packet ...
         ;; ... prepare the answer ...
         (px.sendto sock out-buffer #f 0 sockaddr))
       (px.close sock))
</pre>
   <p class="noindent">while a <acronym>UDP</acronym>/<acronym>IP</acronym> &ldquo;client&rdquo; should do:

<pre class="example">     #!r6rs
     (import (rnrs)
       (prefix (vicare posix) px.)
       (vicare platform-constants))
     
     (let ((sockaddr   (make-sockaddr_in '#vu8(127 0 0 1) 8081))
           (sock       (px.socket PF_INET SOCK_DGRAM 0))
           (out-buffer (make-bytevector 1024))
           (in-buffer  (make-bytevector 1024)))
       (px.bind sock sockaddr)
       ;; ... prepare the request ...
       (px.sendto sock out-buffer #f 0 sockaddr)
       (let-values (((len sockaddr)
                     (px.recvfrom sock in-buffer #f 0)))
         ;; ... process the received packet ...
         )
       (px.close sock))
</pre>
   <p>A Unix&ndash;domain socket server should do:

<pre class="example">     #!r6rs
     (import (rnrs)
       (prefix (vicare posix) px.)
       (vicare platform-constants))
     
     (let* ((tmpdir       (px.getenv "TMPDIR"))
            (pathname     (string-append tmpdir "/use-me"))
            (sockaddr     (make-sockaddr_un pathname))
            (server-sock  (px.socket PF_LOCAL SOCK_STREAM 0)))
       (px.bind   server-sock sockaddr)
       (px.listen server-sock 2)
       (let-values (((sock client-address)
                     (px.accept server-sock)))
         ;; ... talk to the client through SOCK ...
         (px.close sock))
       (px.close server-sock))
</pre>
   <p class="noindent">while a Unix&ndash;domain socket client should do:

<pre class="example">     #!r6rs
     (import (rnrs)
       (prefix (vicare posix) px.)
       (vicare platform-constants))
     
     (let* ((tmpdir    (px.getenv "TMPDIR"))
            (pathname  (string-append tmpdir "/use-me"))
            (sockaddr  (make-sockaddr_un pathname))
            (sock      (px.socket PF_LOCAL SOCK_STREAM 0)))
       (px.connect sock sockaddr)
       ;; ... talk to the server through SOCK ...
       (px.close sock))
</pre>
   <p>To receive incoming data and Out Of Band data, a <acronym>TCP</acronym>/<acronym>IP</acronym> server
should do:

<pre class="example">     #!r6rs
     (import (rnrs)
       (prefix (vicare posix) px.)
       (vicare platform-constants))
     
     (let ((sockaddr    (make-sockaddr_in '#vu8(127 0 0 1) 8080))
           (server-sock (px.socket PF_INET SOCK_STREAM 0)))
       (px.bind   server-sock sockaddr)
       (px.listen server-sock 2)
       (let*-values
           (((sock client-address) (px.accept server-sock))
            ((bv)                  (make-bytevector 10)))
         (let loop ()
           (let-values (((rd wr ex) (select-fd sock 2 0)))
             (cond (ex ;process exceptional conditions first!!!
                    ;; block until OOB data arrives
                    (let ((len (px.recv sock bv #f MSG_OOB)))
                      ;; process data in BV between 0 and LEN,
                      ;; which should be 1
                      (loop)))
                   (rd
                    (let ((len (px.recv sock bv #f 0)))
                      (when (positive? len)
                        ;; process data in BV between 0
                        ;; and LEN
                        (loop))))
                   (else (loop)))))
         (px.close sock))
       (px.close server-sock))
</pre>
   <p class="noindent">to send outgoing data and Out Of Band data, a <acronym>TCP</acronym>/<acronym>IP</acronym> client should
do:

<pre class="example">     #!r6rs
     (import (rnrs)
       (prefix (vicare posix) px.)
       (vicare platform-constants))
     
     (let ((sockaddr  (make-sockaddr_in '#vu8(127 0 0 1) 8080))
           (sock      (px.socket PF_INET SOCK_STREAM 0)))
       (px.connect sock sockaddr)
       (px.send sock '#vu8(1 2 3) #f 0)
       ;; only the single byte 6 (the last) is sent as
       ;; OOB data, 4 and 5 are sent as ordinary data
       (px.send sock '#vu8(4 5 6) #f MSG_OOB)
       (px.send sock '#vu8(7 8 9) #f 0)
       (px.close sock))
</pre>
   <!-- page -->
<div class="node">
<a name="posix-socket-oob"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-socket-examples">posix socket examples</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-socket">posix socket</a>

</div>

<h4 class="subsection">5.13.9 Notes on transmission of <acronym>OOB</acronym> data</h4>

<p>In a <acronym>TCP</acronym>/<acronym>IP</acronym> stream&ndash;oriented client/server architecture, the
scenario is the following:

<pre class="example">      --------------------        ------------
     | sending appication |-----&gt;| sending OS |
      --------------------        ------------
                                       |
                                       v
      -----------------------     -------------
     | receiving application |&lt;--| receving OS |
      -----------------------     -------------
</pre>
   <p class="noindent">sending ordinary data works as follows:

     <ol type=1 start=1>
<li>The sending application calls (for example) the <code>send</code> function
asking the sending <acronym>OS</acronym> to send data to the remote host.

     <li>The sending <acronym>OS</acronym> enqueues the data in a <acronym>FIFO</acronym> buffer, which it
progressively fragments in packets for delivery.

     <li>The receiving <acronym>OS</acronym> orders and enqueues data from received packets in a
<acronym>FIFO</acronym> buffer.

     <li>The receiving application calls (for example) the <code>recv()</code> function
to consume chunks of the input data.
        </ol>

<p class="noindent">sending a single byte of <acronym>OOB</acronym> data works as follows:

     <ol type=1 start=1>
<li>The sending application calls the function <code>send</code> specifying the
<code>MSG_OOB</code> flag, asking the sending <acronym>OS</acronym> to deliver a single byte
of <acronym>OOB</acronym> data.

     <li>The sending <acronym>OS</acronym> enqueues the single byte in its <acronym>FIFO</acronym> buffer and
tags the next outgoing packet to announce future delivery of the <acronym>OOB</acronym>
byte.

     <li>The receiving <acronym>OS</acronym> orders and enqueues data from received packets in a
<acronym>FIFO</acronym> buffer; when it detects a tagged packet announcing the <acronym>OOB</acronym>
byte: it optionally informs the receiving application of its future
arrival, signaling an exceptional condition on the socket descriptor, if
requested.

     <li>The sending <acronym>OS</acronym> proceeds in sending ordinary data from its <acronym>FIFO</acronym>
buffer and whenever it reaches the <acronym>OOB</acronym> byte: it sends it in a
specially tagged packet.

     <li>The receiving <acronym>OS</acronym> orders and enqueues data from received packets in a
<acronym>FIFO</acronym> buffer; when it detects a tagged packet holding the <acronym>OOB</acronym> byte:
it makes it available to the receiving application.

     <li>The receving application calls the function <code>recv</code> specifying the
<code>MSG_OOB</code> flag and retrieves the single <acronym>OOB</acronym> byte.
        </ol>

   <p>If we send the <acronym>OOB</acronym> byte with the form:

<pre class="example">     (posix.send sock '#vu8(8) #f MSG_OOB)
</pre>
   <p class="noindent">the byte <code>8</code> will be the <acronym>OOB</acronym> byte; if we send the <acronym>OOB</acronym> byte
with the form:

<pre class="example">     (posix.send sock '#vu8(1 2 3) #f MSG_OOB)
</pre>
   <p class="noindent">the byte <code>3</code>, the last in the memory block, will be the <acronym>OOB</acronym> byte
and the bytes <code>1</code> and <code>2</code> will be sent as ordinary data; the
receiving application must <strong>not</strong> assume that bytes <code>1</code> and
<code>2</code> will be made available before the <acronym>OOB</acronym> byte <code>3</code>.

   <p>When using <code>select</code> to be notified of incoming <acronym>OOB</acronym> data: the
receiving application must assume that the exceptional condition is
notified <strong>only once</strong> and not persist in further calls to
<code>select</code>; for this reason the exceptional condition must be
recognised and registered by the application as soon as it is notified
by <code>select</code>.

   <p>The socket option <code>SO_OOBINLINE</code> allows the <acronym>OOB</acronym> byte to be
places in the ordinary data <acronym>FIFO</acronym> buffer, so that it can be
transparently consumed by a call to <code>read</code> or <code>recv</code> without
the <code>MSG_OOB</code> flag.

   <p>Notice that the single <acronym>OOB</acronym> byte, although limited, can represent
256 symbols in an appropriate alphabet of commands.

<!-- page -->
<div class="node">
<a name="posix-users"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-job">posix job</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-socket">posix socket</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.14 Users and groups</h3>

<div class="defun">
&mdash; Function: <b>getuid</b><var><a name="index-getuid-672"></a></var><br>
<blockquote><p>Interface to the C function <code>getuid()</code>, <a href="libc.html#Reading-Persona">getuid</a>.  Return a fixnum representing the real user ID of the process. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getgid</b><var><a name="index-getgid-673"></a></var><br>
<blockquote><p>Interface to the C function <code>getgid()</code>, <a href="libc.html#Reading-Persona">getgid</a>.  Return a fixnum representing the real group ID of the process. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>geteuid</b><var><a name="index-geteuid-674"></a></var><br>
<blockquote><p>Interface to the C function <code>geteuid()</code>, <a href="libc.html#Reading-Persona">geteuid</a>.  Return a fixnum representing the effective user ID of the
process. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getegid</b><var><a name="index-getegid-675"></a></var><br>
<blockquote><p>Interface to the C function <code>getegid()</code>, <a href="libc.html#Reading-Persona">getegid</a>.  Return a fixnum representing the effective group ID of the
process. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getgroups</b><var><a name="index-getgroups-676"></a></var><br>
<blockquote><p>Interface to the C function <code>getgroups()</code>, <a href="libc.html#Reading-Persona">getgroups</a>.  Return a list of fixnums representing the
supplementary group IDs of the process; if an error occurs an exception
is raised. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>seteuid</b><var> new-uid<a name="index-seteuid-677"></a></var><br>
<blockquote><p>Interface to the C function <code>seteuid()</code>, <a href="libc.html#Setting-User-ID">seteuid</a>.  Set the effective user ID to <var>new-uid</var>, which must be a
fixnum.  If successful return unspecified values, else raise an
exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>setuid</b><var> new-uid<a name="index-setuid-678"></a></var><br>
<blockquote><p>Interface to the C function <code>setuid()</code>, <a href="libc.html#Setting-User-ID">setuid</a>.  Set both the real and effective user IDs to <var>new-uid</var>,
which must be a fixnum.  If successful return unspecified values, else
raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>setreuid</b><var> real-uid effective-uid<a name="index-setreuid-679"></a></var><br>
<blockquote><p>Interface to the C function <code>setreuid()</code>, <a href="libc.html#Setting-User-ID">setreuid</a>.  Set the real user ID to <var>real_uid</var> and the effective
user ID to <var>effective_uid</var>, both the arguments must be fixnums.  If
successful return unspecified values, else raise an exception. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>setegid</b><var> new-gid<a name="index-setegid-680"></a></var><br>
<blockquote><p>Interface to the C function <code>setegid()</code>, <a href="libc.html#Setting-Group">setegid</a>.  Set the effective group ID to <var>new-gid</var>, which must be a
fixnum.  If successful return unspecified values, else raise an
exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>setgid</b><var> new-gid<a name="index-setgid-681"></a></var><br>
<blockquote><p>Interface to the C function <code>setgid()</code>, <a href="libc.html#Setting-Groups">setgid</a>.  Set both the real and effective group IDs to <var>new-gid</var>,
which must be a fixnum.  If successful return unspecified values, else
raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>setregid</b><var> real-gid effective-gid<a name="index-setregid-682"></a></var><br>
<blockquote><p>Interface to the C function <code>setregid()</code>, <a href="libc.html#Setting-Group">setregid</a>.  Set the real group ID to <var>real_gid</var> and the effective
group ID to <var>effective_gid</var>, both the arguments must be fixnums.  If
successful return unspecified values, else raise an exception. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>getlogin</b><var><a name="index-getlogin-683"></a></var><br>
&mdash; Function: <b>getlogin/string</b><var><a name="index-getlogin_002fstring-684"></a></var><br>
<blockquote><p>Interface to the C function <code>getlogin()</code>, <a href="libc.html#Who-Logged-In">getlogin</a>.  <code>getlogin</code> returns a bytevector holding the <acronym>ASCII</acronym>
coding of the name of the user logged in on the controlling terminal of
the process; <code>getlogin/string</code> returns a string; if the name cannot
be determined: return false. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Structure Type: <b>struct-passwd</b><var><a name="index-struct_002dpasswd-685"></a></var><br>
<blockquote><p>Scheme level representation of <code>struct passwd</code>.  It has the
following fields:

          <dl>
<dt><code>pw_name</code><dd>Bytevector, user login name.

          <br><dt><code>pw_passwd</code><dd>Bytevector, encrypted password.

          <br><dt><code>pw_uid</code><dd>Fixnum, user ID.

          <br><dt><code>pw_gid</code><dd>Fixnum, group ID.

          <br><dt><code>pw_gecos</code><dd>Bytevector, user data.

          <br><dt><code>pw_dir</code><dd>Bytevector, user's home directory.

          <br><dt><code>pw_shell</code><dd>Bytevector, user's default shell. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-struct-passwd</b><var> name passwd uid gid gecos dir shell<a name="index-make_002dstruct_002dpasswd-686"></a></var><br>
<blockquote><p>Build and return a new instance of <code>struct-passwd</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-passwd?</b><var> obj<a name="index-struct_002dpasswd_003f-687"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>obj</var> is an instance of <code>struct-passwd</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-passwd-pw_name</b><var> passwd<a name="index-struct_002dpasswd_002dpw_005fname-688"></a></var><br>
&mdash; Function: <b>struct-passwd-pw_passwd</b><var> passwd<a name="index-struct_002dpasswd_002dpw_005fpasswd-689"></a></var><br>
&mdash; Function: <b>struct-passwd-pw_uid</b><var> passwd<a name="index-struct_002dpasswd_002dpw_005fuid-690"></a></var><br>
&mdash; Function: <b>struct-passwd-pw_gid</b><var> passwd<a name="index-struct_002dpasswd_002dpw_005fgid-691"></a></var><br>
&mdash; Function: <b>struct-passwd-pw_gecos</b><var> passwd<a name="index-struct_002dpasswd_002dpw_005fgecos-692"></a></var><br>
&mdash; Function: <b>struct-passwd-pw_dir</b><var> passwd<a name="index-struct_002dpasswd_002dpw_005fdir-693"></a></var><br>
&mdash; Function: <b>struct-passwd-pw_shell</b><var> passwd<a name="index-struct_002dpasswd_002dpw_005fshell-694"></a></var><br>
<blockquote><p>Accessors for the fields of <code>struct-passwd</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getpwuid</b><var> uid<a name="index-getpwuid-695"></a></var><br>
<blockquote><p>Interface to the C function <code>getpwuid()</code>, <a href="libc.html#Lookup-User">getpwuid</a>.  Retrieve informations on the user with identifier <var>uid</var>,
which must be a fixnum.  If successful return an instance of
<code>struct-passwd</code>; if a user with such an ID does not exists: return
false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getpwnam</b><var> name<a name="index-getpwnam-696"></a></var><br>
<blockquote><p>Interface to the C function <code>getpwnam()</code>, <a href="libc.html#Lookup-User">getpwnam</a>.  Retrieve informations on the user with name represented in
<acronym>ASCII</acronym> coding in the string or bytevector <var>name</var>.  If successful
return an instance of <code>struct-passwd</code>; if a user with such an ID
does not exists: return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>user-entries</b><var><a name="index-user_002dentries-697"></a></var><br>
<blockquote><p>Interface to the C functions <code>setpwent()</code>, <code>getpwent()</code> and
<code>endpwent()</code>, <a href="libc.html#Scanning-All-Users">setpwent</a>.  Iterate the
database of users and return a list of <code>struct-passwd</code> representing
the entries. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Structure Type: <b>struct-group</b><var><a name="index-struct_002dgroup-698"></a></var><br>
<blockquote><p>Scheme level representation of <code>struct group</code>.  It has the
following fields:

          <dl>
<dt><code>gr_name</code><dd>Bytevector, group name.

          <br><dt><code>gr_gid</code><dd>Fixnum, group ID.

          <br><dt><code>gr_mem</code><dd>List of bytevectors, user names. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-struct-group</b><var> name gid mem<a name="index-make_002dstruct_002dgroup-699"></a></var><br>
<blockquote><p>Build and return a new instance of <code>struct-group</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-group-gr_name</b><var> group<a name="index-struct_002dgroup_002dgr_005fname-700"></a></var><br>
&mdash; Function: <b>struct-group-gr_gid</b><var> group<a name="index-struct_002dgroup_002dgr_005fgid-701"></a></var><br>
&mdash; Function: <b>struct-group-gr_mem</b><var> group<a name="index-struct_002dgroup_002dgr_005fmem-702"></a></var><br>
<blockquote><p>Accessors for the fields of <code>struct-group</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getgrgid</b><var> gid<a name="index-getgrgid-703"></a></var><br>
<blockquote><p>Interface to the C function <code>getgrgid()</code>, <a href="libc.html#Lookup-Group">getgrgid</a>.  Retrieve informations on the group with identifier
<var>gid</var>, which must be a fixnum.  If successful return an instance of
<code>struct-group</code>; if a group with such an ID does not exists: return
false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getgrnam</b><var> name<a name="index-getgrnam-704"></a></var><br>
<blockquote><p>Interface to the C function <code>getgrnam()</code>, <a href="libc.html#Lookup-Group">getgrnam</a>.  Retrieve informations on the group with name represented in
<acronym>ASCII</acronym> coding in the string or bytevector <var>name</var>.  If successful
return an instance of <code>struct-group</code>; if a group with such an ID
does not exists: return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>group-entries</b><var><a name="index-group_002dentries-705"></a></var><br>
<blockquote><p>Interface to the C functions <code>setgrent()</code>, <code>getgrent()</code> and
<code>endgrent()</code>, <a href="libc.html#Scanning-All-Groups">setgrent</a>.  Iterate the
database of groups and return a list of <code>struct-group</code> representing
the entries. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-job"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-time">posix time</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-users">posix users</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.15 Job control</h3>

<div class="defun">
&mdash; Function: <b>ctermid</b><var><a name="index-ctermid-706"></a></var><br>
&mdash; Function: <b>ctermid/string</b><var><a name="index-ctermid_002fstring-707"></a></var><br>
<blockquote><p>Interface to the C function <code>ctermid()</code>, <a href="libc.html#Identifying-the-Terminal">ctermid</a>.  Return a bytevector or string holding the <acronym>ASCII</acronym>
coded pathname of the controlling terminal of the current process; the
returned value may be the empty bytevector or string. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>setsid</b><var><a name="index-setsid-708"></a></var><br>
<blockquote><p>Interface to the C function <code>setsid()</code>, <a href="libc.html#Process-Group-Functions">setsid</a>.  Create a new session, making the current process
the group leader with no controlling terminal.  If successful return a
fixnum representing the new process groups ID, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getsid</b><var> pid<a name="index-getsid-709"></a></var><br>
<blockquote><p>Interface to the C function <code>getsid()</code>, <a href="libc.html#Process-Group-Functions">getsid</a>.  If successful return a fixnum representing the
session ID of the process with process ID <var>pid</var>, which must be a
fixnum; else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>getpgrp</b><var><a name="index-getpgrp-710"></a></var><br>
<blockquote><p>Interface to the C function <code>getpgrp()</code>, <a href="libc.html#Process-Group-Functions">getpgrp</a>.  Return a fixnum representing the process group ID
of the calling process. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>setpgid</b><var> pid pgid<a name="index-setpgid-711"></a></var><br>
<blockquote><p>Interface to the C function <code>setpgid()</code>, <a href="libc.html#Process-Group-Functions">setpgid</a>.  Put the process <var>pid</var> in the process group
<var>pgid</var>; both the arguments must be fixnums.  If successful return
unspecified values, else raise an exception. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>tcgetpgrp</b><var> fd<a name="index-tcgetpgrp-712"></a></var><br>
<blockquote><p>Interface to the C function <code>tcgetpgrp()</code>, <a href="libc.html#Terminal-Access-Functions">tcgetpgrp</a>.  If successful return a fixnum representing the
process group ID of the foreground process group associated with the
terminal open on descriptor <var>fd</var>, which must be a fixnum; else raise
an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>tcsetpgrp</b><var> fd pgid<a name="index-tcsetpgrp-713"></a></var><br>
<blockquote><p>Interface to the C function <code>tcsetpgrp()</code>, <a href="libc.html#Terminal-Access-Functions">tcsetpgrp</a>.  Set to process group ID <var>pgid</var> the
foreground process group for the terminal open on descriptor <var>fd</var>;
both the arguments must be fixnums.  If successful return the fixnum
zero, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>tcgetsid</b><var> fd<a name="index-tcgetsid-714"></a></var><br>
<blockquote><p>Interface to the C function <code>tcgetsid()</code>, <a href="libc.html#Terminal-Access-Functions">tcgetsid</a>.  If successful return a fixnum representing the
process group ID of the session for which the terminal open on
descriptor <var>fd</var> is the controlling terminal; else raise an
exception. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-time"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-misc">posix misc</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-job">posix job</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.16 Date and time</h3>

<ul class="menu">
<li><a accesskey="1" href="#posix-time-timeval">posix time timeval</a>:           Data structure <code>struct-timeval</code>. 
<li><a accesskey="2" href="#posix-time-timespec">posix time timespec</a>:          Data structure <code>struct-timespec</code>. 
<li><a accesskey="3" href="#posix-time-tms">posix time tms</a>:               Data structure <code>struct-tms</code>. 
<li><a accesskey="4" href="#posix-time-tm">posix time tm</a>:                Data structure <code>struct-tm</code>. 
<li><a accesskey="5" href="#posix-time-functions">posix time functions</a>:         Date and time functions. 
</ul>

<!-- page -->
<div class="node">
<a name="posix-time-timeval"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-time-timespec">posix time timespec</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-time">posix time</a>

</div>

<h4 class="subsection">5.16.1 Data structure <code>struct-timeval</code></h4>

<div class="defun">
&mdash; Structure Type: <b>struct-timeval</b><var><a name="index-struct_002dtimeval-715"></a></var><br>
<blockquote><p>Scheme level representation of <code>struct timeval</code>, <a href="libc.html#Elapsed-Time">struct timeval</a>.  It has the
following fields:

          <dl>
<dt><code>tv_sec</code><dd>Exact integer, represents a count of seconds.

          <br><dt><code>tv_usec</code><dd>Exact integer, represents a count of microseconds. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-struct-timeval</b><var> sec usec<a name="index-make_002dstruct_002dtimeval-716"></a></var><br>
<blockquote><p>Build and return a new instance of <code>struct-timeval</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-timeval?</b><var> obj<a name="index-struct_002dtimeval_003f-717"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>obj</var> is an instance of <code>struct-timeval</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-timeval-tv_sec</b><var> timeval<a name="index-struct_002dtimeval_002dtv_005fsec-718"></a></var><br>
&mdash; Function: <b>struct-timeval-tv_usec</b><var> timeval<a name="index-struct_002dtimeval_002dtv_005fusec-719"></a></var><br>
<blockquote><p>Accessors for the fields of <code>struct-timeval</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-time-timespec"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-time-tms">posix time tms</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-time-timeval">posix time timeval</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-time">posix time</a>

</div>

<h4 class="subsection">5.16.2 Data structure <code>struct-timespec</code></h4>

<div class="defun">
&mdash; Structure Type: <b>struct-timespec</b><var><a name="index-struct_002dtimespec-720"></a></var><br>
<blockquote><p>Scheme level representation of <code>struct timespec</code>, <a href="libc.html#Elapsed-Time">struct timeval</a>.  It has the following fields:

          <dl>
<dt><code>tv_sec</code><dd>Exact integer, represents a count of seconds.

          <br><dt><code>tv_nsec</code><dd>Exact integer, represents a count of nanoseconds. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-struct-timespec</b><var> sec usec<a name="index-make_002dstruct_002dtimespec-721"></a></var><br>
<blockquote><p>Build and return a new instance of <code>struct-timespec</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-timespec?</b><var> obj<a name="index-struct_002dtimespec_003f-722"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>obj</var> is an instance of <code>struct-timespec</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-timespec-tv_sec</b><var> timespec<a name="index-struct_002dtimespec_002dtv_005fsec-723"></a></var><br>
&mdash; Function: <b>struct-timespec-tv_usec</b><var> timespec<a name="index-struct_002dtimespec_002dtv_005fusec-724"></a></var><br>
<blockquote><p>Accessors for the fields of <code>struct-timespec</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-time-tms"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-time-tm">posix time tm</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-time-timespec">posix time timespec</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-time">posix time</a>

</div>

<h4 class="subsection">5.16.3 Data structure <code>struct-tms</code></h4>

<div class="defun">
&mdash; Structure Type: <b>struct-tms</b><var><a name="index-struct_002dtms-725"></a></var><br>
<blockquote><p>Scheme level representation of <code>struct tms</code>, <a href="libc.html#Processor-Time">struct tms</a>.  It has the following fields:

          <dl>
<dt><code>tms_utime</code><dd>Exact integer.

          <br><dt><code>tms_stime</code><dd>Exact integer.

          <br><dt><code>tms_cutime</code><dd>Exact integer.

          <br><dt><code>tms_cstime</code><dd>Exact integer. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-struct-tms</b><var> utime stime cutime cstime<a name="index-make_002dstruct_002dtms-726"></a></var><br>
<blockquote><p>Build and return a new instance of <code>struct-tms</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-tms?</b><var> obj<a name="index-struct_002dtms_003f-727"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>obj</var> is an instance of <code>struct-tms</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-tms-tms_utime</b><var> tms<a name="index-struct_002dtms_002dtms_005futime-728"></a></var><br>
&mdash; Function: <b>struct-tms-tms_stime</b><var> tms<a name="index-struct_002dtms_002dtms_005fstime-729"></a></var><br>
&mdash; Function: <b>struct-tms-tms_cutime</b><var> tms<a name="index-struct_002dtms_002dtms_005fcutime-730"></a></var><br>
&mdash; Function: <b>struct-tms-tms_cstime</b><var> tms<a name="index-struct_002dtms_002dtms_005fcstime-731"></a></var><br>
<blockquote><p>Accessors for the fields of <code>struct-tms</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-time-tm"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#posix-time-functions">posix time functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-time-tms">posix time tms</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-time">posix time</a>

</div>

<h4 class="subsection">5.16.4 Data structure <code>struct-tm</code></h4>

<div class="defun">
&mdash; Structure Type: <b>struct-tm</b><var><a name="index-struct_002dtm-732"></a></var><br>
<blockquote><p>Scheme level representation of <code>struct tm</code>, <a href="libc.html#Broken_002ddown-Time">struct tm</a>.  It has the following fields:

          <dl>
<dt><code>tm_sec</code><dd>Exact integer.

          <br><dt><code>tm_min</code><dd>Exact integer.

          <br><dt><code>tm_hour</code><dd>Exact integer.

          <br><dt><code>tm_mday</code><dd>Exact integer.

          <br><dt><code>tm_mon</code><dd>Exact integer.

          <br><dt><code>tm_year</code><dd>Exact integer.

          <br><dt><code>tm_wday</code><dd>Exact integer.

          <br><dt><code>tm_yday</code><dd>Exact integer.

          <br><dt><code>tm_isdst</code><dd>Boolean.

          <br><dt><code>tm_gmtoff</code><dd>Exact integer.

          <br><dt><code>tm_zone</code><dd>Bytevector. 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-struct-tm</b><var> tm_sec tm_min tm_hour tm_mday tm_mon tm_year tm_wday tm_yday tm_isdst tm_gmtoff tm_zone<a name="index-make_002dstruct_002dtm-733"></a></var><br>
<blockquote><p>Build and return a new instance of <code>struct-tm</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-tm?</b><var> obj<a name="index-struct_002dtm_003f-734"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>obj</var> is an instance of <code>struct-tm</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>struct-tm-tm_sec</b><var> tm<a name="index-struct_002dtm_002dtm_005fsec-735"></a></var><br>
&mdash; Function: <b>struct-tm-tm_min</b><var> tm<a name="index-struct_002dtm_002dtm_005fmin-736"></a></var><br>
&mdash; Function: <b>struct-tm-tm_hour</b><var> tm<a name="index-struct_002dtm_002dtm_005fhour-737"></a></var><br>
&mdash; Function: <b>struct-tm-tm_mday</b><var> tm<a name="index-struct_002dtm_002dtm_005fmday-738"></a></var><br>
&mdash; Function: <b>struct-tm-tm_mon</b><var> tm<a name="index-struct_002dtm_002dtm_005fmon-739"></a></var><br>
&mdash; Function: <b>struct-tm-tm_year</b><var> tm<a name="index-struct_002dtm_002dtm_005fyear-740"></a></var><br>
&mdash; Function: <b>struct-tm-tm_wday</b><var> tm<a name="index-struct_002dtm_002dtm_005fwday-741"></a></var><br>
&mdash; Function: <b>struct-tm-tm_yday</b><var> tm<a name="index-struct_002dtm_002dtm_005fyday-742"></a></var><br>
&mdash; Function: <b>struct-tm-tm_isdst</b><var> tm<a name="index-struct_002dtm_002dtm_005fisdst-743"></a></var><br>
&mdash; Function: <b>struct-tm-tm_gmtoff</b><var> tm<a name="index-struct_002dtm_002dtm_005fgmtoff-744"></a></var><br>
&mdash; Function: <b>struct-tm-tm_zone</b><var> tm<a name="index-struct_002dtm_002dtm_005fzone-745"></a></var><br>
<blockquote><p>Accessors for instances of <var>struct-tm</var>
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-time-functions"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-time-tm">posix time tm</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix-time">posix time</a>

</div>

<h4 class="subsection">5.16.5 Date and time functions</h4>

<div class="defun">
&mdash; Function: <b>clock</b><var><a name="index-clock-746"></a></var><br>
<blockquote><p>Interface to the C function <code>clock()</code>, <a href="libc.html#CPU-Time">clock</a>. 
If successful return an exact integer representing the CPU time for the
calling process expressed in clock ticks; if the clock time is not
available return false. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>times</b><var><a name="index-times-747"></a></var><br>
<blockquote><p>Interface to the C function <code>times()</code>, <a href="libc.html#Processor-Time">times</a>.  If successful return an instance of <code>struct-tms</code>
representing the current processor time, else return false. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>posix-time</b><var><a name="index-posix_002dtime-748"></a></var><br>
<blockquote><p>Interface to the C function <code>time()</code>, <a href="libc.html#Simple-Calendar-Time">time</a>.  If successful return the calendar time as an exact
integer, else return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>gettimeofday</b><var><a name="index-gettimeofday-749"></a></var><br>
<blockquote><p>Interface to the C function <code>gettimeofday()</code>,
<a href="libc.html#High_002dResolution-Calendar">gettimeofday</a>.  Acquire the current
time.  If successful return an instance of <code>struct-timeval</code>, else
raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>localtime</b><var> time<a name="index-localtime-750"></a></var><br>
<blockquote><p>Interface to the C function <code>localtime()</code>, <a href="libc.html#Broken_002ddown-Time">localtime</a>.  Given an exact integer <var>time</var> representing the
local time as returned by the <code>posix-time</code> function: build and
return an instance of <code>struct-tm</code> representing the same time in
human readable form; if an error occurs raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>gmtime</b><var> time<a name="index-gmtime-751"></a></var><br>
<blockquote><p>Interface to the C function <code>gmtime()</code>, <a href="libc.html#Broken_002ddown-Time">gmtime</a>.  Given an exact integer <var>time</var> representing the <acronym>UTC</acronym> time
as returned by the <code>posix-time</code> function: build and return an
instance of <code>struct-tm</code> representing the same time in human
readable form; if an error occurs raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>timelocal</b><var> tm<a name="index-timelocal-752"></a></var><br>
<blockquote><p>Interface to the C function <code>timelocal()</code>, <a href="libc.html#Broken_002ddown-Time">timelocal</a>.  Given a reference to a <code>struct-rm</code>, <var>tm</var>,
representing a local broken time, convert it into a time value as
returned by <code>time()</code>.  If successful return an exact integer
representing the time value, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>timegm</b><var> tm<a name="index-timegm-753"></a></var><br>
<blockquote><p>Interface to the C function <code>timegm()</code>, <a href="libc.html#Broken_002ddown-Time">timegm</a>.  Given a reference to a <code>struct-rm</code>, <var>tm</var>,
representing a <acronym>UTC</acronym> broken time, convert it into a time value as
returned by <code>time()</code>.  If successful return an exact integer
representing the time value, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>strftime</b><var> template tm<a name="index-strftime-754"></a></var><br>
&mdash; Function: <b>strftime/string</b><var> template tm<a name="index-strftime_002fstring-755"></a></var><br>
<blockquote><p>Interface to the C function <code>strftime()</code>, <a href="libc.html#Formatting-Calendar-Time">strftime</a>.  Given a bytevector <var>template</var> holding an
<acronym>ASCII</acronym> coded format string and a <code>struct-tm</code> instance <var>tm</var>:
build a formatted time string; the resulting time string can be at most
4096 bytes wide.  If successful <code>strftime</code> returns a
bytevector holding the time string in <acronym>ASCII</acronym> coding and
<code>strftime/string</code> returns a Scheme string, else raise an exception. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>nanosleep</b><var> secs nsecs<a name="index-nanosleep-756"></a></var><br>
<blockquote><p>Interface to the C function <code>nanosleep()</code>, <a href="libc.html#Sleeping">nanosleep</a>.  Halt the current process for the specified amount of time.

        <p>The count of seconds <var>secs</var> must be an exact integer in the range
[0, 2^32); the count of nanoseconds <var>nsecs</var> must be an exact
integer in the range [0, 999999999].

        <p>If successful and the requested time is elapsed: return a pair whose car
is false and whose cdr is false.  If successful and the sleeping was
interrupted by an interprocess signal: return a pair whose car is an
exact integer representing the count of remaining seconds and whose cdr
is an exact integer representing the count of remaining nanoseconds.  If
an error occurs an exception is raised. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="posix-misc"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix-time">posix time</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#posix">posix</a>

</div>

<h3 class="section">5.17 Miscellaneous functions</h3>

<div class="defun">
&mdash; Function: <b>strerror</b><var> errno<a name="index-strerror-757"></a></var><br>
<blockquote><p>Return a string describing the <code>errno</code> code <var>errno</var>.  Makes use
of the system function <code>strerror()</code>.  If <var>errno</var> is not a valid
<code>errno</code> value: return a string telling it.  As special cases
<var>errno</var> can be also <code>#t</code>, meaning &ldquo;unknown error&rdquo;, and
<code>#f</code>, meaning &ldquo;no error&rdquo;.

        <p><a href="libc.html#Error-Messages">Error Messages</a>
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>file-descriptor?</b><var> obj<a name="index-file_002ddescriptor_003f-758"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a non&ndash;negative fixnum less than the value
of <code>FD_SETSIZE</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="glibc"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#linux">linux</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#posix">posix</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">6 The <acronym>GNU</acronym> C Library interface</h2>

<p>The functions described in this chapter are exported by the library
<code>(vicare glibc)</code>.  The <acronym>API</acronym> attempts to create a one&ndash;to&ndash;one
Scheme functions mapping towards <acronym>GNU</acronym> C Library functions, keeping the
same semantics as much as possible; the platform's own documentation is
relevant at the Scheme level.

   <p>All the constants needed to use the interface are available as
identifier syntaxes exported by the <code>(vicare platform-constants)</code>
library; if a constant value is not exported file a feature request for
the project.  If a constant is not defined on a platform: its value is
set to <code>#f</code>.

   <p>On non&ndash;<acronym>GNU</acronym> C Library platforms we must avoid calling these
functions, else the behaviour is undefined.

<ul class="menu">
<li><a accesskey="1" href="#glibc-env">glibc env</a>:                    Operating system environment
                                variables. 
<li><a accesskey="2" href="#glibc-dir">glibc dir</a>:                    File system directories. 
<li><a accesskey="3" href="#glibc-temp">glibc temp</a>:                   Temporary files and directories. 
<li><a accesskey="4" href="#glibc-sync">glibc sync</a>:                   File system synchronisation. 
<li><a accesskey="5" href="#glibc-socket">glibc socket</a>:                 Network sockets. 
<li><a accesskey="6" href="#glibc-math">glibc math</a>:                   Mathematics. 
<li><a accesskey="7" href="#glibc-random">glibc random</a>:                 Pseudo--random numbers. 
<li><a accesskey="8" href="#glibc-match">glibc match</a>:                  Pattern matching, globbing and
                                regular expressions. 
<li><a accesskey="9" href="#glibc-word">glibc word</a>:                   Performing word expansion. 
<li><a href="#glibc-config">glibc config</a>:                 System configuration. 
<li><a href="#glibc-iconv">glibc iconv</a>:                  Generic character set conversion. 
</ul>

<!-- page -->
<div class="node">
<a name="glibc-env"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#glibc-dir">glibc dir</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#glibc">glibc</a>

</div>

<h3 class="section">6.1 Operating system environment variables</h3>

<p>The following bindings are exported by the <code>(vicare glibc)</code>
library.

<div class="defun">
&mdash; Function: <b>clearenv</b><var><a name="index-clearenv-759"></a></var><br>
<blockquote><p>Interface to the C function <code>clearenv()</code>, <a href="libc.html#Environment-Access">clearenv</a>.  Remove all the entries from the environment.  Return
unspecified values. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="glibc-dir"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#glibc-temp">glibc temp</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#glibc-env">glibc env</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#glibc">glibc</a>

</div>

<h3 class="section">6.2 File system directories</h3>

<p>The following bindings are exported by the <code>(vicare glibc)</code>
library.

<div class="defun">
&mdash; Function: <b>dirfd</b><var> stream<a name="index-dirfd-760"></a></var><br>
<blockquote><p>Interface to the C function <code>dirfd()</code>, <a href="libc.html#Opening-a-Directory">dirfd</a>.  Acquire a file descriptor associated to
<var>stream</var>, which must be an instance of <code>directory-stream</code>;
<a href="#posix-dir">posix dir</a> for details.  If successful return a fixnum representing
the file descriptor, else raise an exception. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="glibc-temp"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#glibc-sync">glibc sync</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#glibc-dir">glibc dir</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#glibc">glibc</a>

</div>

<h3 class="section">6.3 Temporary files and directories</h3>

<p>The following bindings are exported by the <code>(vicare glibc)</code>
library.

<div class="defun">
&mdash; Function: <b>mkstemp</b><var> template<a name="index-mkstemp-761"></a></var><br>
<blockquote><p>Interface to the C function <code>mkstemp()</code>, <a href="libc.html#Temporary-Files">mkstemp</a>.  Create a temporary file, create it and open a file descriptor
for reading and writing.  <var>template</var> must be a mutable bytevector
holding a template pathname on entering and the actual pathname on
returning.  If successful return a file descriptor, else raise an
exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>mkdtemp</b><var> template<a name="index-mkdtemp-762"></a></var><br>
<blockquote><p>Interface to the C function <code>mkdtemp()</code>, <a href="libc.html#Temporary-Files">mkdtemp</a>.  Create a temporary directory for reading and writing. 
<var>template</var> must be a mutable bytevector holding a template pathname
on entering and the actual pathname on returning.  If successful return
<var>template</var> itself, else raise an exception. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="glibc-sync"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#glibc-socket">glibc socket</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#glibc-temp">glibc temp</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#glibc">glibc</a>

</div>

<h3 class="section">6.4 File system synchronisation</h3>

<p>The following bindings are exported by the <code>(vicare glibc)</code>
library.

<div class="defun">
&mdash; Function: <b>sync</b><var><a name="index-sync-763"></a></var><br>
<blockquote><p>Interface to the C function <code>sync()</code>, <a href="libc.html#Synchronizing-I_002fO">Synchronizing I/O</a>. 
Flush kernel buffer data and meta informations to the file system
devices.  If successful return unspecified values, else raise an
exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>fsync</b><var> fd<a name="index-fsync-764"></a></var><br>
<blockquote><p>Interface to the C function <code>fsync()</code>, <a href="libc.html#Synchronizing-I_002fO">Synchronizing I/O</a>. 
Flush kernel buffer data and meta informations to the file system device
for the file descriptor <var>fd</var>.  If successful return unspecified
values, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>fdatasync</b><var> fd<a name="index-fdatasync-765"></a></var><br>
<blockquote><p>Interface to the C function <code>fdatasync()</code>, <a href="libc.html#Synchronizing-I_002fO">Synchronizing I/O</a>.  Flush kernel buffer data to the file system device for the file
descriptor <var>fd</var>.  If successful return unspecified values, else
raise an exception. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="glibc-socket"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#glibc-math">glibc math</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#glibc-sync">glibc sync</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#glibc">glibc</a>

</div>

<h3 class="section">6.5 Network sockets</h3>

<p>The following bindings are exported by the <code>(vicare glibc)</code>
library.

<div class="defun">
&mdash; Function: <b>if-nametoindex</b><var> name<a name="index-if_002dnametoindex-766"></a></var><br>
<blockquote><p>Interface to the C function <code>if_nametoindex()</code>, <a href="libc.html#Interface-Naming">if_nametoindex</a>.  Convert the string <var>name</var> representing a
network interface to the corresponding internal index.  Return a fixnum
representing the index or false if <var>name</var> is invalid.

     <pre class="example">          (import (vicare))
          
          (if-indextoname 0)      &rArr; #f
          (if-indextoname 1)      &rArr; "lo"
          (if-indextoname 2)      &rArr; "eth0"
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>ikptr</b><var> if-indextoname index<a name="index-ikptr-767"></a></var><br>
<blockquote><p>Interface to the C function <code>if_indextoname()</code>, <a href="libc.html#Interface-Naming">if_indextoname</a>.  Convert the fixnum <var>index</var> associated to
an interface to the corresponding string name.  Return a string holding
the name or false if <var>index</var> is invalid.

     <pre class="example">          (import (vicare))
          
          (if-nametoindex "lo")   &rArr; 1
          (if-nametoindex "eth0") &rArr; 2
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>if-nameindex</b><var><a name="index-if_002dnameindex-768"></a></var><br>
<blockquote><p>Interface to the C function <code>if_nameindex()</code>, <a href="libc.html#Interface-Naming">if_nameindex</a>.  Build and return an association list having
fixnums as keys and strings as values; the fixnums are the interface
indexes, the strings are the corresponding interface names.

     <pre class="example">          (import (vicare))
          
          (if-nameindex)
          &rArr; ((4 . "wlan0")
              (2 . "eth0")
              (1 . "lo"))
</pre>
        </blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: <b>gethostbyname2</b><var> hostname addrtype<a name="index-gethostbyname2-769"></a></var><br>
<blockquote><p>Interface to the C function <code>gethostbyname2()</code>, <a href="libc.html#Host-Names">gethostbyname2</a>.  Like <code>gethostbyname</code> but allows the selection of
the address type with the parameter <var>addrtype</var> which must be
<code>AF_INET</code> or <code>AF_INET6</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="glibc-math"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#glibc-random">glibc random</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#glibc-socket">glibc socket</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#glibc">glibc</a>

</div>

<h3 class="section">6.6 Mathematics</h3>

<p>A binding for each of the following constants is exported by
<code>(vicare platform-constants)</code>:

<pre class="example">     M_E         M_LOG2E     M_LOG10E
     M_LN2       M_LN10      M_PI
     M_PI_2      M_PI_4      M_1_PI
     M_2_PI      M_2_SQRTPI  M_SQRT2
     M_SQRT1_2
</pre>
   <p>The following bindings are exported by the <code>(vicare glibc)</code>
library.  The functions are implemented by the <acronym>GNU</acronym> C library and are
probably faster than the ones implemented by the <acronym>R6RS</acronym> libraries. 
All the arguments <var>fl</var> must be flonums, all the arguments <var>cfl</var>
must be complex flonums.

<!--  -->
<h5 class="subsubheading">Trigonometric functions</h5>

<div class="defun">
&mdash; Function: <b>csin</b><var> cfl<a name="index-csin-770"></a></var><br>
&mdash; Function: <b>ccos</b><var> cfl<a name="index-ccos-771"></a></var><br>
&mdash; Function: <b>ctan</b><var> cfl<a name="index-ctan-772"></a></var><br>
<blockquote><p>Trigonometric functions for complex flonums. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>casin</b><var> cfl<a name="index-casin-773"></a></var><br>
&mdash; Function: <b>cacos</b><var> cfl<a name="index-cacos-774"></a></var><br>
&mdash; Function: <b>catan</b><var> cfl<a name="index-catan-775"></a></var><br>
<blockquote><p>Inverse trigonometric functions for complex flonums. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Exponents and logarithms</h5>

<div class="defun">
&mdash; Function: <b>cexp</b><var> cfl<a name="index-cexp-776"></a></var><br>
<blockquote><p>Return the base of the natural logarithms raised to the power of the
operand. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>clog</b><var> cfl<a name="index-clog-777"></a></var><br>
<blockquote><p>Return the natural logarithm of the operand. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>clog10</b><var> cfl<a name="index-clog10-778"></a></var><br>
<blockquote><p>Return the base 10 logarithm of the operand. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>csqrt</b><var> cfl<a name="index-csqrt-779"></a></var><br>
<blockquote><p>Return the square root of the operand. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>cpow</b><var> cfl1 cfl2<a name="index-cpow-780"></a></var><br>
<blockquote><p>Return <var>cfl1</var> raised to the power of <var>cfl2</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Hyperbolic functions</h5>

<div class="defun">
&mdash; Function: <b>glibc-sinh</b><var> fl<a name="index-glibc_002dsinh-781"></a></var><br>
&mdash; Function: <b>glibc-cosh</b><var> fl<a name="index-glibc_002dcosh-782"></a></var><br>
&mdash; Function: <b>glibc-tanh</b><var> fl<a name="index-glibc_002dtanh-783"></a></var><br>
<blockquote><p>Hyperbolic functions for flonums. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>glibc-asinh</b><var> fl<a name="index-glibc_002dasinh-784"></a></var><br>
&mdash; Function: <b>glibc-acosh</b><var> fl<a name="index-glibc_002dacosh-785"></a></var><br>
&mdash; Function: <b>glibc-atanh</b><var> fl<a name="index-glibc_002datanh-786"></a></var><br>
<blockquote><p>Inverse hyperbolic functions for flonums. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>csinh</b><var> cfl<a name="index-csinh-787"></a></var><br>
&mdash; Function: <b>ccosh</b><var> cfl<a name="index-ccosh-788"></a></var><br>
&mdash; Function: <b>ctanh</b><var> cfl<a name="index-ctanh-789"></a></var><br>
<blockquote><p>Hyperbolic functions for complex flonums. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>casinh</b><var> cfl<a name="index-casinh-790"></a></var><br>
&mdash; Function: <b>cacosh</b><var> cfl<a name="index-cacosh-791"></a></var><br>
&mdash; Function: <b>catanh</b><var> cfl<a name="index-catanh-792"></a></var><br>
<blockquote><p>Inverse hyperbolic functions for complex flonums. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Special functions</h5>

<div class="defun">
&mdash; Function: <b>erf</b><var> fl<a name="index-erf-793"></a></var><br>
&mdash; Function: <b>erfc</b><var> fl<a name="index-erfc-794"></a></var><br>
<blockquote><p>Interfaces to the C functions <code>erf()</code> and <code>erfc()</code>,
<a href="libc.html#Special-Functions">erf</a>.  Compute the error function. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>lgamma</b><var> fl<a name="index-lgamma-795"></a></var><br>
<blockquote><p>Interface to the C function <code>lgamma()</code>, <a href="libc.html#Special-Functions">lgamma</a>.  Compute the natural logarithm of the absolute value of the
gamma function of the operand.  Return two values: a flonum being the
result of the function and a fixnum representing the sign of the
intermediate result. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>tgamma</b><var> fl<a name="index-tgamma-796"></a></var><br>
<blockquote><p>Interface to the C function <code>tgamma()</code>, <a href="libc.html#Special-Functions">lgamma</a>.  Compute the gamma function of the operand. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>j0</b><var> fl<a name="index-j0-797"></a></var><br>
&mdash; Function: <b>j1</b><var> fl<a name="index-j1-798"></a></var><br>
&mdash; Function: <b>jn</b><var> fx fl<a name="index-jn-799"></a></var><br>
<blockquote><p>Interfaces to the C functions <code>j0()</code>, <code>j1()</code> and <code>jn()</code>;
<a href="libc.html#Special-Functions">j0</a>.  Compute the Bessel functions of the
first kind.  <var>fx</var> must be a fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>y0</b><var> fl<a name="index-y0-800"></a></var><br>
&mdash; Function: <b>y1</b><var> fl<a name="index-y1-801"></a></var><br>
&mdash; Function: <b>yn</b><var> fx fl<a name="index-yn-802"></a></var><br>
<blockquote><p>Interfaces to the C functions <code>y0()</code>, <code>y1()</code> and <code>yn()</code>;
<a href="libc.html#Special-Functions">y0</a>.  Compute the Bessel functions of the
second kind.  <var>fx</var> must be a fixnum. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="glibc-random"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#glibc-match">glibc match</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#glibc-math">glibc math</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#glibc">glibc</a>

</div>

<h3 class="section">6.7 Pseudo&ndash;random numbers</h3>

<p>The following bindings are exported by the <code>(vicare glibc)</code>
library.

<div class="defun">
&mdash; Function: <b>rand</b><var><a name="index-rand-803"></a></var><br>
<blockquote><p>Interface to the C function <code>rand()</code>, <a href="libc.html#ISO-Random">rand</a>. 
Return a non&ndash;negative exact integer representing the next
pseudo&ndash;random number in the series.  The maximum returned value is
<code>RAND_MAX</code>, which is a binding exported by <code>(vicare
platform-constants)</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>srand</b><var> seed<a name="index-srand-804"></a></var><br>
<blockquote><p>Interface to the C function <code>srand()</code>, <a href="libc.html#ISO-Random">srand</a>. 
Set to the exact integer <var>seed</var> the seed of the pseudo&ndash;random
numbers series. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="glibc-match"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#glibc-word">glibc word</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#glibc-random">glibc random</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#glibc">glibc</a>

</div>

<h3 class="section">6.8 Pattern matching, globbing and regular expressions</h3>

<p>The following bindings are exported by the <code>(vicare glibc)</code>
library.

<div class="defun">
&mdash; Function: <b>fnmatch</b><var> pattern string flags<a name="index-fnmatch-805"></a></var><br>
<blockquote><p>Interface to the C function <code>fnmatch()</code>, <a href="libc.html#Wildcard-Matching">fnmatch</a>.  Tests whether <var>string</var> matches <var>pattern</var>
according to <var>flags</var>; if it matches return <code>#t</code>, else return
<code>#f</code>.

        <p><var>pattern</var> and <var>string</var> must be Scheme strings or bytevectors;
<var>flags</var> must be a fixnum resulting from the bitwise combination
(<code>fxior</code>) of the <code>FNM_</code> constants exported by <code>(vicare
platform-constants)</code>.

     <pre class="example">          #!r6rs
          (import (vicare)
            (prefix (vicare glibc) glibc.)
            (vicare platform-constants))
          
          (glibc.fnmatch "ciao" "ciao"  0)        &rArr; #t
          (glibc.fnmatch "ciao" "salut" 0)        &rArr; #f
          
          (glibc.fnmatch "ciao*" "ciao a tutti" 0)
          &rArr; #t
          
          (glibc.fnmatch "*(Ciao)" "CiaoCiao" FNM_EXTMATCH)
          &rArr; #t
          
          (glibc.fnmatch "?(Ciao|Hello)" "Hello" FNM_EXTMATCH)
          &rArr; #t
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>glob</b><var> pattern flags error-handler<a name="index-glob-806"></a></var><br>
&mdash; Function: <b>glob/string</b><var> pattern flags error-handler<a name="index-glob_002fstring-807"></a></var><br>
<blockquote><p>Interface to the C function <code>glob()</code>, <a href="libc.html#Calling-Glob">glob</a>. 
Perform file globbing <strong>in the current directory</strong> using
<var>pattern</var> to select entries according to <var>flags</var>.  If successful
<code>glob</code> returns a list of bytevectors representing the result,
<code>glob/string</code> returns a list of strings representing the result;
else both return a fixnum representing one of the error codes:
<code>GLOB_ABORTED</code>, <code>GLOB_NOMATCH</code>, <code>GLOB_NOSPACE</code>.

        <p><var>pattern</var> must be a string or bytevector.  <var>flags</var> must be a
fixnum built as bitwise composition (<code>fxior</code>) of the flags:
<code>GLOB_ERR</code>, <code>GLOB_MARK</code>, <code>GLOB_NOCHECK</code>,
<code>GLOB_NOSORT</code>, <code>GLOB_NOESCAPE</code>, <code>GLOB_PERIOD</code>,
<code>GLOB_BRACE</code>, <code>GLOB_NOMAGIC</code>, <code>GLOB_TILDE</code>,
<code>GLOB_TILDE_CHECK</code>, <code>GLOB_ONLYDIR</code>.

        <p><var>error-handler</var> must be <code>#f</code> or a callback pointer with the
signature:

     <pre class="example">          int <var>error-handler</var> (const char * filename, int error-code)
</pre>
        <p class="noindent">called by <code>glob</code> whenever it cannot open a directory; see the
documentation for <code>glob()</code> and the flag <code>GLOB_ERR</code> for details.

     <pre class="example">          #!r6rs
          (import (vicare)
            (prefix (vicare glibc) glibc.)
            (vicare platform-constants))
          
          (glibc.glob/string "*" 0 #f)
          &rArr; ("bin" "boot" "dev" "etc" "home" "lib"
              "libexec" "lost+found" "media" "mnt" "opt"
              "proc" "root" "sbin" "share" "srv" "sys"
              "tmp" "usr" "var")
          
          (glibc.glob/string "~marco" GLOB_TILDE #f)
          &rArr; ("/home/marco")
</pre>
        </blockquote></div>

<!--  -->
<h5 class="subsubheading"><acronym>POSIX</acronym> regular expressions</h5>

<p>The following are usage examples of <acronym>POSIX</acronym> regular expressions
matching:

<pre class="example">     #!r6rs
     (import (vicare)
       (prefix (vicare glibc) glibc.)
       (vicare platform-constants))
     
     (let ((rex (glibc.regcomp "abc" 0)))
       (glibc.regexec rex "abc" 0))
     &rArr; #((0 . 3)))   ;the regex matched the whole string
     
     (let ((rex (glibc.regcomp "abc" 0)))
       (glibc.regexec rex "abcdef" 0))
     &rArr; #((0 . 3))    ;substring [0, 3) matched
     
     (let ((rex (glibc.regcomp "ciao" 0)))
       (glibc.regexec rex "abc" 0))
     &rArr; #f            ;no match
     
     (let ((rex (glibc.regcomp "\\(a\\)" 0)))
       (glibc.regexec rex "abc" 0))
     &rArr; #((0 . 1)     ;the regexp matched the whole string
          (0 . 1))    ;substring [0, 1) matched the 1st paren
     
     (let ((rex (glibc.regcomp "\\(a\\)\\(b\\)\\(c\\)" 0)))
       (glibc.regexec rex "abc" 0))
     &rArr; #((0 . 3)     ;the regexp matched the whole string
          (0 . 1)     ;substring [0, 1) matched the 1st paren
          (1 . 2)     ;substring [1, 2) matched the 2nd paren
          (2 . 3))    ;substring [2, 3) matched the 3rd paren
     
     (let ((rex (glibc.regcomp "\\(a\\(b\\(c\\)\\)\\)" 0)))
       (glibc.regexec rex "abc" 0))
     &rArr; #((0 . 3)     ;the regexp matched the whole string
          (0 . 3)     ;substring [0, 3) matched the 1st paren
          (1 . 3)     ;substring [1, 3) matched the 2nd paren
          (2 . 3))    ;substring [2, 3) matched the 3rd paren
</pre>
   <p class="noindent">we have to remember that this <acronym>API</acronym> can be used only with bytevectors
representing <acronym>ASCII</acronym> coded strings and with Scheme strings containing
only characters whose Unicode code points are in the range [0,
255].

   <p><acronym>POSIX</acronym> regular expression patterns are described in the &ldquo;Base
Definitions&rdquo; volume of <acronym>IEEE</acronym> Std 1003.1-2001, Chapter 9, Regular
Expressions:

<div align="center"><a href="http://pubs.opengroup.org/onlinepubs/009695399/nframe.html">http://pubs.opengroup.org/onlinepubs/009695399/nframe.html</a></div>

<p class="noindent"><acronym>URL</acronym> last verified Dec  9, 2011.

<div class="defun">
&mdash; Function: <b>regcomp</b><var> pattern flags<a name="index-regcomp-808"></a></var><br>
<blockquote><p>Interface to the C function <code>regcomp()</code>, <a href="libc.html#POSIX-Regexp-Compilation">regcomp</a>.  Compile the regular expression in <var>pattern</var>
accoding to <var>flags</var>.  If successful return a pointer referencing the
compiled regexp, else raise an exception with condition components
<code>&amp;error</code>, <code>&amp;who</code>, <code>&amp;message</code>,
<code>&amp;irritants</code>.

        <p><var>pattern</var> must be a string or bytevector representing the regular
expression.  <var>flags</var> must be a fixnum resulting from the bitwise
combination (<code>fxior</code>) of <code>REG_</code> constants.

        <p>The pointer returned in case of success references a <code>regex_t</code> data
structure whose fields must be released explicitly by <code>regfree</code>, or
they are automatically released by the garbage collector whenever the
pointer itself is collected. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>regexec</b><var> regex string flags<a name="index-regexec-809"></a></var><br>
<blockquote><p>Interface to the C function <code>regexec()</code>, <a href="libc.html#Matching-POSIX-Regexps">regexec</a>.  Attempt to match <var>string</var> against the
precompiled regular expression <var>regex</var> according to <var>flags</var>.

        <p><var>regex</var> must be a pointer returned by a previous call to
<code>regcomp</code>; <var>string</var> must be a string or bytevector in <acronym>ASCII</acronym>
encoding; <var>flags</var> must be a fixnum representing matching flags, we
can use zero for no flags.

        <p>If one or more matches occur return a vector holding pairs describing
the portions of <var>string</var> that did match; if no match occurs return
<code>#f</code>; if an error occurs raise an exception with condition
components: <code>&amp;error</code>, <code>&amp;who</code>, <code>&amp;message</code>,
<code>&amp;irritants</code>.

        <p>The vector returned in case of success contains pairs: the car being a
fixnum representing the starting offset of a match substring, the cdr
being a fixnum representing the ending offset of a match substring.

        <p>The vector element at index 0 represents the portion of
<var>string</var> which matched the whole regular expression; the vector
element at index 1 represents the portion of <var>string</var> which
matched the first parenthetical subexpression, the vector element at
index 2 represents the portion of <var>string</var> which matched the
second parenthetical subexpression, and so on.  If <var>string</var> matches:
the returned vector has at least one element. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>regfree</b><var> regex<a name="index-regfree-810"></a></var><br>
<blockquote><p>Interface to the C function <code>regfree()</code>, <a href="libc.html#Regexp-Cleanup">regfree</a>.  Release the resources associated to the compiled regular
expression <var>regex</var>, which must be a pointer.

        <p>It is safe to apply this function multiple times to the same <var>regex</var>
pointer object: releasing occurs only if the first time, subsequent
applications do nothing.  After the resources have been released:
<var>regex</var> is reset to <code>NULL</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="glibc-word"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#glibc-config">glibc config</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#glibc-match">glibc match</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#glibc">glibc</a>

</div>

<h3 class="section">6.9 Performing word expansion</h3>

<p>Word expansion is a set of operations acting on a given string and
involving the current system environment variable; it is usually
performed by Unix shell programs.  It works as follows:

<pre class="example">     #!r6rs
     (import (rnrs)
       (prefix (vicare posix) px.)
       (prefix (vicare glibc) glibc.)
       (vicare platform-constants))
     
     (px.setenv "CIAO" "BLU")
     (glibc.wordexp/string "$CIAO" 0)        &rArr; #("BLU")
     
     (px.setenv "CIAO" "BLUETTE")
     (glibc.wordexp/string "${CIAO##BLU}" 0) &rArr; #("ETTE")
     
     (glibc.wordexp/string "/bin/ch*" 0)
     &rArr; #("/bin/chcon""/bin/chgrp"
          "/bin/chmod" "/bin/chown" "/bin/chroot")
     
</pre>
   <p>The following bindings are exported by the <code>(vicare glibc)</code>
library.

<div class="defun">
&mdash; Function: <b>wordexp</b><var> words flags<a name="index-wordexp-811"></a></var><br>
&mdash; Function: <b>wordexp/string</b><var> words flags<a name="index-wordexp_002fstring-812"></a></var><br>
<blockquote><p>Interface to the C function <code>wordexp()</code>, <a href="libc.html#Calling-Wordexp">wordexp</a>.  Perform word expansion on <var>words</var> according to
<var>flags</var>.

        <p><var>words</var> must be a string or bytevector.  <var>flags</var> must be a
fixnum resulting from the bitwise combination (<code>fxior</code>) of the
flags: <code>WRDE_NOCMD</code>, <code>WRDE_SHOWERR</code>, <code>WRDE_UNDEF</code>.

        <p>If successful <code>wordexp</code> returns a vector holding the resulting
bytevectors, <code>wordexp/string</code> returns a vector holding the
resulting strings; else the return value is a fixnum among:
<code>WRDE_BADCHAR</code>, <code>WRDE_BADVAL</code>, <code>WRDE_CMDSUB</code>,
<code>WRDE_NOSPACE</code>, <code>WRDE_SYNTAX</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="glibc-config"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#glibc-iconv">glibc iconv</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#glibc-word">glibc word</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#glibc">glibc</a>

</div>

<h3 class="section">6.10 System configuration</h3>

<p>The following bindings are exported by the <code>(vicare glibc)</code>
library.  If an error occurs: all the following functions raise an
exception with condition components <code>&amp;errno</code>,
<code>&amp;error</code>, <code>&amp;who</code>, <code>&amp;message</code>,
<code>&amp;irritants</code>.

<div class="defun">
&mdash; Function: <b>sysconf</b><var> parameter<a name="index-sysconf-813"></a></var><br>
<blockquote><p>Interface to the C function <code>sysconf()</code>, <a href="libc.html#Sysconf-Definition">sysconf</a>.  Query the system for a configuration value
selected by the exact integer <var>parameter</var> among the <code>_SC_</code>
constants.  If successful and a value is available: return a positive
exact integer; if successful but no value is available return false; if
<var>parameter</var> is invalid raise an exception.

        <p><strong>NOTE</strong> This function assumes that all the validly returnable
values are non&ndash;negative.  If a value is negative, the behaviour is
unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>pathconf</b><var> pathname parameter<a name="index-pathconf-814"></a></var><br>
<blockquote><p>Interface to the C function <code>pathconf()</code>, <a href="libc.html#Pathconf">pathconf</a>.  Query the system for a configuration value associated to the
file <var>pathname</var> selected by the exact integer <var>parameter</var> among
the <code>_PC_</code> constants.

        <p><var>pathname</var> must be a string or bytevector; if it is a string: it is
converted to bytevector with the function referenced by
<code>string-&gt;filename-func</code>.

        <p>If successful and a value is available: return a positive exact integer;
if successful but no value is available return false; if <var>parameter</var>
is invalid raise an exception.

        <p><strong>NOTE</strong> This function assumes that all the validly returnable
values are non&ndash;negative.  If a value is negative, the behaviour is
unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>fpathconf</b><var> fd parameter<a name="index-fpathconf-815"></a></var><br>
<blockquote><p>Interface to the C function <code>fpathconf()</code>, <a href="libc.html#Pathconf">fpathconf</a>.  Query the system for a configuration value associated to
the file descriptor <var>fd</var> selected by the exact integer
<var>parameter</var> among the <code>_PC_</code> constants.

        <p>If successful and a value is available: return a positive exact integer;
if successful but no value is available return false; if <var>parameter</var>
is invalid raise an exception.

        <p><strong>NOTE</strong> This function assumes that all the validly returnable
values are non&ndash;negative.  If a value is negative, the behaviour is
unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>confstr</b><var> parameter<a name="index-confstr-816"></a></var><br>
&mdash; Function: <b>confstr/string</b><var> parameter<a name="index-confstr_002fstring-817"></a></var><br>
<blockquote><p>Interface to the C function <code>confstr()</code>, <a href="libc.html#String-Parameters">confstr</a>.  Query the system for a configuration value
selected by the exact integer <var>parameter</var> among the <code>_CS_</code>
constants.  If successful <code>confstr</code> returns a bytevector
representing the value, <code>confstr/string</code> returns a string
representing the value; else an exception is raised.

     <pre class="example">          #!r6rs
          (import (rnrs)
            (prefix (vicare glibc) glibc.)
            (vicare platform-constants))
          
          (glibc.confstr/string _CS_PATH)
          &rArr; "/bin:/usr/bin"
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="glibc-iconv"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#glibc-config">glibc config</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#glibc">glibc</a>

</div>

<h3 class="section">6.11 Generic character set conversion</h3>

<p>The Iconv functions allow conversion among character set encodings,
<a href="libc.html#Generic-Charset-Conversion">Conversion</a>.  This <acronym>API</acronym> is
available only if, at package configuration time, it was enabled with
the <samp><span class="option">--with-iconv</span></samp> option to the <samp><span class="command">configure</span></samp> script.

<ul class="menu">
<li><a accesskey="1" href="#glibc-iconv-set">glibc iconv set</a>:              Encoding enumeration sets. 
<li><a accesskey="2" href="#glibc-iconv-conv">glibc iconv conv</a>:             Conversion functions. 
</ul>

<!-- page -->
<div class="node">
<a name="glibc-iconv-set"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#glibc-iconv-conv">glibc iconv conv</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#glibc-iconv">glibc iconv</a>

</div>

<h4 class="subsection">6.11.1 Encoding enumeration sets</h4>

<p>The following bindings are exported by the <code>(vicare glibc)</code>
library.

<div class="defun">
&mdash; Enumeration Type: <b>enum-iconv-encoding</b><var><a name="index-enum_002diconv_002dencoding-818"></a></var><br>
<blockquote><p>Enumeration type for the symbols describing supported Iconv encodings. 
All the encoding symbols are included with the exception of &lsquo;<samp><span class="samp">850</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">862</span></samp>&rsquo; and &lsquo;<samp><span class="samp">866</span></samp>&rsquo; (because they are numbers) which are aliases
for &lsquo;<samp><span class="samp">CP850</span></samp>&rsquo;, &lsquo;<samp><span class="samp">CP862</span></samp>&rsquo; and &lsquo;<samp><span class="samp">CP866</span></samp>&rsquo;.

        <p>Additionally &lsquo;<samp><span class="samp">TRANSLIT</span></samp>&rsquo; and &lsquo;<samp><span class="samp">IGNORE</span></samp>&rsquo; are included to allow the
specification of the corresponding modes for <code>iconv!</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Syntax: <b>iconv-encoding</b><var> &lt;symbol&gt; ...<a name="index-iconv_002dencoding-819"></a></var><br>
<blockquote><p>Evaluate to an enumeration set holding symbols from the
<code>enum-iconv-encoding</code> enumeration.  It should be used to compose
sets with a single encoding symbol and optionally none, one or both the
symbols &lsquo;<samp><span class="samp">TRANSLIT</span></samp>&rsquo; and &lsquo;<samp><span class="samp">IGNORE</span></samp>&rsquo;.

        <p>Examples:

     <pre class="example">          (iconv-encoding ISO8859-4)
          (iconv-encoding UTF-16BE IGNORE)
          (iconv-encoding UCS-4 TRANSLIT IGNORE)
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Constant: <b>iconv-encoding-universe</b><var><a name="index-iconv_002dencoding_002duniverse-820"></a></var><br>
<blockquote><p>Enumeration set holding all the symbols in the
<code>enum-iconv-encoding</code> enumeration. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>iconv-encoding-aliases?</b><var> set1 set2<a name="index-iconv_002dencoding_002daliases_003f-821"></a></var><br>
<blockquote><p>Return true if the encodings specified by the enumeration sets
<var>set1</var> and <var>set2</var> are aliases for the same encoding.  This
predicate does <strong>not</strong> take into account the &lsquo;<samp><span class="samp">TRANSLIT</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">IGNORE</span></samp>&rsquo; symbols. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>iconv-encoding=?</b><var> set1 set2<a name="index-iconv_002dencoding_003d_003f-822"></a></var><br>
<blockquote><p>Return true if the encodings specified by the enumeration sets
<var>set1</var> and <var>set2</var> are aliases for the same encoding, taking
into account the &lsquo;<samp><span class="samp">TRANSLIT</span></samp>&rsquo; and &lsquo;<samp><span class="samp">IGNORE</span></samp>&rsquo; symbols. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="glibc-iconv-conv"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#glibc-iconv-set">glibc iconv set</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#glibc-iconv">glibc iconv</a>

</div>

<h4 class="subsection">6.11.2 Conversion functions</h4>

<p>The basics of the conversion are as follows:

<pre class="example">     #!r6rs
     (import (vicare)
       (prefix (vicare glibc) glibc.))
     
     (let* ((handle    (glibc.iconv-open
                         (glibc.iconv-encoding UTF-16BE) ;from
                         (glibc.iconv-encoding UTF-8)))  ;to
            (in.bv     (string-&gt;utf16 "ciao hello salut"
                         (endianness big)))
            (out.bv    (make-bytevector 16)))
       (let-values (((in.start out.start)
                    (glibc.iconv! handle in.bv 0 #f out.bv 0 #f)))
         (utf8-&gt;string out.bv)))
     &rArr; "ciao hello salut"
</pre>
   <p>The following bindings are exported by the <code>(vicare glibc)</code>
library.

<div class="defun">
&mdash; Function: <b>iconv-open</b><var> from to<a name="index-iconv_002dopen-823"></a></var><br>
<blockquote><p>Build and return a new conversion context object for the specified
encodings.  <var>from</var> and <var>to</var> must be enumeration sets of type
<code>enum-iconv-encoding</code>.  The returned handle must be finalised with
<code>iconv-close</code>; this operation is automatically performed when the
handle is garbage collected.

        <blockquote>
<strong>NOTE</strong> Beware of the order of the arguments!  An error may be
difficult to detect. 
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Function: <b>iconv?</b><var> obj<a name="index-iconv_003f-824"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is an Iconv context object.  Context objects
are disjoint from the other Scheme objects. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>iconv-closed?</b><var> context<a name="index-iconv_002dclosed_003f-825"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>context</var> is an Iconv context already closed;
return <code>#f</code> otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>iconv-close</b><var> context<a name="index-iconv_002dclose-826"></a></var><br>
<blockquote><p>Close the conversion <var>context</var> releasing all the associated
resources.  Applying this function multiple times to the same
<var>context</var> object is safe: the first time the context is finalised,
the subsequent times nothing happens. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>iconv!</b><var> context in in.start in.past out out.start out.past<a name="index-iconv_0021-827"></a></var><br>
<blockquote><p>Convert a range of bytes from the bytevector <var>in</var> and store the
result into a range of bytes in the bytevector <var>out</var>, according
to the context specified by <var>context</var>.

        <p><var>in.start</var> is a fixnum representing the input inclusive start index;
<var>in.past</var> is a fixnum representing the input exclusive end index;
<var>out.start</var> is a fixnum representing the output inclusive start
index; <var>out.past</var> is a fixnum representing the output exclusive end
index.  They must be such that:

     <pre class="example">          0 &lt;= <var>in.start</var>  &lt;= <var>in.past</var>  &lt;= length(<var>in</var>)
          0 &lt;= <var>out.start</var> &lt;= <var>out.past</var> &lt;= length(<var>out</var>)
</pre>
        <p>As special cases: if <var>in.past</var> is false, the input past index is the
length of <var>in</var>; if <var>out.past</var> is false, the output past index is
the length of <var>out</var>.

        <p>If the operation is successful return two values:

          <ol type=1 start=1>
<li>A fixnum representing the index of the first byte in <var>in</var> that was
not consumed.  If all the input range was processed: this value equals
<var>in.past</var>.

          <li>A fixnum representing the index of the first byte in <var>out</var> that was
not filled with output data.  If all the output range was filled with
output: this value equals <var>out.past</var>.
             </ol>

        <p>If an error occurs raise an exception.

        <blockquote>
<strong>NOTE</strong> Beware of the order of the arguments!  An error may be
difficult to detect. 
</blockquote>
        </p></blockquote></div>

<!-- page -->
<div class="node">
<a name="linux"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib">syslib</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#glibc">glibc</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">7 The <acronym>GNU</acronym>+Linux interface</h2>

<p>The functions described in this chapter are exported by the library
<code>(vicare linux)</code>.  The <acronym>API</acronym> attempts to create a one&ndash;to&ndash;one
Scheme functions mapping towards Linux functions, keeping the same
semantics as much as possible; the platform's own documentation is
relevant at the Scheme level.

   <p>All the constants needed to use the interface are available as
identifier syntaxes exported by the <code>(vicare platform-constants)</code>
library; if a constant value is not exported file a feature request for
the project.  If a constant is not defined on a platform: its value is
set to <code>#f</code>.

   <p>On non&ndash;Linux platforms we must avoid calling these functions, else the
behaviour is undefined.

<ul class="menu">
<li><a accesskey="1" href="#linux-env">linux env</a>:                    Operating system environment variables. 
<li><a accesskey="2" href="#linux-status">linux status</a>:                 Process termination status. 
</ul>

<!-- page -->
<div class="node">
<a name="linux-env"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#linux-status">linux status</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#linux">linux</a>

</div>

<h3 class="section">7.1 Operating system environment variables</h3>

<p>The following bindings are exported by the <code>(vicare linux)</code>
library.

<div class="defun">
&mdash; Function: <b>clearenv</b><var><a name="index-clearenv-828"></a></var><br>
<blockquote><p>Interface to the C function <code>clearenv()</code>, <a href="libc.html#Environment-Access">clearenv</a>.  Remove all the entries from the environment.  Return
unspecified values. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="linux-status"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#linux-env">linux env</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#linux">linux</a>

</div>

<h3 class="section">7.2 Process termination status</h3>

<p>The following bindings are exported by the <code>(vicare linux)</code>
library.

<div class="defun">
&mdash; Function: <b>waitid</b><var> idtype id options<a name="index-waitid-829"></a></var><br>
<blockquote><p>Interface to the Linux specific C function <code>waitid()</code>, see the
<code>waitid()</code> manual page for details.  Wait for the termination of one
or more child processes with finer control of <code>waitpid</code>.  All the
arguments must be fixnums.  If successful: return an instance of
structure <code>struct-siginfo_t</code>, else raise an exception. 
</p></blockquote></div>

<div class="defun">
&mdash; Struct: <b>struct-siginfo_t</b><var><a name="index-struct_002dsiginfo_005ft-830"></a></var><br>
<blockquote><p>Data structure used by <code>waitid</code> to report its result; it has the
following fields:

     <pre class="example">          si_pid si_uid si_signo si_status si_code
</pre>
        <p>See the <code>waitid()</code> manual page for details. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>make-struct-siginfo_t</b><var> pid uid signo status code<a name="index-make_002dstruct_002dsiginfo_005ft-831"></a></var><br>
&mdash; Function: <b>struct-siginfo_t?</b><var> obj<a name="index-struct_002dsiginfo_005ft_003f-832"></a></var><br>
&mdash; Function: <b>struct-siginfo_t-si_pid</b><var><a name="index-struct_002dsiginfo_005ft_002dsi_005fpid-833"></a></var><br>
&mdash; Function: <b>struct-siginfo_t-si_uid</b><var><a name="index-struct_002dsiginfo_005ft_002dsi_005fuid-834"></a></var><br>
&mdash; Function: <b>struct-siginfo_t-si_signo</b><var><a name="index-struct_002dsiginfo_005ft_002dsi_005fsigno-835"></a></var><br>
&mdash; Function: <b>struct-siginfo_t-si_status</b><var><a name="index-struct_002dsiginfo_005ft_002dsi_005fstatus-836"></a></var><br>
&mdash; Function: <b>struct-siginfo_t-si_code</b><var><a name="index-struct_002dsiginfo_005ft_002dsi_005fcode-837"></a></var><br>
<blockquote><p>Constructor, predicate and field accessors for structures of type
<code>struct-siginfo_t</code>. 
</p></blockquote></div>

   <p>The following functions accept as argument a fixnum representing the
process termination status, for example the return value of
<code>system()</code> or the status acquired by <code>waitpid()</code>.

<div class="defun">
&mdash; Function: <b>WIFCONTINUED</b><var> status<a name="index-WIFCONTINUED-838"></a></var><br>
<blockquote><p>Interface to the Linux specific C macro <code>WIFCONTINUED()</code>.  Return
true if the process was resumed by delivery of <code>SIGCONT</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi">capi</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#linux">linux</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">8 Low level, fast, unsafe operations</h2>

<p>The bindings documented in this chapter are low level operations inlined
by the compiler; mostly they are defined in the source file
<samp><span class="file">pass-specify-rep-primops.ss</span></samp>.

   <p>They are unsafe because when acting upon wrong arguments will cause
undefined behaviour (probably a crash).  They are also faster than the
public interface exported by <code>(ikarus)</code> and <code>(rnrs)</code>.

<ul class="menu">
<li><a accesskey="1" href="#syslib-symbols">syslib symbols</a>:               Low level symbol operations. 
<li><a accesskey="2" href="#syslib-fixnums">syslib fixnums</a>:               Low level fixnum operations. 
<li><a accesskey="3" href="#syslib-bignums">syslib bignums</a>:               Low level bignum operations. 
<li><a accesskey="4" href="#syslib-flonums">syslib flonums</a>:               Low level flonum operations. 
<li><a accesskey="5" href="#syslib-ratnums">syslib ratnums</a>:               Low level ratnum operations. 
<li><a accesskey="6" href="#syslib-compnums">syslib compnums</a>:              Low level compnum operations. 
<li><a accesskey="7" href="#syslib-cflonums">syslib cflonums</a>:              Low level cflonum operations. 
<li><a accesskey="8" href="#syslib-chars">syslib chars</a>:                 Low level character operations. 
<li><a accesskey="9" href="#syslib-pairs">syslib pairs</a>:                 Low level pair operations. 
<li><a href="#syslib-structs">syslib structs</a>:               Low level structure operations. 
<li><a href="#syslib-vectors">syslib vectors</a>:               Low level vector operations. 
<li><a href="#syslib-bytevectors">syslib bytevectors</a>:           Low level bytevector operations. 
<li><a href="#syslib-strings">syslib strings</a>:               Low level string operations. 
<li><a href="#syslib-ports">syslib ports</a>:                 Low level port structures. 
<li><a href="#syslib-transcoders">syslib transcoders</a>:           Low level transcoder operations. 
<li><a href="#syslib-pointers">syslib pointers</a>:              Low level pointer operations. 
</ul>

<!-- page -->
<div class="node">
<a name="syslib-symbols"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-fixnums">syslib fixnums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.1 Low level symbol operations</h3>

<p>The arguments <var>sym</var> must be references to symbol blocks, the
arguments <var>str</var> must be references to strings.  The following
bindings are exported by the <code>(ikarus system $symbols)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-symbol</b><var> str<a name="index-g_t_0024make_002dsymbol-839"></a></var><br>
<blockquote><p>Allocate a new symbol block and initialise the <code>string</code> field with
<var>str</var>; return the reference to the symbol block.

        <p>The <code>ustring</code> is initialised to the fixnum zero.  The <code>value</code>
and <code>proc</code> fields are initialised to a special machine word value
meaning &ldquo;unbound&rdquo;.  The <code>plist</code> field is initialised to nil. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$symbol-string</b><var> sym<a name="index-g_t_0024symbol_002dstring-840"></a></var><br>
&mdash; Unsafe Operation: <b>$symbol-unique-string</b><var> sym<a name="index-g_t_0024symbol_002dunique_002dstring-841"></a></var><br>
&mdash; Unsafe Operation: <b>$symbol-plist</b><var> sym<a name="index-g_t_0024symbol_002dplist-842"></a></var><br>
&mdash; Unsafe Operation: <b>$symbol-value</b><var> sym<a name="index-g_t_0024symbol_002dvalue-843"></a></var><br>
<blockquote><p>Accessors for the fields of <var>sym</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$set-symbol-string!</b><var> sym str<a name="index-g_t_0024set_002dsymbol_002dstring_0021-844"></a></var><br>
&mdash; Unsafe Operation: <b>$set-symbol-unique-string!</b><var> sym str<a name="index-g_t_0024set_002dsymbol_002dunique_002dstring_0021-845"></a></var><br>
&mdash; Unsafe Operation: <b>$set-symbol-plist!</b><var> sym ell<a name="index-g_t_0024set_002dsymbol_002dplist_0021-846"></a></var><br>
&mdash; Unsafe Operation: <b>$set-symbol-value!</b><var> sym val<a name="index-g_t_0024set_002dsymbol_002dvalue_0021-847"></a></var><br>
&mdash; Unsafe Operation: <b>$set-symbol-proc!</b><var> sym proc<a name="index-g_t_0024set_002dsymbol_002dproc_0021-848"></a></var><br>
<blockquote><p>Mutators for the fields of <var>sym</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$set-symbol-value/proc!</b><var> sym val<a name="index-g_t_0024set_002dsymbol_002dvalue_002fproc_0021-849"></a></var><br>
<blockquote><p>Set both the fields <code>value</code> and <code>proc</code> of <var>sym</var> to
<var>val</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$unbound-object?</b><var> sym<a name="index-g_t_0024unbound_002dobject_003f-850"></a></var><br>
<blockquote><p>Return true if the <code>$symbol-value</code> field of <var>sym</var> is set to the
special &ldquo;unbound&rdquo; machine word value. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>top-level-value</b><var> sym<a name="index-top_002dlevel_002dvalue-851"></a></var><br>
<blockquote><p>Still to be documented. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$init-symbol-function!</b><var> sym proc<a name="index-g_t_0024init_002dsymbol_002dfunction_0021-852"></a></var><br>
<blockquote><p>Still to be documented. 
</p></blockquote></div>

   <p>The following bindings are related to the symbol table collecting
interned symbols.

<div class="defun">
&mdash; Function: <b>$symbol-table-size</b><var><a name="index-g_t_0024symbol_002dtable_002dsize-853"></a></var><br>
<blockquote><p>Return the number of interned symbols. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>$log-symbol-table-status</b><var><a name="index-g_t_0024log_002dsymbol_002dtable_002dstatus-854"></a></var><br>
<blockquote><p>Write to the current error port a description of the current symbol
table status.  Example:

     <pre class="example">          vicare&gt; (import (ikarus system $symbols))
          vicare&gt; ($log-symbol-table-status)
          Vicare internal symbol table status:
                  number of interned symbols: 2962
                  number of hash table buckets: 4096
          
          vicare&gt;
</pre>
        </blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-fixnums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-bignums">syslib bignums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-symbols">syslib symbols</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.2 Low level fixnum operations</h3>

<p>The following bindings are exported by the <code>(ikarus system $fx)</code>
library.  The arguments to these operations must be fixnums. 
<a href="#objects-fixnums">objects fixnums</a> for details on the representation of fixnums.

<div class="defun">
&mdash; Unsafe Operation: <b>$fxzero?</b><var> fx<a name="index-g_t_0024fxzero_003f-855"></a></var><br>
<blockquote><p>Evaluate to true if <var>fx</var> is zero. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx=</b><var> fx1 fx2<a name="index-g_t_0024fx_003d-856"></a></var><br>
<blockquote><p>Evaluate to true if the arguments are equal. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx&lt;</b><var> fx1 fx2<a name="index-g_t_0024fx_003c-857"></a></var><br>
<blockquote><p>Evaluate to true if <var>fx1</var> is less than <var>fx2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx&lt;=</b><var> fx1 fx2<a name="index-g_t_0024fx_003c_003d-858"></a></var><br>
<blockquote><p>Evaluate to true if <var>fx1</var> is less than or equal to <var>fx2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx&gt;</b><var> fx1 fx2<a name="index-g_t_0024fx_003e-859"></a></var><br>
<blockquote><p>Evaluate to true if <var>fx1</var> is greater than <var>fx2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx&gt;=</b><var> fx1 fx2<a name="index-g_t_0024fx_003e_003d-860"></a></var><br>
<blockquote><p>Evaluate to true if <var>fx1</var> is greater than or equal to <var>fx2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxadd1</b><var> fx<a name="index-g_t_0024fxadd1-861"></a></var><br>
<blockquote><p>Increment the operand by one and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxsub1</b><var> fx<a name="index-g_t_0024fxsub1-862"></a></var><br>
<blockquote><p>Decrement the operand by one and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx+</b><var> fx1 fx2<a name="index-g_t_0024fx_002b-863"></a></var><br>
<blockquote><p>Sum the operands and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx-</b><var> fx1 fx2<a name="index-g_t_0024fx_002d-864"></a></var><br>
<blockquote><p>Subtract the operands and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fx*</b><var> fx1 fx2<a name="index-g_t_0024fx_002a-865"></a></var><br>
<blockquote><p>Multiply the operands and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxlognot</b><var> fx<a name="index-g_t_0024fxlognot-866"></a></var><br>
<blockquote><p>Perform the bitwise NOT on the operand and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxlogand</b><var> fx1 fx2<a name="index-g_t_0024fxlogand-867"></a></var><br>
<blockquote><p>Perform the bitwise AND on the operands and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxlogor</b><var> fx1 fx2<a name="index-g_t_0024fxlogor-868"></a></var><br>
<blockquote><p>Perform the bitwise inclusive OR on the operands and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxlogxor</b><var> fx1 fx2<a name="index-g_t_0024fxlogxor-869"></a></var><br>
<blockquote><p>Perform the bitwise exclusive OR on the operands and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxsll</b><var> fx1 fx2<a name="index-g_t_0024fxsll-870"></a></var><br>
<blockquote><p>Perform bitwise shift left of <var>fx1</var> by <var>fx2</var> positions and
return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxsra</b><var> fx1 fx2<a name="index-g_t_0024fxsra-871"></a></var><br>
<blockquote><p>Perform bitwise shift right of <var>fx1</var> by <var>fx2</var> positions and
return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxquotient</b><var> fx1 fx2<a name="index-g_t_0024fxquotient-872"></a></var><br>
<blockquote><p>Compute the quotient between the operands and return the result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fxinthash</b><var> fx<a name="index-g_t_0024fxinthash-873"></a></var><br>
<blockquote><p>Evaluate to a fixnum which can be used as hash value.

        <blockquote>
<strong>NOTE</strong>  This appears to be unused in the source. 
</blockquote>
        </p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-bignums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-flonums">syslib flonums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-fixnums">syslib fixnums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.3 Low level bignum operations</h3>

<p>The arguments <var>bn</var> to these operations must be bignums.  The
following bindings are exported by the <code>(ikarus system $bignums)</code>
library.  <a href="#iklib-numerics">iklib numerics</a> for more functions acting on bignums.

<div class="defun">
&mdash; Unsafe Operation: <b>$bignum-positive?</b><var> bn<a name="index-g_t_0024bignum_002dpositive_003f-874"></a></var><br>
<blockquote><p>Evaluate to true if the operand is positive. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bignum-byte-ref</b><var> bn fx<a name="index-g_t_0024bignum_002dbyte_002dref-875"></a></var><br>
<blockquote><p>Return a fixnum representing the byte at index <var>fx</var> in the data of
<var>bn</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bignum-size</b><var> bn<a name="index-g_t_0024bignum_002dsize-876"></a></var><br>
<blockquote><p>Return a fixnum representing the number of machine words in the data
portion of a bignum memory block. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-flonums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-ratnums">syslib ratnums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-bignums">syslib bignums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.4 Low level flonum operations</h3>

<p>The arguments <var>fl</var> to these operations must be flonums, the
arguments <var>fx</var> must be fixnums.  The following bindings are exported
by the <code>(ikarus system $flonums)</code> library.  <a href="#iklib-numerics">iklib numerics</a>
for more functions acting on flonums.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-flonum</b><var><a name="index-g_t_0024make_002dflonum-877"></a></var><br>
<blockquote><p>Allocate a new flonum memory block and return a reference to it.  Does
not initialise the data area. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$flonum-u8-ref</b><var> fl fx<a name="index-g_t_0024flonum_002du8_002dref-878"></a></var><br>
<blockquote><p>Return the octet at index <var>fx</var> in the data area of <var>fl</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$flonum-set!</b><var> fl fx-index fx-value<a name="index-g_t_0024flonum_002dset_0021-879"></a></var><br>
<blockquote><p>Store the byte or octet represented by <var>fx-value</var> at index
<var>fx-index</var> in the data area of <var>fl</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fixnum-&gt;flonum</b><var> fx<a name="index-g_t_0024fixnum_002d_003eflonum-880"></a></var><br>
<blockquote><p>Convert the fixnum operand into a flonum and return a reference to the
result. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fl+</b><var> fl1 fl2<a name="index-g_t_0024fl_002b-881"></a></var><br>
&mdash; Unsafe Operation: <b>$fl-</b><var> fl1 fl2<a name="index-g_t_0024fl_002d-882"></a></var><br>
&mdash; Unsafe Operation: <b>$fl*</b><var> fl1 fl2<a name="index-g_t_0024fl_002a-883"></a></var><br>
&mdash; Unsafe Operation: <b>$fl/</b><var> fl1 fl2<a name="index-g_t_0024fl_002f-884"></a></var><br>
<blockquote><p>Perform arithmetic operations. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fl=</b><var> fl1 fl2<a name="index-g_t_0024fl_003d-885"></a></var><br>
&mdash; Unsafe Operation: <b>$fl&lt;</b><var> fl1 fl2<a name="index-g_t_0024fl_003c-886"></a></var><br>
&mdash; Unsafe Operation: <b>$fl&lt;=</b><var> fl1 fl2<a name="index-g_t_0024fl_003c_003d-887"></a></var><br>
&mdash; Unsafe Operation: <b>$fl&gt;</b><var> fl1 fl2<a name="index-g_t_0024fl_003e-888"></a></var><br>
&mdash; Unsafe Operation: <b>$fl&gt;=</b><var> fl1 fl2<a name="index-g_t_0024fl_003e_003d-889"></a></var><br>
<blockquote><p>Perform comparison operations
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$flonum-sbe</b><var> fl<a name="index-g_t_0024flonum_002dsbe-890"></a></var><br>
<blockquote><p>Return a fixnum<small class="dots">...</small> Still undocumented, read the code look at the
format of <acronym>IEEE</acronym> double precision flonums. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-ratnums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-compnums">syslib compnums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-flonums">syslib flonums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.5 Low level ratnum operations</h3>

<p>The arguments <var>rat</var> to these operations must be ratnums, the
arguments <var>num</var> must be references to either fixnums or bignums. 
The following bindings are exported by the <code>(ikarus system
$ratnums)</code> library.  <a href="#iklib-numerics">iklib numerics</a> for more functions acting on
ratnums.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-ratnum</b><var> num1 num2<a name="index-g_t_0024make_002dratnum-891"></a></var><br>
<blockquote><p>Allocate a new ratnum memory block, store <var>num1</var> as reference to the
numerator and <var>num2</var> as reference to the denominator.  Return a
reference to the ratnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$ratnum-n</b><var> rat<a name="index-g_t_0024ratnum_002dn-892"></a></var><br>
<blockquote><p>Return the reference to the numerator. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$ratnum-d</b><var> rat<a name="index-g_t_0024ratnum_002dd-893"></a></var><br>
<blockquote><p>Return the reference to the denominator. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-compnums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-cflonums">syslib cflonums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-ratnums">syslib ratnums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.6 Low level compnum operations</h3>

<p>The arguments <var>cmp</var> to these operations must be compnums, the
arguments <var>num</var> must be references to either fixnums, bignums or
flonums.  The following bindings are exported by the <code>(ikarus
system $compnums)</code> library.  <a href="#iklib-numerics">iklib numerics</a> for more functions
acting on compnums.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-compnum</b><var> num1 num2<a name="index-g_t_0024make_002dcompnum-894"></a></var><br>
<blockquote><p>Allocate a new compnum memory block, store <var>num1</var> as reference to
the real part and <var>num2</var> as reference to the imaginary part. 
Return a reference to the compnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$compnum-real</b><var> cmp<a name="index-g_t_0024compnum_002dreal-895"></a></var><br>
<blockquote><p>Return the reference to the real part. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$compnum-imag</b><var> cmp<a name="index-g_t_0024compnum_002dimag-896"></a></var><br>
<blockquote><p>Return the reference to the imaginary part. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-cflonums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-chars">syslib chars</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-compnums">syslib compnums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.7 Low level cflonum operations</h3>

<p>The arguments <var>cmp</var> to these operations must be cflonums, the
arguments <var>fl</var> must be references to flonums.  The following
bindings are exported by the <code>(ikarus system $compnums)</code> library. 
<a href="#iklib-numerics">iklib numerics</a> for more functions acting on cflonums.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-cflonum</b><var> fl1 fl2<a name="index-g_t_0024make_002dcflonum-897"></a></var><br>
<blockquote><p>Allocate a new cflonum memory block, store <var>fl1</var> as reference to the
real part and <var>fl2</var> as reference to the imaginary part.  Return a
reference to the cflonum. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$cflonum-real</b><var> cmp<a name="index-g_t_0024cflonum_002dreal-898"></a></var><br>
<blockquote><p>Return the reference to the real part. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$cflonum-imag</b><var> cmp<a name="index-g_t_0024cflonum_002dimag-899"></a></var><br>
<blockquote><p>Return the reference to the imaginary part. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-chars"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-pairs">syslib pairs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-cflonums">syslib cflonums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.8 Low level character operations</h3>

<p>The arguments <var>ch</var> to these operations must be characters, the
arguments <var>fx</var> must be fixnums in the range <code>[0, #x10FFFF]</code> but
not in the range <code>[#xD800, #xDFFF]</code>.  The following bindings are
exported by the <code>(ikarus system $chars)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$char=</b><var> ch1 ch2<a name="index-g_t_0024char_003d-900"></a></var><br>
<blockquote><p>Evaluate to true if the operands are equal. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$char&lt;</b><var> ch1 ch2<a name="index-g_t_0024char_003c-901"></a></var><br>
<blockquote><p>Evaluate to true if the <var>ch1</var> is less than <var>ch2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$char&lt;=</b><var> ch1 ch2<a name="index-g_t_0024char_003c_003d-902"></a></var><br>
<blockquote><p>Evaluate to true if the <var>ch1</var> is less than or equal to <var>ch2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$char&gt;</b><var> ch1 ch2<a name="index-g_t_0024char_003e-903"></a></var><br>
<blockquote><p>Evaluate to true if the <var>ch1</var> is greater than <var>ch2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$char&gt;=</b><var> ch1 ch2<a name="index-g_t_0024char_003e_003d-904"></a></var><br>
<blockquote><p>Evaluate to true if the <var>ch1</var> is greater than or equal to
<var>ch2</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$fixnum-&gt;char</b><var> fx<a name="index-g_t_0024fixnum_002d_003echar-905"></a></var><br>
<blockquote><p>Return a new character value whose code point equals <var>fx</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$char-&gt;fixnum</b><var> ch<a name="index-g_t_0024char_002d_003efixnum-906"></a></var><br>
<blockquote><p>Return a fixnum representing the code point of the operand. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-pairs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-structs">syslib structs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-chars">syslib chars</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.9 Low level pair operations</h3>

<p>The arguments <var>P</var> to these operations must be pairs.  The following
bindings are exported by the <code>(ikarus system $pairs)</code> library. 
<a href="#objects-pairs">objects pairs</a> for details of pair representation.

<div class="defun">
&mdash; Unsafe Operation: <b>$car</b><var> P<a name="index-g_t_0024car-907"></a></var><br>
<blockquote><p>Return the car of the operand. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$cdr</b><var> P<a name="index-g_t_0024cdr-908"></a></var><br>
<blockquote><p>Return the cdr of the operand. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$set-car!</b><var> P value<a name="index-g_t_0024set_002dcar_0021-909"></a></var><br>
<blockquote><p>Store <var>value</var> in the car location of <var>P</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$set-cdr!</b><var> P value<a name="index-g_t_0024set_002dcdr_0021-910"></a></var><br>
<blockquote><p>Store <var>value</var> in the cdr location of <var>P</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-structs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-vectors">syslib vectors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-pairs">syslib pairs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.10 Low level structure operations</h3>

<p>The arguments <var>stru</var> to these operations must be references to data
structures, the arguments <var>rtd</var> must be references to structure type
descriptors, the arguments <var>fx</var> must be fixnums of appropriate
value.  The following bindings are exported by the <code>(ikarus
system $structs)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>base-rtd</b><var><a name="index-base_002drtd-911"></a></var><br>
<blockquote><p>Return a reference to the type descriptor used as type for all the type
descriptors. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$struct?</b><var> obj<a name="index-g_t_0024struct_003f-912"></a></var><br>
<blockquote><p>Evaluate to true if <var>obj</var> is the reference to a structure. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$struct/rtd?</b><var> stru rtd<a name="index-g_t_0024struct_002frtd_003f-913"></a></var><br>
<blockquote><p>Evaluate to true if <var>stru</var> is a structure of type <var>rtd</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$make-struct</b><var> rtd fx<a name="index-g_t_0024make_002dstruct-914"></a></var><br>
<blockquote><p>Allocate a new data structure of type <var>rtd</var> capable of holding
<var>fx</var> words and return a reference to it. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$struct-rtd</b><var> stru<a name="index-g_t_0024struct_002drtd-915"></a></var><br>
<blockquote><p>Return a reference to the type descriptor of <var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$struct-ref</b><var> stru fx<a name="index-g_t_0024struct_002dref-916"></a></var><br>
<blockquote><p>Return the value in the field at index <var>fx</var> of <var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$struct-set!</b><var> stru fx value<a name="index-g_t_0024struct_002dset_0021-917"></a></var><br>
<blockquote><p>Store <var>value</var> in the field at index <var>fx</var> of <var>stru</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$struct</b><var> rtd value ...<a name="index-g_t_0024struct-918"></a></var><br>
<blockquote><p>Allocate a new data structure of type <var>rtd</var> capable of holding as
many words as given <var>value</var> arguments and initialise the fields with
such values.  Return a reference to the structure. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-vectors"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-bytevectors">syslib bytevectors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-structs">syslib structs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.11 Low level vector operations</h3>

<p>The arguments <var>vec</var> to these operations must be fixnums, the
arguments <var>fx</var> must be fixnums.  The following bindings are exported
by the <code>(ikarus system $vectors)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-vector</b><var> fx<a name="index-g_t_0024make_002dvector-919"></a></var><br>
<blockquote><p>Allocate and return a new vector value of <var>fx</var> elements.

        <blockquote>
<strong>NOTE</strong> This operation does not initialise the data area, leaving
the items set to whatever is on the Scheme heap; this is bad for garbage
collection if the newly built vector is moved before the items are
initialised to correct Scheme values.  We should use the
<code>$make-clean-vector</code> operations from <code>(vicare
unsafe-operations)</code>. 
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$vector-length</b><var> vec<a name="index-g_t_0024vector_002dlength-920"></a></var><br>
<blockquote><p>Evaluate to a fixnum representing the numbe of values in <var>vec</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$vector-ref</b><var> vec fx<a name="index-g_t_0024vector_002dref-921"></a></var><br>
<blockquote><p>Return the value at index <var>fx</var> in <var>vec</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$vector-set!</b><var> vec fx value<a name="index-g_t_0024vector_002dset_0021-922"></a></var><br>
<blockquote><p>Store <var>value</var> at index <var>fx</var> in <var>vec</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-bytevectors"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-strings">syslib strings</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-vectors">syslib vectors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.12 Low level bytevector operations</h3>

<p>The arguments <var>bv</var> to these operations must be references to
bytevectors, the arguments <var>fx</var> must be fixnums in the appropriate
range, the arguments <var>fl</var> must be flonums.  The following bindings
are exported by the <code>(ikarus system $bytevectors)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-bytevector</b><var> fx<a name="index-g_t_0024make_002dbytevector-923"></a></var><br>
<blockquote><p>Allocate a new bytevector capable of holding <var>fx</var> bytes and return a
reference to it. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-length</b><var> bv<a name="index-g_t_0024bytevector_002dlength-924"></a></var><br>
<blockquote><p>Return a fixnum representing the number of bytes in the operand. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-u8-ref</b><var> bv fx<a name="index-g_t_0024bytevector_002du8_002dref-925"></a></var><br>
<blockquote><p>Return a fixnum representing the octet at offset <var>fx</var> in <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-s8-ref</b><var> bv fx<a name="index-g_t_0024bytevector_002ds8_002dref-926"></a></var><br>
<blockquote><p>Return a fixnum representing the byte at offset <var>fx</var> in <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-set!</b><var> bv fx-index fx-value<a name="index-g_t_0024bytevector_002dset_0021-927"></a></var><br>
<blockquote><p>Store the octet or byte <var>fx-value</var> at index <var>fx-index</var> of
<var>bv</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Double&ndash;precision <acronym>IEEE</acronym> flonums</h5>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-double-native-ref</b><var> bv fx<a name="index-g_t_0024bytevector_002dieee_002ddouble_002dnative_002dref-928"></a></var><br>
<blockquote><p>Return a flonum representing the value at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-double-native-set!</b><var> bv fx fl<a name="index-g_t_0024bytevector_002dieee_002ddouble_002dnative_002dset_0021-929"></a></var><br>
<blockquote><p>Store <var>fl</var> at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-double-nonnative-ref</b><var> bv fx<a name="index-g_t_0024bytevector_002dieee_002ddouble_002dnonnative_002dref-930"></a></var><br>
<blockquote><p>Return a flonum representing the value at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-double-nonnative-set!</b><var> bv fx fl<a name="index-g_t_0024bytevector_002dieee_002ddouble_002dnonnative_002dset_0021-931"></a></var><br>
<blockquote><p>Store <var>fl</var> at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Single&ndash;precision <acronym>IEEE</acronym> flonums</h5>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-single-native-ref</b><var> bv fx<a name="index-g_t_0024bytevector_002dieee_002dsingle_002dnative_002dref-932"></a></var><br>
<blockquote><p>Return a flonum representing the value at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-single-native-set!</b><var> bv fx fl<a name="index-g_t_0024bytevector_002dieee_002dsingle_002dnative_002dset_0021-933"></a></var><br>
<blockquote><p>Store <var>fl</var> at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-single-nonnative-ref</b><var> bv fx<a name="index-g_t_0024bytevector_002dieee_002dsingle_002dnonnative_002dref-934"></a></var><br>
<blockquote><p>Return a flonum representing the value at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$bytevector-ieee-single-nonnative-set!</b><var> bv fx fl<a name="index-g_t_0024bytevector_002dieee_002dsingle_002dnonnative_002dset_0021-935"></a></var><br>
<blockquote><p>Store <var>fl</var> at index <var>fx</var> of <var>bv</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-strings"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-ports">syslib ports</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-bytevectors">syslib bytevectors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.13 Low level string operations</h3>

<p>The arguments <var>str</var> to these operations must be references to
strings, the arguments <var>fx</var> must be fixnums in the appropriate
range, the arguments <var>ch</var> must be characters.  The following
bindings are exported by the <code>(ikarus system $strings)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$make-string</b><var> fx<a name="index-g_t_0024make_002dstring-936"></a></var><br>
<blockquote><p>Allocate a new string capable of holding <var>fx</var> characters and return
a reference to it. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$string-length</b><var> str<a name="index-g_t_0024string_002dlength-937"></a></var><br>
<blockquote><p>Return a fixnum representing the length of the operand. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$string-ref</b><var> str fx<a name="index-g_t_0024string_002dref-938"></a></var><br>
<blockquote><p>Return the character at offset <var>fx</var> in <var>str</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$string-set!</b><var> str fx ch<a name="index-g_t_0024string_002dset_0021-939"></a></var><br>
<blockquote><p>Store <var>ch</var> at index <var>fx</var> of <var>str</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-ports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-transcoders">syslib transcoders</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-strings">syslib strings</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.14 Low level port structures</h3>

<p>The following bindings are exported by the <code>(ikarus system $io)</code>
library.

<div class="defun">
&mdash; Function: <b>port?</b><var> obj<a name="index-port_003f-940"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is the reference to a port structure; return
false otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$make-port</b><var> attrs idx sz buf tr id read write getp setp cl cookie<a name="index-g_t_0024make_002dport-941"></a></var><br>
<blockquote><p>Allocate a new port structure, initialise its fields with the arguments,
return a reference to it. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$port-index</b><var> port<a name="index-g_t_0024port_002dindex-942"></a></var><br>
&mdash; Unsafe Operation: <b>$port-size</b><var> port<a name="index-g_t_0024port_002dsize-943"></a></var><br>
&mdash; Unsafe Operation: <b>$port-buffer</b><var> port<a name="index-g_t_0024port_002dbuffer-944"></a></var><br>
&mdash; Unsafe Operation: <b>$port-transcoder</b><var> port<a name="index-g_t_0024port_002dtranscoder-945"></a></var><br>
&mdash; Unsafe Operation: <b>$port-id</b><var> port<a name="index-g_t_0024port_002did-946"></a></var><br>
&mdash; Unsafe Operation: <b>$port-read!</b><var> port<a name="index-g_t_0024port_002dread_0021-947"></a></var><br>
&mdash; Unsafe Operation: <b>$port-write!</b><var> port<a name="index-g_t_0024port_002dwrite_0021-948"></a></var><br>
&mdash; Unsafe Operation: <b>$port-get-position</b><var> port<a name="index-g_t_0024port_002dget_002dposition-949"></a></var><br>
&mdash; Unsafe Operation: <b>$port-set-position!</b><var> port<a name="index-g_t_0024port_002dset_002dposition_0021-950"></a></var><br>
&mdash; Unsafe Operation: <b>$port-close</b><var> port<a name="index-g_t_0024port_002dclose-951"></a></var><br>
&mdash; Unsafe Operation: <b>$port-cookie</b><var> port<a name="index-g_t_0024port_002dcookie-952"></a></var><br>
<blockquote><p>Accessors for the fields of a port structure. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$port-attrs</b><var> port<a name="index-g_t_0024port_002dattrs-953"></a></var><br>
<blockquote><p>Given a port value: return a fixnum representing the port attributes. 
</p></blockquote></div>

<div class="defun">
&mdash; Safe Operation: <b>$port-tag</b><var> port<a name="index-g_t_0024port_002dtag-954"></a></var><br>
<blockquote><p>Extract from a port reference a fixnum representing the port attributes;
if the argument is not a port reference the return value is zero. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$set-port-index!</b><var> port new-index<a name="index-g_t_0024set_002dport_002dindex_0021-955"></a></var><br>
<blockquote><p>Mutator for the buffer index field. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$set-port-size!</b><var> port new-used-size<a name="index-g_t_0024set_002dport_002dsize_0021-956"></a></var><br>
<blockquote><p>Mutator for the buffer used size field. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$set-port-attrs!</b><var> port new-attrs<a name="index-g_t_0024set_002dport_002dattrs_0021-957"></a></var><br>
<blockquote><p>Mutator for the port attributes. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-transcoders"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#syslib-pointers">syslib pointers</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-ports">syslib ports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.15 Low level transcoder operations</h3>

<p>The arguments <var>tran</var> to these operations must be transcoders, the
arguments <var>fx</var> must be fixnums in the appropriate range.  The
following bindings are exported by the <code>(ikarus system
$transcoders)</code> library.

<div class="defun">
&mdash; Unsafe Operation: <b>$data-&gt;transcoder</b><var> fx<a name="index-g_t_0024data_002d_003etranscoder-958"></a></var><br>
<blockquote><p>Encode <var>fx</var> as payload bits of a transcoder word and return the
resulting transcoder. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$transcoder-&gt;data</b><var> tran<a name="index-g_t_0024transcoder_002d_003edata-959"></a></var><br>
<blockquote><p>Extract the payload bits from a transcoder and return them as fixnum. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="syslib-pointers"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib-transcoders">syslib transcoders</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#syslib">syslib</a>

</div>

<h3 class="section">8.16 Low level pointer operations</h3>

<p>In the following definitions the <var>ptr</var> arguments must be pointer
objects.

<div class="defun">
&mdash; Primitive Operation: <b>$pointer?</b><var> obj<a name="index-g_t_0024pointer_003f-960"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>obj</var> is a reference to a pointer memory block,
else return <code>#f</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Unsafe Operation: <b>$pointer=</b><var> ptr1 ptr2<a name="index-g_t_0024pointer_003d-961"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>ptr1</var> and <var>ptr2</var> are equal, else return
<code>#f</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#gcc">gcc</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#syslib">syslib</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">9 C language programming interface</h2>

<p>The executable <samp><span class="command">vicare</span></samp> defines a number of C language
functions that can be invoked by compiled code to access various
services, both to handle startup and to access the operating system.

   <p>When on a <acronym>GNU</acronym>+Linux system: the Linux specific functions are
available; when on other systems: calling such functions will terminate
the process.

<ul class="menu">
<li><a accesskey="1" href="#capi-ffi">capi ffi</a>:                     C language level <acronym>FFI</acronym>. 
<li><a accesskey="2" href="#capi-posix">capi posix</a>:                   C language level <acronym>POSIX</acronym> interface. 
<li><a accesskey="3" href="#capi-linux">capi linux</a>:                   C language level <acronym>GNU</acronym>+Linux interface. 
<li><a accesskey="4" href="#capi-glibc">capi glibc</a>:                   C language level <acronym>GNU</acronym> C Library
                                interface. 
</ul>

<!-- page -->
<div class="node">
<a name="capi-ffi"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix">capi posix</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi">capi</a>

</div>

<h3 class="section">9.1 C language level <acronym>FFI</acronym></h3>

<ul class="menu">
<li><a accesskey="1" href="#capi-ffi-accessors">capi ffi accessors</a>:           Raw memory accessors. 
<li><a accesskey="2" href="#capi-ffi-mutators">capi ffi mutators</a>:            Raw memory mutators. 
</ul>

<!-- page -->
<div class="node">
<a name="capi-ffi-accessors"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-ffi-mutators">capi ffi mutators</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-ffi">capi ffi</a>

</div>

<h4 class="subsection">9.1.1 Raw memory accessors</h4>

<h5 class="subsubheading">Bit&ndash;sized values</h5>

<p>In all the following definitions: <var>pointer</var> must be a pointer
object, <var>offset</var> must be an exact integer.

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_uint8</b> (<var>ikptr pointer, ikptr offset</var>)<var><a name="index-ikrt_005fref_005fuint8-962"></a></var><br>
<blockquote><p>Extract and return the 8-bit unsigned integer at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_sint8</b> (<var>ikptr pointer, ikptr offset</var>)<var><a name="index-ikrt_005fref_005fsint8-963"></a></var><br>
<blockquote><p>Extract and return the 8-bit signed integer at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_uint16</b> (<var>ikptr pointer, ikptr offset</var>)<var><a name="index-ikrt_005fref_005fuint16-964"></a></var><br>
<blockquote><p>Extract and return the 16-bit unsigned integer at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_sint16</b> (<var>ikptr pointer, ikptr offset</var>)<var><a name="index-ikrt_005fref_005fsint16-965"></a></var><br>
<blockquote><p>Extract and return the 16-bit signed integer at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_uint32</b> (<var>ikptr pointer, ikptr offset, ikpcb * pcb</var>)<var><a name="index-ikrt_005fref_005fuint32-966"></a></var><br>
<blockquote><p>Extract and return the 32-bit unsigned integer at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_sint32</b> (<var>ikptr pointer, ikptr offset, ikpcb * pcb</var>)<var><a name="index-ikrt_005fref_005fsint32-967"></a></var><br>
<blockquote><p>Extract and return the 32-bit signed integer at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_uint64</b> (<var>ikptr pointer, ikptr offset, ikpcb * pcb</var>)<var><a name="index-ikrt_005fref_005fuint64-968"></a></var><br>
<blockquote><p>Extract and return the 64-bit unsigned integer at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_sint64</b> (<var>ikptr pointer, ikptr offset, ikpcb * pcb</var>)<var><a name="index-ikrt_005fref_005fsint64-969"></a></var><br>
<blockquote><p>Extract and return the 64-bit signed integer at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">C language integer type&ndash;sized values</h5>

<p>In all the following definitions: <var>pointer</var> must be a pointer
object, <var>offset</var> must be an exact integer.

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_char</b> (<var>ikptr pointer, ikptr offset</var>)<var><a name="index-ikrt_005fref_005fchar-970"></a></var><br>
<blockquote><p>Extract and return the exact integer representation of the C language
<code>signed char</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_uchar</b> (<var>ikptr pointer, ikptr offset</var>)<var><a name="index-ikrt_005fref_005fuchar-971"></a></var><br>
<blockquote><p>Extract and return the exact integer representation of the C language
<code>unsigned char</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_short</b> (<var>ikptr pointer, ikptr offset</var>)<var><a name="index-ikrt_005fref_005fshort-972"></a></var><br>
<blockquote><p>Extract and return the exact integer representation of the C language
<code>signed short int</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_ushort</b> (<var>ikptr pointer, ikptr offset</var>)<var><a name="index-ikrt_005fref_005fushort-973"></a></var><br>
<blockquote><p>Extract and return the exact integer representation of the C language
<code>unsigned short int</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_long</b> (<var>ikptr pointer, ikptr offset</var>)<var><a name="index-ikrt_005fref_005flong-974"></a></var><br>
<blockquote><p>Extract and return the exact integer representation of the C language
<code>signed long</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_ulong</b> (<var>ikptr pointer, ikptr offset</var>)<var><a name="index-ikrt_005fref_005fulong-975"></a></var><br>
<blockquote><p>Extract and return the exact integer representation of the C language
<code>unsigned long</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_longlong</b> (<var>ikptr pointer, ikptr offset</var>)<var><a name="index-ikrt_005fref_005flonglong-976"></a></var><br>
<blockquote><p>Extract and return the exact integer representation of the C language
<code>signed long long</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_ulonglong</b> (<var>ikptr pointer, ikptr offset</var>)<var><a name="index-ikrt_005fref_005fulonglong-977"></a></var><br>
<blockquote><p>Extract and return the exact integer representation of the C language
<code>unsigned long long</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Other C language type&ndash;sized values</h5>

<p>In all the following definitions: <var>pointer</var> must be a pointer
object, <var>offset</var> must be an exact integer.

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_float</b> (<var>ikptr pointer, ikptr offset</var>)<var><a name="index-ikrt_005fref_005ffloat-978"></a></var><br>
<blockquote><p>Extract and return the flonum representation of the C language
<code>float</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_double</b> (<var>ikptr pointer, ikptr offset</var>)<var><a name="index-ikrt_005fref_005fdouble-979"></a></var><br>
<blockquote><p>Extract and return the flonum representation of the C language
<code>double</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_ref_pointer</b> (<var>ikptr pointer, ikptr offset</var>)<var><a name="index-ikrt_005fref_005fpointer-980"></a></var><br>
<blockquote><p>Extract and return the pointer representation of the C language
<code>void *</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-ffi-mutators"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-ffi-accessors">capi ffi accessors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-ffi">capi ffi</a>

</div>

<h4 class="subsection">9.1.2 Raw memory mutators</h4>

<h5 class="subsubheading">Bit&ndash;sized values</h5>

<p>In all the following definitions: <var>pointer</var> must be a pointer
object, <var>offset</var> and <var>value</var> must be an exact integers.

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_uint8</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fuint8-981"></a></var><br>
<blockquote><p>Store the 8-bit unsigned integer <var>value</var> at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_sint8</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fsint8-982"></a></var><br>
<blockquote><p>Store the 8-bit signed integer <var>value</var> at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_uint16</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fuint16-983"></a></var><br>
<blockquote><p>Store the 16-bit unsigned integer <var>value</var> at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_sint16</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fsint16-984"></a></var><br>
<blockquote><p>Store the 16-bit signed integer <var>value</var> at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_uint32</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fuint32-985"></a></var><br>
<blockquote><p>Store the 32-bit unsigned integer <var>value</var> at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_sint32</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fsint32-986"></a></var><br>
<blockquote><p>Store the 32-bit signed integer <var>value</var> at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_uint64</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fuint64-987"></a></var><br>
<blockquote><p>Store the 64-bit unsigned integer <var>value</var> at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_sint64</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fsint64-988"></a></var><br>
<blockquote><p>Store the 64-bit signed integer <var>value</var> at <var>offset</var> from
<var>pointer</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">C language integer type&ndash;sized values</h5>

<p>In all the following definitions: <var>pointer</var> must be a pointer
object, <var>offset</var> and <var>value</var> must be an exact integers.

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_char</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fchar-989"></a></var><br>
<blockquote><p>Store the exact integer <var>value</var> representing a C language
<code>signed char</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_uchar</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fuchar-990"></a></var><br>
<blockquote><p>Store the exact integer <var>value</var> representing a C language
<code>unsigned char</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_short</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fshort-991"></a></var><br>
<blockquote><p>Store the exact integer <var>value</var> representing a C language
<code>signed short int</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_ushort</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fushort-992"></a></var><br>
<blockquote><p>Store the exact integer <var>value</var> representing a C language
<code>unsigned short int</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_int</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fint-993"></a></var><br>
<blockquote><p>Store the exact integer <var>value</var> representing a C language
<code>signed int</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_uint</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fuint-994"></a></var><br>
<blockquote><p>Store the exact integer <var>value</var> representing a C language
<code>unsigned int</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_long</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005flong-995"></a></var><br>
<blockquote><p>Store the exact integer <var>value</var> representing a C language
<code>signed long</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_ulong</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fulong-996"></a></var><br>
<blockquote><p>Store the exact integer <var>value</var> representing a C language
<code>unsigned long</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_longlong</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005flonglong-997"></a></var><br>
<blockquote><p>Store the exact integer <var>value</var> representing a C language
<code>signed long long</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_ulonglong</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fulonglong-998"></a></var><br>
<blockquote><p>Store the exact integer <var>value</var> representing a C language
<code>unsigned long long</code> value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Other C language type&ndash;sized values</h5>

<p>In all the following definitions: <var>pointer</var> must be a pointer
object, <var>offset</var> must be an exact integer.

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_float</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005ffloat-999"></a></var><br>
<blockquote><p>Store the flonum <var>value</var> representing a C language <code>float</code>
value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_double</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fdouble-1000"></a></var><br>
<blockquote><p>Store the flonum <var>value</var> representing a C language <code>double</code>
value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_pointer</b> (<var>ikptr pointer, ikptr offset, ikptr value</var>)<var><a name="index-ikrt_005fset_005fpointer-1001"></a></var><br>
<blockquote><p>Store the pointer <var>value</var> representing a C language <code>void *</code>
value at <var>offset</var> from <var>pointer</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-linux">capi linux</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-ffi">capi ffi</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi">capi</a>

</div>

<h3 class="section">9.2 C language level <acronym>POSIX</acronym> interface</h3>

<p>Several files are involved in the full implementation of the <acronym>POSIX</acronym>
interface:

<pre class="example">     src/ikarus-posix.c
     lib/vicare/unsafe-capi.sls
     scheme/ikarus.posix.sls
     scheme/makefile.sps
     tests/test-vicare-posix.sps
</pre>
   <p>File pathnames are bytevectors at the C language level and strings at
the Scheme language level; the conversion is performed with the function
in the parameter <code>string-&gt;filename-func</code>.

   <p>The authoritative documentation for all the interface functions is the
one of the C library on the platform's operating system; this file gives
only a brief overview of the features and explains the Scheme
adaptation.

<ul class="menu">
<li><a accesskey="1" href="#capi-posix-adding">capi posix adding</a>:            How to add a <acronym>POSIX</acronym> primitive. 
<li><a accesskey="2" href="#capi-posix-errno">capi posix errno</a>:             Handling <code>errno</code> codes. 
<li><a accesskey="3" href="#capi-posix-env">capi posix env</a>:               Operating system environment variables. 
<li><a accesskey="4" href="#capi-posix-port">capi posix port</a>:              File descriptors and Scheme ports. 
<li><a accesskey="5" href="#capi-posix-pid">capi posix pid</a>:               Process identifier functions. 
<li><a accesskey="6" href="#capi-posix-process">capi posix process</a>:           Forking and executing processes. 
<li><a accesskey="7" href="#capi-posix-status">capi posix status</a>:            Process termination status. 
<li><a accesskey="8" href="#capi-posix-signals">capi posix signals</a>:           Delivering interprocess signals. 
<li><a accesskey="9" href="#capi-posix-stat">capi posix stat</a>:              File system inspection. 
<li><a href="#capi-posix-file">capi posix file</a>:              File system interface. 
<li><a href="#capi-posix-link">capi posix link</a>:              Hard and symbolic links. 
<li><a href="#capi-posix-dir">capi posix dir</a>:               File system directories. 
<li><a href="#capi-posix-fd">capi posix fd</a>:                File descriptors at low level. 
<li><a href="#capi-posix-socket">capi posix socket</a>:            Network sockets. 
<li><a href="#capi-posix-users">capi posix users</a>:             Users and groups. 
<li><a href="#capi-posix-job">capi posix job</a>:               Job control. 
<li><a href="#capi-posix-time">capi posix time</a>:              Time and date. 
</ul>

<!-- page -->
<div class="node">
<a name="capi-posix-adding"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-errno">capi posix errno</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.1 How to add a <acronym>POSIX</acronym> primitive</h4>

<p>We must remember that the <acronym>POSIX</acronym> primitives end up exported by both
the <code>(vicare)</code> and <code>(ikarus)</code> libraries; following the
example of the <code>getpid()</code> function, to add a <acronym>POSIX</acronym> primitive we
should follow these steps:

     <ol type=1 start=1>
<li>In the file <samp><span class="file">src/ikarus-posix.c</span></samp> add the primitive C language
function:

     <pre class="example">          ikptr
          ikrt_posix_getpid(void)
          {
            int   retval = getpid();
            return fix(retval);
          }
</pre>
     <li>In the file <samp><span class="file">lib/vicare/unsafe-capi.sls</span></samp> add the following macro
definition to the library:

     <pre class="example">          (define-inline (posix-getpid)
            (foreign-call "ikrt_posix_getpid"))
</pre>
     <p class="noindent">and add the binding to the export list.

     <li>In the file <samp><span class="file">scheme/ikarus.posix.sls</span></samp>: add the binding to both the
export list of the library and to the <code>except</code> import list from
<code>(ikarus)</code>; add the function implementation calling a syntax
associated to the foreign function:

     <pre class="example">          (define (getpid)
            (posix-getpid))
</pre>
     <li>In the file <samp><span class="file">scheme/makefile.sps</span></samp>: add an entry for the function to
the list bound to <code>identifier-&gt;library-map</code> to have the function
exported by <code>(ikarus)</code> and <code>(vicare)</code>:

     <pre class="example">          (getpid         i v)
</pre>
     <li>In the file <samp><span class="file">tests/test-vicare-posix.sps</span></samp> add test cases for the
function.
        </ol>

<!-- page -->
<div class="node">
<a name="capi-posix-errno"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-env">capi posix env</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-adding">capi posix adding</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.2 Handling <code>errno</code> codes</h4>

<p>Vicare makes use of the platform's own <code>errno</code> codes; they
are negated to make them different from file descriptors, and so
distinguishable when used as single return values from C functions, and
converted to fixnums.  Example: if the C language code for <code>EPERM</code>
is the integer <code>1</code>, the corresponding Scheme language value is the
fixnum <code>-1</code>.

<div class="defun">
&mdash; Function: ikptr <b>ik_errno_to_code</b> (<var>void</var>)<var><a name="index-ik_005ferrno_005fto_005fcode-1002"></a></var><br>
<blockquote><p>Negate the current <code>errno</code> value and convert the result into a
fixnum, return the fixnum.  When an error occurs: many functions call
this function and return its return value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_strerror</b> (<var>ikptr ec, ikpcb * pcb</var>)<var><a name="index-ikrt_005fstrerror-1003"></a></var><br>
<blockquote><p>Interface to the C function <code>strerror()</code>, <a href="libc.html#Error-Messages">strerror</a>.  Convert a fixnum representing an encoded <code>errno</code> code
into a bytevector holding the string message which describes it; return
a reference to the bytevector; if <var>ec</var> is invalid: return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_last_errno</b> (<var>ikpcb * pcb</var>)<var><a name="index-ikrt_005flast_005ferrno-1004"></a></var><br>
<blockquote><p>Return a fixnum representing the negated value of <code>errno</code> right
after the last call to a foreign function through the <acronym>FFI</acronym>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-env"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-port">capi posix port</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-errno">capi posix errno</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.3 Accessing environment variables</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getenv</b> (<var>ikptr variable, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetenv-1005"></a></var><br>
<blockquote><p>Interface to the C function <code>getenv()</code>, <a href="libc.html#Environment-Access">getenv</a>.  Retrieve the value of environment variables. 
<var>variable</var> must reference a bytevector object representing the name
of the environment variable.  If the environment variable is set: return
a bytevector representing its value; else return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_setenv</b> (<var>ikptr variable, ikptr value, ikptr overwrite</var>)<var><a name="index-ikrt_005fposix_005fsetenv-1006"></a></var><br>
<blockquote><p>Interface to the C function <code>setenv()</code>, <a href="libc.html#Environment-Access">setenv</a>.  Set a new value for an environment variable.

        <p><var>variable</var> must reference a bytevector object representing the name
of the environment variable; <var>value</var> must reference a bytevector
object representing the new value.  If <var>overwrite</var> is
<code>false_object</code> and the environment variable already exists: the
environment variable is left untouched; else the new value is set,
either creating a new environment variable or replacing the old value.

        <p>If successful return <code>true_object</code>; if an error occurs in
<code>setenv()</code> return <code>false_object</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_unsetenv</b> (<var>ikptr variable</var>)<var><a name="index-ikrt_005fposix_005funsetenv-1007"></a></var><br>
<blockquote><p>Interface to the C function <code>unsetenv()</code>, <a href="libc.html#Environment-Access">unsetenv</a>.  Unset an environment variable.  <var>variable</var> must
reference a bytevector object representing the name of the environment
variable.  Return true if <var>variable</var> has the correct format, else
return false; there is no way to know if a variable was actually unset. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_environ</b> (<var>ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fenviron-1008"></a></var><br>
<blockquote><p>Interface to the global C variable <code>environ</code>, <a href="libc.html#Environment-Access">unsetenv</a>.  Retrieve the full environment.  Return a list of
bytevectors representing the contents of the <code>environ</code> array; if
the environment is empty (no environment variables set) return nil. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-port"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-pid">capi posix pid</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-env">capi posix env</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.4 File descriptors and Scheme ports</h4>

<ul class="menu">
<li><a accesskey="1" href="#capi-posix-port-open">capi posix port open</a>:         Opening and closing file descriptors. 
<li><a accesskey="2" href="#capi-posix-port-seek">capi posix port seek</a>:         Handling file descriptor cursor. 
<li><a accesskey="3" href="#capi-posix-port-rw">capi posix port rw</a>:           Reading and writing. 
<li><a accesskey="4" href="#capi-posix-port-event">capi posix port event</a>:        Handling file descriptor events. 
<li><a accesskey="5" href="#capi-posix-port-net">capi posix port net</a>:          Handling sockets. 
</ul>

<!-- page -->
<div class="node">
<a name="capi-posix-port-open"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-port-seek">capi posix port seek</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix-port">capi posix port</a>

</div>

<h5 class="subsubsection">9.2.4.1 Opening and closing file descriptors</h5>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_close_fd</b> (<var>ikptr fd</var>)<var><a name="index-ikrt_005fclose_005ffd-1009"></a></var><br>
<blockquote><p>Interface to the <code>close()</code> C function.  <a href="libc.html#Opening-and-Closing-Files">close</a>.  Close a file descriptor.

        <p><var>fd</var> must be a fixnum representing a file descriptor.

        <p>If successful return <code>false_object</code>; if an error occurs in
<code>close()</code> return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_open_input_fd</b> (<var>ikptr pathname</var>)<var><a name="index-ikrt_005fopen_005finput_005ffd-1010"></a></var><br>
<blockquote><p>Interface to the <code>open()</code> C function.  <a href="libc.html#Opening-and-Closing-Files">open</a>.  Open a file for reading, using open mode <code>O_RDONLY</code>.

        <p><var>pathname</var> must reference a bytevector object holding the file
pathname.

        <p>If successful return a fixnum representing the file descriptor; if an
error occurs in <code>open()</code> return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_open_output_fd</b> (<var>ikptr pathname, ikptr opts</var>)<var><a name="index-ikrt_005fopen_005foutput_005ffd-1011"></a></var><br>
<blockquote><p>Interface to the <code>open()</code> C function.  <a href="libc.html#Opening-and-Closing-Files">open</a>.  Open a file for writing with configurable mode based on
<code>O_WRONLY</code>; the access permissions when a new file is created are
<code>S_IRUSR | S_IWUSR | S_IRGRP | S_IROTH</code>.

        <p><var>pathname</var> must reference a bytevector object holding the file
pathname; <var>opts</var> must be a fixnum with the following encoding:

          <dl>
<dt><code>0</code><dd>The open mode is <code>O_WRONLY | O_CREAT | O_EXCL</code>.

          <br><dt><code>1</code><dd>The open mode is <code>O_WRONLY | O_TRUNC</code>.

          <br><dt><code>2</code><dd>The open mode is <code>O_WRONLY | O_TRUNC | O_CREAT</code>.

          <br><dt><code>3</code><dd>The open mode is <code>O_WRONLY | O_TRUNC</code>.

          <br><dt><code>4</code><dd>The open mode is <code>O_WRONLY | O_CREAT | O_EXCL</code>.

          <br><dt><code>5</code><dd>The open mode is <code>O_WRONLY | O_CREAT</code>.

          <br><dt><code>6</code><dd>The open mode is <code>O_WRONLY | O_CREAT</code>.

          <br><dt><code>7</code><dd>The open mode is <code>O_WRONLY</code>. 
</dl>

        <p>If successful return a fixnum representing the file descriptor; if an
error occurs in <code>open()</code> return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_open_input_output_fd</b> (<var>ikptr pathname, ikptr opts</var>)<var><a name="index-ikrt_005fopen_005finput_005foutput_005ffd-1012"></a></var><br>
<blockquote><p>Interface to the <code>open()</code> C function.  <a href="libc.html#Opening-and-Closing-Files">open</a>.  Open a file for reading and writing with configurable
mode based on <code>O_RDWR</code>; the access permissions when a new file is
created are <code>S_IRUSR | S_IWUSR | S_IRGRP | S_IROTH</code>.

        <p><var>pathname</var> must reference a bytevector object holding the file
pathname; <var>opts</var> must be a fixnum representing the opening flags, it
has the same format of the <var>opts</var> argument to
<code>ikrt_open_output_fd</code>.

        <p>If successful return a fixnum representing the file descriptor; if an
error occurs in <code>open()</code> return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-port-seek"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-port-rw">capi posix port rw</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-port-open">capi posix port open</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix-port">capi posix port</a>

</div>

<h5 class="subsubsection">9.2.4.2 Handling file descriptor cursor</h5>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_set_position</b> (<var>ikptr fd, ikptr pos</var>)<var><a name="index-ikrt_005fset_005fposition-1013"></a></var><br>
<blockquote><p>Interface to the <code>lseek()</code> C function.  <a href="libc.html#File-Position-Primitive">lseek</a>.  Set the cursor position.

        <p><var>fd</var> must be a fixnum representing a file descriptor; <var>pos</var> must
be an exact integer in the range of the <code>off_t</code> platform type.

        <p>If successful return <code>false_object</code>; if an error occurs in
<code>lseek()</code> return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-port-rw"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-port-event">capi posix port event</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-port-seek">capi posix port seek</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix-port">capi posix port</a>

</div>

<h5 class="subsubsection">9.2.4.3 Reading and writing</h5>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_read_fd</b> (<var>ikptr fd, ikptr buffer, ikptr buffer-start, ikptr size</var>)<var><a name="index-ikrt_005fread_005ffd-1014"></a></var><br>
<blockquote><p>Interface to the <code>read()</code> C function.  <a href="libc.html#Input-and-Output-Primitives">read</a>.  Read data from a file descriptor.

        <p><var>fd</var> must be a fixnum representing a file descriptor; <var>buffer</var>
must reference a bytevector object in which the data will be stored;
<var>buffer-start</var> must be a fixnum representing the offset in the
buffer at which data will be written; <var>size</var> must be a fixnum
representing the number of bytes to read.

        <p>If successful return a fixnum representing the number of bytes actually
read and stored in the buffer; if an error occurs in <code>read()</code> return
the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_write_fd</b> (<var>ikptr fd, ikptr buffer, ikptr buffer-start, ikptr size</var>)<var><a name="index-ikrt_005fwrite_005ffd-1015"></a></var><br>
<blockquote><p>Interface to the <code>write()</code> C function.  <a href="libc.html#Input-and-Output-Primitives">write</a>.  Write data to a file descriptor.

        <p><var>fd</var> must be a fixnum representing a file descriptor; <var>buffer</var>
must reference a bytevector object from which the data will be read;
<var>buffer-start</var> must be a fixnum representing the offset in the
buffer from which data will be read; <var>size</var> must be a fixnum
representing the number of bytes to write.

        <p>If successful return a fixnum representing the number of bytes actually
written; if an error occurs in <code>write()</code> return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-port-event"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-port-net">capi posix port net</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-port-rw">capi posix port rw</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix-port">capi posix port</a>

</div>

<h5 class="subsubsection">9.2.4.4 Handling file descriptor events</h5>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_select</b> (<var>ikptr max-fd, ikptr rfds, ikptr wfds, ikptr xfds</var>)<var><a name="index-ikrt_005fselect-1016"></a></var><br>
<blockquote><p>Interface to the <code>select()</code> C function.  <a href="libc.html#Waiting-for-I_002fO">select</a>.  Poll for events on sets of file descriptors, without timeout.

        <p><var>max-fd</var> must be a fixnum representing the maximum file descriptor
for which to wait for events; <var>rfds</var>, <var>wfds</var> and <var>xfds</var> must
reference bytevectors holding <code>fd_set</code> data structures.

        <p>If successful return a fixnum representing the return value from
<code>select()</code>; if an error occurs in <code>select()</code> return the return
value of <code>ik_errno_to_code()</code>.  Notice that if the call is
interrupted by a signal, so it returns with <code>EINTR</code>, the function
returns with error without reattempting the call. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_make_fd_nonblocking</b> (<var>ikptr fd</var>)<var><a name="index-ikrt_005fmake_005ffd_005fnonblocking-1017"></a></var><br>
<blockquote><p>Interface to the <code>fcntl()</code> C function.  <a href="libc.html#Control-Operations">fcntl</a>.  Set non&ndash;blocking mode for a file descriptor.

        <p><var>fd</var> must be a fixnum representing the file descriptor.

        <p>If successful return the raw C language <code>NULL</code> pointer; if an error
occurs in <code>fcntl()</code> return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-port-net"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-port-event">capi posix port event</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix-port">capi posix port</a>

</div>

<h5 class="subsubsection">9.2.4.5 Handling sockets</h5>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_tcp_connect</b> (<var>ikptr host, ikptr srvc</var>)<var><a name="index-ikrt_005ftcp_005fconnect-1018"></a></var><br>
&mdash; Function: ikptr <b>ikrt_ucp_connect</b> (<var>ikptr host, ikptr srvc</var>)<var><a name="index-ikrt_005fucp_005fconnect-1019"></a></var><br>
<blockquote><p>Interface to the <code>getaddrinfo()</code>, <code>socket()</code> and <code>connect()</code>
C functions.  <a href="libc.html#Sockets">Sockets</a>.  Establish a client
connection to a remote server using the <code>SOCK_STREAM</code> or
<code>SOCK_DGRAM</code> style.

        <p><var>host</var> must reference a bytevector holding the remote server
hostname; <var>srvc</var> must reference a bytevector holding the service
specification.

        <p>If successful return a fixnum representing the socket; if an error
occurs resolving the host name and address, return <code>false_object</code>;
if an error occurs in one of the C function calls, return the return
value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_listen</b> (<var>ikptr port-number</var>)<var><a name="index-ikrt_005flisten-1020"></a></var><br>
<blockquote><p>Interface to the <code>socket()</code>, <code>bind()</code>, <code>listen()</code> and
<code>setsockopt()</code> C functions.  <a href="libc.html#Sockets">Sockets</a>.  Create a
server socket bound to the given port number for the local host, using
the <code>AF_INET</code> namespace and the <code>SOCK_STREAM</code> style; the
option <code>SO_REUSEADDR</code> is set for the server socket; at most
1024 concurrent connections to the socket will be enqueued.

        <p><var>port-number</var> must be a fixnum representing the port number to use.

        <p>If successful return a fixnum representing the server socket; if an
error occurs in one of the C function calls, return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_accept</b> (<var>ikptr sock, ikptr sockaddr</var>)<var><a name="index-ikrt_005faccept-1021"></a></var><br>
<blockquote><p>Interface to the <code>accept()</code> C function.  <a href="libc.html#Accepting-Connections">accept</a>.  Accept a connection to a server socket.

        <p><var>sock</var> must be a fixnum representing the server socket;
<var>sockaddr</var> must reference a bytevector object which will hold the
<code>struct sockaddr</code> describing the client's address.

        <p>If successful return a fixnum representing the client socket and fill
<var>sockaddr</var> with the client address; if an error occurs in
<code>accept()</code>, return the return value of <code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_shutdown</b> (<var>ikptr sock</var>)<var><a name="index-ikrt_005fshutdown-1022"></a></var><br>
<blockquote><p>Interface to the <code>shutdown()</code> C function.  <a href="libc.html#Closing-a-Socket">shutdown</a>.  Close a socket for both reading and writing.

        <p><var>sock</var> must be a fixnum representing the socket.

        <p>If successful return the raw C language <code>NULL</code> pointer; if an error
occurs in <code>shutdown()</code>, return the return value of
<code>ik_errno_to_code()</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-pid"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-process">capi posix process</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-port">capi posix port</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.5 Process identifier functions</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getpid</b> (<var>void</var>)<var><a name="index-ikrt_005fposix_005fgetpid-1023"></a></var><br>
<blockquote><p>Return the process identifier as fixnum.  <a href="libc.html#Process-Identification">getpid</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getppid</b> (<var>void</var>)<var><a name="index-ikrt_005fposix_005fgetppid-1024"></a></var><br>
<blockquote><p>Return the parent process identifier as fixnum.  <a href="libc.html#Process-Identification">getpid</a>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-process"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-status">capi posix status</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-pid">capi posix pid</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.6 Forking and executing processes</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_system</b> (<var>ikptr command</var>)<var><a name="index-ikrt_005fposix_005fsystem-1025"></a></var><br>
<blockquote><p>Interface to the C function <code>system()</code>, <a href="libc.html#Running-a-Command">system</a>.  Execute a command through the system shell; <var>command</var> must
reference a bytevector object holding the command to execute.  If
successful return the termination status of the executed process,
<a href="#capi-posix-status">capi posix status</a> for details; if an error occurs: return an
encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_fork</b> (<var>void</var>)<var><a name="index-ikrt_005fposix_005ffork-1026"></a></var><br>
<blockquote><p>Interface to the C function <code>fork()</code>, <a href="libc.html#Creating-a-Process">fork</a>.  Create a new process by forking the current; if successful
return a non&ndash;negative fixnum representing the the return value of
<code>fork()</code>; if an error occurs: return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_execv</b> (<var>ikptr filename, ikptr argv</var>)<var><a name="index-ikrt_005fposix_005fexecv-1027"></a></var><br>
<blockquote><p>Interface to the C function <code>execv()</code>, <a href="libc.html#Executing-a-File">execv</a>.  <var>filename</var> must be a bytevector representing the pathname
of an executable file; <var>argv</var> must be a list of bytevectors
representing command line arguments.  Execute the command; if the
function returns: an error has occurred, return an encoded <code>errno</code>
value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_execve</b> (<var>ikptr filename, ikptr argv, ikptr env</var>)<var><a name="index-ikrt_005fposix_005fexecve-1028"></a></var><br>
<blockquote><p>Interface to the C function <code>execve()</code>, <a href="libc.html#Executing-a-File">execve</a>.  <var>filename</var> must be a bytevector representing the pathname
of an executable file; <var>argv</var> must be a list of bytevectors
representing command line arguments; <var>env</var> must be a list of
bytevectors representing environment variables assignments.  Execute the
command; if the function returns: an error has occurred, return an
encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_execvp</b> (<var>ikptr filename, ikptr argv</var>)<var><a name="index-ikrt_005fposix_005fexecvp-1029"></a></var><br>
<blockquote><p>Interface to the C function <code>execvp()</code>, <a href="libc.html#Executing-a-File">execvp</a>.  <var>filename</var> must be a bytevector representing the file name
of an executable file reachable in the current <samp><span class="env">PATH</span></samp>; <var>argv</var>
must be a list of bytevectors representing command line arguments. 
Execute the command; if the function returns: an error has occurred,
return an encoded <code>errno</code> value. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-status"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-signals">capi posix signals</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-process">capi posix process</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.7 Process termination status</h4>

<p>The following functions accept as argument a fixnum representing the
process termination status, for example the return value of
<code>system()</code> or the status acquired by <code>waitpid()</code>.

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_waitpid</b> (<var>ikptr pid, ikptr options</var>)<var><a name="index-ikrt_005fposix_005fwaitpid-1030"></a></var><br>
<blockquote><p>Interface to the C function <code>waitpid()</code>, <a href="libc.html#Process-Completion">waitpid</a>.  Request status informations on a process or group
of processes knowing the identifier.  If successful return a fixnum
representing the status; if an error occurs: return an encoded
<code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_wait</b> (<var>void</var>)<var><a name="index-ikrt_005fposix_005fwait-1031"></a></var><br>
<blockquote><p>Interface to the C function <code>wait()</code>, <a href="libc.html#Process-Completion">wait</a>.  Request status informations on any process or group of
processes.  If successful return a fixnum representing the status; if an
error occurs: return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_WIFEXITED</b> (<var>ikptr status</var>)<var><a name="index-ikrt_005fposix_005fWIFEXITED-1032"></a></var><br>
<blockquote><p>Interface to the C macro <code>WIFEXITED()</code>, <a href="libc.html#Process-Completion-Status">WIFEXITED</a>.  Return true if the process terminated normally with
<code>exit()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_WEXITSTATUS</b> (<var>ikptr status</var>)<var><a name="index-ikrt_005fposix_005fWEXITSTATUS-1033"></a></var><br>
<blockquote><p>Interface to the C macro <code>WEXITSTATUS()</code>, <a href="libc.html#Process-Completion-Status">WEXITSTATUS</a>.  If <code>WIFEXITED()</code> applied to
<var>status</var> would return true: return the low&ndash;order 8 bits from
the exit status, which is the process exit status selected with
<code>exit()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_WIFSIGNALED</b> (<var>ikptr status</var>)<var><a name="index-ikrt_005fposix_005fWIFSIGNALED-1034"></a></var><br>
<blockquote><p>Interface to the C macro <code>WIFSIGNALED()</code>, <a href="libc.html#Process-Completion-Status">WIFSIGNALED</a>.  Return true if the process terminated
because it received an interprocess signal which was not handled. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_WTERMSIG</b> (<var>ikptr status</var>)<var><a name="index-ikrt_005fposix_005fWTERMSIG-1035"></a></var><br>
<blockquote><p>Interface to the C macro <code>WTERMSIG()</code>, <a href="libc.html#Process-Completion-Status">WTERMSIG</a>.  If <code>WIFSIGNALED()</code> applied to <var>status</var> would
return true: return the number of the interprocess signal that
terminated the process. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_WCOREDUMP</b> (<var>ikptr status</var>)<var><a name="index-ikrt_005fposix_005fWCOREDUMP-1036"></a></var><br>
<blockquote><p>Interface to the C macro <code>WCOREDUMP()</code>, <a href="libc.html#Process-Completion-Status">WCOREDUMP</a>.  Return true if the process terminated and produced
a core dump. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_WIFSTOPPED</b> (<var>ikptr status</var>)<var><a name="index-ikrt_005fposix_005fWIFSTOPPED-1037"></a></var><br>
<blockquote><p>Interface to the C macro <code>WIFSTOPPED()</code>, <a href="libc.html#Process-Completion-Status">WIFSTOPPED</a>.  Return true if the process is stopped. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_WSTOPSIG</b> (<var>ikptr status</var>)<var><a name="index-ikrt_005fposix_005fWSTOPSIG-1038"></a></var><br>
<blockquote><p>Interface to the C macro <code>WSTOPSIG()</code>, <a href="libc.html#Process-Completion-Status">WSTOPSIG</a>.  If <code>WIFSTOPPED()</code> applied to <var>status</var> would
return true: return the number of the interprocess signal that caused
the process to stop. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-signals"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-stat">capi posix stat</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-status">capi posix status</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.8 Delivering interprocess signals</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_raise</b> (<var>ikptr signum</var>)<var><a name="index-ikrt_005fposix_005fraise-1039"></a></var><br>
<blockquote><p>Interface to the C function <code>raise()</code>, <a href="libc.html#Signaling-Yourself">raise</a>.  Send the selected signal to the calling process.  If successful
return zero, else return an encoded <code>errno</code> code. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_kill</b> (<var>ikptr pid, ikptr signum</var>)<var><a name="index-ikrt_005fposix_005fkill-1040"></a></var><br>
<blockquote><p>Interface to the C function <code>kill()</code>, <a href="libc.html#Signaling-Another-Process">kill</a>.  Send the selected signal to selected process.  If
successful return zero, else return an encoded <code>errno</code> code. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_pause</b> (<var>void</var>)<var><a name="index-ikrt_005fposix_005fpause-1041"></a></var><br>
<blockquote><p>Interface to the C function <code>pause()</code>, <a href="libc.html#Using-Pause">pause</a>.  Suspend the process until a signal is received.  Return the
void object. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-stat"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-file">capi posix file</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-signals">capi posix signals</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.9 File system inspection</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_stat</b> (<var>ikptr pathname, ikptr stat, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fstat-1042"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_lstat</b> (<var>ikptr pathname, ikptr stat, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005flstat-1043"></a></var><br>
<blockquote><p>Interfaces to the C functions <code>stat()</code> and <code>lstat()</code>,
<a href="libc.html#Reading-Attributes">stat</a>.  Inspect the file system entry
selected by <var>pathname</var>, which must be a bytevector, and fill the
<code>struct-stat</code> instance referenced by <var>stat</var> with the results. 
If successful return zero, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_fstat</b> (<var>ikptr fd, ikptr stat, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005ffstat-1044"></a></var><br>
<blockquote><p>Interface to the C function <code>fstat()</code>, <a href="libc.html#Reading-Attributes">fstat</a>.  Inspect the file system entry associated to the file descriptor
<var>fd</var>, which must be a fixnum, and fill the <code>struct-stat</code>
instance referenced by <var>stat</var> with the results.  If successful
return zero, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_file_is_directory</b> (<var>ikptr pathname, ikptr follow</var>)<var><a name="index-ikrt_005fposix_005ffile_005fis_005fdirectory-1045"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_file_is_char_device</b> (<var>ikptr pathname, ikptr follow</var>)<var><a name="index-ikrt_005fposix_005ffile_005fis_005fchar_005fdevice-1046"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_file_is_block_device</b> (<var>ikptr pathname, ikptr follow</var>)<var><a name="index-ikrt_005fposix_005ffile_005fis_005fblock_005fdevice-1047"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_file_is_regular_file</b> (<var>ikptr pathname, ikptr follow</var>)<var><a name="index-ikrt_005fposix_005ffile_005fis_005fregular_005ffile-1048"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_file_is_symbolic_link</b> (<var>ikptr pathname, ikptr follow</var>)<var><a name="index-ikrt_005fposix_005ffile_005fis_005fsymbolic_005flink-1049"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_file_is_socket</b> (<var>ikptr pathname, ikptr follow</var>)<var><a name="index-ikrt_005fposix_005ffile_005fis_005fsocket-1050"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_file_is_fifo</b> (<var>ikptr pathname, ikptr follow</var>)<var><a name="index-ikrt_005fposix_005ffile_005fis_005ffifo-1051"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_file_is_message_queue</b> (<var>ikptr pathname, ikptr follow</var>)<var><a name="index-ikrt_005fposix_005ffile_005fis_005fmessage_005fqueue-1052"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_file_is_semaphore</b> (<var>ikptr pathname, ikptr follow</var>)<var><a name="index-ikrt_005fposix_005ffile_005fis_005fsemaphore-1053"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_file_is_shared_memory</b> (<var>ikptr pathname, ikptr follow</var>)<var><a name="index-ikrt_005fposix_005ffile_005fis_005fshared_005fmemory-1054"></a></var><br>
<blockquote><p>Return <code>#t</code> or <code>#f</code> whether the file system entry selected by
<var>pathname</var>, which must be a bytevector, is of the specified type; if
an error occurs return an encoded <code>errno</code> value.  When <var>follow</var>
is true: <code>stat()</code> is used to inspect the entry, else <code>lstat()</code>
is used. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_access</b> (<var>ikptr pathname, ikptr how</var>)<var><a name="index-ikrt_005fposix_005faccess-1055"></a></var><br>
<blockquote><p>Interface to the C function <code>access()</code>, <a href="libc.html#Testing-File-Access">access</a>.  Test the access mode selected by <var>how</var>, which must
be a fixnum, for the file system entry selected by <var>pathname</var>, which
must be a bytevector.  Return <code>#t</code> or <code>#f</code> or an encoded
<code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_file_size</b> (<var>ikptr filename, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005ffile_005fsize-1056"></a></var><br>
<blockquote><p>Determine the size of the file selected by <var>filename</var>, which must be
a bytevector, relying on a call to <code>stat()</code>.  If successful: return
an exact integer representing the size, else return an encoded
<code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_file_atime</b> (<var>ikptr pathname, ikptr vector, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005ffile_005fatime-1057"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_file_mtime</b> (<var>ikptr pathname, ikptr vector, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005ffile_005fmtime-1058"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_file_ctime</b> (<var>ikptr pathname, ikptr vector, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005ffile_005fctime-1059"></a></var><br>
<blockquote><p>Compute an exact integer representing the access, modification and
creation times for <var>pathname</var>, which must be a bytevector.  If
successful return zero, else return an encoded <code>errno</code> value.

        <p>The <var>vector</var> argument must be a vector which is mutated as follows:
the first item holds an exact integer representing the number of
seconds, the second item holds an exact integer representing the number
of microseconds. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-file"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-link">capi posix link</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-stat">capi posix stat</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.10 File system interface</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_chown</b> (<var>ikptr pathname, ikptr owner, ikptr group</var>)<var><a name="index-ikrt_005fposix_005fchown-1060"></a></var><br>
<blockquote><p>Interface to the C function <code>chown()</code>, <a href="libc.html#File-Owner">chown</a>. 
Changes the owner and group of the file system entry selected by
<var>pathname</var>, which must be a bytevector.  <var>owner</var> and <var>group</var>
must be fixnums.  If successful return zero, else return an encoded
<code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_fchown</b> (<var>ikptr fd, ikptr owner, ikptr group</var>)<var><a name="index-ikrt_005fposix_005ffchown-1061"></a></var><br>
<blockquote><p>Interface to the C function <code>fchown()</code>, <a href="libc.html#File-Owner">fchown</a>.  Changes the owner and group of the file system entry selected
by <var>fd</var>, which must be a fixnum representing a platform file
descriptor.  <var>owner</var> and <var>group</var> must be fixnums.  If successful
return zero, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_chmod</b> (<var>ikptr pathname, ikptr mode</var>)<var><a name="index-ikrt_005fposix_005fchmod-1062"></a></var><br>
<blockquote><p>Interface to the C function <code>chmod()</code>, <a href="libc.html#Setting-Permissions">chmod</a>.  Change to <var>mode</var>, which must be a fixnum, the
access permissions for the file system entry selected by <var>pathname</var>,
which must be a bytevector.  If successful return zero, else return an
encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_fchmod</b> (<var>ikptr fd, ikptr mode</var>)<var><a name="index-ikrt_005fposix_005ffchmod-1063"></a></var><br>
<blockquote><p>Interface to the C function <code>fchmod()</code>, <a href="libc.html#Setting-Permissions">fchmod</a>.  Change to <var>mode</var>, which must be a fixnum, the
access permissions for the file system entry associated to <var>fd</var>,
which must be a fixnum representing a platform file descriptor.  If
successful return zero, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_umask</b> (<var>ikptr mask</var>)<var><a name="index-ikrt_005fposix_005fumask-1064"></a></var><br>
<blockquote><p>Interface to the C function <code>umask()</code>, <a href="libc.html#Setting-Permissions">umask</a>.  Set the current file creation mask to <var>mask</var>
which must be a fixnum and return the previous mask as a fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getumask</b> (<var>void</var>)<var><a name="index-ikrt_005fposix_005fgetumask-1065"></a></var><br>
<blockquote><p>Interface to the C function <code>getumask()</code>, <a href="libc.html#Setting-Permissions">getumask</a>.  Return the current file creation mask as a
fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_utime</b> (<var>ikptr pathname, ikptr atime_sec, ikptr mtime_sec</var>)<var><a name="index-ikrt_005fposix_005futime-1066"></a></var><br>
<blockquote><p>Interface to the C function <code>utime()</code>, <a href="libc.html#File-Times">utime</a>. 
Set the access and modification times of the file system entry selected
by <var>pathname</var>, which must be a bytevector, to the specified counts
of seconds; both <var>atime_sec</var> and <var>mtime_sec</var> must be fixnums. 
If successful return zero, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_utimes</b> (<var>ikptr pathname, ikptr atime_sec, ikptr atime_usec, ikptr mtime_sec, ikptr mtime_usec</var>)<var><a name="index-ikrt_005fposix_005futimes-1067"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_lutimes</b> (<var>ikptr pathname, ikptr atime_sec, ikptr atime_usec, ikptr mtime_sec, ikptr mtime_usec</var>)<var><a name="index-ikrt_005fposix_005flutimes-1068"></a></var><br>
<blockquote><p>Interface to the C functions <code>utimes()</code> and <code>lutimes()</code>,
<a href="libc.html#File-Times">utimes</a>.  Set the access and modification times of
the file system entry selected by <var>pathname</var>, which must be a
bytevector, to the specified counts of seconds and microseconds; all the
numeric arguments must be fixnums.  If successful return zero, else
return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_futimes</b> (<var>ikptr fd, ikptr atime_sec, ikptr atime_usec, ikptr mtime_sec, ikptr mtime_usec</var>)<var><a name="index-ikrt_005fposix_005ffutimes-1069"></a></var><br>
<blockquote><p>Interface to the C function <code>futimes()</code>, <a href="libc.html#File-Times">futimes</a>.  Set the access and modification times of the file system
entry associated to <var>fd</var>, which must be a fixnum representing a file
descriptor, to the specified counts of seconds and microseconds; all the
numeric arguments must be fixnums.  If successful return zero, else
return an encoded <code>errno</code> value. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-link"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-dir">capi posix dir</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-file">capi posix file</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.11 Hard and symbolic links</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_link</b> (<var>ikptr old_pathname, ikptr new_pathname</var>)<var><a name="index-ikrt_005fposix_005flink-1070"></a></var><br>
<blockquote><p>Interface to the C function <code>link()</code>, <a href="libc.html#Hard-Links">link</a>. 
Create a hard link <var>new_pathname</var> to the source file system entry
<var>old_pathname</var>.  If successful return zero, else return an encoded
<code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_symlink</b> (<var>ikptr file_pathname, ikptr link_pathname</var>)<var><a name="index-ikrt_005fposix_005fsymlink-1071"></a></var><br>
<blockquote><p>Interface to the C function <code>symlink()</code>, <a href="libc.html#Symbolic-Links">symlink</a>.  Create a symbolic link <var>link_pathname</var> to the source file
system entry <var>file_pathname</var>.  If successful return zero, else
return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_readlink</b> (<var>ikptr link_pathname, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005freadlink-1072"></a></var><br>
<blockquote><p>Interface to the C function <code>readlink()</code>, <a href="libc.html#Symbolic-Links">readlink</a>.  If <var>pathname</var> references a symbolic link: follow it once
and return the referenced pathname as bytevector; if an error occurs:
return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_realpath</b> (<var>ikptr pathname</var>)<var><a name="index-ikrt_005fposix_005frealpath-1073"></a></var><br>
<blockquote><p>Interface to the C function <code>realpath()</code>, <a href="libc.html#Symbolic-Links">realpath</a>.  If <var>pathname</var> references a symbolic link: follow it and
return the real pathname as bytevector; if an error occurs: return an
encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_unlink</b> (<var>ikptr pathname</var>)<var><a name="index-ikrt_005fposix_005funlink-1074"></a></var><br>
<blockquote><p>Interface to the C function <code>unlink()</code>, <a href="libc.html#Deleting-Files">unlink</a>.  Delete the file system entry referenced by <var>pathname</var>,
which must be a bytevector and referencing a file.  If successful return
zero, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_remove</b> (<var>ikptr pathname</var>)<var><a name="index-ikrt_005fposix_005fremove-1075"></a></var><br>
<blockquote><p>Interface to the C function <code>remove()</code>, <a href="libc.html#Deleting-Files">remove</a>.  Delete the file system entry referenced by <var>pathname</var>,
which must be a bytevector and referencing a file or directory.  If
successful return zero, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_rename</b> (<var>ikptr old_pathname, ikptr new_pathname</var>)<var><a name="index-ikrt_005fposix_005frename-1076"></a></var><br>
<blockquote><p>Interface to the C function <code>rename()</code>, <a href="libc.html#Renaming-Files">rename</a>.  Rename the file system entry <var>old_pathname</var> to
<var>new_pathname</var>, both of which must be bytevectors.  If successful
return zero, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-dir"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-fd">capi posix fd</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-link">capi posix link</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.12 File system directories</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_mkdir</b> (<var>ikptr pathname, ikptr mode</var>)<var><a name="index-ikrt_005fposix_005fmkdir-1077"></a></var><br>
<blockquote><p>Interface to the C function <code>mkdir()</code>, <a href="libc.html#Creating-Directories">mkdir</a>.  Create a new directory file system entry with name
<var>pathname</var>, which must be a bytevector; <var>mode</var> must be a fixnum
specifying access permissions.  If successful return the fixnum zero,
else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_rmdir</b> (<var>ikptr pathname</var>)<var><a name="index-ikrt_005fposix_005frmdir-1078"></a></var><br>
<blockquote><p>Interface to the C function <code>rmdir()</code>, <a href="libc.html#Creating-Directories">rmdir</a>.  Remove the directory file system entry selected by
<var>pathname</var>, which must be a bytevector.  If successful return the
fixnum zero, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getcwd</b> (<var>ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetcwd-1079"></a></var><br>
<blockquote><p>Interface to the C function <code>getcwd()</code>, <a href="libc.html#Working-Directory">getcwd</a>.  Acquire the pathname of the current working directory.  If
successful return a bytevector holding the pathname, else return an
encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_chdir</b> (<var>ikptr pathname</var>)<var><a name="index-ikrt_005fposix_005fchdir-1080"></a></var><br>
<blockquote><p>Interface to the C function <code>chdir()</code>, <a href="libc.html#Working-Directory">chdir</a>.  Change the current working directory to the file system entry
selected by <var>pathname</var>, which must be a bytevector.  If successful
return the fixnum zero, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_fchdir</b> (<var>ikptr fd</var>)<var><a name="index-ikrt_005fposix_005ffchdir-1081"></a></var><br>
<blockquote><p>Interface to the C function <code>fchdir()</code>, <a href="libc.html#Working-Directory">fchdir</a>.  Change the current working directory to the file system entry
associated to <var>fd</var>, which must be a fixnum representing a file
descriptor.  If successful return the fixnum zero, else return an
encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_opendir</b> (<var>ikptr pathname, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fopendir-1082"></a></var><br>
<blockquote><p>Interface to the C function <code>opendir()</code>, <a href="libc.html#Opening-a-Directory">opendir</a>.  Open a directory stream for the inspection of the
file system entry <var>pathname</var>, which must be a bytevector.  If
successful return a pointer object, else return an encoded <code>errno</code>
value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_fdopendir</b> (<var>ikptr fd, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005ffdopendir-1083"></a></var><br>
<blockquote><p>Interface to the C function <code>fdopendir()</code>, <a href="libc.html#Opening-a-Directory">fdopendir</a>.  Open a directory stream for the inspection of
the file system entry associated to <var>fd</var>, which must be a fixnum
representing a file descriptor.  If successful return a pointer object,
else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_readdir</b> (<var>ikptr pointer, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005freaddir-1084"></a></var><br>
<blockquote><p>Interface to the C function <code>readdir()</code>, <a href="libc.html#Reading_002fClosing-Directory">readdir</a>.  Acquire the next entry from a directory stream
referenced by <var>pointer</var>, which must be a pointer object.  If
successful and an entry is available: return a pointer object; if
successful and no more entries are available: return the false object;
else return an encoded <code>errno</code> value.

        <p>When no more entries are available or an error occurs: the directory
stream is closed. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_closedir</b> (<var>ikptr pointer, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fclosedir-1085"></a></var><br>
<blockquote><p>Interface to the C function <code>closedir()</code>, <a href="libc.html#Reading_002fClosing-Directory">closedir</a>.  Close the directory stream referenced by
<var>pointer</var>, which must be a pointer object.  If successful return the
fixnum zero, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_rewinddir</b> (<var>ikptr pointer</var>)<var><a name="index-ikrt_005fposix_005frewinddir-1086"></a></var><br>
<blockquote><p>Interface to the C function <code>rewinddir()</code>, <a href="libc.html#Random-Access-Directory">rewinddir</a>.  Rewind to the beginning the directory stream
referenced by <var>pointer</var>, which must be a pointer object.  Return the
void object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_telldir</b> (<var>ikptr pointer</var>)<var><a name="index-ikrt_005fposix_005ftelldir-1087"></a></var><br>
<blockquote><p>Interface to the C function <code>telldir()</code>, <a href="libc.html#Random-Access-Directory">telldir</a>.  Return an exact integer representing the current
position in the directory stream referenced by <var>pointer</var>, which must
be a pointer object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_seekdir</b> (<var>ikptr pointer, ikptr pos</var>)<var><a name="index-ikrt_005fposix_005fseekdir-1088"></a></var><br>
<blockquote><p>Interface to the C function <code>seekdir()</code>, <a href="libc.html#Random-Access-Directory">seekdir</a>.  Set to <var>pos</var> the position of the directory
stream referenced by <var>pointer</var>, which must be a pointer object;
<var>pos</var> must be the return value of a previous call to
<code>telldir()</code>.  Return the void object. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-fd"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-socket">capi posix socket</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-dir">capi posix dir</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.13 File descriptors at low level</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_open</b> (<var>ikptr pathname, ikptr flags, ikptr mode</var>)<var><a name="index-ikrt_005fposix_005fopen-1089"></a></var><br>
<blockquote><p>Interface to the C function <code>open()</code>, <a href="libc.html#Opening-and-Closing-Files">open</a>.  Open a file descriptor for the file system entry
<var>pathname</var>, which must be a bytevector; <var>flags</var> and <var>mode</var>
must be fixnums.  If successful return a fixnum representing the file
descriptor, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_close</b> (<var>ikptr fd</var>)<var><a name="index-ikrt_005fposix_005fclose-1090"></a></var><br>
<blockquote><p>Interface to the C function <code>close()</code>, <a href="libc.html#Opening-and-Closing-Files">close</a>.  Close a file descriptor represented by <var>fd</var>, which
must be a fixnum.  If successful return the fixnum zero, else return an
encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_read</b> (<var>ikptr fd, ikptr buffer, ikptr size</var>)<var><a name="index-ikrt_005fposix_005fread-1091"></a></var><br>
<blockquote><p>Interface to the C function <code>read()</code>, <a href="libc.html#I_002fO-Primitives">read</a>.  Read bytes from the file descriptor <var>fd</var> and store them in
the bytevector <var>buffer</var>; if <var>size</var> is a fixnum, read <var>size</var>
bytes; if <var>size</var> is false, read a number of bytes equal to the
length of <var>buffer</var>.  If successful return a non&ndash;negative fixnum
representing the number of bytes read, else return an encoded
<code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_pread</b> (<var>ikptr fd, ikptr buffer, ikptr size, ikptr off</var>)<var><a name="index-ikrt_005fposix_005fpread-1092"></a></var><br>
<blockquote><p>Interface to the C function <code>pread()</code>, <a href="libc.html#I_002fO-Primitives">pread</a>.  Like <code>ikrt_posix_read()</code>, but start reading at offset
<var>off</var> from the start of the file; <var>off</var> must be a non&ndash;negative
exact integer. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_write</b> (<var>ikptr fd, ikptr buffer, ikptr size</var>)<var><a name="index-ikrt_005fposix_005fwrite-1093"></a></var><br>
<blockquote><p>Interface to the C function <code>write()</code>, <a href="libc.html#I_002fO-Primitives">write</a>.  Write bytes to the file descriptor <var>fd</var> from the bytevector
<var>buffer</var>; if <var>size</var> is a fixnum, write <var>size</var> bytes; if
<var>size</var> is false, write a number of bytes equal to the length of
<var>buffer</var>.  If successful return a non&ndash;negative fixnum representing
the number of written bytes, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_pwrite</b> (<var>ikptr fd, ikptr buffer, ikptr size, ikptr off</var>)<var><a name="index-ikrt_005fposix_005fpwrite-1094"></a></var><br>
<blockquote><p>Interface to the C function <code>pwrite()</code>, <a href="libc.html#I_002fO-Primitives">pwrite</a>.  Like <code>ikrt_posix_write()</code>, but start writing at offset
<var>off</var> from the start of the file; <var>off</var> must be a non&ndash;negative
exact integer. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_lseek</b> (<var>ikptr fd, ikptr off, ikptr whence, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005flseek-1095"></a></var><br>
<blockquote><p>Interface to the C function <code>lseek()</code>, <a href="libc.html#File-Position-Primitive">lseek</a>.  Change the file position of the file descriptor
<var>fd</var> to <var>off</var> from <var>whence</var>; <var>fd</var> and <var>whence</var> must
be fixnums, <var>off</var> must be an exact integer.  If successful return a
non&ndash;negative exact integer representing the number of bytes from the
beginning of the file, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_readv</b> (<var>ikptr fd, ikptr buffers, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005freadv-1096"></a></var><br>
<blockquote><p>Interface to the C function <code>readv()</code>, <a href="libc.html#Scatter_002dGather">readv</a>.  Read bytes from the file descriptor <var>fd</var> and store them
into the list of bytevectors referenced by <var>buffers</var>.  If successful
return a non&ndash;negative exact integer representing the number of bytes
actually read, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_writev</b> (<var>ikptr fd, ikptr buffers, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fwritev-1097"></a></var><br>
<blockquote><p>Interface to the C function <code>writev()</code>, <a href="libc.html#Scatter_002dGather">writev</a>.  Write bytes to the file descriptor <var>fd</var> from the list of
bytevectors referenced by <var>buffers</var>.  If successful return a
non&ndash;negative exact integer representing the number of bytes actually
written, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_select</b> (<var>ikptr nfds, ikptr read_fds, ikptr write_fds, ikptr except_fds, ikptr sec, ikptr usec, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fselect-1098"></a></var><br>
<blockquote><p>Interface to the C function <code>select()</code>, <a href="libc.html#Waiting-for-I_002fO">select</a>.  Wait for read, write or exceptional events on selected lists
of file descriptors.

        <p><var>nfds</var> must be false or a non&ndash;negative fixnum, when false it
defaults to the maximum file descriptor value in the given lists; it is
the maximum file descriptor number in the sets to be checked for events,
plus one.  <var>read_fds</var>, <var>write_fds</var> and <var>except_fds</var> must be
nil or lists of file descriptors to be checked for events.  <var>sec</var>
and <var>usec</var> must be fixnums representing timeout seconds and
microseconds.

        <p>Return the fixnum zero if the timeout expired before any event arrived;
else return a vector of 3 elements being lists of file descriptors,
respectively, ready for reading, writing or an exceptional condition. 
If an error occurs: return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_select_fd</b> (<var>ikptr fd, ikptr sec, ikptr usec, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fselect_005ffd-1099"></a></var><br>
<blockquote><p>Interface to the C function <code>select()</code>, <a href="libc.html#Waiting-for-I_002fO">select</a>.  Wait for read, write or exceptional events on the single file
descriptor <var>fd</var>.  <var>sec</var> and <var>usec</var> must be fixnums
representing timeout seconds and microseconds.

        <p>Return the fixnum zero if the timeout expired before any event arrived;
else return a vector of 3 elements being false or <var>fd</var>,
respectively, if <var>fd</var> is ready for reading, writing or an
exceptional condition.  If an error occurs: return an encoded
<code>errno</code> value. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_fcntl</b> (<var>ikptr fd, ikptr command, ikptr arg</var>)<var><a name="index-ikrt_005fposix_005ffcntl-1100"></a></var><br>
<blockquote><p>Interface to the C function <code>fcntl()</code>, <a href="libc.html#Control-Operations">fcntl</a>.  Perform the operation specified by <var>command</var> on the file
descriptor <var>fd</var> using <var>arg</var>; <var>fd</var> and <var>command</var> must be
fixnums; <var>arg</var> must be the false object, a fixnum, a bytevector or a
pointer, if it is <code>#f</code> no argument is handed to <code>fcntl()</code>.  If
successful return a fixnum representing the return value of
<code>fcntl()</code>, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_ioctl</b> (<var>ikptr fd, ikptr command, ikptr arg</var>)<var><a name="index-ikrt_005fposix_005fioctl-1101"></a></var><br>
<blockquote><p>Interface to the C function <code>ioctl()</code>, <a href="libc.html#IOCTLs">ioctl</a>. 
Perform the operation specified by <var>command</var> on the file descriptor
<var>fd</var> using <var>arg</var>; <var>fd</var> and <var>command</var> must be fixnums;
<var>arg</var> must be the false object, a fixnum, a bytevector or a pointer,
if it is <code>#f</code> no argument is handed to <code>ioctl()</code>.  If successful
return a fixnum representing the return value of <code>ioctl()</code>, else
return an encoded <code>errno</code> value. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_dup</b> (<var>ikptr fd</var>)<var><a name="index-ikrt_005fposix_005fdup-1102"></a></var><br>
<blockquote><p>Interface to the C function <code>dup()</code>, <a href="libc.html#Duplicating-Descriptors">dup</a>.  Duplicate the file descriptor <var>fd</var>.  If
successful return a non&ndash;negative fixnum representing the new
descriptor, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_dup2</b> (<var>ikptr old, ikptr new</var>)<var><a name="index-ikrt_005fposix_005fdup2-1103"></a></var><br>
<blockquote><p>Interface to the C function <code>dup2()</code>, <a href="libc.html#Duplicating-Descriptors">dup</a>.  Duplicate the file descriptor <var>old</var> to
<var>new</var>.  If successful return the fixnum zero, else return an encoded
<code>errno</code> value. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_pipe</b> (<var>ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fpipe-1104"></a></var><br>
<blockquote><p>Interface to the C function <code>pipe()</code>, <a href="libc.html#Creating-a-Pipe">pipe</a>.  Create a pair of file descriptors connected through a pipe.  If
successful return a pair whose car and cdr are fixnums representing the
file descriptors, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_mkfifo</b> (<var>ikptr pathname, ikptr mode</var>)<var><a name="index-ikrt_005fposix_005fmkfifo-1105"></a></var><br>
<blockquote><p>Interface to the C function <code>mkfifo()</code>, <a href="libc.html#FIFO-Special-Files">mkfifo</a>.  Create a FIFO special file with name <var>pathname</var>,
which must be a bytevector, and mode <var>mode</var>, which must be a fixnum. 
If successful return the fixnum zero, else return an encoded
<code>errno</code> value. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-socket"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-users">capi posix users</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-fd">capi posix fd</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.14 Network sockets</h4>

<h5 class="subsubheading">Address structures</h5>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_make_sockaddr_un</b> (<var>ikptr pathname, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fmake_005fsockaddr_005fun-1106"></a></var><br>
<blockquote><p>Given a bytevector <var>pathname</var> representing the pathname of a local
socket, build and return a bytevector holding the <code>struct
sockaddr_un</code> representing it. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_sockaddr_un_pathname</b> (<var>ikptr socket_address, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fsockaddr_005fun_005fpathname-1107"></a></var><br>
<blockquote><p>Given a bytevector <var>socket_address</var>, which must be the return value
of a previous call to <code>ikrt_posix_make_sockaddr_un()</code>, holding a
<code>struct sockaddr_un</code> build and return a bytevector holding the
corresponding socket pathname.  If the data in <var>socket_address</var> is
invalid: return false. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_make_sockaddr_in</b> (<var>ikptr host_address, ikptr port, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fmake_005fsockaddr_005fin-1108"></a></var><br>
<blockquote><p>Given a bytevector <var>host_address</var> holding a <code>struct in_addr</code>
and a fixnum <var>port</var> representing a network port number, build and
return a bytevector holding a <code>struct sockaddr_in</code> initialised with
this data. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_sockaddr_in_in_addr</b> (<var>ikptr socket_address, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fsockaddr_005fin_005fin_005faddr-1109"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_sockaddr_in_in_port</b> (<var>ikptr socket_address</var>)<var><a name="index-ikrt_005fposix_005fsockaddr_005fin_005fin_005fport-1110"></a></var><br>
<blockquote><p>Given a bytevector <var>socket_address</var> holding a <code>struct
sockaddr_in</code>, extract the <code>in_addr</code> and <code>in_port</code> fields and
return them as bytevector holding the corresponding <code>struct
in_addr</code> and as fixnum.  If the data in <var>socket_address</var> is invalid:
return false. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_make_sockaddr_in6</b> (<var>ikptr host_address, ikptr port, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fmake_005fsockaddr_005fin6-1111"></a></var><br>
<blockquote><p>Given a bytevector <var>host_address</var> holding a <code>struct in6_addr</code>
and a fixnum <var>port</var> representing a network port number, build and
return a bytevector holding a <code>struct sockaddr_in6</code> initialised
with this data. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_sockaddr_in6_in6_addr</b> (<var>ikptr socket_address, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fsockaddr_005fin6_005fin6_005faddr-1112"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_sockaddr_in6_in6_port</b> (<var>ikptr socket_address</var>)<var><a name="index-ikrt_005fposix_005fsockaddr_005fin6_005fin6_005fport-1113"></a></var><br>
<blockquote><p>Given a bytevector <var>socket_address</var> holding a <code>struct
sockaddr_in6</code>, extract the <code>in6_addr</code> and <code>in6_port</code> fields
and return them as bytevector holding the corresponding <code>struct
in6_addr</code> and as fixnum.  If the data in <var>socket_address</var> is
invalid: return false. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_in6addr_loopback</b> (<var>ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fin6addr_005floopback-1114"></a></var><br>
&mdash; Function: ikptr <b>ikrt_posix_in6addr_any</b> (<var>ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fin6addr_005fany-1115"></a></var><br>
<blockquote><p>Build and return a bytevector holding the constant structures of type
<code>struct in6_addr</code> defined by <code>in6addr_loopback</code> and
<code>in6addr_any</code>. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_inet_aton</b> (<var>ikptr dotted_quad, ikpcb * pcb</var>)<var><a name="index-ikrt_005finet_005faton-1116"></a></var><br>
<blockquote><p>Given the bytevector <var>dotted_quad</var> holding the <acronym>ASCII</acronym> dotted quad
representation of a host address, build and return a bytevector holding
the corresponding <code>struct in_addr</code>.  If <var>dotted_quad</var> is
invalid: return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_inet_ntoa</b> (<var>ikptr host_address, ikpcb * pcb</var>)<var><a name="index-ikrt_005finet_005fntoa-1117"></a></var><br>
<blockquote><p>Given the bytevector <var>host_address</var> holding a <code>struct in_addr</code>,
build and return a bytevector holding the corresponding <acronym>ASCII</acronym> dotted
quad representation. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_inet_pton</b> (<var>ikptr af, ikptr presentation, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005finet_005fpton-1118"></a></var><br>
<blockquote><p>Given the fixnum <var>af</var>, being <code>AF_INET</code> or <code>AF_INET6</code>, and
the bytevector <var>presentation</var> holding the <acronym>ASCII</acronym> presentation of
an Internet address, build and return a bytevector holding the
corresponding <code>struct in_addr</code> or <code>struct in6_addr</code>.  If
either <var>af</var> or <var>presentation</var> is invalid: return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_inet_ntop</b> (<var>ikptr af, ikptr host_address, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005finet_005fntop-1119"></a></var><br>
<blockquote><p>Given the fixnum <var>af</var>, being <code>AF_INET</code> or <code>AF_INET6</code>, and
the bytevector <var>host_address</var> holding a <code>struct in_addr</code> or
<code>struct in6_addr</code>, build and return a bytevector holding the
corresponding <acronym>ASCII</acronym> presentation of the Internet address .  If the
arguments are invalid: return false. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Host address resolution</h5>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_gethostbyname</b> (<var>ikptr rtd, ikptr hostname, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgethostbyname-1120"></a></var><br>
<blockquote><p>Interface to the C function <code>gethostbyname()</code>, <a href="libc.html#Host-Names">gethostbyname</a>.  Given the bytevector <var>hostname</var> holding the
<acronym>ASCII</acronym> representation of a host name, build and return an instance of
<code>struct-hostent</code> using <var>rtd</var> as its type descriptor.  If an
error occurs, return an encoded <code>h_errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_gethostbyaddr</b> (<var>ikptr rtd, ikptr addr, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgethostbyaddr-1121"></a></var><br>
<blockquote><p>Interface to the C function <code>gethostbyaddr()</code>, <a href="libc.html#Host-Names">gethostbyaddr</a>.  Given the bytevector <var>addr</var> holding a <code>struct
in_addr</code> or a <code>struct in6_addr</code>, build and return an instance of
<code>struct-hostent</code> using <var>rtd</var> as its type descriptor; the type
of address is automatically inferred from the length of the bytevector. 
If an error occurs, return an encoded <code>h_errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_host_entries</b> (<var>ikptr rtd, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fhost_005fentries-1122"></a></var><br>
<blockquote><p>Interface to the C functions <code>sethostent()</code>, <code>gethostent()</code> and
<code>endhostent()</code>, <a href="libc.html#Host-Names">gethostbyaddr</a>.  Build and
return a list of <code>struct-hostent</code> representing the entries in the
hosts database, using <var>rtd</var> as type descriptor. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getaddrinfo</b> (<var>ikptr rtd, ikptr node, ikptr service, ikptr hints, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetaddrinfo-1123"></a></var><br>
<blockquote><p>Interface to the C function <code>getaddrinfo()</code>, see the manual page
<code>getaddrinfo(3)</code>.  Given the bytevectors <var>node</var> and
<var>service</var> identifying an Internet host and a service, build a list
of <code>struct-addrinfo</code> instances representing addresses to which
sockets can be bound or connected.

        <p>Both <var>node</var> and <var>service</var> can be false, in which case the
corresponding arguments handed to the C function are <code>NULL</code>.

        <p><var>hints</var> must be an instance of <code>struct-addrinfo</code> used to select
matching hosts.  <var>rtd</var> must be the type descriptor of
<code>struct-addrinfo</code>.

        <p>If successful: return the list of data structures, else return a fixnum
representing an <code>EAI_</code> error code. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_gai_strerror</b> (<var>ikptr error_code, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgai_005fstrerror-1124"></a></var><br>
<blockquote><p>Interface to the C function <code>gai_strerror()</code>, see the manual page
<code>gai_strerror(3)</code>.  Convert a <code>EAI_</code> error code into the
corresponding error message, return a bytevector holding such message in
<acronym>ASCII</acronym> coding. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Network protocols</h5>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getprotobyname</b> (<var>ikptr rtd, ikptr name, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetprotobyname-1125"></a></var><br>
<blockquote><p>Interface to the C function <code>getprotobyname()</code>, <a href="libc.html#Protocols-Database">getprotobyname</a>.  Given a bytevector <var>name</var> holding the
<acronym>ASCII</acronym> coding of a network protocol name, query the network protocols
database and build an instance of <code>struct-protoent</code> mirroring the
resulting <code>struct protoent</code> entry; <var>rtd</var> must be the type
descriptor of <code>struct-protoent</code>.  If successful return the data
structure, else return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getprotobynumber</b> (<var>ikptr rtd, ikptr proto_num, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetprotobynumber-1126"></a></var><br>
<blockquote><p>Interface to the C function <code>getprotobynumber()</code>,
<a href="libc.html#Protocols-Database">getprotobynumber</a>.  Given a fixnum
<var>proto_num</var> being the number of a network protocol, query the
network protocols database and build an instance of
<code>struct-protoent</code> mirroring the resulting <code>struct protoent</code>
entry; <var>rtd</var> must be the type descriptor of <code>struct-protoent</code>. 
If successful return the data structure, else return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_protocol_entries</b> (<var>ikptr rtd, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fprotocol_005fentries-1127"></a></var><br>
<blockquote><p>Interface to the C functions <code>setprotoent()</code>, <code>getprotoent()</code>
and <code>endprotoent()</code>, <a href="libc.html#Protocols-Database">setprotoent</a>. 
Scan the network protocol database and build a list of
<code>struct-protoent</code> mirroring the resulting <code>struct protoent</code>
entries; <var>rtd</var> must be the type descriptor of
<code>struct-protoent</code>.  Return the list of structures. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Network services</h5>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getservbyname</b> (<var>ikptr rtd, ikptr name, ikptr protocol, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetservbyname-1128"></a></var><br>
<blockquote><p>Interface to the C function <code>getservbyname()</code>, <a href="libc.html#Services-Database">getservbyname</a>.  Given the bytevectors <var>name</var> and
<var>protocol</var> holding the <acronym>ASCII</acronym> coding of a network service name and
protocol, query the network services database and build an instance of
<code>struct-servent</code> mirroring the resulting <code>struct servent</code>
entry.  <var>rtd</var> must be the type descriptor of <code>struct-servent</code>. 
If successful return the data structure, else return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getservbynumber</b> (<var>ikptr rtd, ikptr port, ikptr protocol, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetservbynumber-1129"></a></var><br>
<blockquote><p>Interface to the C function <code>getservbynumber()</code>, <a href="libc.html#Services-Database">getservbynumber</a>.  Given a fixnum <var>port</var> and a string or
bytevector <var>protocol</var> being the port number and protocol name of a
network service, query the network services database and build an
instance of <code>struct-servent</code> mirroring the resulting <code>struct
servent</code> entry.  <var>rtd</var> must be the type descriptor of
<code>struct-servent</code>.  If successful return the data structure, else
return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_service_entries</b> (<var>ikptr rtd, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fservice_005fentries-1130"></a></var><br>
<blockquote><p>Interface to the C functions <code>setservent()</code>, <code>getservent()</code> and
<code>endservent()</code>, <a href="libc.html#Services-Database">setservent</a>.  Scan the
network service database and build a list of <code>struct-servent</code>
mirroring the resulting <code>struct servent</code> entries.  <var>rtd</var> must
be the type descriptor of <code>struct-servent</code>.  Return the list of
structures. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Networks database</h5>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getnetbyname</b> (<var>ikptr rtd, ikptr name, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetnetbyname-1131"></a></var><br>
<blockquote><p>Interface to the C function <code>getnetbyname()</code>, <a href="libc.html#Networks-Database">getnetbyname</a>.  Given the bytevector <var>name</var> holding the
<acronym>ASCII</acronym> coding of a network name, query the networks database and build
an instance of <code>struct-netent</code> mirroring the resulting <code>struct
netent</code> entry.  <var>rtd</var> must be the type descriptor of
<code>struct-netent</code>.  If successful return the data structure, else
return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getnetbyaddr</b> (<var>ikptr rtd, ikptr net, ikptr type, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetnetbyaddr-1132"></a></var><br>
<blockquote><p>Interface to the C function <code>getnetbyaddr()</code>, <a href="libc.html#Networks-Database">getnetbyaddr</a>.  Given an exact integer <var>net</var> representing
a network number and the fixnum <var>type</var> representing a network type,
query the networks database and build an instance of
<code>struct-netent</code> mirroring the resulting <code>struct netent</code> entry. 
<var>rtd</var> must be the type descriptor of <code>struct-netent</code>.  If
successful return the data structure, else return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_network_entries</b> (<var>ikptr rtd, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fnetwork_005fentries-1133"></a></var><br>
<blockquote><p>Interface to the C functions <code>setnetent()</code>, <code>getnetent()</code> and
<code>endnetent()</code>, <a href="libc.html#Networks-Database">setnetent</a>.  Scan the
networks database and build a list of <code>struct-netent</code> mirroring the
resulting <code>struct netent</code> entries.  <var>rtd</var> must be the type
descriptor of <code>struct-netent</code>.  Return the list of structures. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Sockets creation and shutdown</h5>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_socket</b> (<var>ikptr namespace, ikptr style, ikptr protocol</var>)<var><a name="index-ikrt_005fposix_005fsocket-1134"></a></var><br>
<blockquote><p>Interface to the C function <code>socket()</code>, <a href="libc.html#Creating-a-Socket">socket</a>.  Create a new socket descriptor and return it as non&ndash;negative
fixnum; if an error occurs return an encoded <code>errno</code> value.  All
the arguments must be fixnums. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_shutdown</b> (<var>ikptr sock, ikptr how</var>)<var><a name="index-ikrt_005fposix_005fshutdown-1135"></a></var><br>
<blockquote><p>Interface to the C function <code>shutdown()</code>, <a href="libc.html#Closing-a-Socket">shutdown</a>.  Close the socket <var>sock</var> according to <var>how</var>. 
If successful return the fixnum zero, else return an encoded
<code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_socketpair</b> (<var>ikptr namespace, ikptr style, ikptr protocol, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fsocketpair-1136"></a></var><br>
<blockquote><p>Interface to the C function <code>socketpair()</code>, <a href="libc.html#Socket-Pairs">socketpair</a>.  Create a pairs of connected sockets and return a pair
holding the descriptors as non&ndash;negative fixnums; if an error occurs
return an encoded <code>errno</code> value.  All the arguments must be
fixnums, but <var>pcb</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Socket operations</h5>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_connect</b> (<var>ikptr sock, ikptr addr</var>)<var><a name="index-ikrt_005fposix_005fconnect-1137"></a></var><br>
<blockquote><p>Interface to the C function <code>connect()</code>, <a href="libc.html#Connecting">connect</a>.  Connect the socket <var>sock</var> to the address specified by the
bytevector <var>addr</var> which must hold a concrete instance of
<code>struct sockaddr</code>.  If successful return the fixnum zero, else
return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_listen</b> (<var>ikptr sock, ikptr pending_conns</var>)<var><a name="index-ikrt_005fposix_005flisten-1138"></a></var><br>
<blockquote><p>Interface to the C function <code>listen()</code>, <a href="libc.html#Listening">listen</a>.  Enable the socket <var>sock</var> to accept connections; the fixnum
<var>pending_conns</var> specifies the maximum length of the pending
connection requests queue.  If successful return the fixnum zero, else
return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_accept</b> (<var>ikptr sock, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005faccept-1139"></a></var><br>
<blockquote><p>Interface to the C function <code>accept()</code>, <a href="libc.html#Accepting-Connections">accept</a>.  Accept an incoming connection to the server
socket <var>sock</var>.  If successful return a pair whose car is a
non&ndash;negative fixnum representing the socket and whose cdr is a
bytevector representing the client address as <code>struct sockaddr</code>;
else return an encoded <code>errno</code> value, including <code>EWOULDBLOCK</code>
which means that <var>sock</var> is in non&ndash;blocking mode and no pending
connections exist. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_bind</b> (<var>ikptr sock, ikptr sockaddr</var>)<var><a name="index-ikrt_005fposix_005fbind-1140"></a></var><br>
<blockquote><p>Interface to the C function <code>bind()</code>, <a href="libc.html#Setting-Address">bind</a>.  Bind the socket descriptor <var>sock</var> to the address specified
by the <code>struct sockaddr</code> in the bytevector <var>sockaddr</var>.  If
successful return the fixnum zero, else return an encoded <code>errno</code>
value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getpeername</b> (<var>ikptr sock, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetpeername-1141"></a></var><br>
<blockquote><p>Interface to the C function <code>getpeername()</code>, <a href="libc.html#Who-is-Connected">getpeername</a>.  Retrieve informations about the address of the
socket to which the <var>sock</var> socket is connected to.  If successful
return a bytevector holding a <code>struct sockaddr</code>, else return an
encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getsockname</b> (<var>ikptr sock, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetsockname-1142"></a></var><br>
<blockquote><p>Interface to the C function <code>getsockanme()</code>, <a href="libc.html#Setting-Address">getsockname</a>.  Retrieve informations about the address bound to
the socket descriptor <var>sock</var>.  If successful return a bytevector
holding the <code>struct sockaddr</code>, else return an encoded <code>errno</code>
value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_send</b> (<var>ikptr sock, ikptr buffer, ikptr size, ikptr flags</var>)<var><a name="index-ikrt_005fposix_005fsend-1143"></a></var><br>
<blockquote><p>Interface to the C function <code>send()</code>, <a href="libc.html#Sending-Data">send</a>. 
Like <code>write()</code> but with the additional argument <var>flags</var> which
must be a fixnum: write data from the bytevector <var>buffer</var> to the
socket <var>sock</var>; if <var>size</var> is a fixnum, write <var>size</var> bytes; if
<var>size</var> is false, write a number of bytes equal to the length of
<var>buffer</var>.  If successful return a non&ndash;negative fixnum representing
the number of bytes actually sent, else return an encoded <code>errno</code>
value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_recv</b> (<var>ikptr sock, ikptr buffer, ikptr size, ikptr flags</var>)<var><a name="index-ikrt_005fposix_005frecv-1144"></a></var><br>
<blockquote><p>Interface to the C function <code>recv()</code>, <a href="libc.html#Receiving-Data">recv</a>.  Like <code>read()</code> but with the additional argument <var>flags</var>
which must be a fixnum: read data from <var>sock</var> and store it in the
bytevector <var>buffer</var>; if <var>size</var> is a fixnum, read <var>size</var>
bytes; if <var>size</var> is false, read a number of bytes equal to the
length of <var>buffer</var>.  If successful return a non&ndash;negative fixnum
representing the number of bytes actually received, else return an
encoded <code>errno</code> value. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_sendto</b> (<var>ikptr sock, ikptr buffer, ikptr size, ikptr flags, ikptr addr</var>)<var><a name="index-ikrt_005fposix_005fsendto-1145"></a></var><br>
<blockquote><p>Interface to the C function <code>sendto()</code>, <a href="libc.html#Sending-Datagrams">sendto</a>.  Like <code>send()</code> but with the additional argument <var>addr</var>
which must be a bytevector holding a <code>struct sockaddr</code>: write data
from the bytevector <var>buffer</var> to the socket <var>sock</var> to the
destination specified by <var>addr</var>.

        <p>If <var>size</var> is a fixnum, write <var>size</var> bytes; if <var>size</var> is
false, write a number of bytes equal to the length of <var>buffer</var>.

        <p>If successful return a non&ndash;negative fixnum representing the number of
bytes actually sent, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_recvfrom</b> (<var>ikptr sock, ikptr buffer, ikptr size, ikptr flags, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005frecvfrom-1146"></a></var><br>
<blockquote><p>Interface to the C function <code>recvfrom()</code>, <a href="libc.html#Receiving-Datagrams">recvfrom</a>.  Like <code>recv()</code> but additionally retrieve
informations about the address of the sender: read data from <var>sock</var>
and store it in the bytevector <var>buffer</var>.

        <p>If <var>size</var> is a fixnum, read <var>size</var> bytes; if <var>size</var> is
false, read a number of bytes equal to the length of <var>buffer</var>.

        <p>If successful return a pair whose car is a non&ndash;negative fixnum
representing the number of bytes actually received and whose cdr is a
bytevector holding a <code>struct sockaddr</code> representing the address of
the sender; else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getsockopt</b> (<var>ikptr sock, ikptr level, ikptr option, ikptr optval, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetsockopt-1147"></a></var><br>
<blockquote><p>Interface to the C function <code>getsockopt()</code>, <a href="libc.html#Socket-Option-Function">getsockopt</a>.  Retrieve the value of <var>option</var> of socket
<var>sock</var> at <var>level</var> and store it in the bytevector <var>optval</var>. 
<var>option</var> and <var>level</var> must be fixnums.  If successful return the
fixnum zero, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_setsockopt</b> (<var>ikptr sock, ikptr level, ikptr option, ikptr optval, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fsetsockopt-1148"></a></var><br>
<blockquote><p>Interface to the C function <code>setsockopt()</code>, <a href="libc.html#Socket-Option-Function">setsockopt</a>.  Set a new value for <var>option</var> of socket
<var>sock</var> at <var>level</var> reading it from the bytevector <var>optval</var>. 
<var>option</var> and <var>level</var> must be fixnums.  If successful return the
fixnum zero, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-users"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-job">capi posix job</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-socket">capi posix socket</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.15 Users and groups</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getuid</b> (<var>void</var>)<var><a name="index-ikrt_005fposix_005fgetuid-1149"></a></var><br>
<blockquote><p>Interface to the C function <code>getuid()</code>, <a href="libc.html#Reading-Persona">getuid</a>.  Return a fixnum representing the real user ID of the process. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getgid</b> (<var>void</var>)<var><a name="index-ikrt_005fposix_005fgetgid-1150"></a></var><br>
<blockquote><p>Interface to the C function <code>getgid()</code>, <a href="libc.html#Reading-Persona">getgid</a>.  Return a fixnum representing the real group ID of the process. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_geteuid</b> (<var>void</var>)<var><a name="index-ikrt_005fposix_005fgeteuid-1151"></a></var><br>
<blockquote><p>Interface to the C function <code>geteuid()</code>, <a href="libc.html#Reading-Persona">geteuid</a>.  Return a fixnum representing the effective user ID of the
process. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getegid</b> (<var>void</var>)<var><a name="index-ikrt_005fposix_005fgetegid-1152"></a></var><br>
<blockquote><p>Interface to the C function <code>getegid()</code>, <a href="libc.html#Reading-Persona">getegid</a>.  Return a fixnum representing the effective group ID of the
process. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getgroups</b> (<var>ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetgroups-1153"></a></var><br>
<blockquote><p>Interface to the C function <code>getgroups()</code>, <a href="libc.html#Reading-Persona">getgroups</a>.  Return a list of fixnums representing the
supplementary group IDs of the process; if an error occurs return an
encoded <code>errno</code> value. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_seteuid</b> (<var>ikptr new_uid</var>)<var><a name="index-ikrt_005fposix_005fseteuid-1154"></a></var><br>
<blockquote><p>Interface to the C function <code>seteuid()</code>, <a href="libc.html#Setting-User-ID">seteuid</a>.  Set the effective user ID to <var>new_uid</var>, which must be a
fixnum.  If successful return the fixnum zero, else return an encoded
<code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_setuid</b> (<var>ikptr new_uid</var>)<var><a name="index-ikrt_005fposix_005fsetuid-1155"></a></var><br>
<blockquote><p>Interface to the C function <code>setuid()</code>, <a href="libc.html#Setting-User-ID">setuid</a>.  Set both the real and effective user IDs to <var>new_uid</var>,
which must be a fixnum.  If successful return the fixnum zero, else
return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_setreuid</b> (<var>ikptr real_uid, ikptr effective_uid</var>)<var><a name="index-ikrt_005fposix_005fsetreuid-1156"></a></var><br>
<blockquote><p>Interface to the C function <code>setreuid()</code>, <a href="libc.html#Setting-User-ID">setreuid</a>.  Set the real user ID to <var>real_uid</var> and the effective
user ID to <var>effective_uid</var>, both the arguments must be fixnums.  If
successful return the fixnum zero, else return an encoded <code>errno</code>
value. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_setegid</b> (<var>ikptr new_gid</var>)<var><a name="index-ikrt_005fposix_005fsetegid-1157"></a></var><br>
<blockquote><p>Interface to the C function <code>setegid()</code>, <a href="libc.html#Setting-Groups">setegid</a>.  Set the effective group ID to <var>new_gid</var>, which must be a
fixnum.  If successful return the fixnum zero, else return an encoded
<code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_setgid</b> (<var>ikptr new_gid</var>)<var><a name="index-ikrt_005fposix_005fsetgid-1158"></a></var><br>
<blockquote><p>Interface to the C function <code>setgid()</code>, <a href="libc.html#Setting-Groups">setgid</a>.  Set both the real and effective group IDs to <var>new_gid</var>,
which must be a fixnum.  If successful return the fixnum zero, else
return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_setregid</b> (<var>ikptr real_gid, ikptr effective_gid</var>)<var><a name="index-ikrt_005fposix_005fsetregid-1159"></a></var><br>
<blockquote><p>Interface to the C function <code>setregid()</code>, <a href="libc.html#Setting-Groups">setregid</a>.  Set the real group ID to <var>real_gid</var> and the effective
group ID to <var>effective_gid</var>, both the arguments must be fixnums.  If
successful return the fixnum zero, else return an encoded <code>errno</code>
value. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getlogin</b> (<var>ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetlogin-1160"></a></var><br>
<blockquote><p>Interface to the C function <code>getlogin()</code>, <a href="libc.html#Who-Logged-In">getlogin</a>.  Return a bytevector holding the <acronym>ASCII</acronym> coding of the name
of the user logged in on the controlling terminal of the process; if the
name cannot be determined: return false. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getpwuid</b> (<var>ikptr rtd, ikptr uid, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetpwuid-1161"></a></var><br>
<blockquote><p>Interface to the C function <code>getpwuid()</code>, <a href="libc.html#Lookup-User">getpwuid</a>.  Retrieve informations on the user with identifier <var>uid</var>,
which must be a fixnum.  If successful return an instance of
<code>struct-passwd</code> initialised with <var>rtd</var>, which must be its type
descriptor; if a user with such an ID does not exists: return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getpwnam</b> (<var>ikptr rtd, ikptr name, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetpwnam-1162"></a></var><br>
<blockquote><p>Interface to the C function <code>getpwnam()</code>, <a href="libc.html#Lookup-User">getpwnam</a>.  Retrieve informations on the user with name represented in
<acronym>ASCII</acronym> coding by the bytevector <var>name</var>.  If successful return an
instance of <code>struct-passwd</code> initialised with <var>rtd</var>, which must
be its type descriptor; if a user with such an ID does not exists:
return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_user_entries</b> (<var>ikptr rtd, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fuser_005fentries-1163"></a></var><br>
<blockquote><p>Interface to the C functions <code>setpwent()</code>, <code>getpwent()</code> and
<code>endpwent()</code>, <a href="libc.html#Scanning-All-Users">setpwent</a>.  Iterate the
database of users and return a list of <code>struct-passwd</code> representing
the entries; the structures are initialised with <var>rtd</var> which must be
the type descriptor of <code>struct-passwd</code>. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getgrgid</b> (<var>ikptr rtd, ikptr gid, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetgrgid-1164"></a></var><br>
<blockquote><p>Interface to the C function <code>getgrgid()</code>, <a href="libc.html#Lookup-Group">getgrgid</a>.  Retrieve informations on the group with identifier
<var>gid</var>, which must be a fixnum.  If successful return an instance of
<code>struct-group</code> initialised with <var>rtd</var>, which must be its type
descriptor; if a group with such an ID does not exists: return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getgrnam</b> (<var>ikptr rtd, ikptr name, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgetgrnam-1165"></a></var><br>
<blockquote><p>Interface to the C function <code>getgrnam()</code>, <a href="libc.html#Lookup-Group">getgrnam</a>.  Retrieve informations on the group with name represented in
<acronym>ASCII</acronym> coding by the bytevector <var>name</var>.  If successful return an
instance of <code>struct-group</code> initialised with <var>rtd</var>, which must
be its type descriptor; if a group with such an ID does not exists:
return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_group_entries</b> (<var>ikptr rtd, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgroup_005fentries-1166"></a></var><br>
<blockquote><p>Interface to the C functions <code>setgrent()</code>, <code>getgrent()</code> and
<code>endgrent()</code>, <a href="libc.html#Scanning-All-Groups">setgrent</a>.  Iterate the
database of groups and return a list of <code>struct-group</code> representing
the entries; the structures are initialised with <var>rtd</var> which must be
the type descriptor of <code>struct-group</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-job"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-posix-time">capi posix time</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-users">capi posix users</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.16 Job control</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_ctermid</b> (<var>ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fctermid-1167"></a></var><br>
<blockquote><p>Interface to the C function <code>ctermid()</code>, <a href="libc.html#Identifying-the-Terminal">ctermid</a>.  Return a bytevector holding the <acronym>ASCII</acronym> coded
pathname of the controlling terminal of the current process; the
returned value may be the empty bytevector. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_setsid</b> (<var>void</var>)<var><a name="index-ikrt_005fposix_005fsetsid-1168"></a></var><br>
<blockquote><p>Interface to the C function <code>setsid()</code>, <a href="libc.html#Process-Group-Functions">setsid</a>.  Create a new session, making the current process
the group leader with no controlling terminal.  If successful return a
fixnum representing the new process groups ID, else return an encoded
<code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getsid</b> (<var>ikptr pid</var>)<var><a name="index-ikrt_005fposix_005fgetsid-1169"></a></var><br>
<blockquote><p>Interface to the C function <code>getsid()</code>, <a href="libc.html#Process-Group-Functions">getsid</a>.  If successful return a fixnum representing the
session ID of the process with process ID <var>pid</var>, which must be a
fixnum; else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_getpgrp</b> (<var>void</var>)<var><a name="index-ikrt_005fposix_005fgetpgrp-1170"></a></var><br>
<blockquote><p>Interface to the C function <code>getpgrp()</code>, <a href="libc.html#Process-Group-Functions">getpgrp</a>.  Return a fixnum representing the process group ID
of the calling process. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_setpgid</b> (<var>ikptr pid, ikptr pgid</var>)<var><a name="index-ikrt_005fposix_005fsetpgid-1171"></a></var><br>
<blockquote><p>Interface to the C function <code>setpgid()</code>, <a href="libc.html#Process-Group-Functions">setpgid</a>.  Put the process <var>pid</var> in the process group
<var>pgid</var>.  If successful return the fixnum zero, else return an
encoded <code>errno</code> value. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_tcgetpgrp</b> (<var>ikptr fd</var>)<var><a name="index-ikrt_005fposix_005ftcgetpgrp-1172"></a></var><br>
<blockquote><p>Interface to the C function <code>tcgetpgrp()</code>, <a href="libc.html#Terminal-Access-Functions">tcgetpgrp</a>.  If successful return a fixnum representing the
process group ID of the foreground process group associated with the
terminal open on descriptor <var>fd</var>, which must be a fixnum; else
return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_tcsetpgrp</b> (<var>ikptr fd, ikptr pgid</var>)<var><a name="index-ikrt_005fposix_005ftcsetpgrp-1173"></a></var><br>
<blockquote><p>Interface to the C function <code>tcsetpgrp()</code>, <a href="libc.html#Terminal-Access-Functions">tcsetpgrp</a>.  Set to process group ID <var>pgid</var> the
foreground process group for the terminal open on descriptor <var>fd</var>;
both the arguments must be fixnums.  If successful return the fixnum
zero, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_tcgetsid</b> (<var>ikptr fd</var>)<var><a name="index-ikrt_005fposix_005ftcgetsid-1174"></a></var><br>
<blockquote><p>Interface to the C function <code>tcgetsid()</code>, <a href="libc.html#Terminal-Access-Functions">tcgetsid</a>.  If successful return a fixnum representing the
process group ID of the session for which the terminal open on
descriptor <var>fd</var> is the controlling terminal; else return an encoded
<code>errno</code> value. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-posix-time"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix-job">capi posix job</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-posix">capi posix</a>

</div>

<h4 class="subsection">9.2.17 Date and time</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_clock</b> (<var>ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fclock-1175"></a></var><br>
<blockquote><p>Interface to the C function <code>clock()</code>, <a href="libc.html#CPU-Time">clock</a>. 
If successful return an <strong>inexact</strong> integer representing the CPU
time for the calling process expressed in clock ticks; if the clock time
is not available return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_times</b> (<var>ikptr rtd, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005ftimes-1176"></a></var><br>
<blockquote><p>Interface to the C function <code>times()</code>, <a href="libc.html#Processor-Time">times</a>.  If successful return an instance of <code>struct-tms</code>
representing the current processor time with all the fields set to
inexact integers, else return false; <var>rtd</var> must be the type
descriptor of <code>struct-tms</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_time</b> (<var>ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005ftime-1177"></a></var><br>
<blockquote><p>Interface to the C function <code>time()</code>, <a href="libc.html#Simple-Calendar-Time">time</a>.  If successful return the calendar time as an
<strong>inexact</strong> integer, else return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_gettimeofday</b> (<var>ikptr rtd, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgettimeofday-1178"></a></var><br>
<blockquote><p>Interface to the C function <code>gettimeofday()</code>,
<a href="libc.html#High_002dResolution-Calendar">gettimeofday</a>.  Acquire the current
time.  If successful return an instance of <code>struct-timeval</code>, else
return an encoded <code>errno</code> value.  <var>rtd</var> must be the type
descriptor of <code>struct-timeval</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_localtime</b> (<var>ikptr rtd, ikptr time, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005flocaltime-1179"></a></var><br>
<blockquote><p>Interface to the C function <code>localtime()</code>, <a href="libc.html#Broken_002ddown-Time">localtime</a>.  Given an exact integer <var>time</var> representing the
local time as returned by the <code>posix-time</code> function: build and
return an instance of <code>struct-tm</code> representing the same time in
human readable form; if an error occurs return false.  <var>rtd</var> must be
the type descriptor of <code>struct-tm</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_gmtime</b> (<var>ikptr rtd, ikptr time, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fgmtime-1180"></a></var><br>
<blockquote><p>Interface to the C function <code>gmtime()</code>, <a href="libc.html#Broken_002ddown-Time">gmtime</a>.  Given an exact integer <var>time</var> representing the <acronym>UTC</acronym> time
as returned by the <code>posix-time</code> function: build and return an
instance of <code>struct-tm</code> representing the same time in human
readable form; if an error occurs return false.  <var>rtd</var> must be the
type descriptor of <code>struct-tm</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_timelocal</b> (<var>ikptr tm, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005ftimelocal-1181"></a></var><br>
<blockquote><p>Interface to the C function <code>timelocal()</code>, <a href="libc.html#Broken_002ddown-Time">timelocal</a>.  Given a reference to a <code>struct-rm</code>, <var>tm</var>,
representing a local broken time, convert it into a time value as
returned by <code>time()</code>.  If successful return an <strong>inexact</strong>
integer representing the time value, else return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_timegm</b> (<var>ikptr tm, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005ftimegm-1182"></a></var><br>
<blockquote><p>Interface to the C function <code>timegm()</code>, <a href="libc.html#Broken_002ddown-Time">timegm</a>.  Given a reference to a <code>struct-rm</code>, <var>tm</var>,
representing a <acronym>UTC</acronym> broken time, convert it into a time value as
returned by <code>time()</code>.  If successful return an <strong>inexact</strong>
integer representing the time value, else return false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_posix_strftime</b> (<var>ikptr template, ikptr tm, ikpcb * pcb</var>)<var><a name="index-ikrt_005fposix_005fstrftime-1183"></a></var><br>
<blockquote><p>Interface to the C function <code>strftime()</code>, <a href="libc.html#Formatting-Calendar-Time">strftime</a>.  Given a bytevector <var>template</var> holding an
<acronym>ASCII</acronym> coded format string and a <code>struct-tm</code> instance <var>tm</var>:
build a formatted time string; the resulting time string can be at most
4096 bytes wide.  If successful return a bytevector holding the
time string in <acronym>ASCII</acronym> coding, else return false. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_nanosleep</b> (<var>ikptr secs, ikptr nsecs</var>)<var><a name="index-ikrt_005fnanosleep-1184"></a></var><br>
<blockquote><p>Interface to the C function <code>nanosleep()</code>, <a href="libc.html#Sleeping">nanosleep</a>.  Halt the current process for the specified amount of time.

        <p>The count of seconds <var>secs</var> must be an exact integer in the range
[0, 2^32); the count of nanoseconds <var>nsecs</var> must be an exact
integer in the range [0, 999999999].

        <p>If successful and the requested time is elapsed: return a pair whose car
is false and whose cdr is false.  If successful and the sleeping was
interrupted by an interprocess signal: return a pair whose car is an
exact integer representing the count of remaining seconds and whose cdr
is an exact integer representing the count of remaining nanoseconds.  If
an error occurs return an encoded <code>errno</code> value. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_current_time</b> (<var>ikptr time</var>)<var><a name="index-ikrt_005fcurrent_005ftime-1185"></a></var><br>
<blockquote><p>Interface to the <code>gettimeofday()</code> C function. 
<a href="libc.html#High_002dResolution-Calendar">gettimeofday</a>.  Retrieve the current
time.  <var>time</var> must reference a <code>time</code> internal structure, which
is filled with three values: megaseconds, seconds and microseconds. 
Always return <var>time</var> itself. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_gmt_offset</b> (<var>ikptr time</var>)<var><a name="index-ikrt_005fgmt_005foffset-1186"></a></var><br>
<blockquote><p>Compute the offset in seconds between the local time and the
<acronym>UTC</acronym> time.  <var>time</var> must reference a <code>time</code> internal
structure, already filled with megaseconds, seconds and microseconds. 
Return a fixnum representing the offset. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-linux"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-glibc">capi glibc</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-posix">capi posix</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi">capi</a>

</div>

<h3 class="section">9.3 C language level <acronym>GNU</acronym>+Linux interface</h3>

<ul class="menu">
<li><a accesskey="1" href="#capi-linux-status">capi linux status</a>:            Process termination status. 
</ul>

<!-- page -->
<div class="node">
<a name="capi-linux-status"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-linux">capi linux</a>

</div>

<h4 class="subsection">9.3.1 Process termination status</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_linux_waitid</b> (<var>ikptr idtype, ikptr id, ikptr info, ikptr options</var>)<var><a name="index-ikrt_005flinux_005fwaitid-1187"></a></var><br>
<blockquote><p>Interface to the Linux specific C function <code>waitid()</code>, see the
<code>waitid()</code> manual page for details.  Wait for the termination of one
or more child processes with finer control of <code>waitpid()</code>.  The
arguments <var>idtype</var>, <var>id</var> and <var>options</var> must be fixnums. 
<var>info</var> must be a reference to a structure of type
<code>struct-siginfo_t</code>, <a href="#linux-status">linux status</a> for details.  If successful:
return <var>info</var> itself, else raise an exception. 
</p></blockquote></div>

   <p>The following functions accept as argument a fixnum representing the
process termination status, for example the return value of
<code>system()</code> or the status acquired by <code>waitpid()</code>.

<div class="defun">
&mdash; Function: ikptr <b>ikrt_linux_WIFCONTINUED</b> (<var>ikptr status</var>)<var><a name="index-ikrt_005flinux_005fWIFCONTINUED-1188"></a></var><br>
<blockquote><p>Interface to the Linux specific C macro <code>WIFCONTINUED()</code>.  Return
true if the process was resumed by delivery of <code>SIGCONT</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-glibc"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-linux">capi linux</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi">capi</a>

</div>

<h3 class="section">9.4 C language level <acronym>GNU</acronym> C Library interface</h3>

<ul class="menu">
<li><a accesskey="1" href="#capi-glibc-env">capi glibc env</a>:               Operating system environment variables. 
<li><a accesskey="2" href="#capi-glibc-dir">capi glibc dir</a>:               File system directories. 
<li><a accesskey="3" href="#capi-glibc-temp">capi glibc temp</a>:              Temporary files and directories. 
<li><a accesskey="4" href="#capi-glibc-sync">capi glibc sync</a>:              File system synchronisation. 
<li><a accesskey="5" href="#capi-glibc-socket">capi glibc socket</a>:            Network sockets. 
</ul>

<!-- page -->
<div class="node">
<a name="capi-glibc-env"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-glibc-dir">capi glibc dir</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-glibc">capi glibc</a>

</div>

<h4 class="subsection">9.4.1 Operating system environment variables</h4>

<div class="defun">
&mdash; Function: ikrt <b>ikrt_glibc_clearenv</b> (<var>void</var>)<var><a name="index-ikrt_005fglibc_005fclearenv-1189"></a></var><br>
<blockquote><p>Interface to the C function <code>clearenv()</code>, <a href="libc.html#Environment-Access">clearenv</a>.  Remove all the entries from the environment.  Return
the void object. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-glibc-dir"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-glibc-temp">capi glibc temp</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-glibc-env">capi glibc env</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-glibc">capi glibc</a>

</div>

<h4 class="subsection">9.4.2 File system directories</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_glibc_dirfd</b> (<var>ikptr pointer</var>)<var><a name="index-ikrt_005fglibc_005fdirfd-1190"></a></var><br>
<blockquote><p>Interface to the C function <code>dirfd()</code>, <a href="libc.html#Opening-a-Directory">dirfd</a>.  Acquire a file descriptor associated to the
directory entry referenced by <var>pointer</var>, which must be a pointer
object to a directory entry.  If successful return a fixnum representing
the file descriptor, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-glibc-temp"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-glibc-sync">capi glibc sync</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-glibc-dir">capi glibc dir</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-glibc">capi glibc</a>

</div>

<h4 class="subsection">9.4.3 Temporary files and directories</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_glibc_mkstemp</b> (<var>ikptr template, ikpcb * pcb</var>)<var><a name="index-ikrt_005fglibc_005fmkstemp-1191"></a></var><br>
<blockquote><p>Interface to the C function <code>mkstemp()</code>, <a href="libc.html#Temporary-Files">mkstemp</a>.  Create a temporary file, open it and open a file descriptor
for reading and writing.  <var>template</var> must be a mutable bytevector
holding a template pathname on entering and the actual pathname on
returning.  If successful return a file descriptor, else return an
encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_glibc_mkdtemp</b> (<var>ikptr template, ikpcb * pcb</var>)<var><a name="index-ikrt_005fglibc_005fmkdtemp-1192"></a></var><br>
<blockquote><p>Interface to the C function <code>mkdtemp()</code>, <a href="libc.html#Temporary-Files">mkdtemp</a>.  Create a temporary directory for reading and writing. 
<var>template</var> must be a mutable bytevector holding a template pathname
on entering and the actual pathname on returning.  If successful return
<var>template</var> itself, else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-glibc-sync"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#capi-glibc-socket">capi glibc socket</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-glibc-temp">capi glibc temp</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-glibc">capi glibc</a>

</div>

<h4 class="subsection">9.4.4 File system synchronisation</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_glibc_sync</b> (<var>void</var>)<var><a name="index-ikrt_005fglibc_005fsync-1193"></a></var><br>
<blockquote><p>Interface to the C function <code>sync()</code>, <a href="libc.html#Synchronizing-I_002fO">Synchronizing I/O</a>. 
Flush kernel buffer data and meta informations to the file system
devices.  If successful return the fixnum zero, else return an encoded
<code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_glibc_fsync</b> (<var>ikptr fd</var>)<var><a name="index-ikrt_005fglibc_005ffsync-1194"></a></var><br>
<blockquote><p>Interface to the C function <code>fsync()</code>, <a href="libc.html#Synchronizing-I_002fO">Synchronizing I/O</a>. 
Flush kernel buffer data and meta informations to the file system device
for the file descriptor <var>fd</var>.  If successful return the fixnum zero,
else return an encoded <code>errno</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_glibc_fdatasync</b> (<var>ikptr fd</var>)<var><a name="index-ikrt_005fglibc_005ffdatasync-1195"></a></var><br>
<blockquote><p>Interface to the C function <code>fdatasync()</code>, <a href="libc.html#Synchronizing-I_002fO">Synchronizing I/O</a>.  Flush kernel buffer data to the file system device for the file
descriptor <var>fd</var>.  If successful return the fixnum zero, else return
an encoded <code>errno</code> value. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="capi-glibc-socket"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi-glibc-sync">capi glibc sync</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#capi-glibc">capi glibc</a>

</div>

<h4 class="subsection">9.4.5 Network sockets</h4>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_glibc_if_nametoindex</b> (<var>ikptr name</var>)<var><a name="index-ikrt_005fglibc_005fif_005fnametoindex-1196"></a></var><br>
<blockquote><p>Interface to the C function <code>if_nametoindex()</code>, <a href="libc.html#Interface-Naming">if_nametoindex</a>.  Convert a string representing a network
interface to the corresponding internal index.  <var>name</var> must be a
bytevector holding the <acronym>UTF</acronym>-8 representation of the string.  Return a
fixnum representing the index or false if <var>name</var> is invalid. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_glibc_if_indextoname</b> (<var>ikptr index, ikpcb * pcb</var>)<var><a name="index-ikrt_005fglibc_005fif_005findextoname-1197"></a></var><br>
<blockquote><p>Interface to the C function <code>if_indextoname()</code>, <a href="libc.html#Interface-Naming">if_indextoname</a>.  Convert the index associated to an interface
to the corresponding string name.  <var>index</var> must be a fixnum
representing the index.  Return a bytevector holding the name or false
if <var>index</var> is invalid. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_glibc_if_nameindex</b> (<var>ikpcb * pcb</var>)<var><a name="index-ikrt_005fglibc_005fif_005fnameindex-1198"></a></var><br>
<blockquote><p>Interface to the C function <code>if_nameindex()</code>, <a href="libc.html#Interface-Naming">if_nameindex</a>.  Build and return an association list having
fixnums as keys and bytevectors as values; the fixnums are the interface
indexes, the bytevectors are the corresponding interface names. 
</p></blockquote></div>

<!--  -->
<div class="defun">
&mdash; Function: ikptr <b>ikrt_glibc_gethostbyname2</b> (<var>ikptr rtd, ikptr hostname, ikptr addrtype, ikpcb * pcb</var>)<var><a name="index-ikrt_005fglibc_005fgethostbyname2-1199"></a></var><br>
<blockquote><p>Interface to the C function <code>gethostbyname2()</code>, <a href="libc.html#Host-Names">gethostbyname2</a>.  Like <code>ikrt_posix_gethostbyname()</code> but
allows the selection of the address type with <var>addrtype</var> which must
be <code>AF_INET</code> or <code>AF_INET6</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="gcc"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects">objects</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#capi">capi</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">10 A toy library interface to <acronym>GCC</acronym></h2>

<p>The library <code>(vicare gcc)</code> is installed along with
Vicare; it implements a toy interface to <samp><span class="command">gcc</span></samp>, the
<acronym>GNU</acronym> C Compiler.  Its purpose is to build, at runtime, a C language
shared library from possibly dynamically constructed C code; then load
the library and access a C function as <acronym>FFI</acronym> callout.

   <p><code>(vicare gcc)</code> must be considered as a toy to demonstrate the
features of Vicare.

   <p>The following is an example of function to increment an integer:

<pre class="example">     #!r6rs
     (import (vicare)
       (prefix (vicare gcc) gcc.))
     
     (gcc.initialise "/usr/local/bin/gcc" "/home/marco/var/tmp/")
     
     (gcc.define-c-function
       signed-int incr (signed-int)
       "#include &lt;stdio.h&gt;
        int incr (int a) {
          return 1+a;
        }")
     
     (incr 1)        &rArr; 2
</pre>
   <p class="noindent">the code creates a shared library <code>libincr.so</code> in a subdirectory of
the given initialisation directory, then load it and access the symbol
<code>incr</code>.

   <p><code>(vicare gcc)</code> depends upon the following libraries:

<pre class="example">     (vicare ffi)
     (vicare posix)
     (vicare glibc)
     (vicare platform-constants)
     (vicare syntactic-extensions)
</pre>
   <div class="defun">
&mdash; Function: <b>initialise</b><var> gcc tmpdir<a name="index-initialise-1200"></a></var><br>
<blockquote><p>Initialise the library.  <var>gcc</var> must be the string full filename of
the <acronym>GCC</acronym> executable.  <var>tmpdir</var> must be the string pathname of an
existing directory on a partition with executable permissions; it is
used to create temporary files, including the shared libraries.

        <p>Temporary files go in a subdirectory of <var>tmpdir</var>; it is the
responsibility of the system administrator to clean up regularly such
subdirectories. 
</p></blockquote></div>

<div class="defun">
&mdash; Syntax: <b>define-c-function</b><var> &lt;retval&gt; &lt;name&gt; &lt;args&gt; &lt;code&gt;<a name="index-define_002dc_002dfunction-1201"></a></var><br>
<blockquote><p>Define a new Scheme function wrapping a C function from a shared
library.  &lt;name&gt; must be an identifier representing the name of the
function.

        <p>&lt;retval&gt; must be a symbol selecting the type of the return value;
&lt;args&gt; must be a list of symbols selecting the types of the
arguments; <a href="#ffi-call-types">ffi call types</a> for details.

        <p>&lt;code&gt; must be a Scheme string representing the C code to be
compiled. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>COMPILE-FLAGS</b><var><a name="index-COMPILE_002dFLAGS-1202"></a></var><br>
<blockquote><p>References a list of string.  Base options for the compiler, it is
initialised to <code>("-c")</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>LINK-FLAGS</b><var><a name="index-LINK_002dFLAGS-1203"></a></var><br>
<blockquote><p>References a list of string.  Base options for the linker, it is
initialised to <code>("-pipe" "-shared" "-fPIC")</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>CFLAGS</b><var><a name="index-CFLAGS-1204"></a></var><br>
<blockquote><p>References a list of string.  Additional options for the compiler, it is
initialised to <code>("-O2")</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>LDFLAGS</b><var><a name="index-LDFLAGS-1205"></a></var><br>
<blockquote><p>References a list of string.  Additional options for the linker, it is
initialised to nil. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#debug-int">debug int</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#gcc">gcc</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">11 Built in Scheme objects</h2>

<p>Built in Scheme objects are mostly implemented in the C language portion
of the source code, but many core operations are also reimplemented at
the Scheme level.  The overall definitions are in the C language file
<samp><span class="file">vicare.h</span></samp> and the definition of many values is duplicated in the
Scheme language compiler <samp><span class="file">ikarus.compiler.sls</span></samp>.

<ul class="menu">
<li><a accesskey="1" href="#objects-refs">objects refs</a>:                 Builtin objects and tags. 
<li><a accesskey="2" href="#objects-memory">objects memory</a>:               Memory allocation and collection. 
<li><a accesskey="3" href="#objects-fixnums">objects fixnums</a>:              Fixnum objects. 
<li><a accesskey="4" href="#objects-pairs">objects pairs</a>:                Pair objects and lists. 
<li><a accesskey="5" href="#objects-bytevectors">objects bytevectors</a>:          Bytevector objects. 
<li><a accesskey="6" href="#objects-vectors">objects vectors</a>:              Vector objects. 
<li><a accesskey="7" href="#objects-structs">objects structs</a>:              Struct objects. 
<li><a accesskey="8" href="#objects-chars">objects chars</a>:                Character objects. 
<li><a accesskey="9" href="#objects-strings">objects strings</a>:              String objects. 
<li><a href="#objects-symbols">objects symbols</a>:              Symbol objects. 
<li><a href="#objects-bignums">objects bignums</a>:              Bignum objects. 
<li><a href="#objects-ratnums">objects ratnums</a>:              Ratnum objects. 
<li><a href="#objects-flonums">objects flonums</a>:              Flonum objects. 
<li><a href="#objects-compnums">objects compnums</a>:             Compnum objects. 
<li><a href="#objects-cflonums">objects cflonums</a>:             Cflonum objects. 
<li><a href="#objects-ports">objects ports</a>:                Port objects. 
<li><a href="#objects-transcoders">objects transcoders</a>:          Transcoder objects. 
<li><a href="#objects-pointers">objects pointers</a>:             Pointer objects. 
<li><a href="#objects-misc">objects misc</a>:                 Miscellaneous functions. 
</ul>

<!-- page -->
<div class="node">
<a name="objects-refs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-memory">objects memory</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.1 Built in object references</h3>

<p>Values of type <code>ikptr</code> at the C language level are the ones we move
around as arguments and return values at the Scheme level; they
represent machine words.  <code>ikptr</code> values have two major
interpretations:

     <dl>
<dt><strong>Immediate values</strong><dd>Objects that fit in a single machine word: special constants, fixnums,
characters and input/output port transcoders.

     <br><dt><strong>Reference values</strong><dd>Objects allocated on the heap and subject to garbage collection; they
are represented by tagged pointers: symbols, pairs, vectors,
bytevectors, structures, ports, bignums, ratnums, flonums, compnums,
cflonums, strings, closures, continuations, codes, pointers. 
</dl>

<p class="noindent">immediate <code>ikptr</code> values have two minor interpretations:

     <dl>
<dt><strong>Immediate special constants</strong><dd>These are <code>#t</code>, <code>#f</code>, nil, void, unbound, <acronym>BWP</acronym>.

     <br><dt><strong>Immediate variable values</strong><dd>These are fixnums, characters and transcoders. 
</dl>

<p class="noindent">reference <code>ikptr</code> values have two minor interpretations:

     <dl>
<dt><strong>Vector tagged references</strong><dd>Memory pointer values whose 3 least significant bits are set to
the vector tag.  They reference multiword objects allocated on the heap:
vectors, bignums, structures, flonums, ratnums, compnums, cflonums,
continuations, code, ports, symbols, pointers.

     <br><dt><strong>Specially tagged references</strong><dd>Pointer values whose 3 least significant bits are set to a
type&ndash;specific tag.  They reference multiword objects allocated on the
heap: pairs, bytevectors, closures, strings. 
</dl>

<div class="defun">
&mdash; Object Reference: <b>ikptr</b><var><a name="index-ikptr-1206"></a></var><br>
<blockquote><p>An immediate built in object or a reference to a built in object;
implemented as an <code>unsigned long int</code> it is meant to be the size of
a machine word.  The definition assumes that:

          <ul>
<li>On 32-bit platforms, <code>unsigned long int</code> is a 32-bit value.

          <li>On 64-bit platforms, <code>unsigned long int</code> is a 64-bit value.

          <li>The type <code>unsigned long int</code> is big enough to hold a pointer for
the underlying platform. 
</ul>
        </p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: int <b>IK_TAGOF</b> (<var>ikptr ref</var>)<var><a name="index-IK_005fTAGOF-1207"></a></var><br>
<blockquote><p>Return an integer representing the 3 least significant bits of an
<code>ikptr</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_REF</b> (<var>ikptr value_ref, long byte_offset</var>)<var><a name="index-IK_005fREF-1208"></a></var><br>
&mdash; Preprocessor Macro: ikptr <b>ref</b> (<var>ikptr value_ref, long byte_offset</var>)<var><a name="index-ref-1209"></a></var><br>
<blockquote><p>Getter and setter for machine words allocated on the heap.  Interpret
<var>value_ref</var> as a pointer to an array of <code>ikptr</code> and locate the
value at the zero&ndash;based <var>byte_offset</var>.  A use of this macro can
appear both as operand and as left&ndash;side of an assignment.

     <pre class="example">          ikptr   P, Q;
          
          Q = IK_REF(P, 2);     /* retrieve the 3rd word */
          IK_REF(P, 0) = 123L;  /* store a value in the 1st word */
</pre>
        <p>Both <var>value_ref</var> and <var>byte_offset</var> are first cast to <code>long</code>
values, then added and the sum is cast to <code>ikptr *</code>.

        <p>Values for <var>byte_offset</var> are usually precomputed and take into
account a component used to remove the tag from the pointer in
<var>value_ref</var>.

        <blockquote>
<strong>NOTE</strong> <code>ref()</code> is defined only in the internal header file
and its use is deprecated. 
</blockquote>
        </p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Immediate values</h5>

<p>All the immediate values but fixnums have the 3 least significant
bits set to 1; to distinguish between immediate values and
references we can do:

<pre class="example">     ikptr   X;
     
     if (IK_IS_FIXNUM(X) || (immediate_tag == IK_TAGOF(X)))
       it_is_immediate();
     else
       it_is_not();
</pre>
   <p class="noindent">where:

<pre class="example">     immediate_tag = 7 = #b111
</pre>
   <div class="defun">
&mdash; Macro: <b>false_object</b><var> 0x2F<a name="index-false_005fobject-1210"></a></var><br>
&mdash; Macro: <b>true_object</b><var> 0x3F<a name="index-true_005fobject-1211"></a></var><br>
&mdash; Macro: <b>null_object</b><var> 0x4F<a name="index-null_005fobject-1212"></a></var><br>
&mdash; Macro: <b>eof_object</b><var> 0x5F<a name="index-eof_005fobject-1213"></a></var><br>
&mdash; Macro: <b>void_object</b><var> 0x7F<a name="index-void_005fobject-1214"></a></var><br>
<blockquote><p>Special machine words of type <code>ikptr</code> representing, respectively:
<code>#f</code>; <code>#t</code>; nil, the empty list; <acronym>EOF</acronym>, the end of file;
<code>#&lt;void&gt;</code>, the return value of functions returning no value. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>unbound_object</b><var> 0x6F<a name="index-unbound_005fobject-1215"></a></var><br>
<blockquote><p>Special machine word value stored in the <code>value</code> and <code>proc</code>
fields of Scheme symbol memory blocks to signal that these fields are
unset. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>bwp_object</b><var> 0x8F<a name="index-bwp_005fobject-1216"></a></var><br>
<blockquote><p>Special machine word value stored in locations that used to hold weak
references to values which have been already garbage collected. 
</p></blockquote></div>

   <p>The variable values that fit in a single machine word are fixnums,
characters and port transcoders.  The last byte of these machine words
is tagged as follows:

<pre class="example">        object      |  tag bits  | tag hex | mask bits
     ---------------+------------+---------+------------
     fixnums 32-bit | #b??????00 |   --    | #b00000011
     fixnums 64-bit | #b?????000 |   --    | #b00000111
     characters     | #b00001111 |  #x0F   | #b11111111
     transcoders    | #b01111111 |  #x7F   | #b11111111
</pre>
   <p class="noindent">to identify a fixnum we can do:

<pre class="example">     ikptr   X;
     
     if (fx_tag == (X &amp; fx_mask))
       it_is_a_fixnum();
     else
       it_is_not();
</pre>
   <p class="noindent">or just use the macro <code>IK_IS_FIXNUM()</code>; similarly for for the other
immediate variable values.

   <p>Notice that a <code>NULL</code> pointer stored in a <code>ikptr</code> with zero bits as
tag represents the fixnum zero; also, the zero tag bits for fixnums are
in such a number that: a tagged <code>ikptr</code> fixnum can be interpreted as
the number of bytes needed to hold a number of machine words equal to
the number represented by the fixnum itself, that is the following holds
true:

<pre class="example">     long    number_of_words = ...;
     
     number_of_words * wordsize == number_of_words &lt;&lt; fx_shift;
</pre>
   <p class="noindent">where <code>fx_shift</code> is the number of bits in the fixnum's tag.

<!--  -->
<h5 class="subsubheading">Values allocated on the heap</h5>

<p>The values that do not fit into a single machine word are composed of a
reference machine word and an array of machine words on the heap; they
are: symbols, pairs, vectors, bytevectors, structures, ports, bignums,
ratnums, flonums, compnums, cflonums, strings, closures, continuations,
codes, pointers.

   <p>The machine words used as reference have the 3 least significant
bits used as tag and the remaining most significant bits used to store a
pointer in memory; on 32-bit platforms the layout of such machine words
is:

<pre class="example">      PPPPPPPP PPPPPPPP PPPPPPPP PPPPPTTT   P = bit of pointer
     |--------|--------|--------|--------|  T = bit of tag
       byte 3   byte 2   byte 1   byte 0
</pre>
   <p class="noindent">the following tags are used:

<pre class="example">       object    | tag bits | tag hex | mask bits
     ------------+----------+---------+------------
     pairs       |   #b001  |   #x1   | #b00000111
     bytevectors |   #b010  |   #x2   | #b00000111
     closure     |   #b011  |   #x3   | #b00000111
     vectors     |   #b101  |   #x5   | #b00000111
     strings     |   #b110  |   #x6   | #b00000111
</pre>
   <p class="noindent">notice how <strong>none</strong> of the tags for reference words is
<code>#b111</code>, which is reserved for immediate values; also notice how
<code>#b100</code> must <strong>not</strong> be used as tag, because on 32-bit
platforms it would match the fixnums with the least significant bit set
to zero.

   <p>The vector tag is used to tag machine word references to multiple object
types: vectors, bignums, structures, flonums, ratnums, compnums,
cflonums, continuations, code, ports, symbols, pointers, system
continuations.  The first word in the memory block of these types has
the least significant bits set to a secondary tag.

   <p>All the possible values for 3-bit tags in reference values are
already allocated; new object types can be added only defining a new
secondary tag with references tagged as vector.

   <p>While the <acronym>API</acronym> defines predicates to recognise values, to identify a
type&ndash;specific reference we can do:

<pre class="example">     ikptr   X;
     
     if (pair_tag == (X &amp; pair_mask))
       it_is_a_pair();
     else
       it_is_not();
</pre>
   <p class="noindent">similarly for the other types.  The vector tag acts as <dfn>primary
tag</dfn>; a <dfn>secondary tag</dfn> is stored in the least significant bits of
the referenced vector of words on the heap; to recognise such values we
can do:

<pre class="example">     ikptr  X;
     
     if ((vector_tag    == (X &amp; vector_tag)) &amp;&amp;
         (secondary_tag == (secondary_mask
                            &amp; IK_REF(X, -vector_tag))))
       it_is();
     else
       it_is_not();
</pre>
   <p class="noindent">where <code>secondary_tag</code> and <code>secondary_mask</code> are type&ndash;specific. 
The secondary tags and the associated masks are:

<pre class="example">        object           |  tag bits   | tag hex | tag mask
                         |    76543210 |         |    76543210
     --------------------+-------------+---------+-------------
     vector              |  #b??????00 | fixnum  | #b00000111
     bignum              |  #b????s011 |   #x03  | #b00000111
     structure           |  #b?????101 |   #x05  | #b00000111
     flonum              |  #b00010111 |   #x17  |    --
     ratnum              |  #b00100111 |   #x27  |    --
     compnum             |  #b00110111 |   #x37  |    --
     cflonum             |  #b01000111 |   #x47  |    --
     continuation        |  #b00011111 |   #x1F  |    --
     code                |  #b00101111 |   #x2F  |    --
     port                |  #b??111111 |   #x3F  | #b00111111
     symbol              |  #b01011111 |   #x5F  |    --
     pointer             | #b100000111 |  #x107  |    --
     system continuation | #b100011111 |  #x11F  |    --
</pre>
   <p class="noindent">notice how the port secondary tag has all the 6 least significant
bits set to 1: no other tag must have all such bits set to
1.  Secondary tags for new types can be allocated by selecting
the least significant byte to <code>#x0F</code> and reserving a specific bit
pattern in the most significant bytes.

   <p>The only tags having an associated mask are the ones of objects storing
additional informations in the first word of the heap vector:

     <dl>
<dt><strong>Vectors</strong><dd>The first word of a vector is a fixnum representing the number of
elements.

     <br><dt><strong>Bignums</strong><dd>The first word uses the 3 least significant bits as tag, the
4th bit representing the sign (0 for positive, 1
for negative) and the remaining bits representing the number of words in
the bignum data area.

     <br><dt><strong>Structures</strong><dd>The first word is tagged as vector, because the first word of a
structure is itself a reference to a structure: the type descriptor.

     <br><dt><strong>Ports</strong><dd>The most significant bits of the first word are used for port
attributes. 
</dl>

<!-- page -->
<div class="node">
<a name="objects-memory"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-fixnums">objects fixnums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-refs">objects refs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.2 Memory allocation and collection</h3>

<p>In short, memory allocation which may trigger a garbage collection is
performed as follows:

<pre class="example">     ikpcb *   pcb = the_pcb;
     long int  number_of_bytes = the_number_of_bytes;
     ikptr     p = ik_safe_alloc(pcb, IK_ALIGN(number_of_bytes));
</pre>
   <p class="noindent">while memory allocation without garbage collection is performed as
follows:

<pre class="example">     ikpcb *   pcb = the_pcb;
     long int  number_of_bytes = the_number_of_bytes;
     ikptr     p = ik_unsafe_alloc(pcb, IK_ALIGN(number_of_bytes));
</pre>
   <p class="noindent">where <code>p</code> is an untagged memory pointer and <code>pcb</code> is a pointer
to the &ldquo;Process Control Block&rdquo; data structure.

   <p>To add a tag, for example the <code>vector_tag</code>, to an untagged memory
pointer we can do:

<pre class="example">     ikpcb * pcb = the_pcb;
     long    len = IK_ALIGN(the_number_of_bytes);
     ikptr   ref = ik_safe_alloc(pcb, len) | vector_tag;
</pre>
   <p>Objects subject to garbage collection are allocated on the Scheme heap,
which is an array of contiguous memory segments; the next object is
allocated in the &ldquo;current segment&rdquo; of the heap:

<pre class="example">         allocated  allocated      allocated
         block      block          block
     ...|----------|--------------|--------|------...
         ^          ^              ^        ^
         |          |              |        |
       pointer    pointer        pointer   pointer to
                                           next block
</pre>
   <p class="noindent">every pointer must satisfy alignment constraints with the following
purposes:

     <ol type=1 start=1>
<li>To make pointer indirection efficient for the underlying platform.

     <li>To have pointer values with the 3 least significant bits set to
zero, so that such bits can be used to hold an object's type tag.
        </ol>

<p class="noindent">for these reasons we must always filter the requested size (in bytes)
through the <code>IK_ALIGN()</code> macro.  The <acronym>PCB</acronym> always references a
&ldquo;pointer to the next free block&rdquo; with alignment constraints satisfied;
if we filter the requested number of bytes through <code>IK_ALIGN()</code>, we
obtain a number of bytes which, added to the pointer, gives a correctly
aligned pointer:

<pre class="example">     uint8_t * allocated_block = (uint8_t *)pcb-&gt;allocation_pointer;
     long      requested_size  = ...;
     long      align_size      = IK_ALIGN(requested_size);
     uint8_t * next_free_block = allocated_block + align_size;
     pcb-&gt;allocation_pointer   = (ikptr)next_free_block;
     
     /* use "allocated_block" */
     
     
                 requested size
            |.......................|
                 aligned size
            |..........................|
     ...----|--------------------------|-----------....
             ^                          ^
             |                          |
           pointer to an              pointer to the
           allocated block            next block
</pre>
   <div class="defun">
&mdash; Global Variable: ikpcb * <b>the_pcb</b><var><a name="index-the_005fpcb-1217"></a></var><br>
<blockquote><p>Global variable referencing the process control block.  It is rarely
needed because when calling a C function from Scheme a pointer to the
<acronym>PCB</acronym> is always pushed on the C stack as last argument. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: unsigned long <b>IK_ALIGN</b> (<var>unsigned long number_of_bytes</var>)<var><a name="index-IK_005fALIGN-1218"></a></var><br>
<blockquote><p>Convert <var>number_of_bytes</var> to the number of bytes requested to
satisfy pointer alignment constraints.  The aligned size is always an
exact multiple of the underlying platform's word size (32-bit or
64-bit); precisely: it is the smallest multiple of the wordsize which is
greater than <var>number_of_bytes</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ik_safe_alloc</b> (<var>ikpcb * pcb, unsigned long align_size</var>)<var><a name="index-ik_005fsafe_005falloc-1219"></a></var><br>
<blockquote><p>Allocate a memory block on the heap and return a reference to it as an
<strong>untagged</strong> pointer.  <var>pcb</var> must reference the process control
block, <var>align_size</var> must be the requested number of bytes filtered
through <code>IK_ALIGN()</code>.

        <p>If not enough memory is available on the current heap segment: a garbage
collection is triggered; then allocation is tried again: if it still
fails the process is terminated with exit status <code>EXIT_FAILURE</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ik_unsafe_alloc</b> (<var>ikpcb * pcb, unsigned long align_size</var>)<var><a name="index-ik_005funsafe_005falloc-1220"></a></var><br>
<blockquote><p>Allocate a memory block on the Scheme heap and return a reference to it
as an <strong>untagged</strong> pointer.  <var>pcb</var> must reference the process
control block, <var>align_size</var> must be the requested number of bytes
filtered through <code>IK_ALIGN()</code>.

        <p>If not enough memory is available on the current heap segment: a new
heap segment is allocated; if such allocation fails: the process is
terminated with exit status <code>EXIT_FAILURE</code>.

        <p>We notice explicitly that this function <strong>does not</strong> trigger a
garbage collection run, so, when using it, it is not needed to register
C pointers as garbage collection roots. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: <b>IK_ASS</b> (<var>ikptr left, ikptr right</var>)<var><a name="index-IK_005fASS-1221"></a></var><br>
<blockquote><p>Perform a C language assignment enforcing the order of evaluation of the
left&ndash;side and right&ndash;side expressions.  First evaluate <var>right</var>,
then evaluate <var>left</var>, finally store the result of <var>right</var> in the
lvalue resulting from evaluating <var>left</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Writing correct C language code</h5>

<p>The garbage collector considers an object &ldquo;in use&rdquo; if at least one
reference to it is reachable from the roots of the garbage collection;
if an <code>ikptr</code> reference exists only in a <acronym>CPU</acronym> register or on
the C language stack, or on the C language heap out of segments
allocated for Scheme: the garbage collector will not see it.  This
allows to avoid scanning the full process' stack for references to
values, but imposes care when writing C language code.

   <p>Whenever we call <code>ik_safe_alloc()</code> or a function relying on it for
memory allocation: a garbage collection may run and Scheme objects may
be moved from their location in memory to another memory segment; this
renders invalid all the pointers in the <acronym>CPU</acronym> registers, on the
C stack and the C heap.  Notice that this includes the arguments to C
functions called from Scheme through the macro <code>foreign-call</code>.

   <p>We must write C code with the following constraints:

     <ul>
<li>Before a call to <code>ik_safe_alloc()</code>: we must make sure that all the
Scheme objects we are using in C code are reachable by the garbage
collector.  This is done by registering an object as garbage collector
root through the <code>root</code> fields of the <acronym>PCB</acronym>.

     <li>After a call to <code>ik_safe_alloc()</code>: we must reobtain all the pointers
to the internals of the objects we are using. 
</ul>

   <p>To help identification of C functions and macros allocating memory: the
ones calling <code>ik_safe_alloc()</code> are prefixed with <code>ika_</code> and
<code>IKA_</code>; the ones calling <code>ik_unsafe_alloc()</code> are prefixed with
<code>iku_</code> and <code>IKU_</code>.

   <p>Example of <strong>correct</strong> code: <code>s_one</code> is protected while
allocating <code>s_two</code>:

<pre class="example">     ikpcb * pcb = the_pcb;
     ikptr   s_one, s_two;
     
     s_one = ika_bytevector_alloc(pcb, 10);
     pcb-&gt;root0 = &amp;s_one;
     {
       s_two = ika_bytevector_alloc(pcb, 10); /* GOOD */
     }
     pcb-&gt;root0 = NULL;
</pre>
   <p class="noindent">example of <strong>wrong</strong> code: after the second call to the allocation
function the value in <code>s_one</code> may be invalid:

<pre class="example">     ikpcb * pcb = the_pcb;
     ikptr   s_one, s_two;
     
     s_one = ika_bytevector_alloc(pcb, 10);
     s_two = ika_bytevector_alloc(pcb, 10);
     /* do something with "s_one" and "s_two" */ /* WRONG */
</pre>
   <p>Example of <strong>correct</strong> code: <code>s_one</code> is protected while
allocating <code>s_two</code> and after the second allocation the pointer to
the data area of <code>s_one</code> is retrieved again:

<pre class="example">     ikpcb * pcb = the_pcb;
     ikptr   s_one;
     ikptr   s_two;
     char *  one;
     char *  two;
     
     s_one = ika_bytevector_alloc(pcb, 10);
     one   = IK_BYTEVECTOR_DATA_CHARP(s_one);
     /* do something with "one" */
     pcb-&gt;root0 = &amp;s_one;
     {
       s_two = ika_bytevector_alloc(pcb, 10);
     }
     pcb-&gt;root0 = NULL;
     one   = IK_BYTEVECTOR_DATA_CHARP(s_one); /* GOOD */
     two   = IK_BYTEVECTOR_DATA_CHARP(s_two);
     /* do something with "one" and "two" */
</pre>
   <p class="noindent">example of <strong>wrong</strong> code: after the second call to the allocation
function the pointer to the data area of <code>s_one</code> may be invalid:

<pre class="example">     ikpcb * pcb = the_pcb;
     ikptr   s_one;
     ikptr   s_two;
     char *  one;
     char *  two;
     
     s_one = ika_bytevector_alloc(pcb, 10);
     one   = IK_BYTEVECTOR_DATA_CHARP(s_one);
     /* do something with "one" */
     pcb-&gt;root0 = &amp;s_one;
     {
       s_two = ika_bytevector_alloc(pcb, 10);
     }
     pcb-&gt;root0 = NULL;
     two   = IK_BYTEVECTOR_DATA_CHARP(s_two);
     /* do something with "one" and "two" */ /* WRONG */
</pre>
   <p>Notice that, according to the C standard Section 6.5.16 &ldquo;Assignment
operators&rdquo;: the order of evaluation of the operands is
unspecified<a rel="footnote" href="#fn-4" name="fnd-4"><sup>4</sup></a>.  In the following code:

<pre class="example">     IK_CAR(s_pair) = ika_bytevector_alloc(pcb, 8); /* WRONG */
</pre>
   <p class="noindent">the left&ndash;side expression may be evaluated before the right&ndash;side one,
resulting in the value referenced by <code>s_pair</code> to be invalid when
the memory assigment actually takes place; so we have to code:

<pre class="example">     ikptr   s_tmp;
     s_tmp          = ika_bytevector_alloc(pcb, 8); /* GOOD */
     IK_CAR(s_pair) = s_tmp;
</pre>
   <p class="noindent">or:

<pre class="example">     IK_ASS(IK_CAR(s_pair), ika_bytevector_alloc(pcb, 8)); /* GOOD */
</pre>
   <p class="noindent">yes, it is a hard life.

   <p>Let's consider the following snippet, which is <strong>wrong</strong>:

<pre class="example">     ikpcb * pcb = the_pcb;
     ikptr   s_one, s_two;
     
     s_one = IKA_PAIR_ALLOC(pcb); /* WRONG */
     pcb-&gt;root0 = &amp;s_one;
     {
       s_two = IKA_PAIR_ALLOC(pcb);
     }
     pcb-&gt;root0 = NULL;
</pre>
   <p class="noindent">when the second pair is allocated, the first pair has car and cdr still
uninitialised: the content of these words is undefined; this may cause
undefined behaviour while the second allocation takes place and the
garbage collection tries to scan the first pair.  The <strong>correct</strong>
code is:

<pre class="example">     ikpcb * pcb = the_pcb;
     ikptr   s_one, s_two;
     
     s_one = ika_pair_alloc(pcb); /* GOOD */
     pcb-&gt;root0 = &amp;s_one;
     {
       s_two = IKA_PAIR_ALLOC(pcb);
     }
     pcb-&gt;root0 = NULL;
</pre>
   <p class="noindent">because <code>ika_pair_alloc()</code> initialises the car and the cdr.

<!-- page -->
<div class="node">
<a name="objects-fixnums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-pairs">objects pairs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-memory">objects memory</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.3 Fixnum objects</h3>

<p>Fixnums are &ldquo;small&rdquo; exact integers which fit in a single machine word:
if the word size is 4, 30 bits are used for fixnum
representation; else the word size is 8 and 61 bits are
used for fixnum representation.  On a 32-bit platform, 30 bits
are available to store the number:

<pre class="example">     (greatest-fixnum)       &rArr; +536870911
     (expt 2 29)             &rArr; +536870912
     (- (expt 2 29) 1)       &rArr; +536870911
     
     (least-fixnum)          &rArr; -536870912
     (- (expt 2 29))         &rArr; -536870912
</pre>
   <p>With machine words 32-bit wide, which means the word size is 4
bytes, the representation of a fixnum is:

<pre class="example">      30 bits fixnum representation
           |........................|00
     
           |-----|-----|-----|------+--|
            byte3 byte2 byte1   byte0
</pre>
   <p class="noindent">the two least significant bits are set to zero: this &ldquo;tags&rdquo; the
machine words which embed fixnums.  With machine words 64-bit wide,
which means the word size is 8 bytes, the representation of a
fixnum is:

<pre class="example">              61 bits fixnum representation
     |...............................................|000
     
     |-----|-----|-----|-----|-----|-----|-----|-----+---|
      byte7 byte6 byte5 byte4 byte3 byte2 byte1  byte0
</pre>
   <p class="noindent">the three least significant bits are set to zero: this &ldquo;tags&rdquo; the
machine words which embed fixnums.

   <p>The fixnums tag is <code>00</code> on 32-bit platforms and <code>000</code> on
64-bit platforms; given the symbol <code>fx_shift</code>, which is set to the
number of bits in the tag, the value is selected in such a way that:

<pre class="example">     length_in_bytes = number_of_words *  fx_shift
                     = number_of_words *  wordsize
                     = number_of_words &lt;&lt; fx_shift
</pre>
   <p class="noindent">this allows us, for example, to take the fixnum representing the number
of items in a vector and consider it directly as size of the vector's
data area in bytes.

<!--  -->
<h5 class="subsubheading">Basic operations</h5>

<p>Given an exact integer stored in a <code>long</code> value with the right
amount of bits, we encode a fixnum as follows:

<pre class="example">     long    the_value  = ...;
     ikptr   the_fixnum = (ikptr)(the_value &lt;&lt; fx_shift);
</pre>
   <p class="noindent">and we decode it as follows:

<pre class="example">     ikptr   the_fixnum = ...;
     long    the_value  = (long)(the_fixnum &gt;&gt; fx_shift);
</pre>
   <p class="noindent">to verify if a <code>ikptr</code> is a fixnum we do:

<pre class="example">     ikptr   the_fixnum = ...;
     
     if (fx_tag == ((long)the_fixnum &amp; fx_mask))
       it_is_a_fixnum();
     else
       it_is_not();
</pre>
   <p class="noindent">it is better to use the convenience macros described below.

<div class="defun">
&mdash; Macro: <b>fx_tag</b><var> 0<a name="index-fx_005ftag-1222"></a></var><br>
<blockquote><p>The fixnums tag. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>fx_shift</b><var><a name="index-fx_005fshift-1223"></a></var><br>
<blockquote><p>The number of bits in the fixnums tag.  It is the amount of bits we have
to left&ndash;shift a machine word to encode its value as fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>fx_mask</b><var><a name="index-fx_005fmask-1224"></a></var><br>
<blockquote><p>Bit mask used to isolate the tag bits of a fixnum. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Convenience preprocessor macros</h5>

<p>Examples:

<pre class="example">     long int  N = 123L;
     ikptr     P = IK_FIX(N);
     long int  M = IK_UNFIX(P);
</pre>
   <div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_FIX</b> (<var>num</var>)<var><a name="index-IK_005fFIX-1225"></a></var><br>
&mdash; Preprocessor Macro: ikptr <b>fix</b> (<var>num</var>)<var><a name="index-fix-1226"></a></var><br>
<blockquote><p>Convert a small exact integer in the correct range for a fixnum, into a
<code>ikptr</code> value.  <var>num</var> is cast to <code>long int</code>.

        <blockquote>
<strong>NOTE</strong> The macro <code>fix</code> is defined only in the internal
header file and its usage is deprecated. 
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: long <b>IK_UNFIX</b> (<var>ikptr ref</var>)<var><a name="index-IK_005fUNFIX-1227"></a></var><br>
&mdash; Preprocessor Macro: long <b>unfix</b> (<var>ikptr ref</var>)<var><a name="index-unfix-1228"></a></var><br>
<blockquote><p>Convert an <code>ikptr</code> value holding a fixnum into a fixnum of type
<code>long int</code>.

        <blockquote>
<strong>NOTE</strong> The macro <code>unfix</code> is defined only in the internal
header file and its usage is deprecated. 
</blockquote>
        </p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: int <b>IK_IS_FIXNUM</b> (<var>ikptr ref</var>)<var><a name="index-IK_005fIS_005fFIXNUM-1229"></a></var><br>
<blockquote><p>Expand to true if <var>ref</var> is an <code>ikptr</code> embedding a fixnum.  It
just tests if the least significant bits in the tag are set to zero. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-pairs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-bytevectors">objects bytevectors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-fixnums">objects fixnums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.4 Pair objects and lists</h3>

<p>A pair is a fixed&ndash;length block of memory composed of two machine words;
the 3 least significant bits of an <code>ikptr</code> reference to a pair
are the pair tag.

<pre class="example">     |-------------------------|-------------| reference to pair
           heap pointer           pair tag
     
     |-------------------|-------------------| pair memory block
         word 0 = car        word 1 = cdr
</pre>
   <p>The empty list is not a pair: it is a special constant fitting in a
single <code>ikptr</code> machine word, and it is defined by the preprocessor
symbol <code>null_object</code>.

<!--  -->
<h5 class="subsubheading">Basic operations</h5>

<p>Pairs are allocated as follows, leaving the car and cdr uninitialised:

<pre class="example">     ikpcb *  pcb = the_pcb;
     ikptr    s_pair;
     
     s_pair = ik_safe_alloc(pcb, pair_size) | pair_tag;
</pre>
   <p class="noindent">the car and cdr of a pair are extracted as follows:

<pre class="example">     ikptr   s_pair = ...;
     ikptr   s_car, s_cdr;
     
     s_car = IK_REF(s_pair, off_car);
     s_cdr = IK_REF(s_pair, off_cdr);
</pre>
   <p class="noindent">or as follows:

<pre class="example">     ikptr   s_pair = ...;
     ikptr   s_car, s_cdr;
     
     s_car = IK_CAR(s_pair);
     s_cdr = IK_CDR(s_pair);
</pre>
   <p class="noindent">the car and cdr of a pair are set as follows:

<pre class="example">     ikptr   s_pair = ...;
     ikptr   s_car  = ...;
     ikptr   s_cdr  = ...;
     
     IK_REF(s_pair, off_car) = s_car;
     IK_REF(s_pair, off_cdr) = s_car;
</pre>
   <p class="noindent">or as follows:

<pre class="example">     ikptr   s_pair = ...;
     ikptr   s_car  = ...;
     ikptr   s_cdr  = ...;
     
     IK_CAR(s_pair) = s_car;
     IK_CDR(s_pair) = s_car;
</pre>
   <div class="defun">
&mdash; Preprocessor Symbol: <b>pair_mask</b><var><a name="index-pair_005fmask-1230"></a></var><br>
&mdash; Preprocessor Symbol: <b>pair_tag</b><var><a name="index-pair_005ftag-1231"></a></var><br>
&mdash; Preprocessor Symbol: <b>pair_size</b><var><a name="index-pair_005fsize-1232"></a></var><br>
<blockquote><p><code>pair_mask</code> is the bit pattern used to isolate a pair tag from a
reference <code>ikptr</code>; <code>pair_tag</code> is the tag of <code>ikptr</code> values
referencing a pair; <code>pair_size</code> is the number of bytes in a pair
memory block on the heap. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_car</b><var><a name="index-disp_005fcar-1233"></a></var><br>
&mdash; Preprocessor Symbol: <b>disp_cdr</b><var><a name="index-disp_005fcdr-1234"></a></var><br>
&mdash; Preprocessor Symbol: <b>off_car</b><var><a name="index-off_005fcar-1235"></a></var><br>
&mdash; Preprocessor Symbol: <b>off_cdr</b><var><a name="index-off_005fcdr-1236"></a></var><br>
<blockquote><p><code>disp_car</code> and <code>disp_cdr</code> are the offsets in bytes of the car
and cdr from the beginning of a pair memory block; <code>off_car</code> and
<code>off_cdr</code> are integers to be added to a reference <code>ikptr</code> tagged
as pair to retrieve the car and the cdr from a pair memory block. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Convenience preprocessor macros</h5>

<div class="defun">
&mdash; Preprocessor Macro: int <b>IK_IS_PAIR</b> (<var>ikptr X</var>)<var><a name="index-IK_005fIS_005fPAIR-1237"></a></var><br>
<blockquote><p>Evaluate to true if the machine word <var>X</var> is tagged as pair. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IKA_PAIR_ALLOC</b> (<var>ikpcb * pcb</var>)<var><a name="index-IKA_005fPAIR_005fALLOC-1238"></a></var><br>
<blockquote><p>Allocate a new pair object using <code>ik_safe_alloc()</code> and return a
tagged reference to it.  The pair words are left <strong>uninitialised</strong>. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IKU_PAIR_ALLOC</b> (<var>ikpcb * pcb</var>)<var><a name="index-IKU_005fPAIR_005fALLOC-1239"></a></var><br>
<blockquote><p>Allocate a new pair object using <code>ik_unsafe_alloc()</code> and return a
tagged reference to it.  The pair words are left <strong>uninitialised</strong>. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_CAR</b> (<var>ikptr pair</var>)<var><a name="index-IK_005fCAR-1240"></a></var><br>
&mdash; Preprocessor Macro: ikptr <b>IK_CDR</b> (<var>ikptr pair</var>)<var><a name="index-IK_005fCDR-1241"></a></var><br>
<blockquote><p>Evaluate to the locations of the car and cdr of a pair; uses of these
macros can appear both as operands and as left&ndash;side of assignments. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_CAAR</b> (<var>ikptr pair</var>)<var><a name="index-IK_005fCAAR-1242"></a></var><br>
&mdash; Preprocessor Macro: ikptr <b>IK_CDAR</b> (<var>ikptr pair</var>)<var><a name="index-IK_005fCDAR-1243"></a></var><br>
&mdash; Preprocessor Macro: ikptr <b>IK_CADR</b> (<var>ikptr pair</var>)<var><a name="index-IK_005fCADR-1244"></a></var><br>
&mdash; Preprocessor Macro: ikptr <b>IK_CDDR</b> (<var>ikptr pair</var>)<var><a name="index-IK_005fCDDR-1245"></a></var><br>
<blockquote><p>Return, respectively: the car of the car, the cdr of the car, the car of
the cdr, the cdr of the cdr. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Operations on pairs and lists</h5>

<div class="defun">
&mdash; Function: ikptr <b>ika_pair_alloc</b> (<var>ikpcb * pcb</var>)<var><a name="index-ika_005fpair_005falloc-1246"></a></var><br>
&mdash; Function: ikptr <b>iku_pair_alloc</b> (<var>ikpcb * pcb</var>)<var><a name="index-iku_005fpair_005falloc-1247"></a></var><br>
<blockquote><p>Allocate and return a new pair object using, respectively,
<code>ik_safe_alloc()</code> and <code>ik_unsafe_alloc()</code> and return a tagged
reference to it.  Both the car and cdr are initialised to
<code>void_object</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: long <b>ik_list_length</b> (<var>ikptr list</var>)<var><a name="index-ik_005flist_005flength-1248"></a></var><br>
<blockquote><p>Return the length of the proper list referenced by <var>list</var>.  Do not
handle circular lists.  If the length exceeds <code>LONG_MAX</code>: terminate
the process with <code>ik_abort()</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>ik_list_to_argv</b> (<var>ikptr list, char ** argv</var>)<var><a name="index-ik_005flist_005fto_005fargv-1249"></a></var><br>
<blockquote><p>Given a reference <var>list</var> to a proper list of bytevectors, fill
<var>argv</var> with pointers to the data areas, setting the last element of
<var>argv</var> to <code>NULL</code>.  The array referenced by <var>argv</var> must be wide
enough to hold all the pointers from <var>list</var> plus the terminating
<code>NULL</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: void <b>ik_list_to_argv_and_argc</b> (<var>ikptr list, char ** argv, long * argc</var>)<var><a name="index-ik_005flist_005fto_005fargv_005fand_005fargc-1250"></a></var><br>
<blockquote><p>Given a reference <var>list</var> to a proper list of bytevectors: fill
<var>argv</var> with pointers to the data areas, setting the last element of
<var>argv</var> to <code>NULL</code>; fill <var>argc</var> with the lengths of the
bytevectors.  The array referenced by <var>argv</var> must be wide enough to
hold all the pointers from <var>list</var> plus the terminating <code>NULL</code>; the
array referenced by <var>argc</var> must be wide enough to hold all the
lengths. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ika_list_from_argv</b> (<var>ikpcb * pcb, char ** argv</var>)<var><a name="index-ika_005flist_005ffrom_005fargv-1251"></a></var><br>
<blockquote><p>Given a pointer <var>argv</var> to a <code>NULL</code>&ndash;terminated array of <acronym>ASCIIZ</acronym>
strings build and return a list of bytevectors holding a copy of the
<acronym>ASCIIZ</acronym> strings.  Make use of <code>pcb-&gt;root8</code> and <code>pcb-&gt;root9</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ika_list_from_argv_and_argc</b> (<var>ikpcb * pcb, char ** argv, int argc</var>)<var><a name="index-ika_005flist_005ffrom_005fargv_005fand_005fargc-1252"></a></var><br>
<blockquote><p>Given a pointer <var>argv</var> to an array of <acronym>ASCIIZ</acronym> strings holding
<var>argc</var> pointers: build and return a list of bytevectors holding a
copy of the <acronym>ASCIIZ</acronym> strings.  Make use of <code>pcb-&gt;root8</code> and
<code>pcb-&gt;root9</code>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Pairs and lists code examples</h5>

<p>The suggested general way to allocate and initialise a pair is as
follows:

<pre class="example">     ikpcb * pcb    = the_pcb;
     ikptr   s_pair = ika_pair_alloc(pcb);
     
     pcb-&gt;root0 = &amp;s_pair;
     {
       IK_CAR(s_pair) = allocate_and_build_the_car(pcb);
       IK_CDR(s_pair) = allocate_and_build_the_cdr(pcb);
     }
     pcb-&gt;root0 = NULL;
</pre>
   <p class="noindent">notice how we take care of allocating the new pair with a function that
initialises the component words and of registering the pair as garbage
collection root before calling the constructors for the car and cdr.

   <p>If the component words do not need memory allocation, for example
because they are fixnums or already existing objects, we can use the
faster code:

<pre class="example">     ikpcb * pcb    = the_pcb;
     ikptr   s_pair = IKA_PAIR_ALLOC(pcb);
     
     IK_CAR(s_pair) = IK_FIX(123);
     IK_CDR(s_pair) = IK_FIX(456);
</pre>
   <p>Let's say we need to build a list of bytevectors from <acronym>ASCIIZ</acronym> strings
in the array <code>argv</code> and there are <code>argc</code> of them:

<pre class="example">     ikpcb *  pcb  = the_pcb;
     char **  argv = ...;
     long     argc = ...;
     ikptr    s_list;
     
     if (argc) {
       ikptr  s_spine;
       long   i;
     
       s_list = s_spine = ika_pair_alloc(pcb);
       pcb-&gt;root0 = &amp;s_list;
       pcb-&gt;root1 = &amp;s_spine;
       {
         for (i=0; i&lt;argc;) {
           IK_ASS(IK_CAR(s_spine),
                  ika_bytevector_from_cstring(pcb, argv[i]));
           if (++i &lt; argc) {
             IK_ASS(IK_CDR(s_spine), ika_pair_alloc(pcb));
             s_spine = IK_CDR(s_spine);
           } else {
             IK_CDR(s_spine) = null_object;
             break;
           }
         }
       }
       pcb-&gt;root1 = NULL;
       pcb-&gt;root0 = NULL;
     } else
       s_list = null_object;
     
     /* make use of S_LIST */
</pre>
   <!-- page -->
<div class="node">
<a name="objects-bytevectors"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-vectors">objects vectors</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-pairs">objects pairs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.5 Bytevector objects</h3>

<p>Bytevectors are blocks of memory referenced by machine words tagged as
bytevectors.  The first word in the memory block is a fixnum
representing the number of bytes in the data area; a bytevector is
capable of holding at most a number of bytes equal to the return value
of <code>greatest-fixnum</code>.

   <p>When allocating a bytevector capable of holding N bytes, the
actual size of the allocated data area is N+1; the additional
last byte is not part of the data area and is perpetually set to zero. 
All Vicare's functions operating on bytevectors set to zero the
byte right after the last used one in the data area.  This last byte
allows every bytevector to be used as <acronym>ASCIIZ</acronym> string at the C language
level.

   <p>To allow for the same binary layout on both 32-bit and 64-bit platforms,
the data area starts 8 bytes after the beginning; on a 32-bit
platform the layout is:

<pre class="example">       1st word   2nd word                       last byte
     |----------|----------|-------------------|-----------|
        length     unused        data area      set to zero
</pre>
   <p class="noindent">on a 64-bit platform the layout is:

<pre class="example">            1st word                             last byte
     |---------------------|-------------------|-----------|
            length               data area      set to zero
</pre>
   <!--  -->
<h5 class="subsubheading">Basic operations</h5>

<p>Bytevector objects are fully allocated on the heap and subject to
garbage collection; to perform the allocation we compute the whole size
of the bytevector data area, add to it room for meta data and finally
compute the aligned block size:

<pre class="example">     ikpcb * pcb        = the_pcb;
     long    bv_len     = the_number_of_bytes;
     long    block_size = disp_bytevector_data + bv_len + 1;
     lont    align_size = IK_ALIGN(block_size);
     ikptr   bv = ik_safe_alloc(pcb, align_size) | bytevector_tag;
</pre>
   <p><code>ik_safe_alloc()</code> returns an <code>ikptr</code> value representing the
aligned pointer, having the 3 least significant bits set to zero;
we add to it the bytevector tag (an integer value fitting in 3
bits) which allows to recognise bytevectors among all the other built in
objects.

   <p>We have to explicitly store the bytevector length in the memory block as
a fixnum and set the last byte to zero, so usually a full allocation
looks like this:

<pre class="example">     ikptr
     ika_bytevector_alloc (ikpcb * pcb, long bv_len)
     {
       long   align_size;
       ikptr  s_bv;
       char * data;
       align_size = IK_ALIGN(disp_bytevector_data + bv_len + 1);
       s_bv       = ik_safe_alloc(pcb, align_size)
                    | bytevector_tag;
       IK_REF(s_bv, off_bytevector_length) = IK_FIX(bv_len);
       data = (char *)(long)(s_bv + off_bytevector_data);
       data[bv_len] = '\0';
       return s_bv;
     }
</pre>
   <p class="noindent">to acquire the number of bytes we do:

<pre class="example">     ikptr  s_bv = the_bytevector;
     long   bv_len;
     
     bv_len = IK_UNFIX(IK_REF(s_bv, off_bytevector_length));
</pre>
   <p class="noindent">and to access the data area we do:

<pre class="example">     ikptr      s_bv = the_bytevector;
     uint8_t *  data_area;
     
     data_area = (uint8_t *)(long)(s_bv + off_bytevector_data);
</pre>
   <div class="defun">
&mdash; Preprocessor Symbol: <b>bytevector_tag</b><var><a name="index-bytevector_005ftag-1253"></a></var><br>
<blockquote><p>An integer used to tag <code>ikptr</code> references to bytevector memory blocks. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_bytevector_length</b><var><a name="index-disp_005fbytevector_005flength-1254"></a></var><br>
<blockquote><p>Displacement of length.  The number of bytes to add to an untagged
pointer to bytevector to get the pointer to the first byte in the
machine word holding the bytevector length as fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_bytevector_data</b><var><a name="index-disp_005fbytevector_005fdata-1255"></a></var><br>
<blockquote><p>Displacement of data area.  The number of bytes to add to an untagged
pointer to bytevector to get the pointer to the first byte in the data
area. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_bytevector_length</b><var><a name="index-off_005fbytevector_005flength-1256"></a></var><br>
<blockquote><p>An integer to add to a tagged <code>ikptr</code> bytevector reference to retrieve
the pointer to the first byte of the fixnum representing the bytevector
length. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_bytevector_data</b><var><a name="index-off_005fbytevector_005fdata-1257"></a></var><br>
<blockquote><p>An integer to add to a tagged <code>ikptr</code> bytevector reference to retrieve
the pointer to the first byte of the data area.

        <p>Notice that on both 32-bit and 64-bit platforms: the first byte of the
data area is at the same byte offset from the first byte of the
bytevector memory block. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Convenience preprocessor macros</h5>

<div class="defun">
&mdash; Preprocessor Macro: long <b>IK_BYTEVECTOR_LENGTH</b> (<var>ikptr bv</var>)<var><a name="index-IK_005fBYTEVECTOR_005fLENGTH-1258"></a></var><br>
<blockquote><p>Return the number of bytes in the data area of <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_BYTEVECTOR_LENGTH_FX</b> (<var>ikptr bv</var>)<var><a name="index-IK_005fBYTEVECTOR_005fLENGTH_005fFX-1259"></a></var><br>
<blockquote><p>Return a fixnum representing the number of bytes in the data area of
<var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: long <b>IK_BYTEVECTOR_DATA</b> (<var>ikptr bv</var>)<var><a name="index-IK_005fBYTEVECTOR_005fDATA-1260"></a></var><br>
<blockquote><p>Return a integer representing the memory address of the first byte in
the data area of <var>bv</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: void * <b>IK_BYTEVECTOR_DATA_VOIDP</b> (<var>ikptr bv</var>)<var><a name="index-IK_005fBYTEVECTOR_005fDATA_005fVOIDP-1261"></a></var><br>
&mdash; Preprocessor Macro: char * <b>IK_BYTEVECTOR_DATA_CHARP</b> (<var>ikptr bv</var>)<var><a name="index-IK_005fBYTEVECTOR_005fDATA_005fCHARP-1262"></a></var><br>
&mdash; Preprocessor Macro: uint8_t * <b>IK_BYTEVECTOR_DATA_UINT8P</b> (<var>ikptr bv</var>)<var><a name="index-IK_005fBYTEVECTOR_005fDATA_005fUINT8P-1263"></a></var><br>
<blockquote><p>Return a pointer referencing the first byte in the data area of
<var>bv</var>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Operations on bytevectors</h5>

<div class="defun">
&mdash; Function: ikptr <b>ika_bytevector_alloc</b> (<var>ikpcb * pcb, long requested_number_of_bytes</var>)<var><a name="index-ika_005fbytevector_005falloc-1264"></a></var><br>
<blockquote><p>Allocate, initialise and return a new bytevector capable of holding the
specified number of bytes.  The contents of the data area are
unspecified. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ik_bytevector_from_cstring</b> (<var>ikpcb * pcb, const char * cstr</var>)<var><a name="index-ik_005fbytevector_005ffrom_005fcstring-1265"></a></var><br>
<blockquote><p>Allocate, initialise and return a new bytevector and copy the contents
of the <acronym>ASCIIZ</acronym> string referenced by <var>cstr</var> in the data area. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ik_bytevector_from_cstring_len</b> (<var>ikpcb * pcb, const char * cstr, size_t len</var>)<var><a name="index-ik_005fbytevector_005ffrom_005fcstring_005flen-1266"></a></var><br>
<blockquote><p>Allocate, initialise and return a new bytevector and copy the <var>len</var>
bytes of the <acronym>ASCII</acronym> string referenced by <var>cstr</var> in the data area. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ik_bytevector_from_memory_block</b> (<var>ikpcb * pcb, void * memory, size_t length</var>)<var><a name="index-ik_005fbytevector_005ffrom_005fmemory_005fblock-1267"></a></var><br>
<blockquote><p>Allocate, initialise and return a new bytevector and copy in the data
area <var>length</var> bytes from of the memory block referenced by
<var>memory</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_bytevector_copy</b> (<var>ikptr dst, ikptr dst_start, ikptr src, ikptr src_start, ikptr count</var>)<var><a name="index-ikrt_005fbytevector_005fcopy-1268"></a></var><br>
<blockquote><p>Copy <var>count</var> bytes from bytevector <var>src</var> starting at offset
<var>src_start</var>, to bytevector <var>dst</var> starting at offset
<var>dst_start</var>; <var>src_start</var>, <var>dst_start</var> and <var>count</var> must
be non&ndash;negative fixnums.  Return unspecified values. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-vectors"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-structs">objects structs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-bytevectors">objects bytevectors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.6 Vector objects</h3>

<p>Vectors are variable length blocks of memory referenced by machine words
tagged as vectors.  The first machine word of a vector block contains a
fixnum representing the vector length; a vector is capable of holding at
most a number of values equal to the return value of
<code>greatest-fixnum</code>.  This means that the first word of a vector is
tagged as a fixnum.

<pre class="example">     |------------------------|-------------| reference to vector
           heap pointer         vector tag
     
     |------------------------|-------------| vector first word
          number of words       fixnum tag
</pre>
   <!--  -->
<h5 class="subsubheading">Basic operations</h5>

<p>Vector objects are allocated on the heap; to perform the allocation we
compute the whole size of the data area, add to it room for meta data
and finally compute the aligned block size:

<pre class="example">     ikpcb * pcb            = the_pcb;
     long    length         = the_number_of_items;
     long    requested_size = wordsize * length;
     long    block_size     = disp_vector_data + requested_size;
     long    align_size     = IK_ALIGN(block_size);
     ikptr   vec = ik_safe_alloc(pcb, align_size) | vector_tag;
</pre>
   <p class="noindent"><code>ik_safe_alloc()</code> returns an <code>ikptr</code> value representing the
aligned pointer, having the 3 least significant bits set to zero;
we add to it the vector tag (an integer value fitting in 3 bits)
which allows to recognise vectors among all the other built in objects.

   <p>We have to explicitly store the vector length in the memory block as a
fixnum, so usually a full allocation looks like this:

<pre class="example">     ikptr
     ika_vector_alloc (ikpcb * pcb, long number_of_items)
     {
       long  align_size;
       ikptr s_len;
       ikptr s_vec;
       s_len      = IK_FIX(number_of_items);
       align_size = IK_ALIGN(disp_vector_data + s_len);
       s_vec      = ik_safe_alloc(pcb, align_size) | vector_tag;
       IK_REF(s_vec, off_vector_length) = s_len;
       return s_vec;
     }
</pre>
   <p class="noindent">notice how we exploit the fact that the fixnum representing the number
of elements equals the number of bytes in the data area needed to hold
such elements.

   <p>The allocation operations described above leaves the data area
uninitialised: its content is undefined.  This is bad if the garbage
collector moves the newly built vector before the elements are
initialised to a correct Scheme value.  The following function resets
the data area to a vector of zero fixnums:

<pre class="example">     ikptr
     ikrt_vector_clean (ikptr s_vec)
     {
       ikptr	s_len = IK_VECTOR_LENGTH_FX(s_vec);
       memset((char*)(long)(s_vec + off_vector_data), 0, s_len);
       return s_vec;
     }
</pre>
   <p>To fill a vector of 3 items with fixnums we should do:

<pre class="example">     ikptr  s_vec = the_vector;
     IK_REF(s_vec, off_vector_data + 0 * wordsize) = IK_FIX(10);
     IK_REF(s_vec, off_vector_data + 1 * wordsize) = IK_FIX(20);
     IK_REF(s_vec, off_vector_data + 2 * wordsize) = IK_FIX(30);
</pre>
   <p class="noindent">to retrieve the item at index 2 we do:

<pre class="example">     ikptr  s_vec  = the_vector;
     ikptr  s_item = IK_REF(s_vec, off_vector_data + 2 * wordsize);
</pre>
   <p class="noindent">and to retrieve the vector length:

<pre class="example">     ikptr  s_vec  = the_vector;
     ikptr  s_len  = IK_REF(s_vec, off_vector_length);
     long   length = IK_UNFIX(s_len);
</pre>
   <div class="defun">
&mdash; Preprocessor Symbol: <b>vector_tag</b><var><a name="index-vector_005ftag-1269"></a></var><br>
<blockquote><p>An integer used to tag <code>ikptr</code> references  to vector memory blocks. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_vector_length</b><var><a name="index-disp_005fvector_005flength-1270"></a></var><br>
<blockquote><p>Displacement of length.  The number of bytes to add to an untagged
pointer to vector to get the pointer to the first byte in the word
holding the vector length as fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_vector_data</b><var><a name="index-disp_005fvector_005fdata-1271"></a></var><br>
<blockquote><p>Displacement of data area.  The number of bytes to add to an untagged
pointer to vector to get the pointer to the first byte in the data area. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_vector_length</b><var><a name="index-off_005fvector_005flength-1272"></a></var><br>
<blockquote><p>An integer to add to a tagged <code>ikptr</code> reference to retrieve the pointer
to the first byte of the vector length as fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_vector_data</b><var><a name="index-off_005fvector_005fdata-1273"></a></var><br>
<blockquote><p>An integer to add to a tagged <code>ikptr</code> vector reference to retrieve the
pointer to the first byte of the data area. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Convenience preprocessor macros</h5>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_VECTOR_LENGTH_FX</b> (<var>ikptr vec</var>)<var><a name="index-IK_005fVECTOR_005fLENGTH_005fFX-1274"></a></var><br>
<blockquote><p>Return a fixnum representing the number of items in the vector
<var>vec</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: long <b>IK_VECTOR_LENGTH</b> (<var>ikptr vec</var>)<var><a name="index-IK_005fVECTOR_005fLENGTH-1275"></a></var><br>
<blockquote><p>Return an integer representing the number of items in the vector
<var>vec</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_ITEM</b> (<var>ikptr vec, long idx</var>)<var><a name="index-IK_005fITEM-1276"></a></var><br>
<blockquote><p>Evaluate to the item at index <var>idx</var> in the vector <var>vec</var>.  A use
of this macro can appear both as operand and as left&ndash;side of an
assignment; example:

     <pre class="example">          long    idx   = the_index;
          ikptr   s_vec = the_vector;
          ikptr   fx;
          
          IK_ITEM(s_vec, idx) = IK_FIX(10);
          fx = IK_ITEM(s_vec, idx);
</pre>
        </blockquote></div>

<!--  -->
<h5 class="subsubheading">Operations on vectors</h5>

<div class="defun">
&mdash; Function: ikptr <b>ika_vector_alloc_no_init</b> (<var>ikpcb * pcb, long number_of_items</var>)<var><a name="index-ika_005fvector_005falloc_005fno_005finit-1277"></a></var><br>
<blockquote><p>Allocate, initialise and return a new vector object capable of holding
the specified number of items.  Leave the data area uninitialised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ika_vector_alloc_and_init</b> (<var>ikpcb * pcb, long number_of_items</var>)<var><a name="index-ika_005fvector_005falloc_005fand_005finit-1278"></a></var><br>
<blockquote><p>Allocate, initialise and return a new vector object capable of holding
the specified number of items.  Initialise the data area so that all the
items are set to the fixnum zero. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>ik_is_vector</b> (<var>ikptr vec</var>)<var><a name="index-ik_005fis_005fvector-1279"></a></var><br>
<blockquote><p>Return true if <var>vec</var> is a reference to a vector object.  This
predicate tests that <var>vec</var> is tagged as vector reference and that
the first machine word in the referenced memory block is a fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_vector_clean</b> (<var>ikptr vec</var>)<var><a name="index-ikrt_005fvector_005fclean-1280"></a></var><br>
<blockquote><p>Clean the data area so that all the items are set to the fixnum
zero. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_vector_copy</b> (<var>ikptr dst, ikptr dst_start, ikptr src, ikptr src_start, ikptr count</var>)<var><a name="index-ikrt_005fvector_005fcopy-1281"></a></var><br>
<blockquote><p>Copy <var>count</var> items from vector <var>src</var> starting at offset
<var>src_start</var>, to vector <var>dst</var> starting at offset <var>dst_start</var>;
<var>src_start</var>, <var>dst_start</var> and <var>count</var> must be non&ndash;negative
fixnums.  Return unspecified values. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-structs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-chars">objects chars</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-vectors">objects vectors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.7 Struct objects</h3>

<p>A data structure is a variable&ndash;length block of memory referenced by
machine words tagged as vectors; the first machine word of the structure
is a reference to the type descriptor (<acronym>RTD</acronym>), which is itself a data
structure; the subsequent words, if any, are the fields of the
structure.  A block of memory is a data structure if and only if: a
reference to it is tagged as vector and its first word is tagged as
vector.

<pre class="example">     |----------------|----------| reference to structure
       heap pointer    vector tag
     
     |----------------|----------| first word of structure
       heap pointer    vector tag    = reference to rtd
                                     = reference to structure
</pre>
   <p>The type descriptor of the type descriptors is the return value of
<code>base-rtd</code> at the Scheme level and the structure referenced by the
field <code>base_rtd</code> in the process control block.  Such base type
descriptor is built at Vicare's startup.  The graph of
references for a structure and its type descriptor is as follows:

<pre class="example">           rtd ref
          |-------|---------------| structure instance
              |
       ---&lt;---
      |
      |     rtd ref
       --&gt;|-------|---------------| type descriptor
              |
       ---&lt;---
      |
      |     rtd ref
      +--&gt;|-------|---------------| base type descriptor
      |       |
       ---&lt;---
</pre>
   <p class="noindent">the type descriptor of the base type descriptor is the base type
descriptor itself.

   <p>A type descriptor is a fixed&ndash;length block of memory composed of
6 machine words interpreted as follows:

     <ol type=1 start=1>
<li>A reference to the base <acronym>RTD</acronym>.

     <li>A fixnum representing the number of machine words in the structure minus
1; this is the number of fields in the structure excluding the
reference to the <acronym>RTD</acronym>.  This value is 5 in the base <acronym>RTD</acronym>.

     <li>Scheme symbol representing the name of this structure type.

     <li>Scheme list of symbols representing the names of fields in structures of
this type.

     <li>False or a reference to closure used to print to a Scheme port the
structures of this type.  This is the printer function.

     <li>Scheme symbol used as unique identifier for this type.
        </ol>

   <p>Type descriptors are best defined at the Scheme level using the
functions from the <code>(vicare)</code> library, <a href="#iklib-structs">iklib structs</a> for
details.  To instantiate a structure at the C language level we should
write a C function accepting the type descriptor as argument, and have
the Scheme code hand the descriptor to it.  For example, at the Scheme
level we do:

<pre class="example">     (define-struct timeval
       (tv_sec tv_usec))
     
     (define (gettimeofday)
       (foreign-call "ikrt_posix_gettimeofday"
                     (type-descriptor timeval)))
</pre>
   <p class="noindent">and at the C level we do:

<pre class="example">     ikptr
     ikrt_posix_gettimeofday (ikptr s_rtd, ikpcb * pcb)
     {
       /* build and return an instance of "timeval" */
     }
</pre>
   <!--  -->
<h5 class="subsubheading">Basic operations</h5>

<p>Data structure objects are allocated on the heap; to perform the
allocation we compute the whole size of the structure:

<pre class="example">     ikpcb * pcb        = the_pcb;
     long    num_of_fields = ...;
     long    block_size = disp_record_data +
                          wordsize * num_of_fields;
     long    align_size = IK_ALIGN(block_size);
     ikptr   s_stru     = ik_safe_alloc(pcb, align_size) | record_tag;
</pre>
   <p class="noindent"><code>ik_safe_alloc()</code> returns an <code>ikptr</code> value representing the aligned
pointer, having the 3 least significant bits set to zero; we add
to it the record tag (an integer value fitting in 3 bits) which
allows to recognise records among all the other built in objects.

   <p>We have to explicitly store a reference to the <acronym>RTD</acronym> in the first
machine word of the structure, so a full allocation looks like this:

<pre class="example">     ikptr
     ika_struct_alloc (ikpcb * pcb, ikptr s_rtd)
     {
       long	num_of_fields;
       long  align_size;
       ikptr s_stru;
       num_of_fields = IK_UNFIX(IK_REF(s_rtd, off_rtd_length));
       align_size = IK_ALIGN(disp_record_data +
                             num_of_fields * wordsize);
       pcb-&gt;root9 = &amp;s_rtd;
       {
         s_ stru = ik_safe_alloc(pcb, align_size) | record_tag;
       }
       pcb-&gt;root9 = NULL;
       IK_REF(s_stru, off_record_rtd) = s_rtd;
       return s_stru;
     }
</pre>
   <p>The allocation operation described above leaves the data area
uninitialised: its content is undefined.  This is bad if the garbage
collector moves the newly built record before the elements are
initialised to a correct Scheme value.

   <p>To recognise an <code>ikptr</code> value as reference to a structure we do:

<pre class="example">     ikptr   R = the_value;
     
     if ((record_tag == (record_mask &amp; R)) &amp;&amp;
         (record_tag == (record_mask &amp; IK_REF(R, off_record_rtd))))
       it_is_a_structure();
     else
       it_is_not();
</pre>
   <p class="noindent">structure fields are identified at the C level by a zero&ndash;based index;
to store a value in field 2 of a structure we do:

<pre class="example">     ikptr  s_stru  = the_structure;
     ikptr  s_field = the_field;
     
     IK_REF(s_stru, off_record_data + 2 * wordsize) = the_field;
</pre>
   <p class="noindent">and to retrieve a the value of field 2 we do:

<pre class="example">     ikptr  s_stru  = the_structure;
     ikptr  s_field;
     
     s_field = IK_REF(s_stru, off_record_data + 2 * wordsize);
</pre>
   <div class="defun">
&mdash; Preprocessor Symbol: <b>record_mask</b><var><a name="index-record_005fmask-1282"></a></var><br>
&mdash; Preprocessor Symbol: <b>record_tag</b><var><a name="index-record_005ftag-1283"></a></var><br>
<blockquote><p>Integer values used to tag and recognise <code>ikptr</code> references to
structures.  <code>record_mask</code> isolates the tag bits from an <code>ikptr</code>
and <code>record_tag</code> represents the tag bits.  These values are the
same used for vectors. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_record_rtd</b><var><a name="index-disp_005frecord_005frtd-1284"></a></var><br>
<blockquote><p>Displacement of the <acronym>RTD</acronym> from the beginning of a structure block.  The
number of bytes to add to an untagged pointer to structure to get the
pointer to the first byte in the word holding the <acronym>RTD</acronym>. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_record_data</b><var><a name="index-disp_005frecord_005fdata-1285"></a></var><br>
<blockquote><p>Displacement of data area.  The number of bytes to add to an untagged
pointer to structure to get the pointer to the first byte of the first
field in the data area. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_record_rtd</b><var><a name="index-off_005frecord_005frtd-1286"></a></var><br>
<blockquote><p>An integer to add to a tagged <code>ikptr</code> structure reference to retrieve
the pointer to the first byte of the <acronym>RTD</acronym>. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_record_data</b><var><a name="index-off_005frecord_005fdata-1287"></a></var><br>
<blockquote><p>An integer to add to a tagged <code>ikptr</code> structure reference to retrieve
the pointer to the first byte of the first field of the structure. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_rtd_rtd</b><var><a name="index-disp_005frtd_005frtd-1288"></a></var><br>
<blockquote><p>Displacement of the base <acronym>RTD</acronym> from the beginning of an <acronym>RTD</acronym> block. 
The number of bytes to add to an untagged pointer to <acronym>RTD</acronym> to get the
pointer to the first byte of the reference to <acronym>RTD</acronym>. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_rtd_name</b><var><a name="index-disp_005frtd_005fname-1289"></a></var><br>
&mdash; Preprocessor Symbol: <b>disp_rtd_length</b><var><a name="index-disp_005frtd_005flength-1290"></a></var><br>
&mdash; Preprocessor Symbol: <b>disp_rtd_fields</b><var><a name="index-disp_005frtd_005ffields-1291"></a></var><br>
&mdash; Preprocessor Symbol: <b>disp_rtd_printer</b><var><a name="index-disp_005frtd_005fprinter-1292"></a></var><br>
&mdash; Preprocessor Symbol: <b>disp_rtd_symbol</b><var><a name="index-disp_005frtd_005fsymbol-1293"></a></var><br>
<blockquote><p>Displacements of the fields of an <acronym>RTD</acronym>. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>rtd_size</b><var><a name="index-rtd_005fsize-1294"></a></var><br>
<blockquote><p>The total number of bytes in a memory block holding an <acronym>RTD</acronym>. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_rtd_rtd</b><var><a name="index-off_005frtd_005frtd-1295"></a></var><br>
&mdash; Preprocessor Symbol: <b>off_rtd_name</b><var><a name="index-off_005frtd_005fname-1296"></a></var><br>
&mdash; Preprocessor Symbol: <b>off_rtd_length</b><var><a name="index-off_005frtd_005flength-1297"></a></var><br>
&mdash; Preprocessor Symbol: <b>off_rtd_fields</b><var><a name="index-off_005frtd_005ffields-1298"></a></var><br>
&mdash; Preprocessor Symbol: <b>off_rtd_printer</b><var><a name="index-off_005frtd_005fprinter-1299"></a></var><br>
&mdash; Preprocessor Symbol: <b>off_rtd_symbol</b><var><a name="index-off_005frtd_005fsymbol-1300"></a></var><br>
<blockquote><p>Integer to add to a tagged <code>ikptr</code> <acronym>RTD</acronym> reference to retrieve the
pointer to the first byte of the fields. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Convenience preprocessor macros</h5>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_FIELD</b> (<var>ikptr stru, idx</var>)<var><a name="index-IK_005fFIELD-1301"></a></var><br>
<blockquote><p>Evaluate to the location of the field at zero&ndash;based index <var>idx</var> for
the structure <var>stru</var>.  A use of this macro can appear both as
operand and as left&ndash;side of an assignment.

     <pre class="example">          ikptr   s_stru = the_structure;
          ikptr   s_field;
          
          s_field = IK_FIELD(s_stru, 2);
          IK_FIELD(s_stru, 2) = s_field;
</pre>
        </blockquote></div>

<!--  -->
<h5 class="subsubheading">Operations on vectors</h5>

<div class="defun">
&mdash; Function: ikptr <b>ika_struct_alloc_no_init</b> (<var>ikpcb * pcb, ikptr rtd</var>)<var><a name="index-ika_005fstruct_005falloc_005fno_005finit-1302"></a></var><br>
<blockquote><p>Allocate, initialise and return a new structure instance of type
<var>rtd</var>.  The first word of the allocated block is initialised with
<var>rtd</var>, the other words are left uninitialised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ika_struct_alloc_and_init</b> (<var>ikpcb * pcb, ikptr rtd</var>)<var><a name="index-ika_005fstruct_005falloc_005fand_005finit-1303"></a></var><br>
<blockquote><p>Allocate, initialise and return a new structure instance of type
<var>rtd</var>.  The first word of the allocated block is initialised with
<var>rtd</var>, the other words are initialised to the fixnum zero. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>ik_is_struct</b> (<var>ikptr R</var>)<var><a name="index-ik_005fis_005fstruct-1304"></a></var><br>
<blockquote><p>Return true if <var>R</var> is a reference to a structure. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-chars"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-strings">objects strings</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-structs">objects structs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.8 Character objects</h3>

<p>A Scheme character has two representations:

     <ul>
<li>As a standalone Scheme object, it is a machine word whose least
significant bits are set to the character tag and whose most significant
bits are set to the character's Unicode code point.

     <li>When embedded in a Scheme string, it is a 32-bit value whose least
significant bits are set to the character tag and whose most significant
bits are set to the character's Unicode code point. 
</ul>

<p class="noindent">the least significant 32 bits of the two representations are equal. 
<a href="#unicode">unicode</a> for details on Unicode.

   <p>Let's say that machine words are 32-bit values, which means the word
size is 4 bytes; then the representation of a character is:

<pre class="example">     |    Unicode code point    | char tag
     
     |--------|--------|--------|--------|
       byte3    byte2    byte1    byte0
</pre>
   <p class="noindent">the least significant byte is set to <code>#x0F</code>: this &ldquo;tags&rdquo; the
machine words which embed characters.  On 64-bit machines, the layout
is:

<pre class="example">             Unused              |Unicode code point  |char tag
     |...........................|....................|......|
     
     |------|------|------|------|------|------|------|------|
      byte7  byte6  byte5  byte4  byte3  byte2  byte1  byte0
</pre>
   <p>At the Scheme level: standalone characters are moved around as <code>ikptr</code>
values, but when characters are stored in a string the <code>ikptr</code> value is
converted to a 32-bit integer of type <code>ikchar</code>.

<!--  -->
<h5 class="subsubheading">Basic operations</h5>

<p>Standalone characters are encoded into <code>ikptr</code> values as follows:

<pre class="example">     unsigned long   unicode_code_point = the_code_point;
     ikptr           s_char;
     
     s_char = (unicode_code_point &lt;&lt; char_shift) | char_tag;
</pre>
   <p class="noindent">decoded to <code>unsigned long</code> values as follows:

<pre class="example">     ikptr           s_char = the_character;
     unsigned long   unicode_code_point;
     
     unicode_code_point = s_char &gt;&gt; char_shift;
</pre>
   <p class="noindent">and identified as follows:

<pre class="example">     ikptr   X = the_value;
     
     if (char_tag == (char_mask &amp; X))
       it_is_a_character();
     else
       it_is_not();
</pre>
   <p>Characters from a Scheme string are decoded from <code>ikchar</code> to
<code>unsigned long</code> as follows:

<pre class="example">     ikchar          ch = the_32bit_character;
     unsigned long   unicode_code_point;
     
     unicode_code_point = s_char &gt;&gt; char_shift;
</pre>
   <p class="noindent">and encoded from <code>unsigned long</code> to <code>ikchar</code> as follows:

<pre class="example">     unsigned long   unicode_code_point = the_code_point;
     ikchar          ch;
     
     ch = (ikchar)((unicode_code_point &lt;&lt; char_shift) | char_tag);
</pre>
   <div class="defun">
&mdash; Type Definition: <b>ikchar</b><var><a name="index-ikchar-1305"></a></var><br>
<blockquote><p>An alias for <code>uint32_t</code> used to store a Unicode code point tagged
as character. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>char_mask</b><var><a name="index-char_005fmask-1306"></a></var><br>
&mdash; Preprocessor Symbol: <b>char_tag</b><var><a name="index-char_005ftag-1307"></a></var><br>
<blockquote><p>Integer values used to tag and recognise <code>ikptr</code> values representing
characters.  <code>char_mask</code> isolates the tag bits from an <code>ikptr</code> and
<code>char_tag</code> represents the tag bits. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>char_shift</b><var><a name="index-char_005fshift-1308"></a></var><br>
<blockquote><p>Integer value representing the number of bits we must shift left to turn
a C language <code>long</code> into a machine word ready to be tagged as
Scheme character. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Convenience preprocessor macros</h5>

<div class="defun">
&mdash; Preprocessor Macro: int <b>IK_IS_CHAR</b> (<var>ikptr X</var>)<var><a name="index-IK_005fIS_005fCHAR-1309"></a></var><br>
<blockquote><p>Evaluate to true if <var>X</var> is a Scheme character. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_CHAR_FROM_INTEGER</b> (<var>unsigned long X</var>)<var><a name="index-IK_005fCHAR_005fFROM_005fINTEGER-1310"></a></var><br>
&mdash; Preprocessor Macro: unsigned long <b>IK_CHAR_TO_INTEGER</b> (<var>ikptr X</var>)<var><a name="index-IK_005fCHAR_005fTO_005fINTEGER-1311"></a></var><br>
<blockquote><p>Convert a Scheme character to and from an <code>unsigned long</code> value
representing the Unicode code point. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikchar <b>IK_CHAR32_FROM_INTEGER</b> (<var>unsigned long X</var>)<var><a name="index-IK_005fCHAR32_005fFROM_005fINTEGER-1312"></a></var><br>
<blockquote><p>Convert a <code>unsigned long</code> value representing the Unicode code
point into a 32-bit integer representing a Scheme character to be stored
into a string. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-strings"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-symbols">objects symbols</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-chars">objects chars</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.9 String objects</h3>

<p>Strings are variable&ndash;length blocks of memory referenced by machine
words tagged as strings; strings are <strong>not</strong> stored in memory in
<acronym>UTF</acronym>-32 format.  The first word in the memory block is a fixnum
representing the number of characters in the data area; a string is
capable of holding at most a number of characters equal to the return
value of <code>greatest-fixnum</code>.

<pre class="example">     |------------------------|-------------| reference to string
           heap pointer         string tag
     
     |------------------------|-------------| string first word
          number of words       fixnum tag
</pre>
   <p>All the remaining space in the memory block is filled with 32-bit
unsigned integers whose least significant bits are set to the character
tag and whose most significant bits are set to the character's Unicode
code point.

<!--  -->
<h5 class="subsubheading">Basic operations</h5>

<p>String objects are allocated on the heap; to perform the allocation we
compute the whole size of the data area, add to it room for meta data
and finally compute the aligned block size:

<pre class="example">     ikpcb * pcb            = the_pcb;
     long    length         = the_number_of_chars;
     long    requested_size = sizeof(ikchar) * length;
     long    block_size     = disp_string_data + requested_size;
     long    align_size     = IK_ALIGN(block_size);
     ikptr   str = ik_safe_alloc(pcb, align_size) | string_tag;
</pre>
   <p class="noindent"><code>ik_safe_alloc()</code> returns an <code>ikptr</code> value representing the aligned
pointer, having the 3 least significant bits set to zero; we add
to it the string tag (an integer value fitting in 3 bits) which
allows to recognise strings among all the other built in objects.

   <p>We have to explicitly store the string length in the memory block as a
fixnum, so usually a full allocation looks like this:

<pre class="example">     ikptr
     ik_string_alloc (ikpcb * pcb, long number_of_chars)
     {
       long  align_size;
       ikptr str;
       align_size = IK_ALIGN(disp_string_data
                             + number_of_chars * sizeof(ikchar));
       str        = ik_safe_alloc(pcb, align_size) | string_tag;
       IK_REF(str, off_string_length) = IK_FIX(number_of_chars);
       return str;
     }
</pre>
   <p>To fill a string of 3 chars with characters we should do:

<pre class="example">     ikptr     s_str = the_string;
     ikchar *  ch    = (ikchar*)(s_str + off_string_data);
     
     ch[0] = IK_CHAR32_FROM_INTEGER(10);
     ch[1] = IK_CHAR32_FROM_INTEGER(20);
     ch[2] = IK_CHAR32_FROM_INTEGER(30);
</pre>
   <p class="noindent">to retrieve the character at index 2 we do:

<pre class="example">     long      index  = 2;
     ikptr     s_str  = the_string;
     ikchar *  ch     = (ikchar*)(s_str + off_string_data);
     ikptr     s_char = (ikptr)ch[index];
</pre>
   <p class="noindent">and to retrieve the string length:

<pre class="example">     ikptr  s_str    = the_string;
     ikptr  s_length = IK_REF(s_str, off_string_length);
     long   length   = IK_UNFIX(s_length);
</pre>
   <div class="defun">
&mdash; Preprocessor Symbol: <b>string_char_size</b><var><a name="index-string_005fchar_005fsize-1313"></a></var><br>
<blockquote><p>Integer value representing the number of bytes in a Scheme character
stored in a Scheme string. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>string_mask</b><var><a name="index-string_005fmask-1314"></a></var><br>
&mdash; Preprocessor Symbol: <b>string_tag</b><var><a name="index-string_005ftag-1315"></a></var><br>
<blockquote><p>Integer values used to tag and recognise <code>ikptr</code> values representing
string references.  <code>string_mask</code> isolates the tag bits from an
<code>ikptr</code> and <code>string_tag</code> represents the tag bits. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_string_length</b><var><a name="index-disp_005fstring_005flength-1316"></a></var><br>
<blockquote><p>Displacement of length.  The number of bytes to add to an untagged
pointer to string to get the pointer to the first byte in the word
holding the string length as fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_string_data</b><var><a name="index-disp_005fstring_005fdata-1317"></a></var><br>
<blockquote><p>Displacement of data area.  The number of bytes to add to an untagged
pointer to string to get the pointer to the first byte in the data area. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_string_length</b><var><a name="index-off_005fstring_005flength-1318"></a></var><br>
<blockquote><p>An integer to add to a tagged <code>ikptr</code> reference to retrieve the pointer
to the first byte of the string length as fixnum. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_string_data</b><var><a name="index-off_005fstring_005fdata-1319"></a></var><br>
<blockquote><p>An integer to add to a tagged <code>ikptr</code> string reference to retrieve the
pointer to the first byte of the data area. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Convenience preprocessor macros</h5>

<div class="defun">
&mdash; Preprocessor Macro: int <b>IK_IS_STRING</b> (<var>ikptr obj</var>)<var><a name="index-IK_005fIS_005fSTRING-1320"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a reference to a string object. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_STRING_LENGTH_FX</b> (<var>ikptr str</var>)<var><a name="index-IK_005fSTRING_005fLENGTH_005fFX-1321"></a></var><br>
<blockquote><p>Return a fixnum representing the number of characters in the string
<var>str</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: long <b>IK_STRING_LENGTH</b> (<var>ikptr str</var>)<var><a name="index-IK_005fSTRING_005fLENGTH-1322"></a></var><br>
<blockquote><p>Return an integer representing the number of characters in the string
<var>str</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikchar <b>IK_CHAR32</b> (<var>ikptr str, long idx</var>)<var><a name="index-IK_005fCHAR32-1323"></a></var><br>
<blockquote><p>Evaluate to the 32-bit character representation at index <var>idx</var> in
the string <var>str</var>.  A use of this macro can appear both as operand
and as left&ndash;side of an assignment; example:

     <pre class="example">          long    idx   = the_index;
          ikptr   s_str = the_string;
          ikchar  ch;
          
          IK_CHAR32(s_str, idx) = IK_CHAR32_FROM_INTEGER(10);
          ch = IK_CHAR32(s_str, idx);
</pre>
        </blockquote></div>

<!--  -->
<h5 class="subsubheading">Operations on strings</h5>

<div class="defun">
&mdash; Function: ikptr <b>ika_string_alloc</b> (<var>ikpcb * pcb, long number_of_chars</var>)<var><a name="index-ika_005fstring_005falloc-1324"></a></var><br>
<blockquote><p>Allocate, initialise and return a new string object capable of holding
the specified number of chars. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-symbols"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-bignums">objects bignums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-strings">objects strings</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.10 Symbol objects</h3>

<p>A symbol is a fixed length memory block referenced by machine words
tagged as vectors.  The first machine word of a symbol block is tagged
has symbol in its least significant bits and it has the most significant
bits set to zero.

<pre class="example">     |------------------------|-------------| reference to symbol
           heap pointer         vector tag
     
     |------------------------|-------------| symbol first word
        all set to zero         symbol tag
</pre>
   <p>A symbol memory block is 6 words wide and contains references to
the following fields: <code>string</code>, <code>ustring</code>, <code>value</code>,
<code>proc</code>, <code>plist</code>.

<!--  -->
<h5 class="subsubheading">Basic operations</h5>

<p>Symbol objects are allocated on the heap and must be interned, that is
registered in a global symbol table.

<div class="defun">
&mdash; Preprocessor Symbol: <b>symbol_mask</b><var><a name="index-symbol_005fmask-1325"></a></var><br>
&mdash; Preprocessor Symbol: <b>symbol_tag</b><var><a name="index-symbol_005ftag-1326"></a></var><br>
<blockquote><p>Integer values used to tag and recognise the first word in symbol memory
blocks.  <code>symbol_mask</code> isolates the tag bits from an <code>ikptr</code> and
<code>symbol_tag</code> represents the tag bits. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>symbol_record_size</b><var><a name="index-symbol_005frecord_005fsize-1327"></a></var><br>
<blockquote><p>Number of bytes needed to hold a symbol memory block. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_symbol_record_tag</b><var><a name="index-disp_005fsymbol_005frecord_005ftag-1328"></a></var><br>
&mdash; Preprocessor Symbol: <b>disp_symbol_record_string</b><var><a name="index-disp_005fsymbol_005frecord_005fstring-1329"></a></var><br>
&mdash; Preprocessor Symbol: <b>disp_symbol_record_ustring</b><var><a name="index-disp_005fsymbol_005frecord_005fustring-1330"></a></var><br>
&mdash; Preprocessor Symbol: <b>disp_symbol_record_value</b><var><a name="index-disp_005fsymbol_005frecord_005fvalue-1331"></a></var><br>
&mdash; Preprocessor Symbol: <b>disp_symbol_record_proc</b><var><a name="index-disp_005fsymbol_005frecord_005fproc-1332"></a></var><br>
&mdash; Preprocessor Symbol: <b>disp_symbol_record_plist</b><var><a name="index-disp_005fsymbol_005frecord_005fplist-1333"></a></var><br>
<blockquote><p>Symbol field displacements.  The number of bytes to add to an untagged
pointer to symbol to get the pointer to the first byte in the word
holding the specified field. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_symbol_record_tag</b><var><a name="index-off_005fsymbol_005frecord_005ftag-1334"></a></var><br>
&mdash; Preprocessor Symbol: <b>off_symbol_record_string</b><var><a name="index-off_005fsymbol_005frecord_005fstring-1335"></a></var><br>
&mdash; Preprocessor Symbol: <b>off_symbol_record_ustring</b><var><a name="index-off_005fsymbol_005frecord_005fustring-1336"></a></var><br>
&mdash; Preprocessor Symbol: <b>off_symbol_record_value</b><var><a name="index-off_005fsymbol_005frecord_005fvalue-1337"></a></var><br>
&mdash; Preprocessor Symbol: <b>off_symbol_record_proc</b><var><a name="index-off_005fsymbol_005frecord_005fproc-1338"></a></var><br>
&mdash; Preprocessor Symbol: <b>off_symbol_record_plist</b><var><a name="index-off_005fsymbol_005frecord_005fplist-1339"></a></var><br>
<blockquote><p>Symbol field offsets.  The number of bytes to add to an tagged pointer
to symbol to get the pointer to the first byte in the word holding the
specified field. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Operations on symbols</h5>

<div class="defun">
&mdash; Function: int <b>ik_is_symbol</b> (<var>ikptr obj</var>)<var><a name="index-ik_005fis_005fsymbol-1340"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a symbol. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-bignums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-ratnums">objects ratnums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-symbols">objects symbols</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.11 Bignum objects</h3>

<p>Bignums are multi&ndash;precision exact integers bigger than fixnums; they
are implemented using the <code>mpn</code> <acronym>API</acronym> of <acronym>GNU</acronym> <acronym>GMP</acronym>,
See <a href="gmp.html#Low_002dlevel-Functions">mpn</a>.

   <p>Vicare only uses a bignum to represent an exact integer when
the value does not fit in a fixnum; it follows that the following ranges
are enforced:

<pre class="example">     negative bignums &lt; (least-fixnum) &lt;= all fixnums
     
     all fixnums &lt;= (greatest-fixnum) &lt; positive bignums
</pre>
   <p>A bignum is a variable length memory block referenced by machine words
tagged as vectors.  The first machine word of a bignum block is tagged
has bignum in its least significant bits; then comes a sign bit, zero if
positive; the remaining most significant bits represent the number of
words in the memory block after the first one.

<pre class="example">     |------------------------|-------------| reference to bignum
           heap pointer         vector tag
     
                          sign bit
     |----------------------|-|-------------| bignum first word
        number of words         bignum tag
</pre>
   <p>A pointer to the second machine word in a bignum memory block is the
pointer of type <code>mp_limb_t</code> accepted by the <code>mpn_</code> functions
of <acronym>GMP</acronym>; <dfn>limb</dfn>, in <acronym>GMP</acronym> jargon, is a machine word holding a
portion of multi&ndash;precision number.  The layout of a bignum memory block
is as follows:

<pre class="example">     |----|-----|-----|-----|-----| ...
      fst  limb0 limb1 limb2 limb3
</pre>
   <p class="noindent">where the first word <code>fst</code> is header of meta informations encoded
as explained above and each limb is a machine word stored in native
endianness; the big number is the concatenation of limbs with
<code>limb0</code> being the least significant one.  There is always at least
one limb; when a bignum is composed of a single limb, its value is
always non&ndash;zero and outside the range of fixnums.

<!--  -->
<h5 class="subsubheading">Basic operations</h5>

<p>To allocate a bignum we must know the number of required limbs:

<pre class="example">     ikpcb * pcb        = the_pcb;
     long    nlimbs     = the_number_of_limbs;
     long    block_size = disp_bignum_data + nlimbs * wordsize;
     long    align_size = IK_ALIGN(block_size);
     ikptr s_bn = ik_safe_alloc(pcb, align_size) | vector_tag;
</pre>
   <p class="noindent">we must explicitly build and encode the first word; the number of limbs
is encoded as follows:

<pre class="example">     long   nlimbs      = the_number_of_limbs;
     ikptr  meta_nlimbs = nlimbs &lt;&lt; bignum_nlimbs_shift;
</pre>
   <p class="noindent">the sign bit is encoded as follows:

<pre class="example">     long   sign      = zero_if_positive_one_if_negative;
     ikptr  meta_sign = sign &lt;&lt; bignum_sign_shift;
</pre>
   <p class="noindent">and the full first word is composed and stored as follows:

<pre class="example">     ikptr  s_bn        = the_bignum;
     ikptr  meta_nlimbs = ...;
     ikptr  meta_sign   = ...;
     ikptr  s_fst       = meta_nlimbs | meta_sign | bignum_tag;
     
     IK_REF(s_bn, off_bignum_tag) = s_fst;
</pre>
   <p>To identify an object as bignum we do:

<pre class="example">     ikptr  X = the_object;
     
     if ((vector_tag == IK_TAGOF(X)) &amp;&amp;
         (bignum_tag == (bignum_mask &amp; IK_REF(X, -vector_tag))))
       it_is_a_bignum();
     else
       it_is_not();
</pre>
   <p class="noindent">to extract meta informations we must first extract the first word:

<pre class="example">     ikptr   s_bn  = the_bignum;
     ikptr   s_fst = IK_REF(s_bn, off_bignum_tag);
     long    nlimbs;
     long    meta_sign;
     
     nlimbs    = ((ik_ulong)s_fst) &gt;&gt; bignum_nlimbs_shift;
     meta_sign = ((ik_ulong)s_fst) &amp;  bignum_sign_mask;
</pre>
   <p class="noindent">if <code>meta_sign</code> is zero the bignum is positive, else it is negative.

   <p>To acquire a pointer to the data area we do:

<pre class="example">     ikptr        s_bn = the_bignum;
     mp_limb_t *  data;
     
     data = (mp_limb_t*)(long)(s_bn + off_bignum_data);
</pre>
   <p class="noindent">to extract the N-th limb we do:

<pre class="example">     ikptr      s_bn = the_bignum;
     long       N    = the_index;
     mp_limb_t  limb;
     
     limb = (mp_limb_t)IK_REF(s_bn, off_bignum_data + N * wordsize);
</pre>
   <div class="defun">
&mdash; Preprocessor Symbol: <b>bignum_mask</b><var><a name="index-bignum_005fmask-1341"></a></var><br>
&mdash; Preprocessor Symbol: <b>bignum_tag</b><var><a name="index-bignum_005ftag-1342"></a></var><br>
<blockquote><p><code>bignum_mask</code> is the bit pattern used to isolate a bignum tag from
an <code>ikptr</code> value; <code>bignum_tag</code> is the tag of <code>ikptr</code> values used
as first words in bignum memory blocks. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>bignum_sign_mask</b><var><a name="index-bignum_005fsign_005fmask-1343"></a></var><br>
<blockquote><p>A bit pattern used to isolate the sign bit from the <code>ikptr</code> value
used as first word in bignum memory blocks. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>bignum_sign_shift</b><var><a name="index-bignum_005fsign_005fshift-1344"></a></var><br>
<blockquote><p>The number representing the bit left&ndash;shift offset of the sign bit in
the <code>ikptr</code> value used as first word in bignum memory blocks. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>bignum_nlimbs_shift</b><var><a name="index-bignum_005fnlimbs_005fshift-1345"></a></var><br>
<blockquote><p>The number representing the bit left&ndash;shift offset of the number of
limbs in the <code>ikptr</code> value used as first word in bignum memory
blocks. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_bignum_tag</b><var><a name="index-disp_005fbignum_005ftag-1346"></a></var><br>
<blockquote><p>Offset in bytes of the first word in a bignum memory block from the
beginning of the block.  It is zero. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_bignum_data</b><var><a name="index-disp_005fbignum_005fdata-1347"></a></var><br>
<blockquote><p>Offset in bytes of the first byte in the data area of a bignum memory
block from the beginning of the block. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_bignum_tag</b><var><a name="index-off_005fbignum_005ftag-1348"></a></var><br>
<blockquote><p>Number to add to a tagged <code>ikptr</code> reference to bignum to obtain a
pointer to the first word in a bignum memory block. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_bignum_data</b><var><a name="index-off_005fbignum_005fdata-1349"></a></var><br>
<blockquote><p>Number to add to a tagged <code>ikptr</code> reference to bignum to obtain a
pointer to the first byte in the data area of bignum memory block. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Convenience preprocessor macros</h5>

<div class="defun">
&mdash; Preprocessor Macro: long <b>IK_BIGNUM_ALLOC_SIZE</b> (<var>long nlimbs</var>)<var><a name="index-IK_005fBIGNUM_005fALLOC_005fSIZE-1350"></a></var><br>
<blockquote><p>Given a number of limbs: evaluate to the aligned size of the memory
block needed to hold the bignum. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IKA_BIGNUM_ALLOC</b> (<var>ikpcb * pcb, long nlimb</var>)<var><a name="index-IKA_005fBIGNUM_005fALLOC-1351"></a></var><br>
<blockquote><p>Given a number of limbs: allocate, using <code>ik_safe_alloc()</code>, the
memory block needed to hold the bignum and return an untagged pointer to
it. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_COMPOSE_BIGNUM_FIRST_WORD</b> (<var>long nlimb, ikptr meta_sign</var>)<var><a name="index-IK_005fCOMPOSE_005fBIGNUM_005fFIRST_005fWORD-1352"></a></var><br>
<blockquote><p>Given a number of limbs and the encoded sign bit: evaluate to the first
word of a bignum object.  It is equivalent to the following:

     <pre class="example">          ikptr  meta_nlimbs;
          ikptr  s_fst;
          
          meta_nlimbs = (<var>nlimbs</var> &lt;&lt; bignum_nlimbs_shift)
          s_fst       = meta_nlimbs | <var>meta_sign</var> | bignum_tag;
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_POSITIVE_BIGNUM_FIRST_WORD</b> (<var>long nlimb</var>)<var><a name="index-IK_005fPOSITIVE_005fBIGNUM_005fFIRST_005fWORD-1353"></a></var><br>
&mdash; Preprocessor Macro: ikptr <b>IK_NEGATIVE_BIGNUM_FIRST_WORD</b> (<var>long nlimb</var>)<var><a name="index-IK_005fNEGATIVE_005fBIGNUM_005fFIRST_005fWORD-1354"></a></var><br>
<blockquote><p>Given a number of limbs evaluate to the corresponding first word of
bignum representing a positive or negative number. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_BIGNUM_FIRST</b> (<var>ikptr bn</var>)<var><a name="index-IK_005fBIGNUM_005fFIRST-1355"></a></var><br>
<blockquote><p>Given a reference to bignum: evaluate to the location of the first word
holding meta informations.  Can be used both as operand or left&ndash;side of
assignment:

     <pre class="example">          ikptr  s_bn = the_bignum;
          ikptr  s_fst;
          
          s_fst = IK_BIGNUM_FIRST(s_bn);
          IK_BIGNUM_FIRST(s_bn) = s_fst;
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_LIMB</b> (<var>ikptr bn, long N</var>)<var><a name="index-IK_005fLIMB-1356"></a></var><br>
<blockquote><p>Given a reference to bignum: evaluate to the location of the <var>N</var>-th
limb in the data area.  Can be used both as operand or left&ndash;side of
assignment:

     <pre class="example">          ikptr      s_bn = the_bignum;
          mp_limb_t  limb;
          
          limb = (mp_limb_t)IK_LIMB(s_bn);
          IK_LIMB(s_bn) = (ikptr)limb;
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: mp_limb_t * <b>IK_BIGNUM_DATA_LIMBP</b> (<var>ikptr bn</var>)<var><a name="index-IK_005fBIGNUM_005fDATA_005fLIMBP-1357"></a></var><br>
<blockquote><p>Given a reference to bignum: evaluate to a pointer to the first byte in
the data area, which is a pointer to the least significant limb. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: mp_limb_t <b>IK_BIGNUM_FIRST_LIMB</b> (<var>ikptr bn</var>)<var><a name="index-IK_005fBIGNUM_005fFIRST_005fLIMB-1358"></a></var><br>
<blockquote><p>Given a reference to bignum: evaluate to the least significant limb in
the data area. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: mp_limb_t <b>IK_BIGNUM_LAST_LIMB</b> (<var>ikptr bn, long nlimbs</var>)<var><a name="index-IK_005fBIGNUM_005fLAST_005fLIMB-1359"></a></var><br>
<blockquote><p>Given a reference to bignum and its number of limbs: evaluate to the
most significant limb in the data area. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Operations on exact integers</h5>

<div class="defun">
&mdash; Function: int <b>ik_is_bignum</b> (<var>ikptr obj</var>)<var><a name="index-ik_005fis_005fbignum-1360"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a bignum. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ika_integer_from_int</b> (<var>ikpcb * pcb, int N</var>)<var><a name="index-ika_005finteger_005ffrom_005fint-1361"></a></var><br>
&mdash; Function: ikptr <b>ika_integer_from_long</b> (<var>ikpcb * pcb, long N</var>)<var><a name="index-ika_005finteger_005ffrom_005flong-1362"></a></var><br>
&mdash; Function: ikptr <b>ika_integer_from_llong</b> (<var>ikpcb * pcb, ik_llong N</var>)<var><a name="index-ika_005finteger_005ffrom_005fllong-1363"></a></var><br>
&mdash; Function: ikptr <b>ika_integer_from_uint</b> (<var>ikpcb * pcb, ik_uint N</var>)<var><a name="index-ika_005finteger_005ffrom_005fuint-1364"></a></var><br>
&mdash; Function: ikptr <b>ika_integer_from_ulong</b> (<var>ikpcb * pcb, ik_ulong N</var>)<var><a name="index-ika_005finteger_005ffrom_005fulong-1365"></a></var><br>
&mdash; Function: ikptr <b>ika_integer_from_ullong</b> (<var>ikpcb * pcb, ik_ullong N</var>)<var><a name="index-ika_005finteger_005ffrom_005fullong-1366"></a></var><br>
<blockquote><p>Build and return a new exact integer object from the given C language
value. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>ik_integer_to_int</b> (<var>ikptr X</var>)<var><a name="index-ik_005finteger_005fto_005fint-1367"></a></var><br>
&mdash; Function: long <b>ik_integer_to_long</b> (<var>ikptr X</var>)<var><a name="index-ik_005finteger_005fto_005flong-1368"></a></var><br>
&mdash; Function: ik_llong <b>ik_integer_to_llong</b> (<var>ikptr X</var>)<var><a name="index-ik_005finteger_005fto_005fllong-1369"></a></var><br>
&mdash; Function: ik_uint <b>ik_integer_to_uint</b> (<var>ikptr X</var>)<var><a name="index-ik_005finteger_005fto_005fuint-1370"></a></var><br>
&mdash; Function: ik_ulong <b>ik_integer_to_ulong</b> (<var>ikptr X</var>)<var><a name="index-ik_005finteger_005fto_005fulong-1371"></a></var><br>
&mdash; Function: ik_ullong <b>ik_integer_to_ullong</b> (<var>ikptr X</var>)<var><a name="index-ik_005finteger_005fto_005fullong-1372"></a></var><br>
&mdash; Function: int32_t <b>ik_integer_to_sint32</b> (<var>ikptr X</var>)<var><a name="index-ik_005finteger_005fto_005fsint32-1373"></a></var><br>
&mdash; Function: int64_t <b>ik_integer_to_sint64</b> (<var>ikptr X</var>)<var><a name="index-ik_005finteger_005fto_005fsint64-1374"></a></var><br>
&mdash; Function: uint32_t <b>ik_integer_to_uint32</b> (<var>ikptr X</var>)<var><a name="index-ik_005finteger_005fto_005fuint32-1375"></a></var><br>
&mdash; Function: uint64_t <b>ik_integer_to_uint64</b> (<var>ikptr X</var>)<var><a name="index-ik_005finteger_005fto_005fuint64-1376"></a></var><br>
<blockquote><p>Return a C language number from a Scheme exact integer object.  The
object <var>X</var> must be in the correct range for the requested
conversion. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-ratnums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-flonums">objects flonums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-bignums">objects bignums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.12 Ratnum objects</h3>

<p>Ratnums are exact rational numbers, having a fixnum or bignum as
numerator and a fixnum or bignum as denominator.  A ratnum is a fixed
length memory block referenced by machine words tagged as vectors.  The
first machine word of a ratnum block is tagged has ratnum in its least
significant bits and it has the most significant bits set to zero.

<pre class="example">     |------------------------|-------------| reference to ratnum
           heap pointer         vector tag
     
     |------------------------|-------------| ratnum first word
        all set to zero         ratnum tag
</pre>
   <p>A ratnum memory block is 4 words wide; a reference to the
numerator is stored in the second word and a reference to the
denominator is stored in the third word

<pre class="example">        1st word     2nd word     3rd word     4th word
     |------------|------------|------------|------------|
      tagged word   numerator   denominator     unused
</pre>
   <!--  -->
<h5 class="subsubheading">Basic operations</h5>

<p>Ratnums are allocated on the Scheme heap as follows:

<pre class="example">     ikpcb * pcb   = the_pcb;
     ikptr   s_rn;
     
     s_rn = ik_safe_alloc(pcb, ratnum_size) | vector_tag;
     IK_REF(s_rn, off_ratnum_tag) = ratnum_tag;
</pre>
   <p class="noindent">after allocation we must always initialise the numerator and denominator
fields to some correct value before running the next garbage collection;
a full allocation and initialisation is as follows:

<pre class="example">     ikpcb * pcb   = the_pcb;
     ikptr   s_num = the_numerator;
     ikptr   s_den = the_denominator;
     ikptr   s_rn;
     
     pcb-&gt;root9 = &amp;s_num;
     pcb-&gt;root8 = &amp;s_den;
     {
       s_rn = ik_safe_alloc(pcb, ratnum_size) | vector_tag;
     }
     pcb-&gt;root8 = NULL;
     pcb-&gt;root9 = NULL;
     
     IK_REF(s_rn, off_ratnum_tag) = ratnum_tag;
     IK_REF(s_rn, off_ratnum_num) = s_num;
     IK_REF(s_rn, off_ratnum_den) = s_den;
</pre>
   <p>To identify an object as ratnum we do:

<pre class="example">     ikptr  X = the_object;
     
     if ((vector_tag == IK_TAGOF(X)) &amp;&amp;
         (ratnum_tag == IK_REF(X, -vector_tag)))
       it_is_a_ratnum();
     else
       it_is_not();
</pre>
   <p class="noindent">to set or retrieve the numerator and denominator we do:

<pre class="example">     ikptr  s_rn = the_ratnum;
     ikptr  s_num;
     ikptr  s_den;
     
     s_num = IK_REF(s_rn, off_ratnum_num);
     s_den = IK_REF(s_rn, off_ratnum_den);
     IK_REF(s_rn, off_ratnum_num) = s_num;
     IK_REF(s_rn, off_ratnum_den) = s_den;
</pre>
   <div class="defun">
&mdash; Preprocessor Symbol: <b>ratnum_size</b><var><a name="index-ratnum_005fsize-1377"></a></var><br>
<blockquote><p>The number of bytes to allocate to hold a ratnum memory block. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>ratnum_tag</b><var><a name="index-ratnum_005ftag-1378"></a></var><br>
<blockquote><p>The tag of <code>ikptr</code> values used as first words in ratnum memory blocks. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_ratnum_tag</b><var><a name="index-disp_005fratnum_005ftag-1379"></a></var><br>
<blockquote><p>Displacement of secondary tag word.  The number of bytes to add to an
untagged pointer to ratnum to get the pointer to the first byte in the
word holding the ratnum tag. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_ratnum_num</b><var><a name="index-disp_005fratnum_005fnum-1380"></a></var><br>
&mdash; Preprocessor Symbol: <b>disp_ratnum_den</b><var><a name="index-disp_005fratnum_005fden-1381"></a></var><br>
<blockquote><p>Displacements of numerator and denominator.  The number of bytes to add
to an untagged pointer to ratnum to get the pointer to the first byte of
the reference to the numerator or denominator. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_ratnum_tag</b><var><a name="index-off_005fratnum_005ftag-1382"></a></var><br>
<blockquote><p>An integer to add to add to a tagged <code>ikptr</code> pointer to ratnum to get
the pointer to the first byte in the word holding the ratnum tag. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_ratnum_num</b><var><a name="index-off_005fratnum_005fnum-1383"></a></var><br>
&mdash; Preprocessor Symbol: <b>off_ratnum_den</b><var><a name="index-off_005fratnum_005fden-1384"></a></var><br>
<blockquote><p>An integer to add to a tagged <code>ikptr</code> pointer to ratnum to get the
pointer to the first byte of the words referencing the numerator or
denominator. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Convenience preprocessor macros</h5>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_NUMERATOR</b> (<var>ikptr X</var>)<var><a name="index-IK_005fNUMERATOR-1385"></a></var><br>
&mdash; Preprocessor Macro: ikptr <b>IK_DENOMINATOR</b> (<var>ikptr X</var>)<var><a name="index-IK_005fDENOMINATOR-1386"></a></var><br>
<blockquote><p>Evaluate to the location of the numerator or denominator in the ratnum
memory block.  A use of these macros can appear both as operand and as
left&ndash;side of an assignment:

     <pre class="example">          ikptr  s_rn  = the_ratnum;
          ikptr  s_num;
          
          s_num = IK_NUMERATOR(s_rn);
          IK_NUMERATOR(s_rn) = s_num;
</pre>
        </blockquote></div>

<!--  -->
<h5 class="subsubheading">Operations on ratnums</h5>

<div class="defun">
&mdash; Function: int <b>ik_is_ratnum</b> (<var>ikptr obj</var>)<var><a name="index-ik_005fis_005fratnum-1387"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a ratnum object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ika_ratnum_alloc_no_init</b> (<var>ikpcb * pcb</var>)<var><a name="index-ika_005fratnum_005falloc_005fno_005finit-1388"></a></var><br>
<blockquote><p>Allocate a new ratnum object using <code>ik_safe_alloc()</code> and return a
tagged reference to it.  The fields are left uninitialised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ika_ratnum_alloc_and_init</b> (<var>ikpcb * pcb</var>)<var><a name="index-ika_005fratnum_005falloc_005fand_005finit-1389"></a></var><br>
<blockquote><p>Allocate a new ratnum object using <code>ik_safe_alloc()</code> and return a
tagged reference to it.  Both the fields are set to the fixnum zero. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-flonums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-compnums">objects compnums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-ratnums">objects ratnums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.13 Flonum objects</h3>

<p>Flonums are double&ndash;precision floating point numbers (8 bytes
wide) implemented as specified by <acronym>IEEE</acronym> 754 on the hosting platform. 
A flonum is a fixed length memory block referenced by machine words
tagged as vectors.  The first machine word of a flonum block is tagged
has flonum in its least significant bits and it has the most significant
bits set to zero.

<pre class="example">     |------------------------|-------------| reference to flonum
           heap pointer         vector tag
     
     |------------------------|-------------| flonum first word
        all set to zero         flonum tag
</pre>
   <p>A flonum memory block is 16 bytes wide on both 32-bit and 64-bit
platforms; to allow for the same binary layout on both platforms, on a
32-bit platform the actual number is stored in the last two words:

<pre class="example">        1st word     2nd word     3rd word     4th word
     |------------|------------|------------|------------|
      tagged word     unused           data words
</pre>
   <p class="noindent">on a 64-bit platform the actual number is stored in the second word:

<pre class="example">               1st word                 2nd word
     |-------------------------|-------------------------|
              tagged word               data word
</pre>
   <!--  -->
<h5 class="subsubheading">Basic operations</h5>

<p>Flonums are allcated on the heap as follows:

<pre class="example">     ikpcb * pcb  = the_pcb;
     ikptr   s_fl;
     
     s_fl = ik_safe_alloc(pcb, flonum_size) | vector_tag;
     IK_REF(s_fl, off_flonum_tag) = (ikptr)flonum_tag
</pre>
   <p class="noindent">to identify an object as flonum we do:

<pre class="example">     ikptr  X = the_object;
     
     if ((vector_tag == IK_TAGOF(X)) &amp;&amp;
         (flonum_tag == IK_REF(X, -vector_tag)))
       it_is_a_flonum();
     else
       it_is_not();
</pre>
   <p class="noindent">to obtain a pointer to the data area we do:

<pre class="example">     ikptr     s_fl = the_flonum;
     double *  data;
     
     data = (double*)((long)(X) + off_flonum_data);
</pre>
   <div class="defun">
&mdash; Preprocessor Symbol: <b>flonum_size</b><var><a name="index-flonum_005fsize-1390"></a></var><br>
<blockquote><p>The number of bytes to allocate to hold a flonum memory block. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>flonum_tag</b><var><a name="index-flonum_005ftag-1391"></a></var><br>
<blockquote><p>The tag of <code>ikptr</code> values used as first words in bignum memory blocks. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_flonum_tag</b><var><a name="index-disp_005fflonum_005ftag-1392"></a></var><br>
<blockquote><p>Displacement of secondary tag word.  The number of bytes to add to an
untagged pointer to flonum to get the pointer to the first byte in the
word holding the flonum tag. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_flonum_data</b><var><a name="index-disp_005fflonum_005fdata-1393"></a></var><br>
<blockquote><p>Displacement of data area.  The number of bytes to add to an untagged
pointer to flonum to get the pointer to the first byte in the data area
holding the actual <code>double</code> value. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_flonum_tag</b><var><a name="index-off_005fflonum_005ftag-1394"></a></var><br>
<blockquote><p>An integer to add to add to a tagged <code>ikptr</code> pointer to flonum to get
the pointer to the first byte in the word holding the flonum tag. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_flonum_data</b><var><a name="index-off_005fflonum_005fdata-1395"></a></var><br>
<blockquote><p>An integer to add to a tagged <code>ikptr</code> pointer to flonum to get the
pointer to the first byte in the data area holding the actual
<code>double</code> value. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Convenience preprocessor macros</h5>

<div class="defun">
&mdash; Preprocessor Macro: double <b>IK_FLONUM_DATA</b> (<var>ikptr fl</var>)<var><a name="index-IK_005fFLONUM_005fDATA-1396"></a></var><br>
<blockquote><p>Set or retrieve the floating point number.  A use of this macro can
appear both as operand or left&ndash;side of assignment:

     <pre class="example">          ikptr  s_fl = the_flonum;
          double num;
          
          IK_FLONUM_DATA(s_fl) = 1.2;
          num = IK_FLONUM_DATA(s_fl);
</pre>
        </blockquote></div>

<!--  -->
<h5 class="subsubheading">Operations on flonums</h5>

<div class="defun">
&mdash; Function: int <b>ik_is_flonum</b> (<var>ikptr obj</var>)<var><a name="index-ik_005fis_005fflonum-1397"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a flonum object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>iku_flonum_alloc</b> (<var>ikpcb * pcb, double N</var>)<var><a name="index-iku_005fflonum_005falloc-1398"></a></var><br>
<blockquote><p>Allocate and return a new flonum object, using <code>ik_unsafe_alloc()</code>,
intialised with <var>N</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ika_flonum_from_double</b> (<var>ikpcb * pcb, double N</var>)<var><a name="index-ika_005fflonum_005ffrom_005fdouble-1399"></a></var><br>
<blockquote><p>Allocate and return a new flonum object, using <code>ik_safe_alloc()</code>,
intialised with <var>N</var>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-compnums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-cflonums">objects cflonums</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-flonums">objects flonums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.14 Compnum objects</h3>

<p>Compnums are complex numbers having a fixnum, bignum, ratnum or flonum
as real part and a fixnum, bignum, ratnum or flonum as imaginary part,
but <strong>not</strong> both flonums.

   <p>A compnum is a fixed length memory block referenced by machine words
tagged as vectors.  The first machine word of a compnum block is tagged
has compnum in its least significant bits and it has the most
significant bits set to zero.

<pre class="example">     |------------------------|-------------| reference to compnum
           heap pointer         vector tag
     
     |------------------------|-------------| compnum first word
        all set to zero         compnum tag
</pre>
   <p>A compnum memory block is 4 words wide; a reference to the real
part is stored in the second word and a reference to the imaginary part
is stored in the third word

<pre class="example">        1st word     2nd word     3rd word     4th word
     |------------|------------|------------|------------|
      tagged word   real part    imag part     unused
</pre>
   <!--  -->
<h5 class="subsubheading">Basic operations</h5>

<p>Compnums are allocated on the Scheme heap as follows:

<pre class="example">     ikpcb * pcb   = the_pcb;
     ikptr   s_cn;
     
     s_cn = ik_safe_alloc(pcb, compnum_size) | vector_tag;
     IK_REF(s_cn, off_compnum_tag) = compnum_tag;
</pre>
   <p class="noindent">after allocation we must always initialise the real and imaginary parts
to some correct value before running the next garbage collection; a full
allocation and initialisation is as follows:

<pre class="example">     ikpcb * pcb  = the_pcb;
     ikptr   s_re = the_real;
     ikptr   s_im = the_imag;
     ikptr   s_cn;
     
     pcb-&gt;root9 = &amp;s_re;
     pcb-&gt;root8 = &amp;s_im;
     {
       s_rn = ik_safe_alloc(pcb, compnum_size) | vector_tag;
     }
     pcb-&gt;root8 = NULL;
     pcb-&gt;root9 = NULL;
     
     IK_REF(s_cn, off_compnum_tag)  = compnum_tag;
     IK_REF(s_cn, off_compnum_real) = s_re;
     IK_REF(s_cn, off_compnum_imag) = s_im;
</pre>
   <p>To identify an object as compnum we do:

<pre class="example">     ikptr  X = the_object;
     
     if ((vector_tag  == IK_TAGOF(X)) &amp;&amp;
         (compnum_tag == IK_REF(X, -vector_tag)))
       it_is_a_compnum();
     else
       it_is_not();
</pre>
   <p class="noindent">to set or retrieve the real and imaginary parts we do:

<pre class="example">     ikptr  s_cn = the_compnum;
     ikptr  s_re;
     ikptr  s_im;
     
     s_re = IK_REF(s_cn, off_compnum_real);
     s_im = IK_REF(s_cn, off_compnum_imag);
     IK_REF(s_cn, off_compnum_real) = s_re;
     IK_REF(s_cn, off_compnum_imag) = s_im;
</pre>
   <div class="defun">
&mdash; Preprocessor Symbol: <b>compnum_size</b><var><a name="index-compnum_005fsize-1400"></a></var><br>
<blockquote><p>The number of bytes to allocate to hold a compnum memory block. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>compnum_tag</b><var><a name="index-compnum_005ftag-1401"></a></var><br>
<blockquote><p>The tag of <code>ikptr</code> values used as first words in compnum memory blocks. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_compnum_tag</b><var><a name="index-disp_005fcompnum_005ftag-1402"></a></var><br>
<blockquote><p>Displacement of secondary tag word.  The number of bytes to add to an
untagged pointer to compnum to get the pointer to the first byte in the
word holding the compnum tag. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_compnum_real</b><var><a name="index-disp_005fcompnum_005freal-1403"></a></var><br>
&mdash; Preprocessor Symbol: <b>disp_compnum_imag</b><var><a name="index-disp_005fcompnum_005fimag-1404"></a></var><br>
<blockquote><p>Displacements of real and imaginary parts.  The number of bytes to add
to an untagged pointer to compnum to get the pointer to the first byte
of the reference to the real or imaginary part. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_compnum_tag</b><var><a name="index-off_005fcompnum_005ftag-1405"></a></var><br>
<blockquote><p>An integer to add to add to a tagged <code>ikptr</code> pointer to compnum to get
the pointer to the first byte in the word holding the compnum tag. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_compnum_real</b><var><a name="index-off_005fcompnum_005freal-1406"></a></var><br>
&mdash; Preprocessor Symbol: <b>off_compnum_imag</b><var><a name="index-off_005fcompnum_005fimag-1407"></a></var><br>
<blockquote><p>An integer to add to a tagged <code>ikptr</code> pointer to compnum to get the
pointer to the first byte of the words referencing the real or
imaginary part. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Convenience preprocessor macros</h5>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_COMPNUM_REAL</b> (<var>ikptr X</var>)<var><a name="index-IK_005fCOMPNUM_005fREAL-1408"></a></var><br>
&mdash; Preprocessor Macro: ikptr <b>IK_COMPNUM_IMAG</b> (<var>ikptr X</var>)<var><a name="index-IK_005fCOMPNUM_005fIMAG-1409"></a></var><br>
<blockquote><p>Evaluate to the location of the real and imaginary parts in the compnum
memory block.  A use of these macros can appear both as operand and as
left&ndash;side of an assignment:

     <pre class="example">          ikptr  s_cn = the_compnum;
          ikptr  s_re;
          
          s_re = IK_COMPNUM_REAL(s_cn);
          IK_COMPNUM_REAL(s_cn) = s_re;
</pre>
        </blockquote></div>

<!--  -->
<h5 class="subsubheading">Operations on compnums</h5>

<div class="defun">
&mdash; Function: int <b>ik_is_compnum</b> (<var>ikptr obj</var>)<var><a name="index-ik_005fis_005fcompnum-1410"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a compnum object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ika_compnum_alloc_no_init</b> (<var>ikpcb * pcb</var>)<var><a name="index-ika_005fcompnum_005falloc_005fno_005finit-1411"></a></var><br>
<blockquote><p>Allocate a new compnum object using <code>ik_safe_alloc()</code> and return a
tagged reference to it.  The fields are left uninitialised. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ika_compnum_alloc_and_init</b> (<var>ikpcb * pcb</var>)<var><a name="index-ika_005fcompnum_005falloc_005fand_005finit-1412"></a></var><br>
<blockquote><p>Allocate a new compnum object using <code>ik_safe_alloc()</code> and return a
tagged reference to it.  Both the fields are set to the fixnum zero. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-cflonums"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-ports">objects ports</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-compnums">objects compnums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.15 Cflonum objects</h3>

<p>Cflonums are complex numbers having a flonum as real part and flonum as
imaginary part.  A cflonum is a fixed length memory block referenced by
machine words tagged as vectors.  The first machine word of a cflonum
block is tagged has cflonum in its least significant bits and it has the
most significant bits set to zero.

<pre class="example">     |------------------------|-------------| reference to cflonum
           heap pointer         vector tag
     
     |------------------------|-------------| cflonum first word
        all set to zero         cflonum tag
</pre>
   <p>A cflonum memory block is 4 words wide; a reference to the real
part is stored in the second word and a reference to the imaginary part
is stored in the third word

<pre class="example">        1st word     2nd word     3rd word     4th word
     |------------|------------|------------|------------|
      tagged word   real part    imag part     unused
</pre>
   <!--  -->
<h5 class="subsubheading">Basic operations</h5>

<p>Cflonums are allocated on the Scheme heap as follows:

<pre class="example">     ikpcb * pcb   = the_pcb;
     ikptr   s_cn;
     
     s_cn = ik_safe_alloc(pcb, cflonum_size) | vector_tag;
     IK_REF(s_cn, off_cflonum_tag) = cflonum_tag;
</pre>
   <p class="noindent">after allocation we must always initialise the real and imaginary parts
to some correct value before running the next garbage collection; a full
allocation and initialisation is as follows:

<pre class="example">     ikpcb * pcb  = the_pcb;
     ikptr   s_re = the_real;
     ikptr   s_im = the_imag;
     ikptr   s_cn;
     
     pcb-&gt;root9 = &amp;s_re;
     pcb-&gt;root8 = &amp;s_im;
     {
       s_rn = ik_safe_alloc(pcb, cflonum_size) | vector_tag;
     }
     pcb-&gt;root8 = NULL;
     pcb-&gt;root9 = NULL;
     
     IK_REF(s_cn, off_cflonum_tag)  = cflonum_tag;
     IK_REF(s_cn, off_cflonum_real) = s_re;
     IK_REF(s_cn, off_cflonum_imag) = s_im;
</pre>
   <p>To identify an object as cflonum we do:

<pre class="example">     ikptr  X = the_object;
     
     if ((vector_tag  == IK_TAGOF(X)) &amp;&amp;
         (cflonum_tag == IK_REF(X, -vector_tag)))
       it_is_a_cflonum();
     else
       it_is_not();
</pre>
   <p class="noindent">to set or retrieve the real and imaginary parts we do:

<pre class="example">     ikptr  s_cn = the_cflonum;
     ikptr  s_re;
     ikptr  s_im;
     
     s_re = IK_REF(s_cn, off_cflonum_real);
     s_im = IK_REF(s_cn, off_cflonum_imag);
     IK_REF(s_cn, off_cflonum_real) = s_re;
     IK_REF(s_cn, off_cflonum_imag) = s_im;
</pre>
   <div class="defun">
&mdash; Preprocessor Symbol: <b>cflonum_size</b><var><a name="index-cflonum_005fsize-1413"></a></var><br>
<blockquote><p>The number of bytes to allocate to hold a cflonum memory block. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>cflonum_tag</b><var><a name="index-cflonum_005ftag-1414"></a></var><br>
<blockquote><p>The tag of <code>ikptr</code> values used as first words in cflonum memory blocks. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_cflonum_tag</b><var><a name="index-disp_005fcflonum_005ftag-1415"></a></var><br>
<blockquote><p>Displacement of secondary tag word.  The number of bytes to add to an
untagged pointer to cflonum to get the pointer to the first byte in the
word holding the cflonum tag. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_cflonum_real</b><var><a name="index-disp_005fcflonum_005freal-1416"></a></var><br>
&mdash; Preprocessor Symbol: <b>disp_cflonum_imag</b><var><a name="index-disp_005fcflonum_005fimag-1417"></a></var><br>
<blockquote><p>Displacements of real and imaginary parts.  The number of bytes to add
to an untagged pointer to cflonum to get the pointer to the first byte
of the reference to the real or imaginary part. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_cflonum_tag</b><var><a name="index-off_005fcflonum_005ftag-1418"></a></var><br>
<blockquote><p>An integer to add to add to a tagged <code>ikptr</code> pointer to cflonum to get
the pointer to the first byte in the word holding the cflonum tag. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_cflonum_real</b><var><a name="index-off_005fcflonum_005freal-1419"></a></var><br>
&mdash; Preprocessor Symbol: <b>off_cflonum_imag</b><var><a name="index-off_005fcflonum_005fimag-1420"></a></var><br>
<blockquote><p>An integer to add to a tagged <code>ikptr</code> pointer to cflonum to get the
pointer to the first byte of the words referencing the real or
imaginary part. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Convenience preprocessor macros</h5>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_CFLONUM_REAL</b> (<var>ikptr X</var>)<var><a name="index-IK_005fCFLONUM_005fREAL-1421"></a></var><br>
&mdash; Preprocessor Macro: ikptr <b>IK_CFLONUM_IMAG</b> (<var>ikptr X</var>)<var><a name="index-IK_005fCFLONUM_005fIMAG-1422"></a></var><br>
<blockquote><p>Evaluate to the location of the real and imaginary parts in the cflonum
memory block.  A use of these macros can appear both as operand and as
left&ndash;side of an assignment:

     <pre class="example">          ikptr  s_cn = the_cflonum;
          ikptr  s_re;
          
          s_re = IK_CFLONUM_REAL(s_cn);
          IK_CFLONUM_REAL(s_cn) = s_re;
</pre>
        </blockquote></div>

<!--  -->
<h5 class="subsubheading">Operations on cflonums</h5>

<div class="defun">
&mdash; Function: int <b>ik_is_cflonum</b> (<var>ikptr obj</var>)<var><a name="index-ik_005fis_005fcflonum-1423"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is a cflonum object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>iku_cflonum_alloc_and_init</b> (<var>ikpcb * pcb, double re, double im</var>)<var><a name="index-iku_005fcflonum_005falloc_005fand_005finit-1424"></a></var><br>
<blockquote><p>Allocate a cflonum and its flonum components using
<code>ik_unsafe_alloc()</code> and return a tagged reference to it.  No garbage
collection is run while this function is evaluating. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-ports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-transcoders">objects transcoders</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-cflonums">objects cflonums</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.16 Port objects</h3>

<p>A port value is a block of memory allocated as a vector; a reference to
a port value is a reference to a vector.  The first word of the vector
is the bitwise OR between a port tag and a bitvector of port attributes.

<pre class="example">     |----------------|----------| port value
       heap pointer    vector tag
     
     |----------------|----------| 1st word of port's memory block
      port attributes   port tag
</pre>
   <p>At present the port tag is 6 bits wide, so we have: on 32-bit
platforms: 32 - 6 = 24 bits available for attributes; on 64-bit
platforms: 64 - 6 = 58 bits available for attributes.

   <p>See the source code in <samp><span class="file">ikarus.io.sls</span></samp> for a more comprehensive
documentation.

<!-- page -->
<div class="node">
<a name="objects-misc"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-pointers">objects pointers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.17 Miscellaneous functions</h3>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_general_copy</b> (<var>ikptr dst, ikptr dst_start, ikptr src, ikptr src_start, ikptr count</var>)<var><a name="index-ikrt_005fgeneral_005fcopy-1425"></a></var><br>
<blockquote><p>Copy <var>count</var> items from <var>src</var> starting at offset
<var>src_start</var>, to <var>dst</var> starting at offset <var>dst_start</var>;
<var>src_start</var>, <var>dst_start</var> and <var>count</var> must be non&ndash;negative
fixnums.  Return unspecified values.

        <p>Both <var>dst</var> and <var>src</var> can be one among: a bytevector, a pointer,
a string.  For bytevectors and pointers: bytes are moved and
<var>src_start</var>, <var>dst_start</var> and <var>count</var> are in byte units.  For
strings: 32-bit values representing Unicode code points are moved and
<var>src_start</var>, <var>dst_start</var> and <var>count</var> are in character units. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-pointers"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-misc">objects misc</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-transcoders">objects transcoders</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.18 Pointer objects</h3>

<p>A pointer is a fixed length memory block, two words wide, referenced by
machine words tagged as vectors.  The first machine word of a pointer
block is tagged has pointer in its least significant bits and it has the
most significant bits set to zero.  The second machine word of a pointer
block holds the actual pointer value.

<pre class="example">     |------------------------|-------------| reference to pointer
           heap pointer         vector tag
     
     |------------------------|-------------| pointer first word
        all set to zero         pointer tag
     
     |--------------------------------------| pointer second word
                 pointer value
</pre>
   <!--  -->
<h5 class="subsubheading">Basic operations</h5>

<p>Pointers are allocated on the Scheme heap as follows:

<pre class="example">     ikpcb * pcb   = the_pcb;
     ikptr   s_ptr;
     
     s_ptr = ik_safe_alloc(pcb, pointer_size) | vector_tag;
     IK_REF(s_ptr, off_pointer_tag) = pointer_tag;
</pre>
   <p class="noindent">to identify an object as pointer we do:

<pre class="example">     ikptr  X = the_object;
     
     if ((vector_tag  == IK_TAGOF(X)) &amp;&amp;
         (pointer_tag == IK_REF(X, -vector_tag)))
       it_is_a_pointer();
     else
       it_is_not();
</pre>
   <p class="noindent">to set or retrieve the pointer value we do:

<pre class="example">     ikptr  s_ptr = the_pointer;
     void * ptr;
     
     ptr = (void *)IK_REF((X), off_pointer_data);
     IK_REF((X), off_pointer_data) = (ikptr)ptr;
</pre>
   <div class="defun">
&mdash; Preprocessor Symbol: <b>pointer_size</b><var><a name="index-pointer_005fsize-1426"></a></var><br>
<blockquote><p>The number of bytes to allocate to hold a pointer memory block. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>pointer_tag</b><var><a name="index-pointer_005ftag-1427"></a></var><br>
<blockquote><p>The tag of <code>ikptr</code> values used as first words in pointer memory blocks. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_pointer_tag</b><var><a name="index-disp_005fpointer_005ftag-1428"></a></var><br>
<blockquote><p>Displacement of secondary tag word.  The number of bytes to add to an
untagged pointer to pointer object to get the pointer to the first byte
in the word holding the pointer tag. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>disp_pointer_data</b><var><a name="index-disp_005fpointer_005fdata-1429"></a></var><br>
<blockquote><p>Displacement of data area.  The number of bytes to add to an untagged
pointer to pointer object to get the pointer to the first byte of the
data area. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_pointer_tag</b><var><a name="index-off_005fpointer_005ftag-1430"></a></var><br>
<blockquote><p>An integer to add to add to a tagged <code>ikptr</code> pointer to pointer object
to get the pointer to the first byte in the word holding the pointer
tag. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Symbol: <b>off_pointer_data</b><var><a name="index-off_005fpointer_005fdata-1431"></a></var><br>
<blockquote><p>An integer to add to a tagged <code>ikptr</code> pointer to pointer object to get
the pointer to the first byte of the word holding the pointer value. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Convenience preprocessor macros</h5>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_POINTER_DATA</b> (<var>ikptr X</var>)<var><a name="index-IK_005fPOINTER_005fDATA-1432"></a></var><br>
<blockquote><p>Return the value of the pointer as <code>ikptr</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: void * <b>IK_POINTER_DATA_VOIDP</b> (<var>ikptr X</var>)<var><a name="index-IK_005fPOINTER_005fDATA_005fVOIDP-1433"></a></var><br>
&mdash; Preprocessor Macro: char * <b>IK_POINTER_DATA_CHARP</b> (<var>ikptr X</var>)<var><a name="index-IK_005fPOINTER_005fDATA_005fCHARP-1434"></a></var><br>
&mdash; Preprocessor Macro: uint8_t * <b>IK_POINTER_DATA_UINT8P</b> (<var>ikptr X</var>)<var><a name="index-IK_005fPOINTER_005fDATA_005fUINT8P-1435"></a></var><br>
&mdash; Preprocessor Macro: long * <b>IK_POINTER_DATA_LONG</b> (<var>ikptr X</var>)<var><a name="index-IK_005fPOINTER_005fDATA_005fLONG-1436"></a></var><br>
&mdash; Preprocessor Macro: ik_llong * <b>IK_POINTER_DATA_LLONG</b> (<var>ikptr X</var>)<var><a name="index-IK_005fPOINTER_005fDATA_005fLLONG-1437"></a></var><br>
&mdash; Preprocessor Macro: ik_ulong * <b>IK_POINTER_DATA_ULONG</b> (<var>ikptr X</var>)<var><a name="index-IK_005fPOINTER_005fDATA_005fULONG-1438"></a></var><br>
&mdash; Preprocessor Macro: ik_ullong * <b>IK_POINTER_DATA_ULLONG</b> (<var>ikptr X</var>)<var><a name="index-IK_005fPOINTER_005fDATA_005fULLONG-1439"></a></var><br>
<blockquote><p>Return the value of the pointer cast to a specific type. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: ikptr <b>IK_POINTER_SET_NULL</b> (<var>ikptr X</var>)<var><a name="index-IK_005fPOINTER_005fSET_005fNULL-1440"></a></var><br>
<blockquote><p>Reset to <code>NULL</code> the value of the pointer. 
</p></blockquote></div>

<div class="defun">
&mdash; Preprocessor Macro: int <b>IK_POINTER_IS_NULL</b> (<var>ikptr X</var>)<var><a name="index-IK_005fPOINTER_005fIS_005fNULL-1441"></a></var><br>
<blockquote><p>Evaluate to true if the pointer value is <code>NULL</code>. 
</p></blockquote></div>

<!--  -->
<h5 class="subsubheading">Operations on pointers</h5>

<div class="defun">
&mdash; Function: ikptr <b>ika_pointer_alloc</b> (<var>ikpcb * pcb, ik_ulong memory</var>)<var><a name="index-ika_005fpointer_005falloc-1442"></a></var><br>
<blockquote><p>Allocate a pointer object using <code>ik_safe_alloc()</code> and return a
tagged reference to it.  The pointer is initialised to <var>memory</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>iku_pointer_alloc</b> (<var>ikpcb* pcb, ik_ulong memory</var>)<var><a name="index-iku_005fpointer_005falloc-1443"></a></var><br>
<blockquote><p>Allocate a pointer object using <code>ik_unsafe_alloc()</code> and return a
tagged reference to it.  The pointer is initialised to <var>memory</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>ik_is_pointer</b> (<var>ikptr X</var>)<var><a name="index-ik_005fis_005fpointer-1444"></a></var><br>
<blockquote><p>Return true if <var>X</var> is a pointer object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: ikptr <b>ikrt_is_pointer</b> (<var>ikptr X</var>)<var><a name="index-ikrt_005fis_005fpointer-1445"></a></var><br>
<blockquote><p>Return <code>true_object</code> if <var>X</var> is a pointer object, else return
<code>false_object</code>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="objects-transcoders"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#objects-pointers">objects pointers</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects-ports">objects ports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#objects">objects</a>

</div>

<h3 class="section">11.19 Transcoder objects</h3>

<p>A transcoder is a machine word tagged to make it of a disjoint type. 
The transcoder data (codec, <acronym>EOL</acronym> style, error handling) is encoded in
the most significant bits of this word:

<pre class="example">     |---------------------------|------------| transcoder
            payload bits          transcoder-tag
</pre>
   <p class="noindent">the payload of this word is an 8-bit vector whose format is as follows:

<pre class="example">     765 432 10
      |   |   |
      |   |    -- error handling mode
      |    ------ end of line style
       ---------- codec
</pre>
   <p>See the source code in the file <samp><span class="file">ikarus.codecs.sls</span></samp> for more
details.

<!-- page -->
<div class="node">
<a name="debug-int"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#compiler">compiler</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#objects">objects</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">12 Internals: debug mode</h2>

<ul class="menu">
<li><a accesskey="1" href="#debug-int-intro">debug int intro</a>:              Introduction to debug mode. 
</ul>

<!-- page -->
<div class="node">
<a name="debug-int-intro"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#debug-int">debug int</a>

</div>

<h3 class="section">12.1 Introduction to debug mode</h3>

<p>Debug mode is driven with the following options:

     <dl>
<dt><samp><span class="option">-d</span></samp><dt><samp><span class="option">--debug</span></samp><dd>Turn on debugging mode.  The parameter <code>generate-debug-calls</code> is
set to true.

     <br><dt><samp><span class="option">-nd</span></samp><dt><samp><span class="option">--no-debug</span></samp><dd>Turn off debugging mode.  The parameter <code>generate-debug-calls</code> is
set to false. 
</dl>

   <p>The implementation is mostly in <samp><span class="file">ikarus.debugger.sls</span></samp> and
<samp><span class="file">ikarus.compiler.sls</span></samp>.

<div class="defun">
&mdash; Parameter: <b>generate-debug-calls</b><var><a name="index-generate_002ddebug_002dcalls-1446"></a></var><br>
<blockquote><p>Set to true when debug mode is turned on.  Defined in
<samp><span class="file">ikarus.compiler.sls</span></samp>, configured in <samp><span class="file">ikarus.main.sls</span></samp>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>guarded-start</b><var> proc<a name="index-guarded_002dstart-1447"></a></var><br>
<blockquote><p>Evaluate the procedure <var>proc</var> under the debugging infrastructure. 
It is used in the <code>(ikarus main)</code> library (<samp><span class="file">ikarus.main.sls</span></samp>)
to start the execution of a program and all the other execution modes.

        <p><var>proc</var> is evaluated under the installation of an exception handler
displaying the stack trace and offering the continuation alternatives. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="compiler"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#missing">missing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#debug-int">debug int</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">13 Wild notes on the compiler internals</h2>

<blockquote>
This chapter is a collection of notes on the internals of the compiler;
there is guarantee of neither their correctness nor their completeness,
because the original compiler code is fully undocumented. 
</blockquote>

<ul class="menu">
<li><a accesskey="1" href="#compiler-intro">compiler intro</a>:               Introduction to the compiler. 
<li><a accesskey="2" href="#compiler-conventions">compiler conventions</a>:         Coding conventions in the compiler
                                code. 
<li><a accesskey="3" href="#compiler-cogen">compiler cogen</a>:               Stuff in <samp><span class="file">ikarus.compiler.altcogen.ss</span></samp>. 
</ul>

<!-- page -->
<div class="node">
<a name="compiler-intro"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#compiler-conventions">compiler conventions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#compiler">compiler</a>

</div>

<h3 class="section">13.1 Introduction to the compiler</h3>

<p>Vicare Scheme's compiler supports only the Intel architecture.  The
compiler is coded in the following files

     <dl>
<dt><samp><span class="file">ikarus.compiler.altcogen.ss</span></samp><dd>Generate assembly code in S&ndash;expression format. 
</dl>

   <p>How do we generate assembly code?  First we need to generate a single
line of assembly code; this is done by <code>make-asm-instr</code> which
accepts as first argument a Scheme symbol representing the instruction,
for example: &lsquo;<samp><span class="samp">move</span></samp>&rsquo;, &lsquo;<samp><span class="samp">idiv</span></samp>&rsquo;, &lsquo;<samp><span class="samp">int+</span></samp>&rsquo;.

   <p>Then we need to generate blocks of assembly instructions: sequences of
instructions which must be executed in order.  There are two types of
blocks: the ones which at the end generate a value to be stored in a
location (register or memory), the ones which perform some operation but
do not generate a value.  The first kind are blocks which &ldquo;impose a
value&rdquo;, the second kind are the &ldquo;side effects&rdquo;.

<!-- page -->
<div class="node">
<a name="compiler-conventions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#compiler-cogen">compiler cogen</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#compiler-intro">compiler intro</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#compiler">compiler</a>

</div>

<h3 class="section">13.2 Coding conventions in the compiler code</h3>

<p>Throughout the compiler code variables with the following names appear:

     <dl>
<dt><var>op</var><dd>Scheme symbol representing an <strong>operation</strong> to be directly
translated into assembly.  Examples: &lsquo;<samp><span class="samp">alloc</span></samp>&rsquo;, &lsquo;<samp><span class="samp">mref</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">mref32</span></samp>&rsquo;, &lsquo;<samp><span class="samp">bref</span></samp>&rsquo;, &lsquo;<samp><span class="samp">logand</span></samp>&rsquo;, &lsquo;<samp><span class="samp">logxor</span></samp>&rsquo;, &lsquo;<samp><span class="samp">logor</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">int+</span></samp>&rsquo;, &lsquo;<samp><span class="samp">int-</span></samp>&rsquo;, &lsquo;<samp><span class="samp">int*</span></samp>&rsquo;, &lsquo;<samp><span class="samp">int-quotient</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">int-remainder</span></samp>&rsquo;, &lsquo;<samp><span class="samp">sll</span></samp>&rsquo;, &lsquo;<samp><span class="samp">sra</span></samp>&rsquo;.

     <br><dt><var>rator</var><dd>Represents a reference to an <strong>operator</strong>: a function coded in
assembly or C language.

     <br><dt><var>rands</var><dd>Scheme list holding the <strong>operands</strong> to which an operation must be
applied.  These operands are in such a format that can be directly used
in the assembly S&ndash;expression like:

     <pre class="example">          (make-set eax (car rands))
</pre>
     <p class="noindent">which generate an assignment operation to store the first element of
<var>rands</var> into the <code>eax</code> processor register. 
</dl>

<!-- page -->
<div class="node">
<a name="compiler-cogen"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#compiler-conventions">compiler conventions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#compiler">compiler</a>

</div>

<h3 class="section">13.3 Stuff in <samp><span class="file">ikarus.compiler.altcogen.ss</span></samp></h3>

<!-- page -->
<div class="node">
<a name="missing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#building">building</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#compiler">compiler</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix A Missing Features</h2>

<p>Vicare does not fully conform to <acronym>R6RS</acronym> yet.  Although it
implements most of <acronym>R6RS</acronym>'s macros and procedures, some are still
missing.  This appendix summarizes the set of missing features and
procedures.

     <ul>
<li><code>number-&gt;string</code> does not accept the third argument (precision). 
Similarly, <code>string-&gt;number</code> and the reader do not recognize the
<code>|p</code> notation. 
</ul>

<!-- page -->
<div class="node">
<a name="building"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#credits">credits</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#missing">missing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix B Building infrastructure</h2>

<p>This appendix contains instructions on how to use and modify the
building infrastructure of Vicare Scheme.  The source of the package
is manage by a Git repository, so some bits of the infrastructure depend
on Git.

<ul class="menu">
<li><a accesskey="1" href="#building-revision">building revision</a>:            Package revision in the banner. 
</ul>

<!-- page -->
<div class="node">
<a name="building-revision"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#building">building</a>

</div>

<h3 class="appendixsec">B.1 Package revision in the banner</h3>

<p>When running <samp><span class="command">vicare</span></samp> in a terminal, it prints a banner
showing the revision number:

<pre class="smallexample">     $ vicare
     Vicare Scheme version 0.1d0+ \
       (revision master/21da24720f161708372756e1324c230bd5ff6ac9, \
        build 2010-05-01)
     Copyright (c) 2006-2010 Abdulaziz Ghuloum
</pre>
   <p>The revision specification shows the branch name and the commit hash;
they are read from the file <samp><span class="file">./scheme/last-revision</span></samp>, which is
generated by the following chunk of code in the
<samp><span class="file">.git/hooks/post-commit</span></samp> script:

<pre class="smallexample">     LAST_REVISION_FILE=./scheme/last-revision
     BRANCH_NAME=$(git branch 2&gt;/dev/null | \
                     sed -e '/^[^*]/d' -e 's/^* //')
     COMMIT_HASH=$(git show | head -1 | cut -d' ' -f2)
     echo "$BRANCH_NAME/$COMMIT_HASH" &gt;$LAST_REVISION_FILE
</pre>
   <!-- page -->
<div class="node">
<a name="credits"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#unicode">unicode</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#building">building</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix C Credits for this document</h2>

<p>The skeleton of this document is the original &ldquo;Ikarus User's Guide&rdquo; in
XeLaTeX format, by Abdulaziz Ghulom.  That document is available in the
Ikarus distribution and is covered by the <acronym>GNU</acronym> General Public License
version 3 as published by the Free Software Foundation.  It is available
at the following <acronym>URL</acronym>s:

<div align="center"><a href="http://www.cs.indiana.edu/~aghuloum/ikarus/">http://www.cs.indiana.edu/~aghuloum/ikarus/</a></div>
<div align="center"><a href="https://launchpad.net/ikarus">https://launchpad.net/ikarus</a></div>

<!-- page -->
<div class="node">
<a name="unicode"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#fasl">fasl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#credits">credits</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix D On Unicode and <acronym>UTF</acronym> encodings</h2>

<p>As required by <acronym>R6RS</acronym>, the Scheme implementations must support Unicode
characters and input/output libraries must implement transcoders for
textual ports supporting encoding and decoding between Scheme characters
and <acronym>UTF</acronym>-8 and <acronym>UTF</acronym>-16.

   <p>The mandatory starting points to learn about this stuff are the
following (<acronym>URL</acronym>s last verified on Sep 9, 2011):

<div align="center"><a href="http://www.unicode.org/faq/utf_bom.html">http://www.unicode.org/faq/utf_bom.html</a></div>
<div align="center"><a href="http://en.wikipedia.org/wiki/Universal_Character_Set">http://en.wikipedia.org/wiki/Universal_Character_Set</a></div>
<div align="center"><a href="http://en.wikipedia.org/wiki/Unicode">http://en.wikipedia.org/wiki/Unicode</a></div>
<div align="center"><a href="http://en.wikipedia.org/wiki/Byte_order_mark">http://en.wikipedia.org/wiki/Byte_order_mark</a></div>
<div align="center"><a href="http://en.wikipedia.org/wiki/UTF-8">http://en.wikipedia.org/wiki/UTF-8</a></div>
<div align="center"><a href="http://en.wikipedia.org/wiki/UTF-16">http://en.wikipedia.org/wiki/UTF-16</a></div>
<div align="center"><a href="http://en.wikipedia.org/wiki/UTF-32">http://en.wikipedia.org/wiki/UTF-32</a></div>

<p class="noindent">here we give only a brief overview of the main definitions, drawing text
from those pages.

   <p>The <dfn>Universal Character Set</dfn> (<acronym>UCS</acronym>) is a standard set of
characters upon which many character encodings are based; it contains
abstract characters, each identified by an unambiguous name and an
integer number called its &ldquo;code point&rdquo;.

   <p><dfn>Unicode</dfn> is a computing industry standard for the consistent
encoding, representation and handling of text expressed in most of the
world's writing systems.

   <p><acronym>UCS</acronym> and Unicode have an identical repertoire and numbers: the
same characters with the same numbers exist in both standards. 
<acronym>UCS</acronym> is a simple character map, Unicode adds rules for
collation, normalization of forms, and the bidirectional algorithm for
scripts.

   <p>The Unicode Consortium, the nonprofit organization that coordinates
Unicode's development, has the goal of eventually replacing existing
character encoding schemes with Unicode and its standard &ldquo;Unicode
Transformation Format&rdquo; alias &ldquo;<acronym>UCS</acronym> Transformation Format&rdquo;
(<acronym>UTF</acronym>) schemes.

   <p>By convention a Unicode code point is referred to by writing <code>U+</code>
followed by its hexadecimal number with at least 4 digits
(<code>U+0044</code> is fine, <code>U+12</code> is not).

   <p>In practice, Unicode code points are exact integers in the range
[0, #x10FFFF], but outside the range [#xD800, #xDFFF]
which has special meaning in <acronym>UTF</acronym> schemes.  A code point can be stored
in 21 bits:

<pre class="example">     (string-length (number-&gt;string #x10FFFF 2)) &rArr; 21
</pre>
   <p class="noindent"><acronym>R6RS</acronym> defines fixnums to have at least 24 bits, so a fixnum is
wide enough to hold a code point:

<pre class="example">     (fixnum? #x10FFFF) &rArr; #t
</pre>
   <p class="noindent">and indeed Scheme characters are a disjoint type of value holding such
fixnums:

<pre class="example">     (integer-&gt;char #x10FFFF) &rArr; #\x10FFFF
</pre>
   <!--  -->
<h5 class="subsubheading"><acronym>UTF</acronym>-8 scheme</h5>

<p><acronym>UTF</acronym>-8 is a multioctet character encoding for Unicode which can
represent every character in the Unicode set, that is it can represent
every code point in the ranges [0, #xD800) and (#xDFFF,
#x10FFFF].

   <p>A stream of <acronym>UTF</acronym>-8 encoded characters is meant to be stored octet by
octet in fixed order (and so without the need to specify the endianness
of words).

   <p>The encoding scheme uses sequences of 1, 2, 3 or
4 octets to encode a each code point as shown in the following
table; the first octet in a sequence has a unique bit pattern in the
most significant bits and so it allows the determination of the sequence
length; every octet contains a number of payload bits which must be
concatenated (bitwise inclusive OR) to reconstruct the integer
representation of a code point:

<pre class="example">     | # of octets | 1st octet | 2nd octet | 3rd octet | 4th octet |
     |-------------+-----------+-----------+-----------+-----------|
     |     1        #b0xxxxxxx
     |     2        #b110xxxxx  #b10xxxxxx
     |     3        #b1110xxxx  #b10xxxxxx  #b10xxxxxx
     |     4        #b11110xxx  #b10xxxxxx  #b10xxxxxx  #b10xxxxxx
     
     | # of octets | # of payload bits |       hex range     |
     |-------------+-------------------+---------------------|
     |     1                         7    [#x0000,   #x007F]
     |     2                5 + 6 = 11    [#x0080,   #x07FF]
     |     3            4 + 6 + 6 = 16    [#x0800,   #xFFFF]
     |     4        3 + 6 + 6 + 6 = 21  [#x010000, #x10FFFF]
</pre>
   <p>Note that octets <code>#xFE</code> and <code>#xFF</code> cannot appear in a valid
stream of <acronym>UTF</acronym>-8 encoded characters.  The sequence of 3 octets
is the one that could encode (but must not) the forbidden range
[#xD800, #xDFFF].

   <p>The first 128 characters of the Unicode character set correspond
one&ndash;to&ndash;one with <acronym>ASCII</acronym> and are encoded using a single octet with the
same binary value as the corresponding <acronym>ASCII</acronym> character, making valid
<acronym>ASCII</acronym> text valid <acronym>UTF</acronym>-8 encoded Unicode text as well.  Such encoded
octets have the Most Significant Bit (<acronym>MSB</acronym>) set to zero.

   <p>Although the standard does not define it, many programs start a <acronym>UTF</acronym>-8
stream with a Byte Order Mark (<acronym>BOM</acronym>) composed of the 3
octets: <code>#xEF</code>, <code>#xBB</code>, <code>#xBF</code>.

<!--  -->
<h5 class="subsubheading"><acronym>UTF</acronym>-16 decoding</h5>

<p>Given a 16-bit word in a <acronym>UTF</acronym>-16 stream, represented in Scheme as a
fixnum in the range [#x0000, #xFFFF], we can classify it on the
following axis:

<pre class="example">     0000        D7FF D800    DBFF DC00      DFFF E000       FFFF
      |-------------||-----------||-------------||------------|
       single word    first in     second in      single word
       character      pair         pair           character
</pre>
   <p class="noindent">or the following logic:

<pre class="example">     word in [#x0000, #xD7FF] =&gt; single word character
     word in [#xD800, #xDBFF] =&gt; first in surrogate pair
     word in [#xDC00, #xDFFF] =&gt; second in surrogate pair
     word in [#xE000, #xFFFF] =&gt; single word character
</pre>
   <!--  -->
   <p><acronym>ISO</acronym>/<acronym>IEC</acronym> 8859-1 also known as Latin-1

   <p>Latin-1 uses 1 octet per character.  The first 256 Unicode
code points are identical to the content of Latin-1, the first
127 Latin-1 code points are identical to <acronym>ASCII</acronym>.  For an
itroduction see:

<div align="center"><a href="http://en.wikipedia.org/wiki/ISO/IEC_8859-1">http://en.wikipedia.org/wiki/ISO/IEC_8859-1</a></div>

   <p>Latin-1 code points are identical to their octet encoding.

   <p>Latin-1 code points in the range [0, 127] are identical to the
same code points encoded in both <acronym>ASCII</acronym> and in <acronym>UTF</acronym>-8.

   <p>Latin-1 code points in the range [128, 255] are
<strong>different</strong> from the same code points encoded in <acronym>UTF</acronym>-8.

   <p>Every octet (that is: every fixnum in the range [0, 255]) can be
interpreted as a character in Latin-1 encoding.

<!-- page -->
<div class="node">
<a name="fasl"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#cre2">cre2</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#unicode">unicode</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix E Handling <acronym>FASL</acronym> files</h2>

<p><acronym>FASL</acronym> files are binary files in which compiled Scheme code and data is
stored; we can easily create a <acronym>FASL</acronym> file as follows:

<pre class="example">     vicare&gt; (define filename "/tmp/marco/p.fasl")
     vicare&gt; (define p (open-file-output-port filename))
     vicare&gt; (fasl-write '(1 ciao "hello") p)
     vicare&gt; (close-port p)
     vicare&gt; (define p (open-file-input-port filename))
     vicare&gt; (fasl-read p)
     (1 ciao "hello")
     vicare&gt; (close-port p)
     vicare&gt;
</pre>
   <ul class="menu">
<li><a accesskey="1" href="#fasl-format">fasl format</a>:                  Binary format of a <acronym>FASL</acronym> file. 
<li><a accesskey="2" href="#fasl-api">fasl api</a>:                     <acronym>FASL</acronym> files <acronym>API</acronym>. 
<li><a accesskey="3" href="#fasl-foreign">fasl foreign</a>:                 Associating foreign libraries to
                                <acronym>FASL</acronym> files. 
</ul>

<!-- page -->
<div class="node">
<a name="fasl-format"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#fasl-api">fasl api</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#fasl">fasl</a>

</div>

<h3 class="appendixsec">E.1 Binary format of a <acronym>FASL</acronym> file</h3>

<p>A <acronym>FASL</acronym> object is a header followed by one or more object fields
followed by an end&ndash;of&ndash;<acronym>FASL</acronym> marker.  After the end&ndash;of&ndash;<acronym>FASL</acronym>
marker the file must be at its <acronym>EOF</acronym>.

   <p>The header is the string <code>#@IK0</code>, followed by <code>1</code> if fixnum
width is 30 bits, else followed by <code>2</code>; the end of fasl
marker is <code>@</code>.

   <p>If the same object is referenced multiple times in the <acronym>FASL</acronym> file: it
can be included only once and &ldquo;marked&rdquo; with a fixnum; such mark is
later dereferenced to insert a reference to the object in the loaded
code.

   <p>A data word is an exact signed integer of 32-bit or 64-bit depending on
the word size of the underlying platform.

   <p>An object field is a character in <acronym>ASCII</acronym> encoding, optionally followed
by data representing the serialisation of a Scheme value:

     <dl>
<dt>"N"<dd>Denotes the empty list.

     <br><dt>"T"<dd>Denotes <code>#t</code>.

     <br><dt>"F"<dd>Denotes <code>#f</code>.

     <br><dt>"E"<dd>Denotes the end of file object.

     <br><dt>"U"<dd>Denotes the unspecified value (void).

     <br><dt>"I" + word<dd>A fixnum stored as a big endian word.

     <br><dt>"s" + word(N) + octet ...<dd>An <acronym>ASCII</acronym> string of N characters followed by N octets
representing the characters in <acronym>ASCII</acronym> encoding.  The data word
N must represent an exact integer in the range of fixnums.

     <br><dt>"S" + word(N) + int32 ...<dd>A Unicode string of N characters followed by N 32-bit
integers in native order representing the characters as Unicode code
points.  The data word N must represent an exact integer in the
range of fixnums.

     <br><dt>"M" + symbol-name<dd>A symbol.  <code>symbol-name</code> is a string field.

     <br><dt>"G" + pretty-name + unique-name<dd>A gensym.  Both <code>pretty-name</code> and <code>unique-name</code> are strings.

     <br><dt>"c" + octet<dd>A character in the <acronym>ASCII</acronym> range (&lt;= 255).

     <br><dt>"C" + int32<dd>A character store as 32-bit integer representing a Unicode code point.

     <br><dt>"P" + object1 + object2<dd>A pair.

     <br><dt>"V" + word(N) + object ...<dd>A vector of length N followed by N object fields.  The
data word N must represent an exact integer in the range of
fixnums.

     <br><dt>"v" + word(N) + octet ...<dd>A bytevector of length N followed by N octets.  The data
word N must represent an exact integer in the range of fixnums.

     <br><dt>"R" + rtd-name + rtd-symbol + field-count + name ...<dd>A struct type descriptor.  <code>rtd-name</code> must be a symbol. 
<code>rtd-symbol</code> must be a symbol.  <code>field-count</code> must be a word
in the fixnum range.  The <code>name</code> object fields must be symbols
representing the field name and there must be <code>field-count</code> of
them.

     <br><dt>"{" + field-count + rtd + field ...<dd>A structure instance.  <code>field-count</code> must be a word in the fixnum
range.  <code>rtd</code> must be a struct type descriptor.  The <code>field</code>
object fields must be the fields of the structure instance and there
must be <code>field-count</code> of them.

     <br><dt>"r" + denominator + numerator<dd>Ratnum.

     <br><dt>"f" + 8-byte<dd><acronym>IEEE</acronym> double precision flonum.  The bytes are stored: most significant
first, least significant last.

     <br><dt>"b" + word(N) + octet ...<dd>Denotes a bignum.  <var>N</var> is a signed integer word whose sign is the
sign of the bignum and whose modulo is the number of octets representing
the bignum.

     <br><dt>"i" + real-part + imag-part<dd>Complex numbers, both cflonum and compnum.

     <br><dt>"l" + octet(N) + object ...<dd>A list of N &lt;= 255 elements followed by the elements.

     <br><dt>"L" + word(N) + object ...<dd>A list of N &gt; 255 elements followed by the elements.

     <br><dt>"h" + vector + vector<dd><code>eq?</code>  hashtable, first vector keys, second vector values.

     <br><dt>"H" + vector + vector<dd><code>eqv?</code> hashtable, first vector keys, second vector values.

     <br><dt>"W" + name + parent + uid + sealed? + opaque? + count + (bool + field) ...<dd>An <acronym>R6RS</acronym> record type descriptor.  <code>name</code> must be the return
value of <code>record-type-name</code>.  <code>parent</code> must be the return
value of <code>record-type-parent</code>.  <code>uid</code> must be the return value
of <code>record-type-uid</code>.  <code>sealed?</code> must be the return value of
<code>record-type-sealed?</code>.  <code>opaque?</code> must be the return value of
<code>record-type-opaque?</code>.  <code>count</code> must be a fixnum representing
the number of fields.  Each <code>bool + field</code> sequence must be a
boolean representing the mutability of the record field, followed by
symbol representing the name of the record field.

     <br><dt>"x"<dd>Denotes code.

     <br><dt>"Q"<dd>Procedure; followed by code.

     <br><dt>"&gt;" + int32(I)<dd>Mark the next object with index I.

     <br><dt>"&lt;" + int32(I)<dd>Dereference the object marked with index I.

     <br><dt>"O" + libid<dd>Foreign library identifier.  <code>libid</code> must be a string representing
the foreign shared library identifier: on Unix&ndash;like systems it is
prefixed with <code>lib</code> and suffixed with <code>.so</code> to compose a
library file name. 
</dl>

<!-- page -->
<div class="node">
<a name="fasl-api"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#fasl-foreign">fasl foreign</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#fasl-format">fasl format</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#fasl">fasl</a>

</div>

<h3 class="appendixsec">E.2 <acronym>FASL</acronym> files <acronym>API</acronym></h3>

<p>The following bindings are exported by the libraries <code>(ikarus)</code>
and <code>(vicare)</code>.

<div class="defun">
&mdash; Function: <b>fasl-write</b><var> obj port<a name="index-fasl_002dwrite-1448"></a></var><br>
&mdash; Function: <b>fasl-write</b><var> obj port libraries<a name="index-fasl_002dwrite-1449"></a></var><br>
<blockquote><p>Serialise <var>obj</var> to the binary output port <var>port</var> prefixing it
with the <acronym>FASL</acronym> file header.  If <var>libraries</var> is present: it must be
a list of strings representing foreign shared libraries to be loaded
whenever the <acronym>FASL</acronym> file is loaded, <a href="#fasl-foreign">fasl foreign</a> for details. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>fasl-read</b><var> port<a name="index-fasl_002dread-1450"></a></var><br>
<blockquote><p>Read and return a serialised object from the binary input <var>port</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Parameter: <b>fasl-directory</b><var><a name="index-fasl_002ddirectory-1451"></a></var><br>
<blockquote><p>Hold a string representing the top directory under which <acronym>FASL</acronym> files
are stored when libraries are compiled.  The default value is determined
as follows:

          <ol type=1 start=1>
<li>Check the value of the system environment variable
<samp><span class="env">VICARE_FASL_DIRECTORY</span></samp>: if set the value is the directory pathname.

          <li>Acquire the value of the system environment variable <samp><span class="env">HOME</span></samp>: if set
compose a directory pathname by appending to the value the string:

          <pre class="example">               /.vicare/precompiled
</pre>
          <li>Set the parameter to the empty string.
             </ol>
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>fasl-path</b><var> filename<a name="index-fasl_002dpath-1452"></a></var><br>
<blockquote><p>Given a source file name return the associated full <acronym>FASL</acronym> file name
using the current value of <code>fasl-directory</code>.  Return false if
<code>fasl-directory</code> is unset (which should never happen).  It is an
error if the file <var>filename</var> does not exist. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="fasl-foreign"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#fasl-api">fasl api</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#fasl">fasl</a>

</div>

<h3 class="appendixsec">E.3 Associating foreign libraries to <acronym>FASL</acronym> files</h3>

<p><a name="index-g_t_0040func_007bforeign_002dcall_007d-1453"></a>

   <p>The macro <code>foreign-call</code>, exported by the libraries
<code>(ikarus)</code> and <code>(vicare)</code>, is expanded to compiled code
which invokes a C function from the process image; the first argument to
<code>foreign-call</code> is a string naming the C function.  Whenever the
code is compiled, the C pointer to the named function is retrieved with
a call to:

<pre class="example">     dlsym(RTLD_DEFAULT, function_name);
</pre>
   <p class="noindent">so all the public functions from the running <samp><span class="command">vicare</span></samp> executable
are available and also all the functions from host's shared libraries
loaded with <code>dlopen()</code> using the flags <code>RTLD_NOW |
RTLD_GLOBAL</code>.

   <p>It is possible to associate one or more host's shared libraries to a
<acronym>FASL</acronym> file, so that: whenever the <acronym>FASL</acronym> file is loaded, the shared
library is loaded too and the functions required by <code>foreign-call</code>
are available.  This is especially useful to implement bindings to
foreign libraries without relying on the <acronym>FFI</acronym> and making full use of
garbage collection facilities and access to Scheme values' memory
representations.

   <blockquote>
<strong>NOTE</strong> The mechanism described below is a temporary
implementation which may change in the future. 
</blockquote>

   <p>Whenever Vicare's source code reader, in <code>#!vicare</code> mode,
finds a form like:

<pre class="example">     #!(load-shared-library "vicarecre2")
</pre>
   <p class="noindent">it handles it as a special comment which causes no code to be expanded
nor compiled.  Rather a foreign shared library whose identifier is
<code>vicarecre2</code> is immediately loaded.

   <p>If the library file containing such special comment is compiled to a
<acronym>FASL</acronym> file, an object field with header <code>O</code> is written to the
<strong>beginning</strong> of the <acronym>FASL</acronym> file: such object will cause the
foreign library to be loaded whenever the <acronym>FASL</acronym> file is loaded.

   <p>On Unix&ndash;like systems: the library identifier is prefixed with
<code>lib</code> and suffixed with <code>.so</code> to compose a library file name.

<!-- page -->
<div class="node">
<a name="cre2"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#package-license">package license</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#fasl">fasl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix F Binding to the library <acronym>CRE2</acronym></h2>

<p>Vicare implements an optional built in binding to the <acronym>CRE2</acronym>
library: a C wrapper for the <acronym>RE2</acronym> regular expressions library from
Google.  The Scheme <acronym>API</acronym> is exported by the library <code>(vicare
cre2)</code>; it is suggested to prefix the bindings at import time with
<code>cre2</code>, as in the following example:

<pre class="example">     (import (vicare)
       (prefix (vicare cre2) cre2.))
</pre>
   <p class="noindent">the bindings do <strong>not</strong> have the <code>cre2</code> prefix.

<ul class="menu">
<li><a accesskey="1" href="#cre2-version">cre2 version</a>:                 Version functions. 
<li><a accesskey="2" href="#cre2-regexps">cre2 regexps</a>:                 Precompiled regular expressions
                                construction. 
<li><a accesskey="3" href="#cre2-options">cre2 options</a>:                 Matching configuration. 
<li><a accesskey="4" href="#cre2-match">cre2 match</a>:                   Matching regular expressions. 
</ul>

<!-- page -->
<div class="node">
<a name="cre2-version"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#cre2-regexps">cre2 regexps</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#cre2">cre2</a>

</div>

<h3 class="appendixsec">F.1 Version functions</h3>

<p>The following bindings are exported by the <code>(vicare cre2)</code>
library.

<div class="defun">
&mdash; Function: <b>enabled?</b><var><a name="index-enabled_003f-1454"></a></var><br>
<blockquote><p>Return true if the binding to <acronym>CRE2</acronym> was enabled in this
Vicare process. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>version-interface-current</b><var><a name="index-version_002dinterface_002dcurrent-1455"></a></var><br>
&mdash; Function: <b>version-interface-revision</b><var><a name="index-version_002dinterface_002drevision-1456"></a></var><br>
&mdash; Function: <b>version-interface-age</b><var><a name="index-version_002dinterface_002dage-1457"></a></var><br>
<blockquote><p>Return a fixnum representing a component of interface version number for
<acronym>CRE2</acronym>.  For an explanation of interface numbers as managed by <acronym>GNU</acronym>
Libtool See <a href="libtool.html#Libtool-versioning">interface</a>. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="cre2-regexps"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#cre2-options">cre2 options</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#cre2-version">cre2 version</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#cre2">cre2</a>

</div>

<h3 class="appendixsec">F.2 Precompiled regular expressions construction</h3>

<p>The following bindings are exported by the <code>(vicare cre2)</code>
library.

<div class="defun">
&mdash; Function: <b>make-regexp</b><var> pattern<a name="index-make_002dregexp-1458"></a></var><br>
&mdash; Function: <b>make-regexp</b><var> pattern opt<a name="index-make_002dregexp-1459"></a></var><br>
<blockquote><p>Build and return a precompiled regular expression object.  The returned
object must be finalised with <code>delete-regexp</code>; this operation is
automatically performed when the object is garbage collected.

        <p><var>pattern</var> must be a string or <acronym>UTF</acronym>-8 bytevector holding the
regular expression pattern.  When used, <var>opt</var> must be a
configuration options object returned by <code>make-options</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>delete-regexp</b><var> rex<a name="index-delete_002dregexp-1460"></a></var><br>
<blockquote><p>Finalise a precompiled regular expression object releasing all the
associated resources.  This function can be safely applied multiple
times to the same <var>rex</var> object: the first time the object is
finalised, the subsequent times nothing happens. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>regexp?</b><var> obj<a name="index-regexp_003f-1461"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>obj</var> is a precompiled regular expression object,
return <code>#f</code> otherwise. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="cre2-options"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#cre2-match">cre2 match</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#cre2-regexps">cre2 regexps</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#cre2">cre2</a>

</div>

<h3 class="appendixsec">F.3 Matching configuration</h3>

<p>The following bindings are exported by the <code>(vicare cre2)</code>
library.

<div class="defun">
&mdash; Function: <b>make-options</b><var><a name="index-make_002doptions-1462"></a></var><br>
<blockquote><p>Build and return a configuration option object initialised with default
values.  The returned object must be finalised with
<code>delete-options</code>; this operation is automatically performed when
the object is garbage collected. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>delete-options</b><var> opt<a name="index-delete_002doptions-1463"></a></var><br>
<blockquote><p>Finalise a configuration option object releasing all the associated
resources.  This function can be safely applied multiple times to the
same <var>opt</var> object: the first time the object is finalised, the
subsequent times nothing happens. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>options?</b><var> obj<a name="index-options_003f-1464"></a></var><br>
<blockquote><p>Return <code>#t</code> if <var>obj</var> is a configuration options object, return
<code>#f</code> otherwise. 
</p></blockquote></div>

   <p>All the following functions are setters and getters for matching
options; see the original documentation for details.

<div class="defun">
&mdash; Function: <b>set-posix-syntax!</b><var> opt bool<a name="index-set_002dposix_002dsyntax_0021-1465"></a></var><br>
&mdash; Function: <b>set-longest-match!</b><var> opt bool<a name="index-set_002dlongest_002dmatch_0021-1466"></a></var><br>
&mdash; Function: <b>set-log-errors!</b><var> opt bool<a name="index-set_002dlog_002derrors_0021-1467"></a></var><br>
&mdash; Function: <b>set-literal!</b><var> opt bool<a name="index-set_002dliteral_0021-1468"></a></var><br>
&mdash; Function: <b>set-never-nl!</b><var> opt bool<a name="index-set_002dnever_002dnl_0021-1469"></a></var><br>
&mdash; Function: <b>set-case-sensitive!</b><var> opt bool<a name="index-set_002dcase_002dsensitive_0021-1470"></a></var><br>
&mdash; Function: <b>set-perl-classes!</b><var> opt bool<a name="index-set_002dperl_002dclasses_0021-1471"></a></var><br>
&mdash; Function: <b>set-word-boundary!</b><var> opt bool<a name="index-set_002dword_002dboundary_0021-1472"></a></var><br>
&mdash; Function: <b>set-one-line!</b><var> opt bool<a name="index-set_002done_002dline_0021-1473"></a></var><br>
<blockquote><p>Configuration option setters.  <var>opt</var> must be configuration options
object.  <var>bool</var> must be true or false. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>posix-syntax</b><var> opt<a name="index-posix_002dsyntax-1474"></a></var><br>
&mdash; Function: <b>longest-match</b><var> opt<a name="index-longest_002dmatch-1475"></a></var><br>
&mdash; Function: <b>log-errors</b><var> opt<a name="index-log_002derrors-1476"></a></var><br>
&mdash; Function: <b>literal</b><var> opt<a name="index-literal-1477"></a></var><br>
&mdash; Function: <b>never-nl</b><var> opt<a name="index-never_002dnl-1478"></a></var><br>
&mdash; Function: <b>case-sensitive</b><var> opt<a name="index-case_002dsensitive-1479"></a></var><br>
&mdash; Function: <b>perl-classes</b><var> opt<a name="index-perl_002dclasses-1480"></a></var><br>
&mdash; Function: <b>word-boundary</b><var> opt<a name="index-word_002dboundary-1481"></a></var><br>
&mdash; Function: <b>one-line</b><var> opt<a name="index-one_002dline-1482"></a></var><br>
<blockquote><p>Configuration option setters; return <code>#t</code> if the option is set,
<code>#f</code> otherwise.  <var>opt</var> must be configuration options object. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>set-max-mem!</b><var> opt dimension<a name="index-set_002dmax_002dmem_0021-1483"></a></var><br>
&mdash; Function: <b>max-mem</b><var> opt<a name="index-max_002dmem-1484"></a></var><br>
<blockquote><p>Setter and getter for the maximum memory configuration option. 
<var>opt</var> must be a configuration options object.  <var>dimension</var> must
be a positive exact integer fitting in a platform's <code>int</code> C
language data type. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="cre2-match"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#cre2-options">cre2 options</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#cre2">cre2</a>

</div>

<h3 class="appendixsec">F.4 Matching regular expressions</h3>

<p>Basic regular expressions matching goes as follows:

<pre class="example">     #!r6rs
     (import (vicare)
       (prefix (vicare cre2) cre2.))
     
     (let ((rex (cre2.make-regexp "ciao|hello")))
       (cre2.match rex "ciao" #f #f 'unanchored))
     &rArr; #((0 . 4))
     
     (let ((rex (cre2.make-regexp "ciao|hello")))
       (cre2.match rex "hello" #f #f 'unanchored))
     &rArr; #((0 . 5))
     
     (let ((rex (cre2.make-regexp "ci(ao)|hello")))
       (cre2.match rex "ciao" #f #f 'unanchored))
     &rArr; #((0 . 4)
          (2 . 4))
     
     (let ((rex (cre2.make-regexp "c(i(ao))|hello")))
       (cre2.match rex "ciao" #f #f 'unanchored))
     &rArr; #((0 . 4)
          (1 . 4)
          (2 . 4))
</pre>
   <p>The following bindings are exported by the <code>(vicare cre2)</code>
library.

<div class="defun">
&mdash; Function: <b>match</b><var> rex text start end anchor<a name="index-match-1485"></a></var><br>
<blockquote><p>Match a substring of <var>text</var> against the regular expression object
<var>rex</var>.  Return false if there is no match, else return a vector
representing the matching portions.

        <p><var>text</var> must be a <acronym>UTF</acronym>-8 bytevector or a Scheme string which is
internally transformed to a <acronym>UTF</acronym>-8 bytevector.  All the indices in
<var>text</var> used by this function are relative to the
<strong>bytevector</strong>, not the Scheme string.  Only when the string
contains only characters in the <acronym>ASCII</acronym> range the indices for the
<acronym>UTF</acronym>-8 bytevector equal the indices for the string.

        <p>The zero&ndash;based indices <var>start</var> (inclusive) and <var>end</var>
(exclusive) select the range of <var>text</var> to be examined.  As special
case: if <var>start</var> is <code>#f</code>, the start index is set to zero; if
<var>end</var> is <code>#f</code>, the end index is set to the length of the
bytevector.

        <p><var>anchor</var> selects the anchor point for the matching operation, it
must be one of the symbols: <code>unanchored</code>, <code>start</code>,
<code>both</code>.

        <p>Data about the matching groups is returned in a vector of pairs, which
will have a number of slots equal to the number of parenthetical
subexpressions in <var>rex</var> plus one.  Each pair selects a range of
bytes in <var>text</var>: the car is a non&ndash;negative fixnum representing the
inclusive start index, the cdr is a non&ndash;negative fixnum representing
the exclusive end index.

        <p>The first element of the match vector (index 0) references the
full portion of the substring of <var>text</var> matching the pattern; the
second element of the match vector (index 1) references the
portion of text matching the first parenthetical subexpression, the
third element of the match vector (index 2) references the
portion of text matching the second parenthetical subexpression; and so
on. 
</p></blockquote></div>

<!-- page -->
<div class="node">
<a name="package-license"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#references">references</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#cre2">cre2</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix G <acronym>GNU</acronym> General Public License</h2>

<!-- The GNU General Public License. -->
<div align="center">Version 3, 29 June 2007</div>

<pre class="display">     Copyright &copy; 2007 Free Software Foundation, Inc. <a href="http://fsf.org/">http://fsf.org/</a>
     
     Everyone is permitted to copy and distribute verbatim copies of this
     license document, but changing it is not allowed.
</pre>
   <h3 class="heading">Preamble</h3>

<p>The GNU General Public License is a free, copyleft license for
software and other kinds of works.

   <p>The licenses for most software and other practical works are designed
to take away your freedom to share and change the works.  By contrast,
the GNU General Public License is intended to guarantee your freedom
to share and change all versions of a program&mdash;to make sure it remains
free software for all its users.  We, the Free Software Foundation,
use the GNU General Public License for most of our software; it
applies also to any other work released this way by its authors.  You
can apply it to your programs, too.

   <p>When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
them if you wish), that you receive source code or can get it if you
want it, that you can change the software or use pieces of it in new
free programs, and that you know you can do these things.

   <p>To protect your rights, we need to prevent others from denying you
these rights or asking you to surrender the rights.  Therefore, you
have certain responsibilities if you distribute copies of the
software, or if you modify it: responsibilities to respect the freedom
of others.

   <p>For example, if you distribute copies of such a program, whether
gratis or for a fee, you must pass on to the recipients the same
freedoms that you received.  You must make sure that they, too,
receive or can get the source code.  And you must show them these
terms so they know their rights.

   <p>Developers that use the GNU GPL protect your rights with two steps:
(1) assert copyright on the software, and (2) offer you this License
giving you legal permission to copy, distribute and/or modify it.

   <p>For the developers' and authors' protection, the GPL clearly explains
that there is no warranty for this free software.  For both users' and
authors' sake, the GPL requires that modified versions be marked as
changed, so that their problems will not be attributed erroneously to
authors of previous versions.

   <p>Some devices are designed to deny users access to install or run
modified versions of the software inside them, although the
manufacturer can do so.  This is fundamentally incompatible with the
aim of protecting users' freedom to change the software.  The
systematic pattern of such abuse occurs in the area of products for
individuals to use, which is precisely where it is most unacceptable. 
Therefore, we have designed this version of the GPL to prohibit the
practice for those products.  If such problems arise substantially in
other domains, we stand ready to extend this provision to those
domains in future versions of the GPL, as needed to protect the
freedom of users.

   <p>Finally, every program is threatened constantly by software patents. 
States should not allow patents to restrict development and use of
software on general-purpose computers, but in those that do, we wish
to avoid the special danger that patents applied to a free program
could make it effectively proprietary.  To prevent this, the GPL
assures that patents cannot be used to render the program non-free.

   <p>The precise terms and conditions for copying, distribution and
modification follow.

<h3 class="heading">TERMS AND CONDITIONS</h3>

     <ol type=1 start=0>
<li>Definitions.

     <p>&ldquo;This License&rdquo; refers to version 3 of the GNU General Public License.

     <p>&ldquo;Copyright&rdquo; also means copyright-like laws that apply to other kinds
of works, such as semiconductor masks.

     <p>&ldquo;The Program&rdquo; refers to any copyrightable work licensed under this
License.  Each licensee is addressed as &ldquo;you&rdquo;.  &ldquo;Licensees&rdquo; and
&ldquo;recipients&rdquo; may be individuals or organizations.

     <p>To &ldquo;modify&rdquo; a work means to copy from or adapt all or part of the work
in a fashion requiring copyright permission, other than the making of
an exact copy.  The resulting work is called a &ldquo;modified version&rdquo; of
the earlier work or a work &ldquo;based on&rdquo; the earlier work.

     <p>A &ldquo;covered work&rdquo; means either the unmodified Program or a work based
on the Program.

     <p>To &ldquo;propagate&rdquo; a work means to do anything with it that, without
permission, would make you directly or secondarily liable for
infringement under applicable copyright law, except executing it on a
computer or modifying a private copy.  Propagation includes copying,
distribution (with or without modification), making available to the
public, and in some countries other activities as well.

     <p>To &ldquo;convey&rdquo; a work means any kind of propagation that enables other
parties to make or receive copies.  Mere interaction with a user
through a computer network, with no transfer of a copy, is not
conveying.

     <p>An interactive user interface displays &ldquo;Appropriate Legal Notices&rdquo; to
the extent that it includes a convenient and prominently visible
feature that (1) displays an appropriate copyright notice, and (2)
tells the user that there is no warranty for the work (except to the
extent that warranties are provided), that licensees may convey the
work under this License, and how to view a copy of this License.  If
the interface presents a list of user commands or options, such as a
menu, a prominent <li>in the list meets this criterion.

     <li>Source Code.

     <p>The &ldquo;source code&rdquo; for a work means the preferred form of the work for
making modifications to it.  &ldquo;Object code&rdquo; means any non-source form
of a work.

     <p>A &ldquo;Standard Interface&rdquo; means an interface that either is an official
standard defined by a recognized standards body, or, in the case of
interfaces specified for a particular programming language, one that
is widely used among developers working in that language.

     <p>The &ldquo;System Libraries&rdquo; of an executable work include anything, other
than the work as a whole, that (a) is included in the normal form of
packaging a Major Component, but which is not part of that Major
Component, and (b) serves only to enable use of the work with that
Major Component, or to implement a Standard Interface for which an
implementation is available to the public in source code form.  A
&ldquo;Major Component&rdquo;, in this context, means a major essential component
(kernel, window system, and so on) of the specific operating system
(if any) on which the executable work runs, or a compiler used to
produce the work, or an object code interpreter used to run it.

     <p>The &ldquo;Corresponding Source&rdquo; for a work in object code form means all
the source code needed to generate, install, and (for an executable
work) run the object code and to modify the work, including scripts to
control those activities.  However, it does not include the work's
System Libraries, or general-purpose tools or generally available free
programs which are used unmodified in performing those activities but
which are not part of the work.  For example, Corresponding Source
includes interface definition files associated with source files for
the work, and the source code for shared libraries and dynamically
linked subprograms that the work is specifically designed to require,
such as by intimate data communication or control flow between those
subprograms and other parts of the work.

     <p>The Corresponding Source need not include anything that users can
regenerate automatically from other parts of the Corresponding Source.

     <p>The Corresponding Source for a work in source code form is that same
work.

     <li>Basic Permissions.

     <p>All rights granted under this License are granted for the term of
copyright on the Program, and are irrevocable provided the stated
conditions are met.  This License explicitly affirms your unlimited
permission to run the unmodified Program.  The output from running a
covered work is covered by this License only if the output, given its
content, constitutes a covered work.  This License acknowledges your
rights of fair use or other equivalent, as provided by copyright law.

     <p>You may make, run and propagate covered works that you do not convey,
without conditions so long as your license otherwise remains in force. 
You may convey covered works to others for the sole purpose of having
them make modifications exclusively for you, or provide you with
facilities for running those works, provided that you comply with the
terms of this License in conveying all material for which you do not
control copyright.  Those thus making or running the covered works for
you must do so exclusively on your behalf, under your direction and
control, on terms that prohibit them from making any copies of your
copyrighted material outside their relationship with you.

     <p>Conveying under any other circumstances is permitted solely under the
conditions stated below.  Sublicensing is not allowed; section 10
makes it unnecessary.

     <li>Protecting Users' Legal Rights From Anti-Circumvention Law.

     <p>No covered work shall be deemed part of an effective technological
measure under any applicable law fulfilling obligations under article
11 of the WIPO copyright treaty adopted on 20 December 1996, or
similar laws prohibiting or restricting circumvention of such
measures.

     <p>When you convey a covered work, you waive any legal power to forbid
circumvention of technological measures to the extent such
circumvention is effected by exercising rights under this License with
respect to the covered work, and you disclaim any intention to limit
operation or modification of the work as a means of enforcing, against
the work's users, your or third parties' legal rights to forbid
circumvention of technological measures.

     <li>Conveying Verbatim Copies.

     <p>You may convey verbatim copies of the Program's source code as you
receive it, in any medium, provided that you conspicuously and
appropriately publish on each copy an appropriate copyright notice;
keep intact all notices stating that this License and any
non-permissive terms added in accord with section 7 apply to the code;
keep intact all notices of the absence of any warranty; and give all
recipients a copy of this License along with the Program.

     <p>You may charge any price or no price for each copy that you convey,
and you may offer support or warranty protection for a fee.

     <li>Conveying Modified Source Versions.

     <p>You may convey a work based on the Program, or the modifications to
produce it from the Program, in the form of source code under the
terms of section 4, provided that you also meet all of these
conditions:

          <ol type=a start=1>
<li>
The work must carry prominent notices stating that you modified it,
and giving a relevant date.

          <li>
The work must carry prominent notices stating that it is released
under this License and any conditions added under section 7.  This
requirement modifies the requirement in section 4 to &ldquo;keep intact all
notices&rdquo;.

          <li>
You must license the entire work, as a whole, under this License to
anyone who comes into possession of a copy.  This License will
therefore apply, along with any applicable section 7 additional terms,
to the whole of the work, and all its parts, regardless of how they
are packaged.  This License gives no permission to license the work in
any other way, but it does not invalidate such permission if you have
separately received it.

          <li>
If the work has interactive user interfaces, each must display
Appropriate Legal Notices; however, if the Program has interactive
interfaces that do not display Appropriate Legal Notices, your work
need not make them do so.
          </ol>

     <p>A compilation of a covered work with other separate and independent
works, which are not by their nature extensions of the covered work,
and which are not combined with it such as to form a larger program,
in or on a volume of a storage or distribution medium, is called an
&ldquo;aggregate&rdquo; if the compilation and its resulting copyright are not
used to limit the access or legal rights of the compilation's users
beyond what the individual works permit.  Inclusion of a covered work
in an aggregate does not cause this License to apply to the other
parts of the aggregate.

     <li> Conveying Non-Source Forms.

     <p>You may convey a covered work in object code form under the terms of
sections 4 and 5, provided that you also convey the machine-readable
Corresponding Source under the terms of this License, in one of these
ways:

          <ol type=a start=1>
<li>
Convey the object code in, or embodied in, a physical product
(including a physical distribution medium), accompanied by the
Corresponding Source fixed on a durable physical medium customarily
used for software interchange.

          <li>
Convey the object code in, or embodied in, a physical product
(including a physical distribution medium), accompanied by a written
offer, valid for at least three years and valid for as long as you
offer spare parts or customer support for that product model, to give
anyone who possesses the object code either (1) a copy of the
Corresponding Source for all the software in the product that is
covered by this License, on a durable physical medium customarily used
for software interchange, for a price no more than your reasonable
cost of physically performing this conveying of source, or (2) access
to copy the Corresponding Source from a network server at no charge.

          <li>
Convey individual copies of the object code with a copy of the written
offer to provide the Corresponding Source.  This alternative is
allowed only occasionally and noncommercially, and only if you
received the object code with such an offer, in accord with subsection
6b.

          <li>
Convey the object code by offering access from a designated place
(gratis or for a charge), and offer equivalent access to the
Corresponding Source in the same way through the same place at no
further charge.  You need not require recipients to copy the
Corresponding Source along with the object code.  If the place to copy
the object code is a network server, the Corresponding Source may be
on a different server (operated by you or a third party) that supports
equivalent copying facilities, provided you maintain clear directions
next to the object code saying where to find the Corresponding Source. 
Regardless of what server hosts the Corresponding Source, you remain
obligated to ensure that it is available for as long as needed to
satisfy these requirements.

          <li>
Convey the object code using peer-to-peer transmission, provided you
inform other peers where the object code and Corresponding Source of
the work are being offered to the general public at no charge under
subsection 6d.

          </ol>

     <p>A separable portion of the object code, whose source code is excluded
from the Corresponding Source as a System Library, need not be
included in conveying the object code work.

     <p>A &ldquo;User Product&rdquo; is either (1) a &ldquo;consumer product&rdquo;, which means any
tangible personal property which is normally used for personal,
family, or household purposes, or (2) anything designed or sold for
incorporation into a dwelling.  In determining whether a product is a
consumer product, doubtful cases shall be resolved in favor of
coverage.  For a particular product received by a particular user,
&ldquo;normally used&rdquo; refers to a typical or common use of that class of
product, regardless of the status of the particular user or of the way
in which the particular user actually uses, or expects or is expected
to use, the product.  A product is a consumer product regardless of
whether the product has substantial commercial, industrial or
non-consumer uses, unless such uses represent the only significant
mode of use of the product.

     <p>&ldquo;Installation Information&rdquo; for a User Product means any methods,
procedures, authorization keys, or other information required to
install and execute modified versions of a covered work in that User
Product from a modified version of its Corresponding Source.  The
information must suffice to ensure that the continued functioning of
the modified object code is in no case prevented or interfered with
solely because modification has been made.

     <p>If you convey an object code work under this section in, or with, or
specifically for use in, a User Product, and the conveying occurs as
part of a transaction in which the right of possession and use of the
User Product is transferred to the recipient in perpetuity or for a
fixed term (regardless of how the transaction is characterized), the
Corresponding Source conveyed under this section must be accompanied
by the Installation Information.  But this requirement does not apply
if neither you nor any third party retains the ability to install
modified object code on the User Product (for example, the work has
been installed in ROM).

     <p>The requirement to provide Installation Information does not include a
requirement to continue to provide support service, warranty, or
updates for a work that has been modified or installed by the
recipient, or for the User Product in which it has been modified or
installed.  Access to a network may be denied when the modification
itself materially and adversely affects the operation of the network
or violates the rules and protocols for communication across the
network.

     <p>Corresponding Source conveyed, and Installation Information provided,
in accord with this section must be in a format that is publicly
documented (and with an implementation available to the public in
source code form), and must require no special password or key for
unpacking, reading or copying.

     <li>Additional Terms.

     <p>&ldquo;Additional permissions&rdquo; are terms that supplement the terms of this
License by making exceptions from one or more of its conditions. 
Additional permissions that are applicable to the entire Program shall
be treated as though they were included in this License, to the extent
that they are valid under applicable law.  If additional permissions
apply only to part of the Program, that part may be used separately
under those permissions, but the entire Program remains governed by
this License without regard to the additional permissions.

     <p>When you convey a copy of a covered work, you may at your option
remove any additional permissions from that copy, or from any part of
it.  (Additional permissions may be written to require their own
removal in certain cases when you modify the work.)  You may place
additional permissions on material, added by you to a covered work,
for which you have or can give appropriate copyright permission.

     <p>Notwithstanding any other provision of this License, for material you
add to a covered work, you may (if authorized by the copyright holders
of that material) supplement the terms of this License with terms:

          <ol type=a start=1>
<li>
Disclaiming warranty or limiting liability differently from the terms
of sections 15 and 16 of this License; or

          <li>
Requiring preservation of specified reasonable legal notices or author
attributions in that material or in the Appropriate Legal Notices
displayed by works containing it; or

          <li>
Prohibiting misrepresentation of the origin of that material, or
requiring that modified versions of such material be marked in
reasonable ways as different from the original version; or

          <li>
Limiting the use for publicity purposes of names of licensors or
authors of the material; or

          <li>
Declining to grant rights under trademark law for use of some trade
names, trademarks, or service marks; or

          <li>
Requiring indemnification of licensors and authors of that material by
anyone who conveys the material (or modified versions of it) with
contractual assumptions of liability to the recipient, for any
liability that these contractual assumptions directly impose on those
licensors and authors.
          </ol>

     <p>All other non-permissive additional terms are considered &ldquo;further
restrictions&rdquo; within the meaning of section 10.  If the Program as you
received it, or any part of it, contains a notice stating that it is
governed by this License along with a term that is a further
restriction, you may remove that term.  If a license document contains
a further restriction but permits relicensing or conveying under this
License, you may add to a covered work material governed by the terms
of that license document, provided that the further restriction does
not survive such relicensing or conveying.

     <p>If you add terms to a covered work in accord with this section, you
must place, in the relevant source files, a statement of the
additional terms that apply to those files, or a notice indicating
where to find the applicable terms.

     <p>Additional terms, permissive or non-permissive, may be stated in the
form of a separately written license, or stated as exceptions; the
above requirements apply either way.

     <li>Termination.

     <p>You may not propagate or modify a covered work except as expressly
provided under this License.  Any attempt otherwise to propagate or
modify it is void, and will automatically terminate your rights under
this License (including any patent licenses granted under the third
paragraph of section 11).

     <p>However, if you cease all violation of this License, then your license
from a particular copyright holder is reinstated (a) provisionally,
unless and until the copyright holder explicitly and finally
terminates your license, and (b) permanently, if the copyright holder
fails to notify you of the violation by some reasonable means prior to
60 days after the cessation.

     <p>Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.

     <p>Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, you do not qualify to receive new licenses for the same
material under section 10.

     <li>Acceptance Not Required for Having Copies.

     <p>You are not required to accept this License in order to receive or run
a copy of the Program.  Ancillary propagation of a covered work
occurring solely as a consequence of using peer-to-peer transmission
to receive a copy likewise does not require acceptance.  However,
nothing other than this License grants you permission to propagate or
modify any covered work.  These actions infringe copyright if you do
not accept this License.  Therefore, by modifying or propagating a
covered work, you indicate your acceptance of this License to do so.

     <li>Automatic Licensing of Downstream Recipients.

     <p>Each time you convey a covered work, the recipient automatically
receives a license from the original licensors, to run, modify and
propagate that work, subject to this License.  You are not responsible
for enforcing compliance by third parties with this License.

     <p>An &ldquo;entity transaction&rdquo; is a transaction transferring control of an
organization, or substantially all assets of one, or subdividing an
organization, or merging organizations.  If propagation of a covered
work results from an entity transaction, each party to that
transaction who receives a copy of the work also receives whatever
licenses to the work the party's predecessor in interest had or could
give under the previous paragraph, plus a right to possession of the
Corresponding Source of the work from the predecessor in interest, if
the predecessor has it or can get it with reasonable efforts.

     <p>You may not impose any further restrictions on the exercise of the
rights granted or affirmed under this License.  For example, you may
not impose a license fee, royalty, or other charge for exercise of
rights granted under this License, and you may not initiate litigation
(including a cross-claim or counterclaim in a lawsuit) alleging that
any patent claim is infringed by making, using, selling, offering for
sale, or importing the Program or any portion of it.

     <li>Patents.

     <p>A &ldquo;contributor&rdquo; is a copyright holder who authorizes use under this
License of the Program or a work on which the Program is based.  The
work thus licensed is called the contributor's &ldquo;contributor version&rdquo;.

     <p>A contributor's &ldquo;essential patent claims&rdquo; are all patent claims owned
or controlled by the contributor, whether already acquired or
hereafter acquired, that would be infringed by some manner, permitted
by this License, of making, using, or selling its contributor version,
but do not include claims that would be infringed only as a
consequence of further modification of the contributor version.  For
purposes of this definition, &ldquo;control&rdquo; includes the right to grant
patent sublicenses in a manner consistent with the requirements of
this License.

     <p>Each contributor grants you a non-exclusive, worldwide, royalty-free
patent license under the contributor's essential patent claims, to
make, use, sell, offer for sale, import and otherwise run, modify and
propagate the contents of its contributor version.

     <p>In the following three paragraphs, a &ldquo;patent license&rdquo; is any express
agreement or commitment, however denominated, not to enforce a patent
(such as an express permission to practice a patent or covenant not to
sue for patent infringement).  To &ldquo;grant&rdquo; such a patent license to a
party means to make such an agreement or commitment not to enforce a
patent against the party.

     <p>If you convey a covered work, knowingly relying on a patent license,
and the Corresponding Source of the work is not available for anyone
to copy, free of charge and under the terms of this License, through a
publicly available network server or other readily accessible means,
then you must either (1) cause the Corresponding Source to be so
available, or (2) arrange to deprive yourself of the benefit of the
patent license for this particular work, or (3) arrange, in a manner
consistent with the requirements of this License, to extend the patent
license to downstream recipients.  &ldquo;Knowingly relying&rdquo; means you have
actual knowledge that, but for the patent license, your conveying the
covered work in a country, or your recipient's use of the covered work
in a country, would infringe one or more identifiable patents in that
country that you have reason to believe are valid.

     <p>If, pursuant to or in connection with a single transaction or
arrangement, you convey, or propagate by procuring conveyance of, a
covered work, and grant a patent license to some of the parties
receiving the covered work authorizing them to use, propagate, modify
or convey a specific copy of the covered work, then the patent license
you grant is automatically extended to all recipients of the covered
work and works based on it.

     <p>A patent license is &ldquo;discriminatory&rdquo; if it does not include within the
scope of its coverage, prohibits the exercise of, or is conditioned on
the non-exercise of one or more of the rights that are specifically
granted under this License.  You may not convey a covered work if you
are a party to an arrangement with a third party that is in the
business of distributing software, under which you make payment to the
third party based on the extent of your activity of conveying the
work, and under which the third party grants, to any of the parties
who would receive the covered work from you, a discriminatory patent
license (a) in connection with copies of the covered work conveyed by
you (or copies made from those copies), or (b) primarily for and in
connection with specific products or compilations that contain the
covered work, unless you entered into that arrangement, or that patent
license was granted, prior to 28 March 2007.

     <p>Nothing in this License shall be construed as excluding or limiting
any implied license or other defenses to infringement that may
otherwise be available to you under applicable patent law.

     <li>No Surrender of Others' Freedom.

     <p>If conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot convey
a covered work so as to satisfy simultaneously your obligations under
this License and any other pertinent obligations, then as a
consequence you may not convey it at all.  For example, if you agree
to terms that obligate you to collect a royalty for further conveying
from those to whom you convey the Program, the only way you could
satisfy both those terms and this License would be to refrain entirely
from conveying the Program.

     <li>Use with the GNU Affero General Public License.

     <p>Notwithstanding any other provision of this License, you have
permission to link or combine any covered work with a work licensed
under version 3 of the GNU Affero General Public License into a single
combined work, and to convey the resulting work.  The terms of this
License will continue to apply to the part which is the covered work,
but the special requirements of the GNU Affero General Public License,
section 13, concerning interaction through a network will apply to the
combination as such.

     <li>Revised Versions of this License.

     <p>The Free Software Foundation may publish revised and/or new versions
of the GNU General Public License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.

     <p>Each version is given a distinguishing version number.  If the Program
specifies that a certain numbered version of the GNU General Public
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that numbered version or
of any later version published by the Free Software Foundation.  If
the Program does not specify a version number of the GNU General
Public License, you may choose any version ever published by the Free
Software Foundation.

     <p>If the Program specifies that a proxy can decide which future versions
of the GNU General Public License can be used, that proxy's public
statement of acceptance of a version permanently authorizes you to
choose that version for the Program.

     <p>Later license versions may give you additional or different
permissions.  However, no additional obligations are imposed on any
author or copyright holder as a result of your choosing to follow a
later version.

     <li>Disclaimer of Warranty.

     <p>THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY
APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT
HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM &ldquo;AS IS&rdquo; WITHOUT
WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND
PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE PROGRAM PROVE
DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR
CORRECTION.

     <li>Limitation of Liability.

     <p>IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR
CONVEYS THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES
ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT
NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR
LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM
TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER
PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

     <li>Interpretation of Sections 15 and 16.

     <p>If the disclaimer of warranty and limitation of liability provided
above cannot be given local legal effect according to their terms,
reviewing courts shall apply local law that most closely approximates
an absolute waiver of all civil liability in connection with the
Program, unless a warranty or assumption of liability accompanies a
copy of the Program in return for a fee.

     </ol>

<h3 class="heading">END OF TERMS AND CONDITIONS</h3>

<h3 class="heading">How to Apply These Terms to Your New Programs</h3>

<p>If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these
terms.

   <p>To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
state the exclusion of warranty; and each file should have at least
the &ldquo;copyright&rdquo; line and a pointer to where the full notice is found.

<pre class="smallexample">     <var>one line to give the program's name and a brief idea of what it does.</var>
     Copyright (C) <var>year</var> <var>name of author</var>
     
     This program is free software: you can redistribute it and/or modify
     it under the terms of the GNU General Public License as published by
     the Free Software Foundation, either version 3 of the License, or (at
     your option) any later version.
     
     This program is distributed in the hope that it will be useful, but
     WITHOUT ANY WARRANTY; without even the implied warranty of
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
     General Public License for more details.
     
     You should have received a copy of the GNU General Public License
     along with this program.  If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.
</pre>
   <p>Also add information on how to contact you by electronic and paper mail.

   <p>If the program does terminal interaction, make it output a short
notice like this when it starts in an interactive mode:

<pre class="smallexample">     <var>program</var> Copyright (C) <var>year</var> <var>name of author</var>
     This program comes with ABSOLUTELY NO WARRANTY; for details type &lsquo;<samp><span class="samp">show w</span></samp>&rsquo;.
     This is free software, and you are welcome to redistribute it
     under certain conditions; type &lsquo;<samp><span class="samp">show c</span></samp>&rsquo; for details.
</pre>
   <p>The hypothetical commands &lsquo;<samp><span class="samp">show w</span></samp>&rsquo; and &lsquo;<samp><span class="samp">show c</span></samp>&rsquo; should show
the appropriate parts of the General Public License.  Of course, your
program's commands might be different; for a GUI interface, you would
use an &ldquo;about box&rdquo;.

   <p>You should also get your employer (if you work as a programmer) or school,
if any, to sign a &ldquo;copyright disclaimer&rdquo; for the program, if necessary. 
For more information on this, and how to apply and follow the GNU GPL, see
<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.

   <p>The GNU General Public License does not permit incorporating your
program into proprietary programs.  If your program is a subroutine
library, you may consider it more useful to permit linking proprietary
applications with the library.  If this is what you want to do, use
the GNU Lesser General Public License instead of this License.  But
first, please read <a href="http://www.gnu.org/philosophy/why-not-lgpl.html">http://www.gnu.org/philosophy/why-not-lgpl.html</a>.

<!-- page -->
<div class="node">
<a name="references"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#concept-index">concept index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#package-license">package license</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix H Bibliography and references</h2>

<p class="noindent">&ldquo;Revised^6 Report on the Algorithmic Language Scheme.&rdquo;  Michael
Sperber and R. Kent Dybvig and Matthew Flatt and Anton Van Straaten
(Editors).  2007.

<p class="noindent">&ldquo;Revised^6 Report on the Algorithmic Language Scheme&mdash;Standard
Libraries.&rdquo;  Michael Sperber and R. Kent Dybvig and Matthew Flatt and
Anton Van Straaten (Editors). 2007.

<p class="noindent">&ldquo;Scheme Request for Implementation 41: Streams.&rdquo;  Philip L. Bewig. 
2007.  <a href="http://srfi.schemers.org/srfi-41/srfi-41.html">http://srfi.schemers.org/srfi-41/srfi-41.html</a>

<p class="noindent">&ldquo;Guardians in a generation&ndash;based garbage collector&rdquo;.  R. Kent Dybvig
and Carl Bruggeman and David Eby.  PLDI '93, pages 207&ndash;216, June 1993. 
Introduces guardians and describes the implementation of guardians and
weak pairs in Chez Scheme.

<p class="noindent">&ldquo;Don't stop the BiBOP: Flexible and efficient storage management
for dynamically&ndash;typed languages.&rdquo;  R. Kent Dybvig and David Eby and
Carl Bruggeman.  Technical Report 400, Indiana University, March 1994. 
Describes Chez Scheme's storage management system.

<p class="noindent">&ldquo;Generation Friendly Eq Hash Tables.&rdquo;  Abdulaziz Ghuloum and
R. Kent Dybvig. In &ldquo;Proceedings of the 2007 Workshop on Scheme and
Functional Programming&rdquo;, pages 207&ndash;216.  Universite Laval Technical
Report DIUL-RT-0701, 2007.

<p class="noindent">&ldquo;Extending the Scope of Syntactic Abstraction.&rdquo;  Oscar Waddell. 
PhD thesis, Indiana University Computer Science Department, August 1999. 
<a href="http://www.cs.indiana.edu/~owaddell/papers/thesis.ps.gz">http://www.cs.indiana.edu/~owaddell/papers/thesis.ps.gz</a>

<p class="noindent">&ldquo;Extending the Scope of Syntactic Abstraction.&rdquo;  Oscar Waddell and
R. Kent Dybvig.  In &ldquo;Conference Record of POPL'99: The 26th ACM
SIGPLAN-SIGACT Symposium on Principles of Programming Languages&rdquo;, pages
203&ndash;213, January 1999. 
<a href="http://www.cs.indiana.edu/~dyb/papers/popl99.ps.gz">http://www.cs.indiana.edu/~dyb/papers/popl99.ps.gz</a>

<p class="noindent">&ldquo;Chez Scheme Version 7 User's Guide.&rdquo;  R. Kent Dybvig.  Cadence
Research Systems, 2005.  User's guide and reference manual for Chez
Scheme Version 7.  <a href="http://www.scheme.com/csug7/">http://www.scheme.com/csug7/</a>

<p class="noindent">&ldquo;Implicit phasing for R6RS libraries.&rdquo;  Abdulaziz Ghuloum and
R. Kent Dybvig.  In &ldquo;ICFP '07: Proceedings of the 2007 ACM SIGPLAN
international conference on Functional programming&rdquo;, pages 303&ndash;314. 
New York, NY, USA, 2007.  ACM.

<p class="noindent">Michael D.  Adams and R.  Kent Dybvig.  &ldquo;Efficient nondestructive
equality checking for trees and graphs.&rdquo;  In ICFP '08: Proceeding of
the 13th ACM SIGPLAN international conference on Functional programming,
pages 179-188.  ACM, New York, NY, USA, 2008.  ISBN
978-1-59593-919-7. doi: 10.1145/1411204.1411230.

<!-- page -->
<div class="node">
<a name="concept-index"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#function-index">function index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#references">references</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix I An entry for each concept</h2>

<ul class="index-cp" compact>
<li><a href="#index-Command-line-11">Command line</a>: <a href="#using">using</a></li>
<li><a href="#index-Disinstalling-_0040value_007bPRJNAME_007d-9">Disinstalling Vicare</a>: <a href="#overview-install-uninstall">overview install uninstall</a></li>
<li><a href="#index-Disinstalling-_0040value_007bPRJNAME_007d-3">Disinstalling Vicare</a>: <a href="#overview-install">overview install</a></li>
<li><a href="#index-Environment_002c-interaction-68">Environment, interaction</a>: <a href="#iklib-environment">iklib environment</a></li>
<li><a href="#index-Installing-_0040value_007bPRJNAME_007d-1">Installing Vicare</a>: <a href="#overview-install">overview install</a></li>
<li><a href="#index-Invoking-_0040value_007bPRJNAME_007d-12">Invoking Vicare</a>: <a href="#using">using</a></li>
<li><a href="#index-Uninstalling-_0040value_007bPRJNAME_007d-10">Uninstalling Vicare</a>: <a href="#overview-install-uninstall">overview install uninstall</a></li>
<li><a href="#index-Uninstalling-_0040value_007bPRJNAME_007d-2">Uninstalling Vicare</a>: <a href="#overview-install">overview install</a></li>
<li><a href="#index-g_t_0040value_007bPRJNAME_007d_002c-disinstalling-8">Vicare, disinstalling</a>: <a href="#overview-install-uninstall">overview install uninstall</a></li>
<li><a href="#index-g_t_0040value_007bPRJNAME_007d_002c-disinstalling-6">Vicare, disinstalling</a>: <a href="#overview-install">overview install</a></li>
<li><a href="#index-g_t_0040value_007bPRJNAME_007d_002c-installing-4">Vicare, installing</a>: <a href="#overview-install">overview install</a></li>
<li><a href="#index-g_t_0040value_007bPRJNAME_007d_002c-uninstalling-7">Vicare, uninstalling</a>: <a href="#overview-install-uninstall">overview install uninstall</a></li>
<li><a href="#index-g_t_0040value_007bPRJNAME_007d_002c-uninstalling-5">Vicare, uninstalling</a>: <a href="#overview-install">overview install</a></li>
<li><a href="#index-g_t_0040env_007bVICARE_005fLIBRARY_005fPATH_007d-14"><samp><span class="env">VICARE_LIBRARY_PATH</span></samp></a>: <a href="#using-libraries-searching">using libraries searching</a></li>
<li><a href="#index-g_t_0040env_007bVICARE_005fRC_005fFILES_007d-13"><samp><span class="env">VICARE_RC_FILES</span></samp></a>: <a href="#using-invoking">using invoking</a></li>
   </ul><div class="node">
<a name="function-index"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#variable-index">variable index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#concept-index">concept index</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix J An entry for each function</h2>



<ul class="index-fn" compact>
<li><a href="#index-g_t_0023_0021eof-59"><code>#!eof</code></a>: <a href="#iklib-reader-stx">iklib reader stx</a></li>
<li><a href="#index-g_t_0023_0021ikarus-24"><code>#!ikarus</code></a>: <a href="#iklib-reader-mode">iklib reader mode</a></li>
<li><a href="#index-g_t_0023_0021vicare-23"><code>#!vicare</code></a>: <a href="#iklib-reader-mode">iklib reader mode</a></li>
<li><a href="#index-g_t_0023_003apretty_002dname-218"><code>#:pretty-name</code></a>: <a href="#iklib-gensym">iklib gensym</a></li>
<li><a href="#index-g_t_0023vc4b_0028_0040var_007bcflonum_007d-_002e_002e_002e_0029-53"><code>#vc4b(</code><var>cflonum</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vc4l_0028_0040var_007bcflonum_007d-_002e_002e_002e_0029-52"><code>#vc4l(</code><var>cflonum</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vc4n_0028_0040var_007bcflonum_007d-_002e_002e_002e_0029-54"><code>#vc4n(</code><var>cflonum</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vc8b_0028_0040var_007bcflonum_007d-_002e_002e_002e_0029-56"><code>#vc8b(</code><var>cflonum</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vc8l_0028_0040var_007bcflonum_007d-_002e_002e_002e_0029-55"><code>#vc8l(</code><var>cflonum</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vc8n_0028_0040var_007bcflonum_007d-_002e_002e_002e_0029-57"><code>#vc8n(</code><var>cflonum</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vf4b_0028_0040var_007bflonum_007d-_002e_002e_002e_0029-47"><code>#vf4b(</code><var>flonum</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vf4l_0028_0040var_007bflonum_007d-_002e_002e_002e_0029-46"><code>#vf4l(</code><var>flonum</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vf4n_0028_0040var_007bflonum_007d-_002e_002e_002e_0029-48"><code>#vf4n(</code><var>flonum</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vf8b_0028_0040var_007bflonum_007d-_002e_002e_002e_0029-50"><code>#vf8b(</code><var>flonum</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vf8l_0028_0040var_007bflonum_007d-_002e_002e_002e_0029-49"><code>#vf8l(</code><var>flonum</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vf8n_0028_0040var_007bflonum_007d-_002e_002e_002e_0029-51"><code>#vf8n(</code><var>flonum</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs16b_0028_0040var_007bword_007d-_002e_002e_002e_0029-32"><code>#vs16b(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs16l_0028_0040var_007bword_007d-_002e_002e_002e_0029-31"><code>#vs16l(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs16n_0028_0040var_007bword_007d-_002e_002e_002e_0029-33"><code>#vs16n(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs32b_0028_0040var_007bword_007d-_002e_002e_002e_0029-38"><code>#vs32b(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs32l_0028_0040var_007bword_007d-_002e_002e_002e_0029-37"><code>#vs32l(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs32n_0028_0040var_007bword_007d-_002e_002e_002e_0029-39"><code>#vs32n(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs64b_0028_0040var_007bword_007d-_002e_002e_002e_0029-44"><code>#vs64b(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs64l_0028_0040var_007bword_007d-_002e_002e_002e_0029-43"><code>#vs64l(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs64n_0028_0040var_007bword_007d-_002e_002e_002e_0029-45"><code>#vs64n(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vs8_0028_0040var_007bbyte_007d-_002e_002e_002e_0029-27"><code>#vs8(</code><var>byte</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu16b_0028_0040var_007bword_007d-_002e_002e_002e_0029-29"><code>#vu16b(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu16l_0028_0040var_007bword_007d-_002e_002e_002e_0029-28"><code>#vu16l(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu16n_0028_0040var_007bword_007d-_002e_002e_002e_0029-30"><code>#vu16n(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu32b_0028_0040var_007bword_007d-_002e_002e_002e_0029-35"><code>#vu32b(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu32l_0028_0040var_007bword_007d-_002e_002e_002e_0029-34"><code>#vu32l(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu32n_0028_0040var_007bword_007d-_002e_002e_002e_0029-36"><code>#vu32n(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu64b_0028_0040var_007bword_007d-_002e_002e_002e_0029-41"><code>#vu64b(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu64l_0028_0040var_007bword_007d-_002e_002e_002e_0029-40"><code>#vu64l(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023vu64n_0028_0040var_007bword_007d-_002e_002e_002e_0029-42"><code>#vu64n(</code><var>word</var><code> ...)</code></a>: <a href="#iklib-reader-bv">iklib reader bv</a></li>
<li><a href="#index-g_t_0023_0040_007bgensym_0040_007d-215"><code>#{gensym}</code></a>: <a href="#iklib-gensym">iklib gensym</a></li>
<li><a href="#index-g_t_0023_0040_007bpretty_002dname-unique_002dname_0040_007d-217"><code>#{pretty-name unique-name}</code></a>: <a href="#iklib-gensym">iklib gensym</a></li>
<li><a href="#index-g_t_0023_0040_007bunique_002dname_0040_007d-216"><code>#{unique-name}</code></a>: <a href="#iklib-gensym">iklib gensym</a></li>
<li><a href="#index-g_t_0024bignum_002dbyte_002dref-875"><code>$bignum-byte-ref</code></a>: <a href="#syslib-bignums">syslib bignums</a></li>
<li><a href="#index-g_t_0024bignum_002dpositive_003f-874"><code>$bignum-positive?</code></a>: <a href="#syslib-bignums">syslib bignums</a></li>
<li><a href="#index-g_t_0024bignum_002dsize-876"><code>$bignum-size</code></a>: <a href="#syslib-bignums">syslib bignums</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002ddouble_002dnative_002dref-928"><code>$bytevector-ieee-double-native-ref</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002ddouble_002dnative_002dset_0021-929"><code>$bytevector-ieee-double-native-set!</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002ddouble_002dnonnative_002dref-930"><code>$bytevector-ieee-double-nonnative-ref</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002ddouble_002dnonnative_002dset_0021-931"><code>$bytevector-ieee-double-nonnative-set!</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002dsingle_002dnative_002dref-932"><code>$bytevector-ieee-single-native-ref</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002dsingle_002dnative_002dset_0021-933"><code>$bytevector-ieee-single-native-set!</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002dsingle_002dnonnative_002dref-934"><code>$bytevector-ieee-single-nonnative-ref</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dieee_002dsingle_002dnonnative_002dset_0021-935"><code>$bytevector-ieee-single-nonnative-set!</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dlength-924"><code>$bytevector-length</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002ds8_002dref-926"><code>$bytevector-s8-ref</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002dset_0021-927"><code>$bytevector-set!</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024bytevector_002du8_002dref-925"><code>$bytevector-u8-ref</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024car-907"><code>$car</code></a>: <a href="#syslib-pairs">syslib pairs</a></li>
<li><a href="#index-g_t_0024cdr-908"><code>$cdr</code></a>: <a href="#syslib-pairs">syslib pairs</a></li>
<li><a href="#index-g_t_0024cflonum_002dimag-899"><code>$cflonum-imag</code></a>: <a href="#syslib-cflonums">syslib cflonums</a></li>
<li><a href="#index-g_t_0024cflonum_002dreal-898"><code>$cflonum-real</code></a>: <a href="#syslib-cflonums">syslib cflonums</a></li>
<li><a href="#index-g_t_0024char_002d_003efixnum-906"><code>$char-&gt;fixnum</code></a>: <a href="#syslib-chars">syslib chars</a></li>
<li><a href="#index-g_t_0024char_003c-901"><code>$char&lt;</code></a>: <a href="#syslib-chars">syslib chars</a></li>
<li><a href="#index-g_t_0024char_003c_003d-902"><code>$char&lt;=</code></a>: <a href="#syslib-chars">syslib chars</a></li>
<li><a href="#index-g_t_0024char_003d-900"><code>$char=</code></a>: <a href="#syslib-chars">syslib chars</a></li>
<li><a href="#index-g_t_0024char_003e-903"><code>$char&gt;</code></a>: <a href="#syslib-chars">syslib chars</a></li>
<li><a href="#index-g_t_0024char_003e_003d-904"><code>$char&gt;=</code></a>: <a href="#syslib-chars">syslib chars</a></li>
<li><a href="#index-g_t_0024compnum_002dimag-896"><code>$compnum-imag</code></a>: <a href="#syslib-compnums">syslib compnums</a></li>
<li><a href="#index-g_t_0024compnum_002dreal-895"><code>$compnum-real</code></a>: <a href="#syslib-compnums">syslib compnums</a></li>
<li><a href="#index-g_t_0024data_002d_003etranscoder-958"><code>$data-&gt;transcoder</code></a>: <a href="#syslib-transcoders">syslib transcoders</a></li>
<li><a href="#index-g_t_0024fixnum_002d_003echar-905"><code>$fixnum-&gt;char</code></a>: <a href="#syslib-chars">syslib chars</a></li>
<li><a href="#index-g_t_0024fixnum_002d_003eflonum-880"><code>$fixnum-&gt;flonum</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_002a-883"><code>$fl*</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_002b-881"><code>$fl+</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_002d-882"><code>$fl-</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_002f-884"><code>$fl/</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_003c-886"><code>$fl&lt;</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_003c_003d-887"><code>$fl&lt;=</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_003d-885"><code>$fl=</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_003e-888"><code>$fl&gt;</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fl_003e_003d-889"><code>$fl&gt;=</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024flonum_002dsbe-890"><code>$flonum-sbe</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024flonum_002dset_0021-879"><code>$flonum-set!</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024flonum_002du8_002dref-878"><code>$flonum-u8-ref</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024fx_002a-865"><code>$fx*</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fx_002b-863"><code>$fx+</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fx_002d-864"><code>$fx-</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fx_003c-857"><code>$fx&lt;</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fx_003c_003d-858"><code>$fx&lt;=</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fx_003d-856"><code>$fx=</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fx_003e-859"><code>$fx&gt;</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fx_003e_003d-860"><code>$fx&gt;=</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxadd1-861"><code>$fxadd1</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxinthash-873"><code>$fxinthash</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxlogand-867"><code>$fxlogand</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxlognot-866"><code>$fxlognot</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxlogor-868"><code>$fxlogor</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxlogxor-869"><code>$fxlogxor</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxquotient-872"><code>$fxquotient</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxsll-870"><code>$fxsll</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxsra-871"><code>$fxsra</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxsub1-862"><code>$fxsub1</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024fxzero_003f-855"><code>$fxzero?</code></a>: <a href="#syslib-fixnums">syslib fixnums</a></li>
<li><a href="#index-g_t_0024init_002dsymbol_002dfunction_0021-852"><code>$init-symbol-function!</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024log_002dsymbol_002dtable_002dstatus-854"><code>$log-symbol-table-status</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024make_002dbytevector-923"><code>$make-bytevector</code></a>: <a href="#syslib-bytevectors">syslib bytevectors</a></li>
<li><a href="#index-g_t_0024make_002dcflonum-897"><code>$make-cflonum</code></a>: <a href="#syslib-cflonums">syslib cflonums</a></li>
<li><a href="#index-g_t_0024make_002dcompnum-894"><code>$make-compnum</code></a>: <a href="#syslib-compnums">syslib compnums</a></li>
<li><a href="#index-g_t_0024make_002dflonum-877"><code>$make-flonum</code></a>: <a href="#syslib-flonums">syslib flonums</a></li>
<li><a href="#index-g_t_0024make_002dport-941"><code>$make-port</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024make_002dratnum-891"><code>$make-ratnum</code></a>: <a href="#syslib-ratnums">syslib ratnums</a></li>
<li><a href="#index-g_t_0024make_002dstring-936"><code>$make-string</code></a>: <a href="#syslib-strings">syslib strings</a></li>
<li><a href="#index-g_t_0024make_002dstruct-914"><code>$make-struct</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-g_t_0024make_002dsymbol-839"><code>$make-symbol</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024make_002dvector-919"><code>$make-vector</code></a>: <a href="#syslib-vectors">syslib vectors</a></li>
<li><a href="#index-g_t_0024pointer_003d-961"><code>$pointer=</code></a>: <a href="#syslib-pointers">syslib pointers</a></li>
<li><a href="#index-g_t_0024pointer_003f-960"><code>$pointer?</code></a>: <a href="#syslib-pointers">syslib pointers</a></li>
<li><a href="#index-g_t_0024port_002dattrs-953"><code>$port-attrs</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dbuffer-944"><code>$port-buffer</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dclose-951"><code>$port-close</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dcookie-952"><code>$port-cookie</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dget_002dposition-949"><code>$port-get-position</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002did-946"><code>$port-id</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dindex-942"><code>$port-index</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dread_0021-947"><code>$port-read!</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dset_002dposition_0021-950"><code>$port-set-position!</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dsize-943"><code>$port-size</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dtag-954"><code>$port-tag</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dtranscoder-945"><code>$port-transcoder</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024port_002dwrite_0021-948"><code>$port-write!</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024ratnum_002dd-893"><code>$ratnum-d</code></a>: <a href="#syslib-ratnums">syslib ratnums</a></li>
<li><a href="#index-g_t_0024ratnum_002dn-892"><code>$ratnum-n</code></a>: <a href="#syslib-ratnums">syslib ratnums</a></li>
<li><a href="#index-g_t_0024set_002dcar_0021-909"><code>$set-car!</code></a>: <a href="#syslib-pairs">syslib pairs</a></li>
<li><a href="#index-g_t_0024set_002dcdr_0021-910"><code>$set-cdr!</code></a>: <a href="#syslib-pairs">syslib pairs</a></li>
<li><a href="#index-g_t_0024set_002dport_002dattrs_0021-957"><code>$set-port-attrs!</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024set_002dport_002dindex_0021-955"><code>$set-port-index!</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024set_002dport_002dsize_0021-956"><code>$set-port-size!</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-g_t_0024set_002dsymbol_002dplist_0021-846"><code>$set-symbol-plist!</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024set_002dsymbol_002dproc_0021-848"><code>$set-symbol-proc!</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024set_002dsymbol_002dstring_0021-844"><code>$set-symbol-string!</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024set_002dsymbol_002dunique_002dstring_0021-845"><code>$set-symbol-unique-string!</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024set_002dsymbol_002dvalue_0021-847"><code>$set-symbol-value!</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024set_002dsymbol_002dvalue_002fproc_0021-849"><code>$set-symbol-value/proc!</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024string_002dlength-937"><code>$string-length</code></a>: <a href="#syslib-strings">syslib strings</a></li>
<li><a href="#index-g_t_0024string_002dref-938"><code>$string-ref</code></a>: <a href="#syslib-strings">syslib strings</a></li>
<li><a href="#index-g_t_0024string_002dset_0021-939"><code>$string-set!</code></a>: <a href="#syslib-strings">syslib strings</a></li>
<li><a href="#index-g_t_0024struct-918"><code>$struct</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-g_t_0024struct_002dref-916"><code>$struct-ref</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-g_t_0024struct_002drtd-915"><code>$struct-rtd</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-g_t_0024struct_002dset_0021-917"><code>$struct-set!</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-g_t_0024struct_002frtd_003f-913"><code>$struct/rtd?</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-g_t_0024struct_003f-912"><code>$struct?</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-g_t_0024symbol_002dplist-842"><code>$symbol-plist</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024symbol_002dstring-840"><code>$symbol-string</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024symbol_002dtable_002dsize-853"><code>$symbol-table-size</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024symbol_002dunique_002dstring-841"><code>$symbol-unique-string</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024symbol_002dvalue-843"><code>$symbol-value</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024transcoder_002d_003edata-959"><code>$transcoder-&gt;data</code></a>: <a href="#syslib-transcoders">syslib transcoders</a></li>
<li><a href="#index-g_t_0024unbound_002dobject_003f-850"><code>$unbound-object?</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-g_t_0024vector_002dlength-920"><code>$vector-length</code></a>: <a href="#syslib-vectors">syslib vectors</a></li>
<li><a href="#index-g_t_0024vector_002dref-921"><code>$vector-ref</code></a>: <a href="#syslib-vectors">syslib vectors</a></li>
<li><a href="#index-g_t_0024vector_002dset_0021-922"><code>$vector-set!</code></a>: <a href="#syslib-vectors">syslib vectors</a></li>
<li><a href="#index-accept-655"><code>accept</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-accept_002dconnection-323"><code>accept-connection</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-accept_002dconnection_002dnonblocking-324"><code>accept-connection-nonblocking</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-access-521"><code>access</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-acosh-200"><code>acosh</code></a>: <a href="#iklib-numerics-math">iklib numerics math</a></li>
<li><a href="#index-apropos-335"><code>apropos</code></a>: <a href="#iklib-misc">iklib misc</a></li>
<li><a href="#index-argv_002d_003ebytevectors-424"><code>argv-&gt;bytevectors</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-argv_002d_003estrings-427"><code>argv-&gt;strings</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-argv_002dlength-428"><code>argv-length</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-asinh-199"><code>asinh</code></a>: <a href="#iklib-numerics-math">iklib numerics math</a></li>
<li><a href="#index-atanh-201"><code>atanh</code></a>: <a href="#iklib-numerics-math">iklib numerics math</a></li>
<li><a href="#index-base_002drtd-911"><code>base-rtd</code></a>: <a href="#syslib-structs">syslib structs</a></li>
<li><a href="#index-bignum_003f-190"><code>bignum?</code></a>: <a href="#iklib-numerics-preds">iklib numerics preds</a></li>
<li><a href="#index-bind-656"><code>bind</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-bwp_002dobejct_003f-97"><code>bwp-obejct?</code></a>: <a href="#iklib-lists-weak">iklib lists weak</a></li>
<li><a href="#index-bwp_005fobject-1216"><code>bwp_object</code></a>: <a href="#objects-refs">objects refs</a></li>
<li><a href="#index-bytevector_002d_003ec4b_002dlist-158"><code>bytevector-&gt;c4b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003ec4l_002dlist-157"><code>bytevector-&gt;c4l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003ec4n_002dlist-159"><code>bytevector-&gt;c4n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003ec8b_002dlist-164"><code>bytevector-&gt;c8b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003ec8l_002dlist-163"><code>bytevector-&gt;c8l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003ec8n_002dlist-165"><code>bytevector-&gt;c8n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003ecstring-407"><code>bytevector-&gt;cstring</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-bytevector_002d_003ef4b_002dlist-146"><code>bytevector-&gt;f4b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003ef4l_002dlist-145"><code>bytevector-&gt;f4l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003ef4n_002dlist-147"><code>bytevector-&gt;f4n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003ef8b_002dlist-152"><code>bytevector-&gt;f8b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003ef8l_002dlist-151"><code>bytevector-&gt;f8l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003ef8n_002dlist-153"><code>bytevector-&gt;f8n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eguarded_002dcstring-408"><code>bytevector-&gt;guarded-cstring</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-bytevector_002d_003eguarded_002dmemory-406"><code>bytevector-&gt;guarded-memory</code></a>: <a href="#ffi-memory-ops">ffi memory ops</a></li>
<li><a href="#index-bytevector_002d_003ememory-405"><code>bytevector-&gt;memory</code></a>: <a href="#ffi-memory-ops">ffi memory ops</a></li>
<li><a href="#index-bytevector_002d_003es16b_002dlist-113"><code>bytevector-&gt;s16b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es16l_002dlist-112"><code>bytevector-&gt;s16l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es16n_002dlist-114"><code>bytevector-&gt;s16n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es32b_002dlist-125"><code>bytevector-&gt;s32b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es32l_002dlist-124"><code>bytevector-&gt;s32l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es32n_002dlist-126"><code>bytevector-&gt;s32n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es64b_002dlist-137"><code>bytevector-&gt;s64b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es64l_002dlist-136"><code>bytevector-&gt;s64l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es64n_002dlist-138"><code>bytevector-&gt;s64n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003es8_002dlist-104"><code>bytevector-&gt;s8-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu16b_002dlist-116"><code>bytevector-&gt;u16b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu16l_002dlist-115"><code>bytevector-&gt;u16l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu16n_002dlist-117"><code>bytevector-&gt;u16n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu32b_002dlist-128"><code>bytevector-&gt;u32b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu32l_002dlist-127"><code>bytevector-&gt;u32l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu32n_002dlist-129"><code>bytevector-&gt;u32n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu64b_002dlist-140"><code>bytevector-&gt;u64b-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu64l_002dlist-139"><code>bytevector-&gt;u64l-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002d_003eu64n_002dlist-141"><code>bytevector-&gt;u64n-list</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-bytevector_002dappend-166"><code>bytevector-append</code></a>: <a href="#iklib-bytevectors-generic">iklib bytevectors generic</a></li>
<li><a href="#index-bytevector_002dport_002dbuffer_002dsize-305"><code>bytevector-port-buffer-size</code></a>: <a href="#iklib-io-buffer">iklib io buffer</a></li>
<li><a href="#index-bytevectors_002d_003eargv-422"><code>bytevectors-&gt;argv</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-bytevectors_002d_003eguarded_002dargv-423"><code>bytevectors-&gt;guarded-argv</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-c4b_002dlist_002d_003ebytevector-155"><code>c4b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-c4l_002dlist_002d_003ebytevector-154"><code>c4l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-c4n_002dlist_002d_003ebytevector-156"><code>c4n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-c8b_002dlist_002d_003ebytevector-161"><code>c8b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-c8l_002dlist_002d_003ebytevector-160"><code>c8l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-c8n_002dlist_002d_003ebytevector-162"><code>c8n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-cacos-774"><code>cacos</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-cacosh-791"><code>cacosh</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-call_002dwith_002dinput_002dfile-268"><code>call-with-input-file</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-call_002dwith_002doutput_002dfile-271"><code>call-with-output-file</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-calloc-353"><code>calloc</code></a>: <a href="#ffi-memory-alloc">ffi memory alloc</a></li>
<li><a href="#index-case_002derrno-442"><code>case-errno</code></a>: <a href="#ffi-errno">ffi errno</a></li>
<li><a href="#index-case_002dsensitive-1479"><code>case-sensitive</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-casin-773"><code>casin</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-casinh-790"><code>casinh</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-catan-775"><code>catan</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-catanh-792"><code>catanh</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-ccos-771"><code>ccos</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-ccosh-788"><code>ccosh</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-cexp-776"><code>cexp</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-CFLAGS-1204"><code>CFLAGS</code></a>: <a href="#gcc">gcc</a></li>
<li><a href="#index-cflonum_003f-192"><code>cflonum?</code></a>: <a href="#iklib-numerics-preds">iklib numerics preds</a></li>
<li><a href="#index-chdir-553"><code>chdir</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-chmod-531"><code>chmod</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-chown-529"><code>chown</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-clearenv-828"><code>clearenv</code></a>: <a href="#linux-env">linux env</a></li>
<li><a href="#index-clearenv-759"><code>clearenv</code></a>: <a href="#glibc-env">glibc env</a></li>
<li><a href="#index-clock-746"><code>clock</code></a>: <a href="#posix-time-functions">posix time functions</a></li>
<li><a href="#index-clog-777"><code>clog</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-clog10-778"><code>clog10</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-close-571"><code>close</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-close_002dtcp_002dserver_002dsocket-325"><code>close-tcp-server-socket</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-closedir-566"><code>closedir</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-collect-260"><code>collect</code></a>: <a href="#iklib-guardians">iklib guardians</a></li>
<li><a href="#index-COMPILE_002dFLAGS-1202"><code>COMPILE-FLAGS</code></a>: <a href="#gcc">gcc</a></li>
<li><a href="#index-compnum_003f-193"><code>compnum?</code></a>: <a href="#iklib-numerics-preds">iklib numerics preds</a></li>
<li><a href="#index-condition_002derrno-448"><code>condition-errno</code></a>: <a href="#posix-conditions">posix conditions</a></li>
<li><a href="#index-condition_002dh_005ferrno-452"><code>condition-h_errno</code></a>: <a href="#posix-conditions">posix conditions</a></li>
<li><a href="#index-confstr-816"><code>confstr</code></a>: <a href="#glibc-config">glibc config</a></li>
<li><a href="#index-confstr_002fstring-817"><code>confstr/string</code></a>: <a href="#glibc-config">glibc config</a></li>
<li><a href="#index-connect-653"><code>connect</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-console_002derror_002dport-279"><code>console-error-port</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-console_002dinput_002dport-277"><code>console-input-port</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-console_002doutput_002dport-278"><code>console-output-port</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-core_002dexpand-62"><code>core-expand</code></a>: <a href="#iklib-expander">iklib expander</a></li>
<li><a href="#index-cosh-197"><code>cosh</code></a>: <a href="#iklib-numerics-math">iklib numerics math</a></li>
<li><a href="#index-cpow-780"><code>cpow</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-csin-770"><code>csin</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-csinh-787"><code>csinh</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-csqrt-779"><code>csqrt</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-cstring_002d_003ebytevector-409"><code>cstring-&gt;bytevector</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-cstring_002d_003estring-413"><code>cstring-&gt;string</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-ctan-772"><code>ctan</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-ctanh-789"><code>ctanh</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-ctermid-706"><code>ctermid</code></a>: <a href="#posix-job">posix job</a></li>
<li><a href="#index-ctermid_002fstring-707"><code>ctermid/string</code></a>: <a href="#posix-job">posix job</a></li>
<li><a href="#index-define_002dc_002dfunction-1201"><code>define-c-function</code></a>: <a href="#gcc">gcc</a></li>
<li><a href="#index-define_002dstruct-75"><code>define-struct</code></a>: <a href="#iklib-structs-rtd">iklib structs rtd</a></li>
<li><a href="#index-delete_002doptions-1463"><code>delete-options</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-delete_002dregexp-1460"><code>delete-regexp</code></a>: <a href="#cre2-regexps">cre2 regexps</a></li>
<li><a href="#index-directory_002dstream_002dclosed_003f-561"><code>directory-stream-closed?</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-directory_002dstream_002dfd-560"><code>directory-stream-fd</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-directory_002dstream_002dpathname-558"><code>directory-stream-pathname</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-directory_002dstream_002dpointer-559"><code>directory-stream-pointer</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-directory_002dstream_003f-557"><code>directory-stream?</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-dirfd-760"><code>dirfd</code></a>: <a href="#glibc-dir">glibc dir</a></li>
<li><a href="#index-dlclose-432"><code>dlclose</code></a>: <a href="#ffi-dl">ffi dl</a></li>
<li><a href="#index-dlerror-434"><code>dlerror</code></a>: <a href="#ffi-dl">ffi dl</a></li>
<li><a href="#index-dlopen-429"><code>dlopen</code></a>: <a href="#ffi-dl">ffi dl</a></li>
<li><a href="#index-dlsym-433"><code>dlsym</code></a>: <a href="#ffi-dl">ffi dl</a></li>
<li><a href="#index-dup-587"><code>dup</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-dup2-588"><code>dup2</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-else-444"><code>else</code></a>: <a href="#ffi-errno">ffi errno</a></li>
<li><a href="#index-enabled_003f-1454"><code>enabled?</code></a>: <a href="#cre2-version">cre2 version</a></li>
<li><a href="#index-environ-456"><code>environ</code></a>: <a href="#posix-env">posix env</a></li>
<li><a href="#index-environ_002d_003etable-458"><code>environ-&gt;table</code></a>: <a href="#posix-env">posix env</a></li>
<li><a href="#index-environ_002dtable-457"><code>environ-table</code></a>: <a href="#posix-env">posix env</a></li>
<li><a href="#index-environment_002dsymbols-72"><code>environment-symbols</code></a>: <a href="#iklib-environment">iklib environment</a></li>
<li><a href="#index-environment_003f-69"><code>environment?</code></a>: <a href="#iklib-environment">iklib environment</a></li>
<li><a href="#index-eof_005fobject-1213"><code>eof_object</code></a>: <a href="#objects-refs">objects refs</a></li>
<li><a href="#index-erf-793"><code>erf</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-erfc-794"><code>erfc</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-errno-439"><code>errno</code></a>: <a href="#ffi-errno">ffi errno</a></li>
<li><a href="#index-errno_002dcode-441"><code>errno-code</code></a>: <a href="#ffi-errno">ffi errno</a></li>
<li><a href="#index-errno_002dcondition_003f-447"><code>errno-condition?</code></a>: <a href="#posix-conditions">posix conditions</a></li>
<li><a href="#index-execl-468"><code>execl</code></a>: <a href="#posix-process">posix process</a></li>
<li><a href="#index-execle-469"><code>execle</code></a>: <a href="#posix-process">posix process</a></li>
<li><a href="#index-execlp-470"><code>execlp</code></a>: <a href="#posix-process">posix process</a></li>
<li><a href="#index-execv-465"><code>execv</code></a>: <a href="#posix-process">posix process</a></li>
<li><a href="#index-execve-466"><code>execve</code></a>: <a href="#posix-process">posix process</a></li>
<li><a href="#index-execvp-467"><code>execvp</code></a>: <a href="#posix-process">posix process</a></li>
<li><a href="#index-expand-61"><code>expand</code></a>: <a href="#iklib-expander">iklib expander</a></li>
<li><a href="#index-expand_002foptimize-63"><code>expand/optimize</code></a>: <a href="#iklib-expander">iklib expander</a></li>
<li><a href="#index-expand_002fscc_002dletrec-64"><code>expand/scc-letrec</code></a>: <a href="#iklib-expander">iklib expander</a></li>
<li><a href="#index-f4b_002dlist_002d_003ebytevector-143"><code>f4b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-f4l_002dlist_002d_003ebytevector-142"><code>f4l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-f4n_002dlist_002d_003ebytevector-144"><code>f4n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-f8b_002dlist_002d_003ebytevector-149"><code>f8b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-f8l_002dlist_002d_003ebytevector-148"><code>f8l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-f8n_002dlist_002d_003ebytevector-150"><code>f8n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-false_005fobject-1210"><code>false_object</code></a>: <a href="#objects-refs">objects refs</a></li>
<li><a href="#index-fasl_002ddirectory-1451"><code>fasl-directory</code></a>: <a href="#fasl-api">fasl api</a></li>
<li><a href="#index-fasl_002dpath-1452"><code>fasl-path</code></a>: <a href="#fasl-api">fasl api</a></li>
<li><a href="#index-fasl_002dread-1450"><code>fasl-read</code></a>: <a href="#fasl-api">fasl api</a></li>
<li><a href="#index-fasl_002dwrite-1448"><code>fasl-write</code></a>: <a href="#fasl-api">fasl api</a></li>
<li><a href="#index-fchdir-554"><code>fchdir</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-fchmod-532"><code>fchmod</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-fchown-530"><code>fchown</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-fcntl-583"><code>fcntl</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-fdatasync-765"><code>fdatasync</code></a>: <a href="#glibc-sync">glibc sync</a></li>
<li><a href="#index-fdopendir-563"><code>fdopendir</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-file_002datime-526"><code>file-atime</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002dctime-528"><code>file-ctime</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002ddescriptor_003f-758"><code>file-descriptor?</code></a>: <a href="#posix-misc">posix misc</a></li>
<li><a href="#index-file_002dexecutable_003f-524"><code>file-executable?</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002dis_002dblock_002ddevice_003f-506"><code>file-is-block-device?</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002dis_002dchar_002ddevice_003f-505"><code>file-is-char-device?</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002dis_002ddirectory_003f-504"><code>file-is-directory?</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002dis_002dfifo_003f-510"><code>file-is-fifo?</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002dis_002dmessage_002dqueue_003f-511"><code>file-is-message-queue?</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002dis_002dregular_002dfile_003f-507"><code>file-is-regular-file?</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002dis_002dsemaphore_003f-512"><code>file-is-semaphore?</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002dis_002dshared_002dmemory_003f-513"><code>file-is-shared-memory?</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002dis_002dsocket_003f-509"><code>file-is-socket?</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002dis_002dsymbolic_002dlink_003f-508"><code>file-is-symbolic-link?</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002dmtime-527"><code>file-mtime</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002dreadable_003f-522"><code>file-readable?</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002dsize-525"><code>file-size</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-file_002dwritable_003f-523"><code>file-writable?</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-filename_002d_003estring_002dfunc-264"><code>filename-&gt;string-func</code></a>: <a href="#iklib-io-filename">iklib io filename</a></li>
<li><a href="#index-fix-1226"><code>fix</code></a>: <a href="#objects-fixnums">objects fixnums</a></li>
<li><a href="#index-flexpm1-195"><code>flexpm1</code></a>: <a href="#iklib-numerics-flonums">iklib numerics flonums</a></li>
<li><a href="#index-fllog1p-194"><code>fllog1p</code></a>: <a href="#iklib-numerics-flonums">iklib numerics flonums</a></li>
<li><a href="#index-fnmatch-805"><code>fnmatch</code></a>: <a href="#glibc-match">glibc match</a></li>
<li><a href="#index-g_t_0040func_007bforeign_002dcall_007d-1453"><code>foreign-call</code></a>: <a href="#fasl-foreign">fasl foreign</a></li>
<li><a href="#index-fork-463"><code>fork</code></a>: <a href="#posix-process">posix process</a></li>
<li><a href="#index-format-223"><code>format</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-fpathconf-815"><code>fpathconf</code></a>: <a href="#glibc-config">glibc config</a></li>
<li><a href="#index-fprintf-225"><code>fprintf</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-free-355"><code>free</code></a>: <a href="#ffi-memory-alloc">ffi memory alloc</a></li>
<li><a href="#index-free_002dc_002dcallback-438"><code>free-c-callback</code></a>: <a href="#ffi-call-back">ffi call back</a></li>
<li><a href="#index-fstat-503"><code>fstat</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-fsync-764"><code>fsync</code></a>: <a href="#glibc-sync">glibc sync</a></li>
<li><a href="#index-futimes-538"><code>futimes</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-fx_005fmask-1224"><code>fx_mask</code></a>: <a href="#objects-fixnums">objects fixnums</a></li>
<li><a href="#index-fx_005fshift-1223"><code>fx_shift</code></a>: <a href="#objects-fixnums">objects fixnums</a></li>
<li><a href="#index-fx_005ftag-1222"><code>fx_tag</code></a>: <a href="#objects-fixnums">objects fixnums</a></li>
<li><a href="#index-gai_002dstrerror-671"><code>gai-strerror</code></a>: <a href="#posix-socket-misc">posix socket misc</a></li>
<li><a href="#index-generate_002ddebug_002dcalls-1446"><code>generate-debug-calls</code></a>: <a href="#debug-int-intro">debug int intro</a></li>
<li><a href="#index-gensym-210"><code>gensym</code></a>: <a href="#iklib-gensym">iklib gensym</a></li>
<li><a href="#index-gensym_002d_003eunique_002dstring-214"><code>gensym-&gt;unique-string</code></a>: <a href="#iklib-gensym">iklib gensym</a></li>
<li><a href="#index-gensym_002dcount-235"><code>gensym-count</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-gensym_002dprefix-233"><code>gensym-prefix</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-gensym_003f-213"><code>gensym?</code></a>: <a href="#iklib-gensym">iklib gensym</a></li>
<li><a href="#index-get_002dannotated_002ddatum-60"><code>get-annotated-datum</code></a>: <a href="#iklib-reader-fun">iklib reader fun</a></li>
<li><a href="#index-get_002dchar_002dand_002dtrack_002dtextual_002dposition-295"><code>get-char-and-track-textual-position</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-get_002doutput_002dstring-294"><code>get-output-string</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-getaddrinfo-618"><code>getaddrinfo</code></a>: <a href="#posix-socket-addresses-info">posix socket addresses info</a></li>
<li><a href="#index-getcwd-551"><code>getcwd</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-getcwd_002fstring-552"><code>getcwd/string</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-getegid-675"><code>getegid</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-getenv-453"><code>getenv</code></a>: <a href="#posix-env">posix env</a></li>
<li><a href="#index-geteuid-674"><code>geteuid</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-getgid-673"><code>getgid</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-getgrgid-703"><code>getgrgid</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-getgrnam-704"><code>getgrnam</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-getgroups-676"><code>getgroups</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-gethostbyaddr-621"><code>gethostbyaddr</code></a>: <a href="#posix-socket-hosts">posix socket hosts</a></li>
<li><a href="#index-gethostbyname-620"><code>gethostbyname</code></a>: <a href="#posix-socket-hosts">posix socket hosts</a></li>
<li><a href="#index-gethostbyname2-769"><code>gethostbyname2</code></a>: <a href="#glibc-socket">glibc socket</a></li>
<li><a href="#index-getlogin-683"><code>getlogin</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-getlogin_002fstring-684"><code>getlogin/string</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-getnetbyaddr-648"><code>getnetbyaddr</code></a>: <a href="#posix-socket-networks">posix socket networks</a></li>
<li><a href="#index-getnetbyname-647"><code>getnetbyname</code></a>: <a href="#posix-socket-networks">posix socket networks</a></li>
<li><a href="#index-getpeername-657"><code>getpeername</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-getpgrp-710"><code>getpgrp</code></a>: <a href="#posix-job">posix job</a></li>
<li><a href="#index-getpid-460"><code>getpid</code></a>: <a href="#posix-pid">posix pid</a></li>
<li><a href="#index-getppid-461"><code>getppid</code></a>: <a href="#posix-pid">posix pid</a></li>
<li><a href="#index-getprop-187"><code>getprop</code></a>: <a href="#iklib-symbols-plists">iklib symbols plists</a></li>
<li><a href="#index-getprotobyname-628"><code>getprotobyname</code></a>: <a href="#posix-socket-protocols">posix socket protocols</a></li>
<li><a href="#index-getprotobynumber-629"><code>getprotobynumber</code></a>: <a href="#posix-socket-protocols">posix socket protocols</a></li>
<li><a href="#index-getpwnam-696"><code>getpwnam</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-getpwuid-695"><code>getpwuid</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-getservbyname-637"><code>getservbyname</code></a>: <a href="#posix-socket-services">posix socket services</a></li>
<li><a href="#index-getservbynumber-638"><code>getservbynumber</code></a>: <a href="#posix-socket-services">posix socket services</a></li>
<li><a href="#index-getsid-709"><code>getsid</code></a>: <a href="#posix-job">posix job</a></li>
<li><a href="#index-getsockname-658"><code>getsockname</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-getsockopt-663"><code>getsockopt</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-getsockopt_002fint-665"><code>getsockopt/int</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-getsockopt_002fsize_005ft-667"><code>getsockopt/size_t</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-gettimeofday-749"><code>gettimeofday</code></a>: <a href="#posix-time-functions">posix time functions</a></li>
<li><a href="#index-getuid-672"><code>getuid</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-getumask-534"><code>getumask</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-glibc_002dacosh-785"><code>glibc-acosh</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-glibc_002dasinh-784"><code>glibc-asinh</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-glibc_002datanh-786"><code>glibc-atanh</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-glibc_002dcosh-782"><code>glibc-cosh</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-glibc_002dsinh-781"><code>glibc-sinh</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-glibc_002dtanh-783"><code>glibc-tanh</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-glob-806"><code>glob</code></a>: <a href="#glibc-match">glibc match</a></li>
<li><a href="#index-glob_002fstring-807"><code>glob/string</code></a>: <a href="#glibc-match">glibc match</a></li>
<li><a href="#index-gmtime-751"><code>gmtime</code></a>: <a href="#posix-time-functions">posix time functions</a></li>
<li><a href="#index-group_002dentries-705"><code>group-entries</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-guarded_002dcalloc-354"><code>guarded-calloc</code></a>: <a href="#ffi-memory-alloc">ffi memory alloc</a></li>
<li><a href="#index-guarded_002dmalloc-350"><code>guarded-malloc</code></a>: <a href="#ffi-memory-alloc">ffi memory alloc</a></li>
<li><a href="#index-guarded_002drealloc-352"><code>guarded-realloc</code></a>: <a href="#ffi-memory-alloc">ffi memory alloc</a></li>
<li><a href="#index-guarded_002dstart-1447"><code>guarded-start</code></a>: <a href="#debug-int-intro">debug int intro</a></li>
<li><a href="#index-guarded_002dstrdup-419"><code>guarded-strdup</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-guarded_002dstrndup-421"><code>guarded-strndup</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-h_005ferrno_002d_003estring-669"><code>h_errno-&gt;string</code></a>: <a href="#posix-socket-misc">posix socket misc</a></li>
<li><a href="#index-h_005ferrno_002dcondition_003f-451"><code>h_errno-condition?</code></a>: <a href="#posix-conditions">posix conditions</a></li>
<li><a href="#index-h_005fstrerror-670"><code>h_strerror</code></a>: <a href="#posix-socket-misc">posix socket misc</a></li>
<li><a href="#index-host_002dentries-622"><code>host-entries</code></a>: <a href="#posix-socket-hosts">posix socket hosts</a></li>
<li><a href="#index-host_002dinfo-334"><code>host-info</code></a>: <a href="#iklib-misc">iklib misc</a></li>
<li><a href="#index-i_002fo_002dagain_002derror_003f-22"><code>i/o-again-error?</code></a>: <a href="#iklib-conditions-eagain">iklib conditions eagain</a></li>
<li><a href="#index-iconv_0021-827"><code>iconv!</code></a>: <a href="#glibc-iconv-conv">glibc iconv conv</a></li>
<li><a href="#index-iconv_002dclose-826"><code>iconv-close</code></a>: <a href="#glibc-iconv-conv">glibc iconv conv</a></li>
<li><a href="#index-iconv_002dclosed_003f-825"><code>iconv-closed?</code></a>: <a href="#glibc-iconv-conv">glibc iconv conv</a></li>
<li><a href="#index-iconv_002dencoding-819"><code>iconv-encoding</code></a>: <a href="#glibc-iconv-set">glibc iconv set</a></li>
<li><a href="#index-iconv_002dencoding_002daliases_003f-821"><code>iconv-encoding-aliases?</code></a>: <a href="#glibc-iconv-set">glibc iconv set</a></li>
<li><a href="#index-iconv_002dencoding_003d_003f-822"><code>iconv-encoding=?</code></a>: <a href="#glibc-iconv-set">glibc iconv set</a></li>
<li><a href="#index-iconv_002dopen-823"><code>iconv-open</code></a>: <a href="#glibc-iconv-conv">glibc iconv conv</a></li>
<li><a href="#index-iconv_003f-824"><code>iconv?</code></a>: <a href="#glibc-iconv-conv">glibc iconv conv</a></li>
<li><a href="#index-if_002dnameindex-768"><code>if-nameindex</code></a>: <a href="#glibc-socket">glibc socket</a></li>
<li><a href="#index-if_002dnametoindex-766"><code>if-nametoindex</code></a>: <a href="#glibc-socket">glibc socket</a></li>
<li><a href="#index-IK_005fALIGN-1218"><code>IK_ALIGN</code></a>: <a href="#objects-memory">objects memory</a></li>
<li><a href="#index-IK_005fASS-1221"><code>IK_ASS</code></a>: <a href="#objects-memory">objects memory</a></li>
<li><a href="#index-IK_005fBIGNUM_005fALLOC_005fSIZE-1350"><code>IK_BIGNUM_ALLOC_SIZE</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-IK_005fBIGNUM_005fDATA_005fLIMBP-1357"><code>IK_BIGNUM_DATA_LIMBP</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-IK_005fBIGNUM_005fFIRST-1355"><code>IK_BIGNUM_FIRST</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-IK_005fBIGNUM_005fFIRST_005fLIMB-1358"><code>IK_BIGNUM_FIRST_LIMB</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-IK_005fBIGNUM_005fLAST_005fLIMB-1359"><code>IK_BIGNUM_LAST_LIMB</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-IK_005fBYTEVECTOR_005fDATA-1260"><code>IK_BYTEVECTOR_DATA</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-IK_005fBYTEVECTOR_005fDATA_005fCHARP-1262"><code>IK_BYTEVECTOR_DATA_CHARP</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-IK_005fBYTEVECTOR_005fDATA_005fUINT8P-1263"><code>IK_BYTEVECTOR_DATA_UINT8P</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-IK_005fBYTEVECTOR_005fDATA_005fVOIDP-1261"><code>IK_BYTEVECTOR_DATA_VOIDP</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-ik_005fbytevector_005ffrom_005fcstring-1265"><code>ik_bytevector_from_cstring</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-ik_005fbytevector_005ffrom_005fcstring_005flen-1266"><code>ik_bytevector_from_cstring_len</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-ik_005fbytevector_005ffrom_005fmemory_005fblock-1267"><code>ik_bytevector_from_memory_block</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-IK_005fBYTEVECTOR_005fLENGTH-1258"><code>IK_BYTEVECTOR_LENGTH</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-IK_005fBYTEVECTOR_005fLENGTH_005fFX-1259"><code>IK_BYTEVECTOR_LENGTH_FX</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-IK_005fCAAR-1242"><code>IK_CAAR</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-IK_005fCADR-1244"><code>IK_CADR</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-IK_005fCAR-1240"><code>IK_CAR</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-IK_005fCDAR-1243"><code>IK_CDAR</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-IK_005fCDDR-1245"><code>IK_CDDR</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-IK_005fCDR-1241"><code>IK_CDR</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-IK_005fCFLONUM_005fIMAG-1422"><code>IK_CFLONUM_IMAG</code></a>: <a href="#objects-cflonums">objects cflonums</a></li>
<li><a href="#index-IK_005fCFLONUM_005fREAL-1421"><code>IK_CFLONUM_REAL</code></a>: <a href="#objects-cflonums">objects cflonums</a></li>
<li><a href="#index-IK_005fCHAR32-1323"><code>IK_CHAR32</code></a>: <a href="#objects-strings">objects strings</a></li>
<li><a href="#index-IK_005fCHAR32_005fFROM_005fINTEGER-1312"><code>IK_CHAR32_FROM_INTEGER</code></a>: <a href="#objects-chars">objects chars</a></li>
<li><a href="#index-IK_005fCHAR_005fFROM_005fINTEGER-1310"><code>IK_CHAR_FROM_INTEGER</code></a>: <a href="#objects-chars">objects chars</a></li>
<li><a href="#index-IK_005fCHAR_005fTO_005fINTEGER-1311"><code>IK_CHAR_TO_INTEGER</code></a>: <a href="#objects-chars">objects chars</a></li>
<li><a href="#index-IK_005fCOMPNUM_005fIMAG-1409"><code>IK_COMPNUM_IMAG</code></a>: <a href="#objects-compnums">objects compnums</a></li>
<li><a href="#index-IK_005fCOMPNUM_005fREAL-1408"><code>IK_COMPNUM_REAL</code></a>: <a href="#objects-compnums">objects compnums</a></li>
<li><a href="#index-IK_005fCOMPOSE_005fBIGNUM_005fFIRST_005fWORD-1352"><code>IK_COMPOSE_BIGNUM_FIRST_WORD</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-IK_005fDENOMINATOR-1386"><code>IK_DENOMINATOR</code></a>: <a href="#objects-ratnums">objects ratnums</a></li>
<li><a href="#index-ik_005ferrno_005fto_005fcode-1002"><code>ik_errno_to_code</code></a>: <a href="#capi-posix-errno">capi posix errno</a></li>
<li><a href="#index-IK_005fFIELD-1301"><code>IK_FIELD</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-IK_005fFIX-1225"><code>IK_FIX</code></a>: <a href="#objects-fixnums">objects fixnums</a></li>
<li><a href="#index-IK_005fFLONUM_005fDATA-1396"><code>IK_FLONUM_DATA</code></a>: <a href="#objects-flonums">objects flonums</a></li>
<li><a href="#index-ik_005finteger_005fto_005fint-1367"><code>ik_integer_to_int</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ik_005finteger_005fto_005fllong-1369"><code>ik_integer_to_llong</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ik_005finteger_005fto_005flong-1368"><code>ik_integer_to_long</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ik_005finteger_005fto_005fsint32-1373"><code>ik_integer_to_sint32</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ik_005finteger_005fto_005fsint64-1374"><code>ik_integer_to_sint64</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ik_005finteger_005fto_005fuint-1370"><code>ik_integer_to_uint</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ik_005finteger_005fto_005fuint32-1375"><code>ik_integer_to_uint32</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ik_005finteger_005fto_005fuint64-1376"><code>ik_integer_to_uint64</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ik_005finteger_005fto_005fullong-1372"><code>ik_integer_to_ullong</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ik_005finteger_005fto_005fulong-1371"><code>ik_integer_to_ulong</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ik_005fis_005fbignum-1360"><code>ik_is_bignum</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ik_005fis_005fcflonum-1423"><code>ik_is_cflonum</code></a>: <a href="#objects-cflonums">objects cflonums</a></li>
<li><a href="#index-IK_005fIS_005fCHAR-1309"><code>IK_IS_CHAR</code></a>: <a href="#objects-chars">objects chars</a></li>
<li><a href="#index-ik_005fis_005fcompnum-1410"><code>ik_is_compnum</code></a>: <a href="#objects-compnums">objects compnums</a></li>
<li><a href="#index-IK_005fIS_005fFIXNUM-1229"><code>IK_IS_FIXNUM</code></a>: <a href="#objects-fixnums">objects fixnums</a></li>
<li><a href="#index-ik_005fis_005fflonum-1397"><code>ik_is_flonum</code></a>: <a href="#objects-flonums">objects flonums</a></li>
<li><a href="#index-IK_005fIS_005fPAIR-1237"><code>IK_IS_PAIR</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-ik_005fis_005fpointer-1444"><code>ik_is_pointer</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-ik_005fis_005fratnum-1387"><code>ik_is_ratnum</code></a>: <a href="#objects-ratnums">objects ratnums</a></li>
<li><a href="#index-IK_005fIS_005fSTRING-1320"><code>IK_IS_STRING</code></a>: <a href="#objects-strings">objects strings</a></li>
<li><a href="#index-ik_005fis_005fstruct-1304"><code>ik_is_struct</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-ik_005fis_005fsymbol-1340"><code>ik_is_symbol</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-ik_005fis_005fvector-1279"><code>ik_is_vector</code></a>: <a href="#objects-vectors">objects vectors</a></li>
<li><a href="#index-IK_005fITEM-1276"><code>IK_ITEM</code></a>: <a href="#objects-vectors">objects vectors</a></li>
<li><a href="#index-IK_005fLIMB-1356"><code>IK_LIMB</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ik_005flist_005flength-1248"><code>ik_list_length</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-ik_005flist_005fto_005fargv-1249"><code>ik_list_to_argv</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-ik_005flist_005fto_005fargv_005fand_005fargc-1250"><code>ik_list_to_argv_and_argc</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-IK_005fNEGATIVE_005fBIGNUM_005fFIRST_005fWORD-1354"><code>IK_NEGATIVE_BIGNUM_FIRST_WORD</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-IK_005fNUMERATOR-1385"><code>IK_NUMERATOR</code></a>: <a href="#objects-ratnums">objects ratnums</a></li>
<li><a href="#index-IK_005fPOINTER_005fDATA-1432"><code>IK_POINTER_DATA</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-IK_005fPOINTER_005fDATA_005fCHARP-1434"><code>IK_POINTER_DATA_CHARP</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-IK_005fPOINTER_005fDATA_005fLLONG-1437"><code>IK_POINTER_DATA_LLONG</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-IK_005fPOINTER_005fDATA_005fLONG-1436"><code>IK_POINTER_DATA_LONG</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-IK_005fPOINTER_005fDATA_005fUINT8P-1435"><code>IK_POINTER_DATA_UINT8P</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-IK_005fPOINTER_005fDATA_005fULLONG-1439"><code>IK_POINTER_DATA_ULLONG</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-IK_005fPOINTER_005fDATA_005fULONG-1438"><code>IK_POINTER_DATA_ULONG</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-IK_005fPOINTER_005fDATA_005fVOIDP-1433"><code>IK_POINTER_DATA_VOIDP</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-IK_005fPOINTER_005fIS_005fNULL-1441"><code>IK_POINTER_IS_NULL</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-IK_005fPOINTER_005fSET_005fNULL-1440"><code>IK_POINTER_SET_NULL</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-IK_005fPOSITIVE_005fBIGNUM_005fFIRST_005fWORD-1353"><code>IK_POSITIVE_BIGNUM_FIRST_WORD</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-IK_005fREF-1208"><code>IK_REF</code></a>: <a href="#objects-refs">objects refs</a></li>
<li><a href="#index-ik_005fsafe_005falloc-1219"><code>ik_safe_alloc</code></a>: <a href="#objects-memory">objects memory</a></li>
<li><a href="#index-IK_005fSTRING_005fLENGTH-1322"><code>IK_STRING_LENGTH</code></a>: <a href="#objects-strings">objects strings</a></li>
<li><a href="#index-IK_005fSTRING_005fLENGTH_005fFX-1321"><code>IK_STRING_LENGTH_FX</code></a>: <a href="#objects-strings">objects strings</a></li>
<li><a href="#index-IK_005fTAGOF-1207"><code>IK_TAGOF</code></a>: <a href="#objects-refs">objects refs</a></li>
<li><a href="#index-IK_005fUNFIX-1227"><code>IK_UNFIX</code></a>: <a href="#objects-fixnums">objects fixnums</a></li>
<li><a href="#index-ik_005funsafe_005falloc-1220"><code>ik_unsafe_alloc</code></a>: <a href="#objects-memory">objects memory</a></li>
<li><a href="#index-IK_005fVECTOR_005fLENGTH-1275"><code>IK_VECTOR_LENGTH</code></a>: <a href="#objects-vectors">objects vectors</a></li>
<li><a href="#index-IK_005fVECTOR_005fLENGTH_005fFX-1274"><code>IK_VECTOR_LENGTH_FX</code></a>: <a href="#objects-vectors">objects vectors</a></li>
<li><a href="#index-IKA_005fBIGNUM_005fALLOC-1351"><code>IKA_BIGNUM_ALLOC</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ika_005fbytevector_005falloc-1264"><code>ika_bytevector_alloc</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-ika_005fcompnum_005falloc_005fand_005finit-1412"><code>ika_compnum_alloc_and_init</code></a>: <a href="#objects-compnums">objects compnums</a></li>
<li><a href="#index-ika_005fcompnum_005falloc_005fno_005finit-1411"><code>ika_compnum_alloc_no_init</code></a>: <a href="#objects-compnums">objects compnums</a></li>
<li><a href="#index-ika_005fflonum_005ffrom_005fdouble-1399"><code>ika_flonum_from_double</code></a>: <a href="#objects-flonums">objects flonums</a></li>
<li><a href="#index-ika_005finteger_005ffrom_005fint-1361"><code>ika_integer_from_int</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ika_005finteger_005ffrom_005fllong-1363"><code>ika_integer_from_llong</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ika_005finteger_005ffrom_005flong-1362"><code>ika_integer_from_long</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ika_005finteger_005ffrom_005fuint-1364"><code>ika_integer_from_uint</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ika_005finteger_005ffrom_005fullong-1366"><code>ika_integer_from_ullong</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ika_005finteger_005ffrom_005fulong-1365"><code>ika_integer_from_ulong</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-ika_005flist_005ffrom_005fargv-1251"><code>ika_list_from_argv</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-ika_005flist_005ffrom_005fargv_005fand_005fargc-1252"><code>ika_list_from_argv_and_argc</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-ika_005fpair_005falloc-1246"><code>ika_pair_alloc</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-IKA_005fPAIR_005fALLOC-1238"><code>IKA_PAIR_ALLOC</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-ika_005fpointer_005falloc-1442"><code>ika_pointer_alloc</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-ika_005fratnum_005falloc_005fand_005finit-1389"><code>ika_ratnum_alloc_and_init</code></a>: <a href="#objects-ratnums">objects ratnums</a></li>
<li><a href="#index-ika_005fratnum_005falloc_005fno_005finit-1388"><code>ika_ratnum_alloc_no_init</code></a>: <a href="#objects-ratnums">objects ratnums</a></li>
<li><a href="#index-ika_005fstring_005falloc-1324"><code>ika_string_alloc</code></a>: <a href="#objects-strings">objects strings</a></li>
<li><a href="#index-ika_005fstruct_005falloc_005fand_005finit-1303"><code>ika_struct_alloc_and_init</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-ika_005fstruct_005falloc_005fno_005finit-1302"><code>ika_struct_alloc_no_init</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-ika_005fvector_005falloc_005fand_005finit-1278"><code>ika_vector_alloc_and_init</code></a>: <a href="#objects-vectors">objects vectors</a></li>
<li><a href="#index-ika_005fvector_005falloc_005fno_005finit-1277"><code>ika_vector_alloc_no_init</code></a>: <a href="#objects-vectors">objects vectors</a></li>
<li><a href="#index-ikptr-767"><code>ikptr</code></a>: <a href="#glibc-socket">glibc socket</a></li>
<li><a href="#index-ikrt_005faccept-1021"><code>ikrt_accept</code></a>: <a href="#capi-posix-port-net">capi posix port net</a></li>
<li><a href="#index-ikrt_005fbytevector_005fcopy-1268"><code>ikrt_bytevector_copy</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-ikrt_005fclose_005ffd-1009"><code>ikrt_close_fd</code></a>: <a href="#capi-posix-port-open">capi posix port open</a></li>
<li><a href="#index-ikrt_005fcurrent_005ftime-1185"><code>ikrt_current_time</code></a>: <a href="#capi-posix-time">capi posix time</a></li>
<li><a href="#index-ikrt_005fgeneral_005fcopy-1425"><code>ikrt_general_copy</code></a>: <a href="#objects-misc">objects misc</a></li>
<li><a href="#index-ikrt_005fglibc_005fclearenv-1189"><code>ikrt_glibc_clearenv</code></a>: <a href="#capi-glibc-env">capi glibc env</a></li>
<li><a href="#index-ikrt_005fglibc_005fdirfd-1190"><code>ikrt_glibc_dirfd</code></a>: <a href="#capi-glibc-dir">capi glibc dir</a></li>
<li><a href="#index-ikrt_005fglibc_005ffdatasync-1195"><code>ikrt_glibc_fdatasync</code></a>: <a href="#capi-glibc-sync">capi glibc sync</a></li>
<li><a href="#index-ikrt_005fglibc_005ffsync-1194"><code>ikrt_glibc_fsync</code></a>: <a href="#capi-glibc-sync">capi glibc sync</a></li>
<li><a href="#index-ikrt_005fglibc_005fgethostbyname2-1199"><code>ikrt_glibc_gethostbyname2</code></a>: <a href="#capi-glibc-socket">capi glibc socket</a></li>
<li><a href="#index-ikrt_005fglibc_005fif_005findextoname-1197"><code>ikrt_glibc_if_indextoname</code></a>: <a href="#capi-glibc-socket">capi glibc socket</a></li>
<li><a href="#index-ikrt_005fglibc_005fif_005fnameindex-1198"><code>ikrt_glibc_if_nameindex</code></a>: <a href="#capi-glibc-socket">capi glibc socket</a></li>
<li><a href="#index-ikrt_005fglibc_005fif_005fnametoindex-1196"><code>ikrt_glibc_if_nametoindex</code></a>: <a href="#capi-glibc-socket">capi glibc socket</a></li>
<li><a href="#index-ikrt_005fglibc_005fmkdtemp-1192"><code>ikrt_glibc_mkdtemp</code></a>: <a href="#capi-glibc-temp">capi glibc temp</a></li>
<li><a href="#index-ikrt_005fglibc_005fmkstemp-1191"><code>ikrt_glibc_mkstemp</code></a>: <a href="#capi-glibc-temp">capi glibc temp</a></li>
<li><a href="#index-ikrt_005fglibc_005fsync-1193"><code>ikrt_glibc_sync</code></a>: <a href="#capi-glibc-sync">capi glibc sync</a></li>
<li><a href="#index-ikrt_005fgmt_005foffset-1186"><code>ikrt_gmt_offset</code></a>: <a href="#capi-posix-time">capi posix time</a></li>
<li><a href="#index-ikrt_005finet_005faton-1116"><code>ikrt_inet_aton</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005finet_005fntoa-1117"><code>ikrt_inet_ntoa</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fis_005fpointer-1445"><code>ikrt_is_pointer</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-ikrt_005flast_005ferrno-1004"><code>ikrt_last_errno</code></a>: <a href="#capi-posix-errno">capi posix errno</a></li>
<li><a href="#index-ikrt_005flinux_005fwaitid-1187"><code>ikrt_linux_waitid</code></a>: <a href="#capi-linux-status">capi linux status</a></li>
<li><a href="#index-ikrt_005flinux_005fWIFCONTINUED-1188"><code>ikrt_linux_WIFCONTINUED</code></a>: <a href="#capi-linux-status">capi linux status</a></li>
<li><a href="#index-ikrt_005flisten-1020"><code>ikrt_listen</code></a>: <a href="#capi-posix-port-net">capi posix port net</a></li>
<li><a href="#index-ikrt_005fmake_005ffd_005fnonblocking-1017"><code>ikrt_make_fd_nonblocking</code></a>: <a href="#capi-posix-port-event">capi posix port event</a></li>
<li><a href="#index-ikrt_005fnanosleep-1184"><code>ikrt_nanosleep</code></a>: <a href="#capi-posix-time">capi posix time</a></li>
<li><a href="#index-ikrt_005fopen_005finput_005ffd-1010"><code>ikrt_open_input_fd</code></a>: <a href="#capi-posix-port-open">capi posix port open</a></li>
<li><a href="#index-ikrt_005fopen_005finput_005foutput_005ffd-1012"><code>ikrt_open_input_output_fd</code></a>: <a href="#capi-posix-port-open">capi posix port open</a></li>
<li><a href="#index-ikrt_005fopen_005foutput_005ffd-1011"><code>ikrt_open_output_fd</code></a>: <a href="#capi-posix-port-open">capi posix port open</a></li>
<li><a href="#index-ikrt_005fposix_005faccept-1139"><code>ikrt_posix_accept</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005faccess-1055"><code>ikrt_posix_access</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005fbind-1140"><code>ikrt_posix_bind</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fchdir-1080"><code>ikrt_posix_chdir</code></a>: <a href="#capi-posix-dir">capi posix dir</a></li>
<li><a href="#index-ikrt_005fposix_005fchmod-1062"><code>ikrt_posix_chmod</code></a>: <a href="#capi-posix-file">capi posix file</a></li>
<li><a href="#index-ikrt_005fposix_005fchown-1060"><code>ikrt_posix_chown</code></a>: <a href="#capi-posix-file">capi posix file</a></li>
<li><a href="#index-ikrt_005fposix_005fclock-1175"><code>ikrt_posix_clock</code></a>: <a href="#capi-posix-time">capi posix time</a></li>
<li><a href="#index-ikrt_005fposix_005fclose-1090"><code>ikrt_posix_close</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005fclosedir-1085"><code>ikrt_posix_closedir</code></a>: <a href="#capi-posix-dir">capi posix dir</a></li>
<li><a href="#index-ikrt_005fposix_005fconnect-1137"><code>ikrt_posix_connect</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fctermid-1167"><code>ikrt_posix_ctermid</code></a>: <a href="#capi-posix-job">capi posix job</a></li>
<li><a href="#index-ikrt_005fposix_005fdup-1102"><code>ikrt_posix_dup</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005fdup2-1103"><code>ikrt_posix_dup2</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005fenviron-1008"><code>ikrt_posix_environ</code></a>: <a href="#capi-posix-env">capi posix env</a></li>
<li><a href="#index-ikrt_005fposix_005fexecv-1027"><code>ikrt_posix_execv</code></a>: <a href="#capi-posix-process">capi posix process</a></li>
<li><a href="#index-ikrt_005fposix_005fexecve-1028"><code>ikrt_posix_execve</code></a>: <a href="#capi-posix-process">capi posix process</a></li>
<li><a href="#index-ikrt_005fposix_005fexecvp-1029"><code>ikrt_posix_execvp</code></a>: <a href="#capi-posix-process">capi posix process</a></li>
<li><a href="#index-ikrt_005fposix_005ffchdir-1081"><code>ikrt_posix_fchdir</code></a>: <a href="#capi-posix-dir">capi posix dir</a></li>
<li><a href="#index-ikrt_005fposix_005ffchmod-1063"><code>ikrt_posix_fchmod</code></a>: <a href="#capi-posix-file">capi posix file</a></li>
<li><a href="#index-ikrt_005fposix_005ffchown-1061"><code>ikrt_posix_fchown</code></a>: <a href="#capi-posix-file">capi posix file</a></li>
<li><a href="#index-ikrt_005fposix_005ffcntl-1100"><code>ikrt_posix_fcntl</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005ffdopendir-1083"><code>ikrt_posix_fdopendir</code></a>: <a href="#capi-posix-dir">capi posix dir</a></li>
<li><a href="#index-ikrt_005fposix_005ffile_005fatime-1057"><code>ikrt_posix_file_atime</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005ffile_005fctime-1059"><code>ikrt_posix_file_ctime</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005ffile_005fis_005fblock_005fdevice-1047"><code>ikrt_posix_file_is_block_device</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005ffile_005fis_005fchar_005fdevice-1046"><code>ikrt_posix_file_is_char_device</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005ffile_005fis_005fdirectory-1045"><code>ikrt_posix_file_is_directory</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005ffile_005fis_005ffifo-1051"><code>ikrt_posix_file_is_fifo</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005ffile_005fis_005fmessage_005fqueue-1052"><code>ikrt_posix_file_is_message_queue</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005ffile_005fis_005fregular_005ffile-1048"><code>ikrt_posix_file_is_regular_file</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005ffile_005fis_005fsemaphore-1053"><code>ikrt_posix_file_is_semaphore</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005ffile_005fis_005fshared_005fmemory-1054"><code>ikrt_posix_file_is_shared_memory</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005ffile_005fis_005fsocket-1050"><code>ikrt_posix_file_is_socket</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005ffile_005fis_005fsymbolic_005flink-1049"><code>ikrt_posix_file_is_symbolic_link</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005ffile_005fmtime-1058"><code>ikrt_posix_file_mtime</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005ffile_005fsize-1056"><code>ikrt_posix_file_size</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005ffork-1026"><code>ikrt_posix_fork</code></a>: <a href="#capi-posix-process">capi posix process</a></li>
<li><a href="#index-ikrt_005fposix_005ffstat-1044"><code>ikrt_posix_fstat</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005ffutimes-1069"><code>ikrt_posix_futimes</code></a>: <a href="#capi-posix-file">capi posix file</a></li>
<li><a href="#index-ikrt_005fposix_005fgai_005fstrerror-1124"><code>ikrt_posix_gai_strerror</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fgetaddrinfo-1123"><code>ikrt_posix_getaddrinfo</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fgetcwd-1079"><code>ikrt_posix_getcwd</code></a>: <a href="#capi-posix-dir">capi posix dir</a></li>
<li><a href="#index-ikrt_005fposix_005fgetegid-1152"><code>ikrt_posix_getegid</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fgetenv-1005"><code>ikrt_posix_getenv</code></a>: <a href="#capi-posix-env">capi posix env</a></li>
<li><a href="#index-ikrt_005fposix_005fgeteuid-1151"><code>ikrt_posix_geteuid</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fgetgid-1150"><code>ikrt_posix_getgid</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fgetgrgid-1164"><code>ikrt_posix_getgrgid</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fgetgrnam-1165"><code>ikrt_posix_getgrnam</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fgetgroups-1153"><code>ikrt_posix_getgroups</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fgethostbyaddr-1121"><code>ikrt_posix_gethostbyaddr</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fgethostbyname-1120"><code>ikrt_posix_gethostbyname</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fgetlogin-1160"><code>ikrt_posix_getlogin</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fgetnetbyaddr-1132"><code>ikrt_posix_getnetbyaddr</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fgetnetbyname-1131"><code>ikrt_posix_getnetbyname</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fgetpeername-1141"><code>ikrt_posix_getpeername</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fgetpgrp-1170"><code>ikrt_posix_getpgrp</code></a>: <a href="#capi-posix-job">capi posix job</a></li>
<li><a href="#index-ikrt_005fposix_005fgetpid-1023"><code>ikrt_posix_getpid</code></a>: <a href="#capi-posix-pid">capi posix pid</a></li>
<li><a href="#index-ikrt_005fposix_005fgetppid-1024"><code>ikrt_posix_getppid</code></a>: <a href="#capi-posix-pid">capi posix pid</a></li>
<li><a href="#index-ikrt_005fposix_005fgetprotobyname-1125"><code>ikrt_posix_getprotobyname</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fgetprotobynumber-1126"><code>ikrt_posix_getprotobynumber</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fgetpwnam-1162"><code>ikrt_posix_getpwnam</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fgetpwuid-1161"><code>ikrt_posix_getpwuid</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fgetservbyname-1128"><code>ikrt_posix_getservbyname</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fgetservbynumber-1129"><code>ikrt_posix_getservbynumber</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fgetsid-1169"><code>ikrt_posix_getsid</code></a>: <a href="#capi-posix-job">capi posix job</a></li>
<li><a href="#index-ikrt_005fposix_005fgetsockname-1142"><code>ikrt_posix_getsockname</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fgetsockopt-1147"><code>ikrt_posix_getsockopt</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fgettimeofday-1178"><code>ikrt_posix_gettimeofday</code></a>: <a href="#capi-posix-time">capi posix time</a></li>
<li><a href="#index-ikrt_005fposix_005fgetuid-1149"><code>ikrt_posix_getuid</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fgetumask-1065"><code>ikrt_posix_getumask</code></a>: <a href="#capi-posix-file">capi posix file</a></li>
<li><a href="#index-ikrt_005fposix_005fgmtime-1180"><code>ikrt_posix_gmtime</code></a>: <a href="#capi-posix-time">capi posix time</a></li>
<li><a href="#index-ikrt_005fposix_005fgroup_005fentries-1166"><code>ikrt_posix_group_entries</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fhost_005fentries-1122"><code>ikrt_posix_host_entries</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fin6addr_005fany-1115"><code>ikrt_posix_in6addr_any</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fin6addr_005floopback-1114"><code>ikrt_posix_in6addr_loopback</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005finet_005fntop-1119"><code>ikrt_posix_inet_ntop</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005finet_005fpton-1118"><code>ikrt_posix_inet_pton</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fioctl-1101"><code>ikrt_posix_ioctl</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005fkill-1040"><code>ikrt_posix_kill</code></a>: <a href="#capi-posix-signals">capi posix signals</a></li>
<li><a href="#index-ikrt_005fposix_005flink-1070"><code>ikrt_posix_link</code></a>: <a href="#capi-posix-link">capi posix link</a></li>
<li><a href="#index-ikrt_005fposix_005flisten-1138"><code>ikrt_posix_listen</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005flocaltime-1179"><code>ikrt_posix_localtime</code></a>: <a href="#capi-posix-time">capi posix time</a></li>
<li><a href="#index-ikrt_005fposix_005flseek-1095"><code>ikrt_posix_lseek</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005flstat-1043"><code>ikrt_posix_lstat</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005flutimes-1068"><code>ikrt_posix_lutimes</code></a>: <a href="#capi-posix-file">capi posix file</a></li>
<li><a href="#index-ikrt_005fposix_005fmake_005fsockaddr_005fin-1108"><code>ikrt_posix_make_sockaddr_in</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fmake_005fsockaddr_005fin6-1111"><code>ikrt_posix_make_sockaddr_in6</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fmake_005fsockaddr_005fun-1106"><code>ikrt_posix_make_sockaddr_un</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fmkdir-1077"><code>ikrt_posix_mkdir</code></a>: <a href="#capi-posix-dir">capi posix dir</a></li>
<li><a href="#index-ikrt_005fposix_005fmkfifo-1105"><code>ikrt_posix_mkfifo</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005fnetwork_005fentries-1133"><code>ikrt_posix_network_entries</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fopen-1089"><code>ikrt_posix_open</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005fopendir-1082"><code>ikrt_posix_opendir</code></a>: <a href="#capi-posix-dir">capi posix dir</a></li>
<li><a href="#index-ikrt_005fposix_005fpause-1041"><code>ikrt_posix_pause</code></a>: <a href="#capi-posix-signals">capi posix signals</a></li>
<li><a href="#index-ikrt_005fposix_005fpipe-1104"><code>ikrt_posix_pipe</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005fpread-1092"><code>ikrt_posix_pread</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005fprotocol_005fentries-1127"><code>ikrt_posix_protocol_entries</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fpwrite-1094"><code>ikrt_posix_pwrite</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005fraise-1039"><code>ikrt_posix_raise</code></a>: <a href="#capi-posix-signals">capi posix signals</a></li>
<li><a href="#index-ikrt_005fposix_005fread-1091"><code>ikrt_posix_read</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005freaddir-1084"><code>ikrt_posix_readdir</code></a>: <a href="#capi-posix-dir">capi posix dir</a></li>
<li><a href="#index-ikrt_005fposix_005freadlink-1072"><code>ikrt_posix_readlink</code></a>: <a href="#capi-posix-link">capi posix link</a></li>
<li><a href="#index-ikrt_005fposix_005freadv-1096"><code>ikrt_posix_readv</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005frealpath-1073"><code>ikrt_posix_realpath</code></a>: <a href="#capi-posix-link">capi posix link</a></li>
<li><a href="#index-ikrt_005fposix_005frecv-1144"><code>ikrt_posix_recv</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005frecvfrom-1146"><code>ikrt_posix_recvfrom</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fremove-1075"><code>ikrt_posix_remove</code></a>: <a href="#capi-posix-link">capi posix link</a></li>
<li><a href="#index-ikrt_005fposix_005frename-1076"><code>ikrt_posix_rename</code></a>: <a href="#capi-posix-link">capi posix link</a></li>
<li><a href="#index-ikrt_005fposix_005frewinddir-1086"><code>ikrt_posix_rewinddir</code></a>: <a href="#capi-posix-dir">capi posix dir</a></li>
<li><a href="#index-ikrt_005fposix_005frmdir-1078"><code>ikrt_posix_rmdir</code></a>: <a href="#capi-posix-dir">capi posix dir</a></li>
<li><a href="#index-ikrt_005fposix_005fseekdir-1088"><code>ikrt_posix_seekdir</code></a>: <a href="#capi-posix-dir">capi posix dir</a></li>
<li><a href="#index-ikrt_005fposix_005fselect-1098"><code>ikrt_posix_select</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005fselect_005ffd-1099"><code>ikrt_posix_select_fd</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005fsend-1143"><code>ikrt_posix_send</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fsendto-1145"><code>ikrt_posix_sendto</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fservice_005fentries-1130"><code>ikrt_posix_service_entries</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fsetegid-1157"><code>ikrt_posix_setegid</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fsetenv-1006"><code>ikrt_posix_setenv</code></a>: <a href="#capi-posix-env">capi posix env</a></li>
<li><a href="#index-ikrt_005fposix_005fseteuid-1154"><code>ikrt_posix_seteuid</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fsetgid-1158"><code>ikrt_posix_setgid</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fsetpgid-1171"><code>ikrt_posix_setpgid</code></a>: <a href="#capi-posix-job">capi posix job</a></li>
<li><a href="#index-ikrt_005fposix_005fsetregid-1159"><code>ikrt_posix_setregid</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fsetreuid-1156"><code>ikrt_posix_setreuid</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fsetsid-1168"><code>ikrt_posix_setsid</code></a>: <a href="#capi-posix-job">capi posix job</a></li>
<li><a href="#index-ikrt_005fposix_005fsetsockopt-1148"><code>ikrt_posix_setsockopt</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fsetuid-1155"><code>ikrt_posix_setuid</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005fshutdown-1135"><code>ikrt_posix_shutdown</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fsockaddr_005fin6_005fin6_005faddr-1112"><code>ikrt_posix_sockaddr_in6_in6_addr</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fsockaddr_005fin6_005fin6_005fport-1113"><code>ikrt_posix_sockaddr_in6_in6_port</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fsockaddr_005fin_005fin_005faddr-1109"><code>ikrt_posix_sockaddr_in_in_addr</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fsockaddr_005fin_005fin_005fport-1110"><code>ikrt_posix_sockaddr_in_in_port</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fsockaddr_005fun_005fpathname-1107"><code>ikrt_posix_sockaddr_un_pathname</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fsocket-1134"><code>ikrt_posix_socket</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fsocketpair-1136"><code>ikrt_posix_socketpair</code></a>: <a href="#capi-posix-socket">capi posix socket</a></li>
<li><a href="#index-ikrt_005fposix_005fstat-1042"><code>ikrt_posix_stat</code></a>: <a href="#capi-posix-stat">capi posix stat</a></li>
<li><a href="#index-ikrt_005fposix_005fstrftime-1183"><code>ikrt_posix_strftime</code></a>: <a href="#capi-posix-time">capi posix time</a></li>
<li><a href="#index-ikrt_005fposix_005fsymlink-1071"><code>ikrt_posix_symlink</code></a>: <a href="#capi-posix-link">capi posix link</a></li>
<li><a href="#index-ikrt_005fposix_005fsystem-1025"><code>ikrt_posix_system</code></a>: <a href="#capi-posix-process">capi posix process</a></li>
<li><a href="#index-ikrt_005fposix_005ftcgetpgrp-1172"><code>ikrt_posix_tcgetpgrp</code></a>: <a href="#capi-posix-job">capi posix job</a></li>
<li><a href="#index-ikrt_005fposix_005ftcgetsid-1174"><code>ikrt_posix_tcgetsid</code></a>: <a href="#capi-posix-job">capi posix job</a></li>
<li><a href="#index-ikrt_005fposix_005ftcsetpgrp-1173"><code>ikrt_posix_tcsetpgrp</code></a>: <a href="#capi-posix-job">capi posix job</a></li>
<li><a href="#index-ikrt_005fposix_005ftelldir-1087"><code>ikrt_posix_telldir</code></a>: <a href="#capi-posix-dir">capi posix dir</a></li>
<li><a href="#index-ikrt_005fposix_005ftime-1177"><code>ikrt_posix_time</code></a>: <a href="#capi-posix-time">capi posix time</a></li>
<li><a href="#index-ikrt_005fposix_005ftimegm-1182"><code>ikrt_posix_timegm</code></a>: <a href="#capi-posix-time">capi posix time</a></li>
<li><a href="#index-ikrt_005fposix_005ftimelocal-1181"><code>ikrt_posix_timelocal</code></a>: <a href="#capi-posix-time">capi posix time</a></li>
<li><a href="#index-ikrt_005fposix_005ftimes-1176"><code>ikrt_posix_times</code></a>: <a href="#capi-posix-time">capi posix time</a></li>
<li><a href="#index-ikrt_005fposix_005fumask-1064"><code>ikrt_posix_umask</code></a>: <a href="#capi-posix-file">capi posix file</a></li>
<li><a href="#index-ikrt_005fposix_005funlink-1074"><code>ikrt_posix_unlink</code></a>: <a href="#capi-posix-link">capi posix link</a></li>
<li><a href="#index-ikrt_005fposix_005funsetenv-1007"><code>ikrt_posix_unsetenv</code></a>: <a href="#capi-posix-env">capi posix env</a></li>
<li><a href="#index-ikrt_005fposix_005fuser_005fentries-1163"><code>ikrt_posix_user_entries</code></a>: <a href="#capi-posix-users">capi posix users</a></li>
<li><a href="#index-ikrt_005fposix_005futime-1066"><code>ikrt_posix_utime</code></a>: <a href="#capi-posix-file">capi posix file</a></li>
<li><a href="#index-ikrt_005fposix_005futimes-1067"><code>ikrt_posix_utimes</code></a>: <a href="#capi-posix-file">capi posix file</a></li>
<li><a href="#index-ikrt_005fposix_005fwait-1031"><code>ikrt_posix_wait</code></a>: <a href="#capi-posix-status">capi posix status</a></li>
<li><a href="#index-ikrt_005fposix_005fwaitpid-1030"><code>ikrt_posix_waitpid</code></a>: <a href="#capi-posix-status">capi posix status</a></li>
<li><a href="#index-ikrt_005fposix_005fWCOREDUMP-1036"><code>ikrt_posix_WCOREDUMP</code></a>: <a href="#capi-posix-status">capi posix status</a></li>
<li><a href="#index-ikrt_005fposix_005fWEXITSTATUS-1033"><code>ikrt_posix_WEXITSTATUS</code></a>: <a href="#capi-posix-status">capi posix status</a></li>
<li><a href="#index-ikrt_005fposix_005fWIFEXITED-1032"><code>ikrt_posix_WIFEXITED</code></a>: <a href="#capi-posix-status">capi posix status</a></li>
<li><a href="#index-ikrt_005fposix_005fWIFSIGNALED-1034"><code>ikrt_posix_WIFSIGNALED</code></a>: <a href="#capi-posix-status">capi posix status</a></li>
<li><a href="#index-ikrt_005fposix_005fWIFSTOPPED-1037"><code>ikrt_posix_WIFSTOPPED</code></a>: <a href="#capi-posix-status">capi posix status</a></li>
<li><a href="#index-ikrt_005fposix_005fwrite-1093"><code>ikrt_posix_write</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005fwritev-1097"><code>ikrt_posix_writev</code></a>: <a href="#capi-posix-fd">capi posix fd</a></li>
<li><a href="#index-ikrt_005fposix_005fWSTOPSIG-1038"><code>ikrt_posix_WSTOPSIG</code></a>: <a href="#capi-posix-status">capi posix status</a></li>
<li><a href="#index-ikrt_005fposix_005fWTERMSIG-1035"><code>ikrt_posix_WTERMSIG</code></a>: <a href="#capi-posix-status">capi posix status</a></li>
<li><a href="#index-ikrt_005fread_005ffd-1014"><code>ikrt_read_fd</code></a>: <a href="#capi-posix-port-rw">capi posix port rw</a></li>
<li><a href="#index-ikrt_005fref_005fchar-970"><code>ikrt_ref_char</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005fdouble-979"><code>ikrt_ref_double</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005ffloat-978"><code>ikrt_ref_float</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005flong-974"><code>ikrt_ref_long</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005flonglong-976"><code>ikrt_ref_longlong</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005fpointer-980"><code>ikrt_ref_pointer</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005fshort-972"><code>ikrt_ref_short</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005fsint16-965"><code>ikrt_ref_sint16</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005fsint32-967"><code>ikrt_ref_sint32</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005fsint64-969"><code>ikrt_ref_sint64</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005fsint8-963"><code>ikrt_ref_sint8</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005fuchar-971"><code>ikrt_ref_uchar</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005fuint16-964"><code>ikrt_ref_uint16</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005fuint32-966"><code>ikrt_ref_uint32</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005fuint64-968"><code>ikrt_ref_uint64</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005fuint8-962"><code>ikrt_ref_uint8</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005fulong-975"><code>ikrt_ref_ulong</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005fulonglong-977"><code>ikrt_ref_ulonglong</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fref_005fushort-973"><code>ikrt_ref_ushort</code></a>: <a href="#capi-ffi-accessors">capi ffi accessors</a></li>
<li><a href="#index-ikrt_005fselect-1016"><code>ikrt_select</code></a>: <a href="#capi-posix-port-event">capi posix port event</a></li>
<li><a href="#index-ikrt_005fset_005fchar-989"><code>ikrt_set_char</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fdouble-1000"><code>ikrt_set_double</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005ffloat-999"><code>ikrt_set_float</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fint-993"><code>ikrt_set_int</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005flong-995"><code>ikrt_set_long</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005flonglong-997"><code>ikrt_set_longlong</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fpointer-1001"><code>ikrt_set_pointer</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fposition-1013"><code>ikrt_set_position</code></a>: <a href="#capi-posix-port-seek">capi posix port seek</a></li>
<li><a href="#index-ikrt_005fset_005fshort-991"><code>ikrt_set_short</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fsint16-984"><code>ikrt_set_sint16</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fsint32-986"><code>ikrt_set_sint32</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fsint64-988"><code>ikrt_set_sint64</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fsint8-982"><code>ikrt_set_sint8</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fuchar-990"><code>ikrt_set_uchar</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fuint-994"><code>ikrt_set_uint</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fuint16-983"><code>ikrt_set_uint16</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fuint32-985"><code>ikrt_set_uint32</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fuint64-987"><code>ikrt_set_uint64</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fuint8-981"><code>ikrt_set_uint8</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fulong-996"><code>ikrt_set_ulong</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fulonglong-998"><code>ikrt_set_ulonglong</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fset_005fushort-992"><code>ikrt_set_ushort</code></a>: <a href="#capi-ffi-mutators">capi ffi mutators</a></li>
<li><a href="#index-ikrt_005fshutdown-1022"><code>ikrt_shutdown</code></a>: <a href="#capi-posix-port-net">capi posix port net</a></li>
<li><a href="#index-ikrt_005fstrerror-1003"><code>ikrt_strerror</code></a>: <a href="#capi-posix-errno">capi posix errno</a></li>
<li><a href="#index-ikrt_005ftcp_005fconnect-1018"><code>ikrt_tcp_connect</code></a>: <a href="#capi-posix-port-net">capi posix port net</a></li>
<li><a href="#index-ikrt_005fucp_005fconnect-1019"><code>ikrt_ucp_connect</code></a>: <a href="#capi-posix-port-net">capi posix port net</a></li>
<li><a href="#index-ikrt_005fvector_005fclean-1280"><code>ikrt_vector_clean</code></a>: <a href="#objects-vectors">objects vectors</a></li>
<li><a href="#index-ikrt_005fvector_005fcopy-1281"><code>ikrt_vector_copy</code></a>: <a href="#objects-vectors">objects vectors</a></li>
<li><a href="#index-ikrt_005fwrite_005ffd-1015"><code>ikrt_write_fd</code></a>: <a href="#capi-posix-port-rw">capi posix port rw</a></li>
<li><a href="#index-iku_005fcflonum_005falloc_005fand_005finit-1424"><code>iku_cflonum_alloc_and_init</code></a>: <a href="#objects-cflonums">objects cflonums</a></li>
<li><a href="#index-iku_005fflonum_005falloc-1398"><code>iku_flonum_alloc</code></a>: <a href="#objects-flonums">objects flonums</a></li>
<li><a href="#index-iku_005fpair_005falloc-1247"><code>iku_pair_alloc</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-IKU_005fPAIR_005fALLOC-1239"><code>IKU_PAIR_ALLOC</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-iku_005fpointer_005falloc-1443"><code>iku_pointer_alloc</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-import-204"><code>import</code></a>: <a href="#iklib-import">iklib import</a></li>
<li><a href="#index-in6addr_005fany-601"><code>in6addr_any</code></a>: <a href="#posix-socket-addresses-in6">posix socket addresses in6</a></li>
<li><a href="#index-in6addr_005floopback-600"><code>in6addr_loopback</code></a>: <a href="#posix-socket-addresses-in6">posix socket addresses in6</a></li>
<li><a href="#index-inet_002daton-602"><code>inet-aton</code></a>: <a href="#posix-socket-addresses-rep">posix socket addresses rep</a></li>
<li><a href="#index-inet_002dntoa-603"><code>inet-ntoa</code></a>: <a href="#posix-socket-addresses-rep">posix socket addresses rep</a></li>
<li><a href="#index-inet_002dntoa_002fstring-604"><code>inet-ntoa/string</code></a>: <a href="#posix-socket-addresses-rep">posix socket addresses rep</a></li>
<li><a href="#index-inet_002dntop-606"><code>inet-ntop</code></a>: <a href="#posix-socket-addresses-rep">posix socket addresses rep</a></li>
<li><a href="#index-inet_002dntop_002fstring-607"><code>inet-ntop/string</code></a>: <a href="#posix-socket-addresses-rep">posix socket addresses rep</a></li>
<li><a href="#index-inet_002dpton-605"><code>inet-pton</code></a>: <a href="#posix-socket-addresses-rep">posix socket addresses rep</a></li>
<li><a href="#index-initialise-1200"><code>initialise</code></a>: <a href="#gcc">gcc</a></li>
<li><a href="#index-input_002dfile_002dbuffer_002dsize-309"><code>input-file-buffer-size</code></a>: <a href="#iklib-io-buffer">iklib io buffer</a></li>
<li><a href="#index-input_002dsocket_002dbuffer_002dsize-327"><code>input-socket-buffer-size</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-input_002foutput_002dfile_002dbuffer_002dsize-313"><code>input/output-file-buffer-size</code></a>: <a href="#iklib-io-buffer">iklib io buffer</a></li>
<li><a href="#index-input_002foutput_002dsocket_002dbuffer_002dsize-315"><code>input/output-socket-buffer-size</code></a>: <a href="#iklib-io-buffer">iklib io buffer</a></li>
<li><a href="#index-integer_002d_003epointer-338"><code>integer-&gt;pointer</code></a>: <a href="#ffi-memory-pointer">ffi memory pointer</a></li>
<li><a href="#index-interaction_002denvironment-70"><code>interaction-environment</code></a>: <a href="#iklib-environment">iklib environment</a></li>
<li><a href="#index-ioctl-585"><code>ioctl</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-j0-797"><code>j0</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-j1-798"><code>j1</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-jn-799"><code>jn</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-kill-481"><code>kill</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-latin1_002d_003estring-169"><code>latin1-&gt;string</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-LDFLAGS-1205"><code>LDFLAGS</code></a>: <a href="#gcc">gcc</a></li>
<li><a href="#index-lgamma-795"><code>lgamma</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-link-539"><code>link</code></a>: <a href="#posix-link">posix link</a></li>
<li><a href="#index-LINK_002dFLAGS-1203"><code>LINK-FLAGS</code></a>: <a href="#gcc">gcc</a></li>
<li><a href="#index-listen-654"><code>listen</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-literal-1477"><code>literal</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-load-202"><code>load</code></a>: <a href="#iklib-load">iklib load</a></li>
<li><a href="#index-localtime-750"><code>localtime</code></a>: <a href="#posix-time-functions">posix time functions</a></li>
<li><a href="#index-log_002derrors-1476"><code>log-errors</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-longest_002dmatch-1475"><code>longest-match</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-lookahead_002dtwo_002du8-276"><code>lookahead-two-u8</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-lseek-578"><code>lseek</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-lstat-502"><code>lstat</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-lutimes-537"><code>lutimes</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-make_002dbinary_002dfile_002ddescriptor_002dinput_002dport-280"><code>make-binary-file-descriptor-input-port</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-make_002dbinary_002dfile_002ddescriptor_002dinput_002dport_002a-283"><code>make-binary-file-descriptor-input-port*</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-make_002dbinary_002dfile_002ddescriptor_002dinput_002foutput_002dport-282"><code>make-binary-file-descriptor-input/output-port</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-make_002dbinary_002dfile_002ddescriptor_002dinput_002foutput_002dport_002a-285"><code>make-binary-file-descriptor-input/output-port*</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-make_002dbinary_002dfile_002ddescriptor_002doutput_002dport-281"><code>make-binary-file-descriptor-output-port</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-make_002dbinary_002dfile_002ddescriptor_002doutput_002dport_002a-284"><code>make-binary-file-descriptor-output-port*</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-make_002dbinary_002dsocket_002dinput_002foutput_002dport-286"><code>make-binary-socket-input/output-port</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-make_002dbinary_002dsocket_002dinput_002foutput_002dport_002a-287"><code>make-binary-socket-input/output-port*</code></a>: <a href="#iklib-io-binary">iklib io binary</a></li>
<li><a href="#index-make_002dc_002dcallback_002dmaker-437"><code>make-c-callback-maker</code></a>: <a href="#ffi-call-back">ffi call back</a></li>
<li><a href="#index-make_002dc_002dcallout_002dmaker-435"><code>make-c-callout-maker</code></a>: <a href="#ffi-call-out">ffi call out</a></li>
<li><a href="#index-make_002dc_002dcallout_002dmaker_002fwith_002derrno-436"><code>make-c-callout-maker/with-errno</code></a>: <a href="#ffi-call-out">ffi call out</a></li>
<li><a href="#index-make_002ddirectory_002dstream-556"><code>make-directory-stream</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-make_002derrno_002dcondition-446"><code>make-errno-condition</code></a>: <a href="#posix-conditions">posix conditions</a></li>
<li><a href="#index-make_002dguardian-261"><code>make-guardian</code></a>: <a href="#iklib-guardians-api">iklib guardians api</a></li>
<li><a href="#index-make_002dh_005ferrno_002dcondition-450"><code>make-h_errno-condition</code></a>: <a href="#posix-conditions">posix conditions</a></li>
<li><a href="#index-make_002di_002fo_002deagain-21"><code>make-i/o-eagain</code></a>: <a href="#iklib-conditions-eagain">iklib conditions eagain</a></li>
<li><a href="#index-make_002doptions-1462"><code>make-options</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-make_002dparameter-207"><code>make-parameter</code></a>: <a href="#iklib-parameters">iklib parameters</a></li>
<li><a href="#index-make_002dregexp-1458"><code>make-regexp</code></a>: <a href="#cre2-regexps">cre2 regexps</a></li>
<li><a href="#index-make_002dsockaddr_005fin-594"><code>make-sockaddr_in</code></a>: <a href="#posix-socket-addresses-in">posix socket addresses in</a></li>
<li><a href="#index-make_002dsockaddr_005fin6-597"><code>make-sockaddr_in6</code></a>: <a href="#posix-socket-addresses-in6">posix socket addresses in6</a></li>
<li><a href="#index-make_002dsockaddr_005fun-591"><code>make-sockaddr_un</code></a>: <a href="#posix-socket-addresses-local">posix socket addresses local</a></li>
<li><a href="#index-make_002dsource_002dposition_002dcondition-16"><code>make-source-position-condition</code></a>: <a href="#iklib-conditions-spos">iklib conditions spos</a></li>
<li><a href="#index-make_002dstruct_002daddrinfo-609"><code>make-struct-addrinfo</code></a>: <a href="#posix-socket-addresses-info">posix socket addresses info</a></li>
<li><a href="#index-make_002dstruct_002dgroup-699"><code>make-struct-group</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-make_002dstruct_002dnetent-641"><code>make-struct-netent</code></a>: <a href="#posix-socket-networks">posix socket networks</a></li>
<li><a href="#index-make_002dstruct_002dpasswd-686"><code>make-struct-passwd</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-make_002dstruct_002dprotoent-624"><code>make-struct-protoent</code></a>: <a href="#posix-socket-protocols">posix socket protocols</a></li>
<li><a href="#index-make_002dstruct_002dservent-632"><code>make-struct-servent</code></a>: <a href="#posix-socket-services">posix socket services</a></li>
<li><a href="#index-make_002dstruct_002dsiginfo_005ft-831"><code>make-struct-siginfo_t</code></a>: <a href="#linux-status">linux status</a></li>
<li><a href="#index-make_002dstruct_002dstat-484"><code>make-struct-stat</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-make_002dstruct_002dtimespec-721"><code>make-struct-timespec</code></a>: <a href="#posix-time-timespec">posix time timespec</a></li>
<li><a href="#index-make_002dstruct_002dtimeval-716"><code>make-struct-timeval</code></a>: <a href="#posix-time-timeval">posix time timeval</a></li>
<li><a href="#index-make_002dstruct_002dtm-733"><code>make-struct-tm</code></a>: <a href="#posix-time-tm">posix time tm</a></li>
<li><a href="#index-make_002dstruct_002dtms-726"><code>make-struct-tms</code></a>: <a href="#posix-time-tms">posix time tms</a></li>
<li><a href="#index-make_002dstruct_002dtype-76"><code>make-struct-type</code></a>: <a href="#iklib-structs-rtd">iklib structs rtd</a></li>
<li><a href="#index-make_002dtextual_002dfile_002ddescriptor_002dinput_002dport-297"><code>make-textual-file-descriptor-input-port</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-make_002dtextual_002dfile_002ddescriptor_002dinput_002dport_002a-300"><code>make-textual-file-descriptor-input-port*</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-make_002dtextual_002dfile_002ddescriptor_002dinput_002foutput_002dport-299"><code>make-textual-file-descriptor-input/output-port</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-make_002dtextual_002dfile_002ddescriptor_002dinput_002foutput_002dport_002a-302"><code>make-textual-file-descriptor-input/output-port*</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-make_002dtextual_002dfile_002ddescriptor_002doutput_002dport-298"><code>make-textual-file-descriptor-output-port</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-make_002dtextual_002dfile_002ddescriptor_002doutput_002dport_002a-301"><code>make-textual-file-descriptor-output-port*</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-make_002dtextual_002dsocket_002dinput_002foutput_002dport-303"><code>make-textual-socket-input/output-port</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-make_002dtextual_002dsocket_002dinput_002foutput_002dport_002a-304"><code>make-textual-socket-input/output-port*</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-make_002dtraced_002dprocedure-240"><code>make-traced-procedure</code></a>: <a href="#iklib-tracing">iklib tracing</a></li>
<li><a href="#index-malloc-349"><code>malloc</code></a>: <a href="#ffi-memory-alloc">ffi memory alloc</a></li>
<li><a href="#index-match-1485"><code>match</code></a>: <a href="#cre2-match">cre2 match</a></li>
<li><a href="#index-max_002dmem-1484"><code>max-mem</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-memcmp-402"><code>memcmp</code></a>: <a href="#ffi-memory-ops">ffi memory ops</a></li>
<li><a href="#index-memcpy-399"><code>memcpy</code></a>: <a href="#ffi-memory-ops">ffi memory ops</a></li>
<li><a href="#index-memmove-400"><code>memmove</code></a>: <a href="#ffi-memory-ops">ffi memory ops</a></li>
<li><a href="#index-memory_002d_003ebytevector-404"><code>memory-&gt;bytevector</code></a>: <a href="#ffi-memory-ops">ffi memory ops</a></li>
<li><a href="#index-memory_002dcopy-403"><code>memory-copy</code></a>: <a href="#ffi-memory-ops">ffi memory ops</a></li>
<li><a href="#index-memset-401"><code>memset</code></a>: <a href="#ffi-memory-ops">ffi memory ops</a></li>
<li><a href="#index-mkdir-548"><code>mkdir</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-mkdir_002fparents-549"><code>mkdir/parents</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-mkdtemp-762"><code>mkdtemp</code></a>: <a href="#glibc-temp">glibc temp</a></li>
<li><a href="#index-mkfifo-590"><code>mkfifo</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-mkstemp-761"><code>mkstemp</code></a>: <a href="#glibc-temp">glibc temp</a></li>
<li><a href="#index-module-205"><code>module</code></a>: <a href="#iklib-modules-api">iklib modules api</a></li>
<li><a href="#index-nanosleep-756"><code>nanosleep</code></a>: <a href="#posix-time-functions">posix time functions</a></li>
<li><a href="#index-native_002dtranscoder-265"><code>native-transcoder</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-network_002dentries-649"><code>network-entries</code></a>: <a href="#posix-socket-networks">posix socket networks</a></li>
<li><a href="#index-never_002dnl-1478"><code>never-nl</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-new_002dcafe-73"><code>new-cafe</code></a>: <a href="#iklib-cafe">iklib cafe</a></li>
<li><a href="#index-new_002dinteraction_002denvironment-71"><code>new-interaction-environment</code></a>: <a href="#iklib-environment">iklib environment</a></li>
<li><a href="#index-null_002dpointer-339"><code>null-pointer</code></a>: <a href="#ffi-memory-pointer">ffi memory pointer</a></li>
<li><a href="#index-null_005fobject-1212"><code>null_object</code></a>: <a href="#objects-refs">objects refs</a></li>
<li><a href="#index-one_002dline-1482"><code>one-line</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-open-570"><code>open</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-open_002dinput_002dfile-266"><code>open-input-file</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-open_002doutput_002dfile-269"><code>open-output-file</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-open_002dstring_002dinput_002dport-288"><code>open-string-input-port</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-open_002dstring_002dinput_002dport_002fid-290"><code>open-string-input-port/id</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-open_002dstring_002doutput_002dport-292"><code>open-string-output-port</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-opendir-562"><code>opendir</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-options_003f-1464"><code>options?</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-output_002dfile_002dbuffer_002dsize-311"><code>output-file-buffer-size</code></a>: <a href="#iklib-io-buffer">iklib io buffer</a></li>
<li><a href="#index-output_002dsocket_002dbuffer_002dsize-328"><code>output-socket-buffer-size</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-parameterize-209"><code>parameterize</code></a>: <a href="#iklib-parameters">iklib parameters</a></li>
<li><a href="#index-pathconf-814"><code>pathconf</code></a>: <a href="#glibc-config">glibc config</a></li>
<li><a href="#index-pause-482"><code>pause</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-perl_002dclasses-1480"><code>perl-classes</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-pipe-589"><code>pipe</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-pointer_002d_003einteger-337"><code>pointer-&gt;integer</code></a>: <a href="#ffi-memory-pointer">ffi memory pointer</a></li>
<li><a href="#index-pointer_002dadd-342"><code>pointer-add</code></a>: <a href="#ffi-memory-pointer">ffi memory pointer</a></li>
<li><a href="#index-pointer_002ddiff-341"><code>pointer-diff</code></a>: <a href="#ffi-memory-pointer">ffi memory pointer</a></li>
<li><a href="#index-pointer_002dnull_003f-340"><code>pointer-null?</code></a>: <a href="#ffi-memory-pointer">ffi memory pointer</a></li>
<li><a href="#index-pointer_002dref_002dc_002ddouble-397"><code>pointer-ref-c-double</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dfloat-396"><code>pointer-ref-c-float</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dpointer-398"><code>pointer-ref-c-pointer</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dsigned_002dchar-386"><code>pointer-ref-c-signed-char</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dsigned_002dint-390"><code>pointer-ref-c-signed-int</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dsigned_002dlong-392"><code>pointer-ref-c-signed-long</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dsigned_002dlong_002dlong-394"><code>pointer-ref-c-signed-long-long</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dsigned_002dshort-388"><code>pointer-ref-c-signed-short</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dsint16-380"><code>pointer-ref-c-sint16</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dsint32-382"><code>pointer-ref-c-sint32</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dsint64-384"><code>pointer-ref-c-sint64</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dsint8-378"><code>pointer-ref-c-sint8</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002duint16-381"><code>pointer-ref-c-uint16</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002duint32-383"><code>pointer-ref-c-uint32</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002duint64-385"><code>pointer-ref-c-uint64</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002duint8-379"><code>pointer-ref-c-uint8</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dunsigned_002dint-391"><code>pointer-ref-c-unsigned-int</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dunsigned_002dlong-393"><code>pointer-ref-c-unsigned-long</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dunsigned_002dlong_002dlong-395"><code>pointer-ref-c-unsigned-long-long</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dref_002dc_002dunsigned_002dshort-389"><code>pointer-ref-c-unsigned-short</code></a>: <a href="#ffi-memory-peek">ffi memory peek</a></li>
<li><a href="#index-pointer_002dset_002dc_002ddouble_0021-376"><code>pointer-set-c-double!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dfloat_0021-375"><code>pointer-set-c-float!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dpointer_0021-377"><code>pointer-set-c-pointer!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dsigned_002dchar_0021-365"><code>pointer-set-c-signed-char!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dsigned_002dint_0021-369"><code>pointer-set-c-signed-int!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dsigned_002dlong_0021-371"><code>pointer-set-c-signed-long!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dsigned_002dlong_002dlong_0021-373"><code>pointer-set-c-signed-long-long!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dsigned_002dshort_0021-367"><code>pointer-set-c-signed-short!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dsint16_0021-359"><code>pointer-set-c-sint16!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dsint32_0021-361"><code>pointer-set-c-sint32!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dsint64_0021-363"><code>pointer-set-c-sint64!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dsint8_0021-357"><code>pointer-set-c-sint8!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002duint16_0021-360"><code>pointer-set-c-uint16!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002duint32_0021-362"><code>pointer-set-c-uint32!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002duint64_0021-364"><code>pointer-set-c-uint64!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002duint8_0021-358"><code>pointer-set-c-uint8!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dunsigned_002dchar_0021-366"><code>pointer-set-c-unsigned-char!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dunsigned_002dint_0021-370"><code>pointer-set-c-unsigned-int!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dunsigned_002dlong_0021-372"><code>pointer-set-c-unsigned-long!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dunsigned_002dlong_002dlong_0021-374"><code>pointer-set-c-unsigned-long-long!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_002dset_002dc_002dunsigned_002dshort_0021-368"><code>pointer-set-c-unsigned-short!</code></a>: <a href="#ffi-memory-poke">ffi memory poke</a></li>
<li><a href="#index-pointer_003c_003d_003f-347"><code>pointer&lt;=?</code></a>: <a href="#ffi-memory-pointer">ffi memory pointer</a></li>
<li><a href="#index-pointer_003c_003e_003f-344"><code>pointer&lt;&gt;?</code></a>: <a href="#ffi-memory-pointer">ffi memory pointer</a></li>
<li><a href="#index-pointer_003c_003f-345"><code>pointer&lt;?</code></a>: <a href="#ffi-memory-pointer">ffi memory pointer</a></li>
<li><a href="#index-pointer_003d_003f-343"><code>pointer=?</code></a>: <a href="#ffi-memory-pointer">ffi memory pointer</a></li>
<li><a href="#index-pointer_003e_003d_003f-348"><code>pointer&gt;=?</code></a>: <a href="#ffi-memory-pointer">ffi memory pointer</a></li>
<li><a href="#index-pointer_003e_003f-346"><code>pointer&gt;?</code></a>: <a href="#ffi-memory-pointer">ffi memory pointer</a></li>
<li><a href="#index-pointer_003f-336"><code>pointer?</code></a>: <a href="#ffi-memory-pointer">ffi memory pointer</a></li>
<li><a href="#index-port_002ddump_002dstatus-332"><code>port-dump-status</code></a>: <a href="#iklib-io-misc">iklib io misc</a></li>
<li><a href="#index-port_002dfd-329"><code>port-fd</code></a>: <a href="#iklib-io-misc">iklib io misc</a></li>
<li><a href="#index-port_002did-330"><code>port-id</code></a>: <a href="#iklib-io-misc">iklib io misc</a></li>
<li><a href="#index-port_002dmode-25"><code>port-mode</code></a>: <a href="#iklib-reader-mode">iklib reader mode</a></li>
<li><a href="#index-port_002dtextual_002dposition-296"><code>port-textual-position</code></a>: <a href="#iklib-io-textual">iklib io textual</a></li>
<li><a href="#index-port_003f-940"><code>port?</code></a>: <a href="#syslib-ports">syslib ports</a></li>
<li><a href="#index-posix_002dread-572"><code>posix-read</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-posix_002dremove-546"><code>posix-remove</code></a>: <a href="#posix-link">posix link</a></li>
<li><a href="#index-posix_002dsyntax-1474"><code>posix-syntax</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-posix_002dtime-748"><code>posix-time</code></a>: <a href="#posix-time-functions">posix time functions</a></li>
<li><a href="#index-posix_002dwrite-575"><code>posix-write</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-post_002dgc_002dhooks-262"><code>post-gc-hooks</code></a>: <a href="#iklib-guardians-api">iklib guardians api</a></li>
<li><a href="#index-pread-574"><code>pread</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-pretty_002dprint-219"><code>pretty-print</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-pretty_002dwidth-221"><code>pretty-width</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-print_002dgensym-229"><code>print-gensym</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-print_002dgraph-65"><code>print-graph</code></a>: <a href="#iklib-shared">iklib shared</a></li>
<li><a href="#index-print_002dunicode-226"><code>print-unicode</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-printf-224"><code>printf</code></a>: <a href="#iklib-printing">iklib printing</a></li>
<li><a href="#index-property_002dlist-189"><code>property-list</code></a>: <a href="#iklib-symbols-plists">iklib symbols plists</a></li>
<li><a href="#index-protocol_002dentries-630"><code>protocol-entries</code></a>: <a href="#posix-socket-protocols">posix socket protocols</a></li>
<li><a href="#index-putprop-186"><code>putprop</code></a>: <a href="#iklib-symbols-plists">iklib symbols plists</a></li>
<li><a href="#index-pwrite-577"><code>pwrite</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-raise_002dsignal-480"><code>raise-signal</code></a>: <a href="#posix-signal">posix signal</a></li>
<li><a href="#index-rand-803"><code>rand</code></a>: <a href="#glibc-random">glibc random</a></li>
<li><a href="#index-ratnum_003f-191"><code>ratnum?</code></a>: <a href="#iklib-numerics-preds">iklib numerics preds</a></li>
<li><a href="#index-readdir-564"><code>readdir</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-readdir_002fstring-565"><code>readdir/string</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-readlink-541"><code>readlink</code></a>: <a href="#posix-link">posix link</a></li>
<li><a href="#index-readlink_002fstring-542"><code>readlink/string</code></a>: <a href="#posix-link">posix link</a></li>
<li><a href="#index-readv-579"><code>readv</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-realloc-351"><code>realloc</code></a>: <a href="#ffi-memory-alloc">ffi memory alloc</a></li>
<li><a href="#index-realpath-543"><code>realpath</code></a>: <a href="#posix-link">posix link</a></li>
<li><a href="#index-realpath_002fstring-544"><code>realpath/string</code></a>: <a href="#posix-link">posix link</a></li>
<li><a href="#index-recv-660"><code>recv</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-recvfrom-662"><code>recvfrom</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-ref-1209"><code>ref</code></a>: <a href="#objects-refs">objects refs</a></li>
<li><a href="#index-regcomp-808"><code>regcomp</code></a>: <a href="#glibc-match">glibc match</a></li>
<li><a href="#index-regexec-809"><code>regexec</code></a>: <a href="#glibc-match">glibc match</a></li>
<li><a href="#index-regexp_003f-1461"><code>regexp?</code></a>: <a href="#cre2-regexps">cre2 regexps</a></li>
<li><a href="#index-regfree-810"><code>regfree</code></a>: <a href="#glibc-match">glibc match</a></li>
<li><a href="#index-register_002dcallback-326"><code>register-callback</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-remprop-188"><code>remprop</code></a>: <a href="#iklib-symbols-plists">iklib symbols plists</a></li>
<li><a href="#index-rename-547"><code>rename</code></a>: <a href="#posix-link">posix link</a></li>
<li><a href="#index-rewinddir-567"><code>rewinddir</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-rmdir-550"><code>rmdir</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-s16b_002dlist_002d_003ebytevector-107"><code>s16b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s16l_002dlist_002d_003ebytevector-106"><code>s16l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s16n_002dlist_002d_003ebytevector-108"><code>s16n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s32b_002dlist_002d_003ebytevector-119"><code>s32b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s32l_002dlist_002d_003ebytevector-118"><code>s32l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s32n_002dlist_002d_003ebytevector-120"><code>s32n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s64b_002dlist_002d_003ebytevector-131"><code>s64b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s64l_002dlist_002d_003ebytevector-130"><code>s64l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s64n_002dlist_002d_003ebytevector-132"><code>s64n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-s8_002dlist_002d_003ebytevector-105"><code>s8-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-S_005fISBLK-516"><code>S_ISBLK</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-S_005fISCHR-515"><code>S_ISCHR</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-S_005fISDIR-514"><code>S_ISDIR</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-S_005fISFIFO-520"><code>S_ISFIFO</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-S_005fISLNK-518"><code>S_ISLNK</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-S_005fISREG-517"><code>S_ISREG</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-S_005fISSOCK-519"><code>S_ISSOCK</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-seekdir-569"><code>seekdir</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-select-581"><code>select</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-select_002dfd-582"><code>select-fd</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-send-659"><code>send</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-sendto-661"><code>sendto</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-service_002dentries-639"><code>service-entries</code></a>: <a href="#posix-socket-services">posix socket services</a></li>
<li><a href="#index-set_002dcase_002dsensitive_0021-1470"><code>set-case-sensitive!</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-set_002dliteral_0021-1468"><code>set-literal!</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-set_002dlog_002derrors_0021-1467"><code>set-log-errors!</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-set_002dlongest_002dmatch_0021-1466"><code>set-longest-match!</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-set_002dmax_002dmem_0021-1483"><code>set-max-mem!</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-set_002dnever_002dnl_0021-1469"><code>set-never-nl!</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-set_002done_002dline_0021-1473"><code>set-one-line!</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-set_002dperl_002dclasses_0021-1471"><code>set-perl-classes!</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-set_002dport_002dbuffer_002dmode_0021-331"><code>set-port-buffer-mode!</code></a>: <a href="#iklib-io-misc">iklib io misc</a></li>
<li><a href="#index-set_002dport_002dmode_0021-26"><code>set-port-mode!</code></a>: <a href="#iklib-reader-mode">iklib reader mode</a></li>
<li><a href="#index-set_002dposix_002dsyntax_0021-1465"><code>set-posix-syntax!</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-set_002drtd_002dprinter_0021-82"><code>set-rtd-printer!</code></a>: <a href="#iklib-structs-rtd">iklib structs rtd</a></li>
<li><a href="#index-set_002dsymbol_002dvalue_0021-183"><code>set-symbol-value!</code></a>: <a href="#iklib-symbols-value">iklib symbols value</a></li>
<li><a href="#index-set_002dword_002dboundary_0021-1472"><code>set-word-boundary!</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-setegid-680"><code>setegid</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-setenv-454"><code>setenv</code></a>: <a href="#posix-env">posix env</a></li>
<li><a href="#index-seteuid-677"><code>seteuid</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-setgid-681"><code>setgid</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-setpgid-711"><code>setpgid</code></a>: <a href="#posix-job">posix job</a></li>
<li><a href="#index-setregid-682"><code>setregid</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-setreuid-679"><code>setreuid</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-setsid-708"><code>setsid</code></a>: <a href="#posix-job">posix job</a></li>
<li><a href="#index-setsockopt-664"><code>setsockopt</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-setsockopt_002fint-666"><code>setsockopt/int</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-setsockopt_002fsize_005ft-668"><code>setsockopt/size_t</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-setuid-678"><code>setuid</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-shutdown-651"><code>shutdown</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-sinh-196"><code>sinh</code></a>: <a href="#iklib-numerics-math">iklib numerics math</a></li>
<li><a href="#index-sockaddr_005fin_002ein_005faddr-595"><code>sockaddr_in.in_addr</code></a>: <a href="#posix-socket-addresses-in">posix socket addresses in</a></li>
<li><a href="#index-sockaddr_005fin_002ein_005fport-596"><code>sockaddr_in.in_port</code></a>: <a href="#posix-socket-addresses-in">posix socket addresses in</a></li>
<li><a href="#index-sockaddr_005fin6_002ein6_005faddr-598"><code>sockaddr_in6.in6_addr</code></a>: <a href="#posix-socket-addresses-in6">posix socket addresses in6</a></li>
<li><a href="#index-sockaddr_005fin6_002ein6_005fport-599"><code>sockaddr_in6.in6_port</code></a>: <a href="#posix-socket-addresses-in6">posix socket addresses in6</a></li>
<li><a href="#index-sockaddr_005fun_002epathname-592"><code>sockaddr_un.pathname</code></a>: <a href="#posix-socket-addresses-local">posix socket addresses local</a></li>
<li><a href="#index-sockaddr_005fun_002epathname_002fstring-593"><code>sockaddr_un.pathname/string</code></a>: <a href="#posix-socket-addresses-local">posix socket addresses local</a></li>
<li><a href="#index-socket-650"><code>socket</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-socketpair-652"><code>socketpair</code></a>: <a href="#posix-socket-socket">posix socket socket</a></li>
<li><a href="#index-source_002dposition_002dcharacter-19"><code>source-position-character</code></a>: <a href="#iklib-conditions-spos">iklib conditions spos</a></li>
<li><a href="#index-source_002dposition_002dcondition_003f-17"><code>source-position-condition?</code></a>: <a href="#iklib-conditions-spos">iklib conditions spos</a></li>
<li><a href="#index-source_002dposition_002dport_002did-18"><code>source-position-port-id</code></a>: <a href="#iklib-conditions-spos">iklib conditions spos</a></li>
<li><a href="#index-srand-804"><code>srand</code></a>: <a href="#glibc-random">glibc random</a></li>
<li><a href="#index-stat-501"><code>stat</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-stats_002dbytes_002dmajor-259"><code>stats-bytes-major</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dbytes_002dminor-258"><code>stats-bytes-minor</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dcollection_002did-251"><code>stats-collection-id</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dgc_002dreal_002dsecs-256"><code>stats-gc-real-secs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dgc_002dreal_002dusecs-257"><code>stats-gc-real-usecs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dgc_002dsys_002dsecs-254"><code>stats-gc-sys-secs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dgc_002dsys_002dusecs-255"><code>stats-gc-sys-usecs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dgc_002duser_002dsecs-252"><code>stats-gc-user-secs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dgc_002duser_002dusecs-253"><code>stats-gc-user-usecs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dreal_002dsecs-249"><code>stats-real-secs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dreal_002dusecs-250"><code>stats-real-usecs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dsys_002dsecs-247"><code>stats-sys-secs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002dsys_002dusecs-248"><code>stats-sys-usecs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002duser_002dsecs-245"><code>stats-user-secs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_002duser_002dusecs-246"><code>stats-user-usecs</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-stats_003f-244"><code>stats?</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-strcmp-416"><code>strcmp</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-strdup-418"><code>strdup</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-strerror-757"><code>strerror</code></a>: <a href="#posix-misc">posix misc</a></li>
<li><a href="#index-strftime-754"><code>strftime</code></a>: <a href="#posix-time-functions">posix time functions</a></li>
<li><a href="#index-strftime_002fstring-755"><code>strftime/string</code></a>: <a href="#posix-time-functions">posix time functions</a></li>
<li><a href="#index-string_002d_003ecstring-411"><code>string-&gt;cstring</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-string_002d_003efilename_002dfunc-263"><code>string-&gt;filename-func</code></a>: <a href="#iklib-io-filename">iklib io filename</a></li>
<li><a href="#index-string_002d_003eguarded_002dcstring-412"><code>string-&gt;guarded-cstring</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-string_002d_003elatin1-168"><code>string-&gt;latin1</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-string_002d_003eutf16be-171"><code>string-&gt;utf16be</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-string_002d_003eutf16le-170"><code>string-&gt;utf16le</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-string_002d_003eutf16n-172"><code>string-&gt;utf16n</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-string_002dcopy_0021-167"><code>string-copy!</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-string_002dport_002dbuffer_002dsize-307"><code>string-port-buffer-size</code></a>: <a href="#iklib-io-buffer">iklib io buffer</a></li>
<li><a href="#index-strings_002d_003eargv-425"><code>strings-&gt;argv</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-strings_002d_003eguarded_002dargv-426"><code>strings-&gt;guarded-argv</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-strlen-415"><code>strlen</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-strncmp-417"><code>strncmp</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-strndup-420"><code>strndup</code></a>: <a href="#ffi-cstrings">ffi cstrings</a></li>
<li><a href="#index-struct_002daddrinfo_002dai_005faddr-616"><code>struct-addrinfo-ai_addr</code></a>: <a href="#posix-socket-addresses-info">posix socket addresses info</a></li>
<li><a href="#index-struct_002daddrinfo_002dai_005faddrlen-615"><code>struct-addrinfo-ai_addrlen</code></a>: <a href="#posix-socket-addresses-info">posix socket addresses info</a></li>
<li><a href="#index-struct_002daddrinfo_002dai_005fcanonname-617"><code>struct-addrinfo-ai_canonname</code></a>: <a href="#posix-socket-addresses-info">posix socket addresses info</a></li>
<li><a href="#index-struct_002daddrinfo_002dai_005ffamily-612"><code>struct-addrinfo-ai_family</code></a>: <a href="#posix-socket-addresses-info">posix socket addresses info</a></li>
<li><a href="#index-struct_002daddrinfo_002dai_005fflags-611"><code>struct-addrinfo-ai_flags</code></a>: <a href="#posix-socket-addresses-info">posix socket addresses info</a></li>
<li><a href="#index-struct_002daddrinfo_002dai_005fprotocol-614"><code>struct-addrinfo-ai_protocol</code></a>: <a href="#posix-socket-addresses-info">posix socket addresses info</a></li>
<li><a href="#index-struct_002daddrinfo_002dai_005fsocktype-613"><code>struct-addrinfo-ai_socktype</code></a>: <a href="#posix-socket-addresses-info">posix socket addresses info</a></li>
<li><a href="#index-struct_002daddrinfo_003f-610"><code>struct-addrinfo?</code></a>: <a href="#posix-socket-addresses-info">posix socket addresses info</a></li>
<li><a href="#index-struct_002dconstructor-83"><code>struct-constructor</code></a>: <a href="#iklib-structs-using">iklib structs using</a></li>
<li><a href="#index-struct_002dfield_002daccessor-85"><code>struct-field-accessor</code></a>: <a href="#iklib-structs-using">iklib structs using</a></li>
<li><a href="#index-struct_002dfield_002dmutator-86"><code>struct-field-mutator</code></a>: <a href="#iklib-structs-using">iklib structs using</a></li>
<li><a href="#index-struct_002dgroup_002dgr_005fgid-701"><code>struct-group-gr_gid</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-struct_002dgroup_002dgr_005fmem-702"><code>struct-group-gr_mem</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-struct_002dgroup_002dgr_005fname-700"><code>struct-group-gr_name</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-struct_002dlength-90"><code>struct-length</code></a>: <a href="#iklib-structs-inspect">iklib structs inspect</a></li>
<li><a href="#index-struct_002dname-91"><code>struct-name</code></a>: <a href="#iklib-structs-inspect">iklib structs inspect</a></li>
<li><a href="#index-struct_002dnetent_002dn_005faddrtype-644"><code>struct-netent-n_addrtype</code></a>: <a href="#posix-socket-networks">posix socket networks</a></li>
<li><a href="#index-struct_002dnetent_002dn_005faliases-643"><code>struct-netent-n_aliases</code></a>: <a href="#posix-socket-networks">posix socket networks</a></li>
<li><a href="#index-struct_002dnetent_002dn_005fname-642"><code>struct-netent-n_name</code></a>: <a href="#posix-socket-networks">posix socket networks</a></li>
<li><a href="#index-struct_002dnetent_002dn_005fnet-645"><code>struct-netent-n_net</code></a>: <a href="#posix-socket-networks">posix socket networks</a></li>
<li><a href="#index-struct_002dnetent_003f-646"><code>struct-netent?</code></a>: <a href="#posix-socket-networks">posix socket networks</a></li>
<li><a href="#index-struct_002dpasswd_002dpw_005fdir-693"><code>struct-passwd-pw_dir</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-struct_002dpasswd_002dpw_005fgecos-692"><code>struct-passwd-pw_gecos</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-struct_002dpasswd_002dpw_005fgid-691"><code>struct-passwd-pw_gid</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-struct_002dpasswd_002dpw_005fname-688"><code>struct-passwd-pw_name</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-struct_002dpasswd_002dpw_005fpasswd-689"><code>struct-passwd-pw_passwd</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-struct_002dpasswd_002dpw_005fshell-694"><code>struct-passwd-pw_shell</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-struct_002dpasswd_002dpw_005fuid-690"><code>struct-passwd-pw_uid</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-struct_002dpasswd_003f-687"><code>struct-passwd?</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-struct_002dpredicate-84"><code>struct-predicate</code></a>: <a href="#iklib-structs-using">iklib structs using</a></li>
<li><a href="#index-struct_002dprinter-92"><code>struct-printer</code></a>: <a href="#iklib-structs-inspect">iklib structs inspect</a></li>
<li><a href="#index-struct_002dprotoent_002dp_005faliases-626"><code>struct-protoent-p_aliases</code></a>: <a href="#posix-socket-protocols">posix socket protocols</a></li>
<li><a href="#index-struct_002dprotoent_002dp_005fname-625"><code>struct-protoent-p_name</code></a>: <a href="#posix-socket-protocols">posix socket protocols</a></li>
<li><a href="#index-struct_002dprotoent_002dp_005fproto-627"><code>struct-protoent-p_proto</code></a>: <a href="#posix-socket-protocols">posix socket protocols</a></li>
<li><a href="#index-struct_002dref-93"><code>struct-ref</code></a>: <a href="#iklib-structs-inspect">iklib structs inspect</a></li>
<li><a href="#index-struct_002drtd-89"><code>struct-rtd</code></a>: <a href="#iklib-structs-inspect">iklib structs inspect</a></li>
<li><a href="#index-struct_002dservent_002ds_005faliases-634"><code>struct-servent-s_aliases</code></a>: <a href="#posix-socket-services">posix socket services</a></li>
<li><a href="#index-struct_002dservent_002ds_005fname-633"><code>struct-servent-s_name</code></a>: <a href="#posix-socket-services">posix socket services</a></li>
<li><a href="#index-struct_002dservent_002ds_005fport-636"><code>struct-servent-s_port</code></a>: <a href="#posix-socket-services">posix socket services</a></li>
<li><a href="#index-struct_002dservent_002ds_005fproto-635"><code>struct-servent-s_proto</code></a>: <a href="#posix-socket-services">posix socket services</a></li>
<li><a href="#index-struct_002dset_0021-94"><code>struct-set!</code></a>: <a href="#iklib-structs-inspect">iklib structs inspect</a></li>
<li><a href="#index-struct_002dsiginfo_005ft_002dsi_005fcode-837"><code>struct-siginfo_t-si_code</code></a>: <a href="#linux-status">linux status</a></li>
<li><a href="#index-struct_002dsiginfo_005ft_002dsi_005fpid-833"><code>struct-siginfo_t-si_pid</code></a>: <a href="#linux-status">linux status</a></li>
<li><a href="#index-struct_002dsiginfo_005ft_002dsi_005fsigno-835"><code>struct-siginfo_t-si_signo</code></a>: <a href="#linux-status">linux status</a></li>
<li><a href="#index-struct_002dsiginfo_005ft_002dsi_005fstatus-836"><code>struct-siginfo_t-si_status</code></a>: <a href="#linux-status">linux status</a></li>
<li><a href="#index-struct_002dsiginfo_005ft_002dsi_005fuid-834"><code>struct-siginfo_t-si_uid</code></a>: <a href="#linux-status">linux status</a></li>
<li><a href="#index-struct_002dsiginfo_005ft_003f-832"><code>struct-siginfo_t?</code></a>: <a href="#linux-status">linux status</a></li>
<li><a href="#index-struct_002dstat_002dst_005fatime-493"><code>struct-stat-st_atime</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dstat_002dst_005fatime_005fusec-494"><code>struct-stat-st_atime_usec</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dstat_002dst_005fblksize-500"><code>struct-stat-st_blksize</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dstat_002dst_005fblocks-499"><code>struct-stat-st_blocks</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dstat_002dst_005fctime-497"><code>struct-stat-st_ctime</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dstat_002dst_005fctime_005fusec-498"><code>struct-stat-st_ctime_usec</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dstat_002dst_005fdev-488"><code>struct-stat-st_dev</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dstat_002dst_005fgid-491"><code>struct-stat-st_gid</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dstat_002dst_005fino-487"><code>struct-stat-st_ino</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dstat_002dst_005fmode-486"><code>struct-stat-st_mode</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dstat_002dst_005fmtime-495"><code>struct-stat-st_mtime</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dstat_002dst_005fmtime_005fusec-496"><code>struct-stat-st_mtime_usec</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dstat_002dst_005fnlink-489"><code>struct-stat-st_nlink</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dstat_002dst_005fsize-492"><code>struct-stat-st_size</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dstat_002dst_005fuid-490"><code>struct-stat-st_uid</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dstat_003f-485"><code>struct-stat?</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dtimespec_002dtv_005fsec-723"><code>struct-timespec-tv_sec</code></a>: <a href="#posix-time-timespec">posix time timespec</a></li>
<li><a href="#index-struct_002dtimespec_002dtv_005fusec-724"><code>struct-timespec-tv_usec</code></a>: <a href="#posix-time-timespec">posix time timespec</a></li>
<li><a href="#index-struct_002dtimespec_003f-722"><code>struct-timespec?</code></a>: <a href="#posix-time-timespec">posix time timespec</a></li>
<li><a href="#index-struct_002dtimeval_002dtv_005fsec-718"><code>struct-timeval-tv_sec</code></a>: <a href="#posix-time-timeval">posix time timeval</a></li>
<li><a href="#index-struct_002dtimeval_002dtv_005fusec-719"><code>struct-timeval-tv_usec</code></a>: <a href="#posix-time-timeval">posix time timeval</a></li>
<li><a href="#index-struct_002dtimeval_003f-717"><code>struct-timeval?</code></a>: <a href="#posix-time-timeval">posix time timeval</a></li>
<li><a href="#index-struct_002dtm_002dtm_005fgmtoff-744"><code>struct-tm-tm_gmtoff</code></a>: <a href="#posix-time-tm">posix time tm</a></li>
<li><a href="#index-struct_002dtm_002dtm_005fhour-737"><code>struct-tm-tm_hour</code></a>: <a href="#posix-time-tm">posix time tm</a></li>
<li><a href="#index-struct_002dtm_002dtm_005fisdst-743"><code>struct-tm-tm_isdst</code></a>: <a href="#posix-time-tm">posix time tm</a></li>
<li><a href="#index-struct_002dtm_002dtm_005fmday-738"><code>struct-tm-tm_mday</code></a>: <a href="#posix-time-tm">posix time tm</a></li>
<li><a href="#index-struct_002dtm_002dtm_005fmin-736"><code>struct-tm-tm_min</code></a>: <a href="#posix-time-tm">posix time tm</a></li>
<li><a href="#index-struct_002dtm_002dtm_005fmon-739"><code>struct-tm-tm_mon</code></a>: <a href="#posix-time-tm">posix time tm</a></li>
<li><a href="#index-struct_002dtm_002dtm_005fsec-735"><code>struct-tm-tm_sec</code></a>: <a href="#posix-time-tm">posix time tm</a></li>
<li><a href="#index-struct_002dtm_002dtm_005fwday-741"><code>struct-tm-tm_wday</code></a>: <a href="#posix-time-tm">posix time tm</a></li>
<li><a href="#index-struct_002dtm_002dtm_005fyday-742"><code>struct-tm-tm_yday</code></a>: <a href="#posix-time-tm">posix time tm</a></li>
<li><a href="#index-struct_002dtm_002dtm_005fyear-740"><code>struct-tm-tm_year</code></a>: <a href="#posix-time-tm">posix time tm</a></li>
<li><a href="#index-struct_002dtm_002dtm_005fzone-745"><code>struct-tm-tm_zone</code></a>: <a href="#posix-time-tm">posix time tm</a></li>
<li><a href="#index-struct_002dtm_003f-734"><code>struct-tm?</code></a>: <a href="#posix-time-tm">posix time tm</a></li>
<li><a href="#index-struct_002dtms_002dtms_005fcstime-731"><code>struct-tms-tms_cstime</code></a>: <a href="#posix-time-tms">posix time tms</a></li>
<li><a href="#index-struct_002dtms_002dtms_005fcutime-730"><code>struct-tms-tms_cutime</code></a>: <a href="#posix-time-tms">posix time tms</a></li>
<li><a href="#index-struct_002dtms_002dtms_005fstime-729"><code>struct-tms-tms_stime</code></a>: <a href="#posix-time-tms">posix time tms</a></li>
<li><a href="#index-struct_002dtms_002dtms_005futime-728"><code>struct-tms-tms_utime</code></a>: <a href="#posix-time-tms">posix time tms</a></li>
<li><a href="#index-struct_002dtms_003f-727"><code>struct-tms?</code></a>: <a href="#posix-time-tms">posix time tms</a></li>
<li><a href="#index-struct_002dtype_002dfield_002dnames-81"><code>struct-type-field-names</code></a>: <a href="#iklib-structs-rtd">iklib structs rtd</a></li>
<li><a href="#index-struct_002dtype_002dname-79"><code>struct-type-name</code></a>: <a href="#iklib-structs-rtd">iklib structs rtd</a></li>
<li><a href="#index-struct_002dtype_002dsymbol-80"><code>struct-type-symbol</code></a>: <a href="#iklib-structs-rtd">iklib structs rtd</a></li>
<li><a href="#index-struct_003f-87"><code>struct?</code></a>: <a href="#iklib-structs-inspect">iklib structs inspect</a></li>
<li><a href="#index-subbytevector_002ds8-101"><code>subbytevector-s8</code></a>: <a href="#iklib-bytevectors-sub">iklib bytevectors sub</a></li>
<li><a href="#index-subbytevector_002ds8_002fcount-103"><code>subbytevector-s8/count</code></a>: <a href="#iklib-bytevectors-sub">iklib bytevectors sub</a></li>
<li><a href="#index-subbytevector_002du8-98"><code>subbytevector-u8</code></a>: <a href="#iklib-bytevectors-sub">iklib bytevectors sub</a></li>
<li><a href="#index-subbytevector_002du8_002fcount-100"><code>subbytevector-u8/count</code></a>: <a href="#iklib-bytevectors-sub">iklib bytevectors sub</a></li>
<li><a href="#index-subvector-177"><code>subvector</code></a>: <a href="#iklib-vectors">iklib vectors</a></li>
<li><a href="#index-symbol_002dbound_003f-185"><code>symbol-bound?</code></a>: <a href="#iklib-symbols-value">iklib symbols value</a></li>
<li><a href="#index-symbol_002dvalue-184"><code>symbol-value</code></a>: <a href="#iklib-symbols-value">iklib symbols value</a></li>
<li><a href="#index-symlink-540"><code>symlink</code></a>: <a href="#posix-link">posix link</a></li>
<li><a href="#index-sync-763"><code>sync</code></a>: <a href="#glibc-sync">glibc sync</a></li>
<li><a href="#index-sysconf-813"><code>sysconf</code></a>: <a href="#glibc-config">glibc config</a></li>
<li><a href="#index-system-462"><code>system</code></a>: <a href="#posix-process">posix process</a></li>
<li><a href="#index-table_002d_003eenviron-459"><code>table-&gt;environ</code></a>: <a href="#posix-env">posix env</a></li>
<li><a href="#index-tanh-198"><code>tanh</code></a>: <a href="#iklib-numerics-math">iklib numerics math</a></li>
<li><a href="#index-tcgetpgrp-712"><code>tcgetpgrp</code></a>: <a href="#posix-job">posix job</a></li>
<li><a href="#index-tcgetsid-714"><code>tcgetsid</code></a>: <a href="#posix-job">posix job</a></li>
<li><a href="#index-tcp_002dconnect-317"><code>tcp-connect</code></a>: <a href="#iklib-io-socket-client">iklib io socket client</a></li>
<li><a href="#index-tcp_002dconnect_002dnonblocking-319"><code>tcp-connect-nonblocking</code></a>: <a href="#iklib-io-socket-client">iklib io socket client</a></li>
<li><a href="#index-tcp_002dserver_002dsocket-321"><code>tcp-server-socket</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-tcp_002dserver_002dsocket_002dnonblocking-322"><code>tcp-server-socket-nonblocking</code></a>: <a href="#iklib-io-socket-server">iklib io socket server</a></li>
<li><a href="#index-tcsetpgrp-713"><code>tcsetpgrp</code></a>: <a href="#posix-job">posix job</a></li>
<li><a href="#index-telldir-568"><code>telldir</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-tgamma-796"><code>tgamma</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-time-241"><code>time</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-time_002dand_002dgather-243"><code>time-and-gather</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-time_002dit-242"><code>time-it</code></a>: <a href="#iklib-timing">iklib timing</a></li>
<li><a href="#index-timegm-753"><code>timegm</code></a>: <a href="#posix-time-functions">posix time functions</a></li>
<li><a href="#index-timelocal-752"><code>timelocal</code></a>: <a href="#posix-time-functions">posix time functions</a></li>
<li><a href="#index-times-747"><code>times</code></a>: <a href="#posix-time-functions">posix time functions</a></li>
<li><a href="#index-top_002dlevel_002dvalue-851"><code>top-level-value</code></a>: <a href="#syslib-symbols">syslib symbols</a></li>
<li><a href="#index-trace_002ddefine-237"><code>trace-define</code></a>: <a href="#iklib-tracing">iklib tracing</a></li>
<li><a href="#index-trace_002dlambda-239"><code>trace-lambda</code></a>: <a href="#iklib-tracing">iklib tracing</a></li>
<li><a href="#index-true_005fobject-1211"><code>true_object</code></a>: <a href="#objects-refs">objects refs</a></li>
<li><a href="#index-type_002ddescriptor-78"><code>type-descriptor</code></a>: <a href="#iklib-structs-rtd">iklib structs rtd</a></li>
<li><a href="#index-u16b_002dlist_002d_003ebytevector-110"><code>u16b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u16l_002dlist_002d_003ebytevector-109"><code>u16l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u16n_002dlist_002d_003ebytevector-111"><code>u16n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u32b_002dlist_002d_003ebytevector-122"><code>u32b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u32l_002dlist_002d_003ebytevector-121"><code>u32l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u32n_002dlist_002d_003ebytevector-123"><code>u32n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u64b_002dlist_002d_003ebytevector-134"><code>u64b-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u64l_002dlist_002d_003ebytevector-133"><code>u64l-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-u64n_002dlist_002d_003ebytevector-135"><code>u64n-list-&gt;bytevector</code></a>: <a href="#iklib-bytevectors-conv">iklib bytevectors conv</a></li>
<li><a href="#index-udp_002dconnect-318"><code>udp-connect</code></a>: <a href="#iklib-io-socket-client">iklib io socket client</a></li>
<li><a href="#index-udp_002dconnect_002dnonblocking-320"><code>udp-connect-nonblocking</code></a>: <a href="#iklib-io-socket-client">iklib io socket client</a></li>
<li><a href="#index-umask-533"><code>umask</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-unbound_005fobject-1215"><code>unbound_object</code></a>: <a href="#objects-refs">objects refs</a></li>
<li><a href="#index-unfix-1228"><code>unfix</code></a>: <a href="#objects-fixnums">objects fixnums</a></li>
<li><a href="#index-unlink-545"><code>unlink</code></a>: <a href="#posix-link">posix link</a></li>
<li><a href="#index-unsetenv-455"><code>unsetenv</code></a>: <a href="#posix-env">posix env</a></li>
<li><a href="#index-user_002dentries-697"><code>user-entries</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-utf_002d16be_002dcodec-273"><code>utf-16be-codec</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-utf_002d16le_002dcodec-272"><code>utf-16le-codec</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-utf_002d16n_002dcodec-274"><code>utf-16n-codec</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-utf_002dbom_002dcodec-275"><code>utf-bom-codec</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-utf16be_002d_003estring-174"><code>utf16be-&gt;string</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-utf16le_002d_003estring-173"><code>utf16le-&gt;string</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-utf16n_002d_003estring-175"><code>utf16n-&gt;string</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-utime-535"><code>utime</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-utimes-536"><code>utimes</code></a>: <a href="#posix-file">posix file</a></li>
<li><a href="#index-uuid-176"><code>uuid</code></a>: <a href="#iklib-strings">iklib strings</a></li>
<li><a href="#index-vector_002dappend-178"><code>vector-append</code></a>: <a href="#iklib-vectors">iklib vectors</a></li>
<li><a href="#index-vector_002dcopy-179"><code>vector-copy</code></a>: <a href="#iklib-vectors">iklib vectors</a></li>
<li><a href="#index-vector_002dcopy_0021-180"><code>vector-copy!</code></a>: <a href="#iklib-vectors">iklib vectors</a></li>
<li><a href="#index-vector_002dexists-182"><code>vector-exists</code></a>: <a href="#iklib-vectors">iklib vectors</a></li>
<li><a href="#index-vector_002dfor_002dall-181"><code>vector-for-all</code></a>: <a href="#iklib-vectors">iklib vectors</a></li>
<li><a href="#index-version_002dinterface_002dage-1457"><code>version-interface-age</code></a>: <a href="#cre2-version">cre2 version</a></li>
<li><a href="#index-version_002dinterface_002dcurrent-1455"><code>version-interface-current</code></a>: <a href="#cre2-version">cre2 version</a></li>
<li><a href="#index-version_002dinterface_002drevision-1456"><code>version-interface-revision</code></a>: <a href="#cre2-version">cre2 version</a></li>
<li><a href="#index-void-333"><code>void</code></a>: <a href="#iklib-misc">iklib misc</a></li>
<li><a href="#index-void_005fobject-1214"><code>void_object</code></a>: <a href="#objects-refs">objects refs</a></li>
<li><a href="#index-wait-472"><code>wait</code></a>: <a href="#posix-status">posix status</a></li>
<li><a href="#index-waitid-829"><code>waitid</code></a>: <a href="#linux-status">linux status</a></li>
<li><a href="#index-waitpid-471"><code>waitpid</code></a>: <a href="#posix-status">posix status</a></li>
<li><a href="#index-WCOREDUMP-477"><code>WCOREDUMP</code></a>: <a href="#posix-status">posix status</a></li>
<li><a href="#index-weak_002dcons-95"><code>weak-cons</code></a>: <a href="#iklib-lists-weak">iklib lists weak</a></li>
<li><a href="#index-weak_002dpair_003f-96"><code>weak-pair?</code></a>: <a href="#iklib-lists-weak">iklib lists weak</a></li>
<li><a href="#index-WEXITSTATUS-474"><code>WEXITSTATUS</code></a>: <a href="#posix-status">posix status</a></li>
<li><a href="#index-WIFCONTINUED-838"><code>WIFCONTINUED</code></a>: <a href="#linux-status">linux status</a></li>
<li><a href="#index-WIFEXITED-473"><code>WIFEXITED</code></a>: <a href="#posix-status">posix status</a></li>
<li><a href="#index-WIFSIGNALED-475"><code>WIFSIGNALED</code></a>: <a href="#posix-status">posix status</a></li>
<li><a href="#index-WIFSTOPPED-478"><code>WIFSTOPPED</code></a>: <a href="#posix-status">posix status</a></li>
<li><a href="#index-with_002dinput_002dfrom_002dfile-267"><code>with-input-from-file</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-with_002dlocal_002dstorage-356"><code>with-local-storage</code></a>: <a href="#ffi-memory-alloc">ffi memory alloc</a></li>
<li><a href="#index-with_002doutput_002dto_002dfile-270"><code>with-output-to-file</code></a>: <a href="#iklib-io-codecs">iklib io codecs</a></li>
<li><a href="#index-word_002dboundary-1481"><code>word-boundary</code></a>: <a href="#cre2-options">cre2 options</a></li>
<li><a href="#index-wordexp-811"><code>wordexp</code></a>: <a href="#glibc-word">glibc word</a></li>
<li><a href="#index-wordexp_002fstring-812"><code>wordexp/string</code></a>: <a href="#glibc-word">glibc word</a></li>
<li><a href="#index-writev-580"><code>writev</code></a>: <a href="#posix-fd">posix fd</a></li>
<li><a href="#index-WSTOPSIG-479"><code>WSTOPSIG</code></a>: <a href="#posix-status">posix status</a></li>
<li><a href="#index-WTERMSIG-476"><code>WTERMSIG</code></a>: <a href="#posix-status">posix status</a></li>
<li><a href="#index-y0-800"><code>y0</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-y1-801"><code>y1</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-yn-802"><code>yn</code></a>: <a href="#glibc-math">glibc math</a></li>
<li><a href="#index-g_t_007c_0040var_007bsymbol_007d_007c-58"><code>|</code><var>symbol</var><code>|</code></a>: <a href="#iklib-reader-stx">iklib reader stx</a></li>
   </ul><div class="node">
<a name="variable-index"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#type-index">type index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#function-index">function index</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix K An entry for each variable</h2>



<ul class="index-vr" compact>
<li><a href="#index-bignum_005fmask-1341"><code>bignum_mask</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-bignum_005fnlimbs_005fshift-1345"><code>bignum_nlimbs_shift</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-bignum_005fsign_005fmask-1343"><code>bignum_sign_mask</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-bignum_005fsign_005fshift-1344"><code>bignum_sign_shift</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-bignum_005ftag-1342"><code>bignum_tag</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-bytevector_005ftag-1253"><code>bytevector_tag</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-cflonum_005fsize-1413"><code>cflonum_size</code></a>: <a href="#objects-cflonums">objects cflonums</a></li>
<li><a href="#index-cflonum_005ftag-1414"><code>cflonum_tag</code></a>: <a href="#objects-cflonums">objects cflonums</a></li>
<li><a href="#index-char_005fmask-1306"><code>char_mask</code></a>: <a href="#objects-chars">objects chars</a></li>
<li><a href="#index-char_005fshift-1308"><code>char_shift</code></a>: <a href="#objects-chars">objects chars</a></li>
<li><a href="#index-char_005ftag-1307"><code>char_tag</code></a>: <a href="#objects-chars">objects chars</a></li>
<li><a href="#index-compnum_005fsize-1400"><code>compnum_size</code></a>: <a href="#objects-compnums">objects compnums</a></li>
<li><a href="#index-compnum_005ftag-1401"><code>compnum_tag</code></a>: <a href="#objects-compnums">objects compnums</a></li>
<li><a href="#index-disp_005fbignum_005fdata-1347"><code>disp_bignum_data</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-disp_005fbignum_005ftag-1346"><code>disp_bignum_tag</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-disp_005fbytevector_005fdata-1255"><code>disp_bytevector_data</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-disp_005fbytevector_005flength-1254"><code>disp_bytevector_length</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-disp_005fcar-1233"><code>disp_car</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-disp_005fcdr-1234"><code>disp_cdr</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-disp_005fcflonum_005fimag-1417"><code>disp_cflonum_imag</code></a>: <a href="#objects-cflonums">objects cflonums</a></li>
<li><a href="#index-disp_005fcflonum_005freal-1416"><code>disp_cflonum_real</code></a>: <a href="#objects-cflonums">objects cflonums</a></li>
<li><a href="#index-disp_005fcflonum_005ftag-1415"><code>disp_cflonum_tag</code></a>: <a href="#objects-cflonums">objects cflonums</a></li>
<li><a href="#index-disp_005fcompnum_005fimag-1404"><code>disp_compnum_imag</code></a>: <a href="#objects-compnums">objects compnums</a></li>
<li><a href="#index-disp_005fcompnum_005freal-1403"><code>disp_compnum_real</code></a>: <a href="#objects-compnums">objects compnums</a></li>
<li><a href="#index-disp_005fcompnum_005ftag-1402"><code>disp_compnum_tag</code></a>: <a href="#objects-compnums">objects compnums</a></li>
<li><a href="#index-disp_005fflonum_005fdata-1393"><code>disp_flonum_data</code></a>: <a href="#objects-flonums">objects flonums</a></li>
<li><a href="#index-disp_005fflonum_005ftag-1392"><code>disp_flonum_tag</code></a>: <a href="#objects-flonums">objects flonums</a></li>
<li><a href="#index-disp_005fpointer_005fdata-1429"><code>disp_pointer_data</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-disp_005fpointer_005ftag-1428"><code>disp_pointer_tag</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-disp_005fratnum_005fden-1381"><code>disp_ratnum_den</code></a>: <a href="#objects-ratnums">objects ratnums</a></li>
<li><a href="#index-disp_005fratnum_005fnum-1380"><code>disp_ratnum_num</code></a>: <a href="#objects-ratnums">objects ratnums</a></li>
<li><a href="#index-disp_005fratnum_005ftag-1379"><code>disp_ratnum_tag</code></a>: <a href="#objects-ratnums">objects ratnums</a></li>
<li><a href="#index-disp_005frecord_005fdata-1285"><code>disp_record_data</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-disp_005frecord_005frtd-1284"><code>disp_record_rtd</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-disp_005frtd_005ffields-1291"><code>disp_rtd_fields</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-disp_005frtd_005flength-1290"><code>disp_rtd_length</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-disp_005frtd_005fname-1289"><code>disp_rtd_name</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-disp_005frtd_005fprinter-1292"><code>disp_rtd_printer</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-disp_005frtd_005frtd-1288"><code>disp_rtd_rtd</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-disp_005frtd_005fsymbol-1293"><code>disp_rtd_symbol</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-disp_005fstring_005fdata-1317"><code>disp_string_data</code></a>: <a href="#objects-strings">objects strings</a></li>
<li><a href="#index-disp_005fstring_005flength-1316"><code>disp_string_length</code></a>: <a href="#objects-strings">objects strings</a></li>
<li><a href="#index-disp_005fsymbol_005frecord_005fplist-1333"><code>disp_symbol_record_plist</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-disp_005fsymbol_005frecord_005fproc-1332"><code>disp_symbol_record_proc</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-disp_005fsymbol_005frecord_005fstring-1329"><code>disp_symbol_record_string</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-disp_005fsymbol_005frecord_005ftag-1328"><code>disp_symbol_record_tag</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-disp_005fsymbol_005frecord_005fustring-1330"><code>disp_symbol_record_ustring</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-disp_005fsymbol_005frecord_005fvalue-1331"><code>disp_symbol_record_value</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-disp_005fvector_005fdata-1271"><code>disp_vector_data</code></a>: <a href="#objects-vectors">objects vectors</a></li>
<li><a href="#index-disp_005fvector_005flength-1270"><code>disp_vector_length</code></a>: <a href="#objects-vectors">objects vectors</a></li>
<li><a href="#index-flonum_005fsize-1390"><code>flonum_size</code></a>: <a href="#objects-flonums">objects flonums</a></li>
<li><a href="#index-flonum_005ftag-1391"><code>flonum_tag</code></a>: <a href="#objects-flonums">objects flonums</a></li>
<li><a href="#index-iconv_002dencoding_002duniverse-820"><code>iconv-encoding-universe</code></a>: <a href="#glibc-iconv-set">glibc iconv set</a></li>
<li><a href="#index-off_005fbignum_005fdata-1349"><code>off_bignum_data</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-off_005fbignum_005ftag-1348"><code>off_bignum_tag</code></a>: <a href="#objects-bignums">objects bignums</a></li>
<li><a href="#index-off_005fbytevector_005fdata-1257"><code>off_bytevector_data</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-off_005fbytevector_005flength-1256"><code>off_bytevector_length</code></a>: <a href="#objects-bytevectors">objects bytevectors</a></li>
<li><a href="#index-off_005fcar-1235"><code>off_car</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-off_005fcdr-1236"><code>off_cdr</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-off_005fcflonum_005fimag-1420"><code>off_cflonum_imag</code></a>: <a href="#objects-cflonums">objects cflonums</a></li>
<li><a href="#index-off_005fcflonum_005freal-1419"><code>off_cflonum_real</code></a>: <a href="#objects-cflonums">objects cflonums</a></li>
<li><a href="#index-off_005fcflonum_005ftag-1418"><code>off_cflonum_tag</code></a>: <a href="#objects-cflonums">objects cflonums</a></li>
<li><a href="#index-off_005fcompnum_005fimag-1407"><code>off_compnum_imag</code></a>: <a href="#objects-compnums">objects compnums</a></li>
<li><a href="#index-off_005fcompnum_005freal-1406"><code>off_compnum_real</code></a>: <a href="#objects-compnums">objects compnums</a></li>
<li><a href="#index-off_005fcompnum_005ftag-1405"><code>off_compnum_tag</code></a>: <a href="#objects-compnums">objects compnums</a></li>
<li><a href="#index-off_005fflonum_005fdata-1395"><code>off_flonum_data</code></a>: <a href="#objects-flonums">objects flonums</a></li>
<li><a href="#index-off_005fflonum_005ftag-1394"><code>off_flonum_tag</code></a>: <a href="#objects-flonums">objects flonums</a></li>
<li><a href="#index-off_005fpointer_005fdata-1431"><code>off_pointer_data</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-off_005fpointer_005ftag-1430"><code>off_pointer_tag</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-off_005fratnum_005fden-1384"><code>off_ratnum_den</code></a>: <a href="#objects-ratnums">objects ratnums</a></li>
<li><a href="#index-off_005fratnum_005fnum-1383"><code>off_ratnum_num</code></a>: <a href="#objects-ratnums">objects ratnums</a></li>
<li><a href="#index-off_005fratnum_005ftag-1382"><code>off_ratnum_tag</code></a>: <a href="#objects-ratnums">objects ratnums</a></li>
<li><a href="#index-off_005frecord_005fdata-1287"><code>off_record_data</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-off_005frecord_005frtd-1286"><code>off_record_rtd</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-off_005frtd_005ffields-1298"><code>off_rtd_fields</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-off_005frtd_005flength-1297"><code>off_rtd_length</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-off_005frtd_005fname-1296"><code>off_rtd_name</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-off_005frtd_005fprinter-1299"><code>off_rtd_printer</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-off_005frtd_005frtd-1295"><code>off_rtd_rtd</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-off_005frtd_005fsymbol-1300"><code>off_rtd_symbol</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-off_005fstring_005fdata-1319"><code>off_string_data</code></a>: <a href="#objects-strings">objects strings</a></li>
<li><a href="#index-off_005fstring_005flength-1318"><code>off_string_length</code></a>: <a href="#objects-strings">objects strings</a></li>
<li><a href="#index-off_005fsymbol_005frecord_005fplist-1339"><code>off_symbol_record_plist</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-off_005fsymbol_005frecord_005fproc-1338"><code>off_symbol_record_proc</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-off_005fsymbol_005frecord_005fstring-1335"><code>off_symbol_record_string</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-off_005fsymbol_005frecord_005ftag-1334"><code>off_symbol_record_tag</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-off_005fsymbol_005frecord_005fustring-1336"><code>off_symbol_record_ustring</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-off_005fsymbol_005frecord_005fvalue-1337"><code>off_symbol_record_value</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-off_005fvector_005fdata-1273"><code>off_vector_data</code></a>: <a href="#objects-vectors">objects vectors</a></li>
<li><a href="#index-off_005fvector_005flength-1272"><code>off_vector_length</code></a>: <a href="#objects-vectors">objects vectors</a></li>
<li><a href="#index-pair_005fmask-1230"><code>pair_mask</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-pair_005fsize-1232"><code>pair_size</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-pair_005ftag-1231"><code>pair_tag</code></a>: <a href="#objects-pairs">objects pairs</a></li>
<li><a href="#index-pointer_005fsize-1426"><code>pointer_size</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-pointer_005ftag-1427"><code>pointer_tag</code></a>: <a href="#objects-pointers">objects pointers</a></li>
<li><a href="#index-ratnum_005fsize-1377"><code>ratnum_size</code></a>: <a href="#objects-ratnums">objects ratnums</a></li>
<li><a href="#index-ratnum_005ftag-1378"><code>ratnum_tag</code></a>: <a href="#objects-ratnums">objects ratnums</a></li>
<li><a href="#index-record_005fmask-1282"><code>record_mask</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-record_005ftag-1283"><code>record_tag</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-rtd_005fsize-1294"><code>rtd_size</code></a>: <a href="#objects-structs">objects structs</a></li>
<li><a href="#index-string_005fchar_005fsize-1313"><code>string_char_size</code></a>: <a href="#objects-strings">objects strings</a></li>
<li><a href="#index-string_005fmask-1314"><code>string_mask</code></a>: <a href="#objects-strings">objects strings</a></li>
<li><a href="#index-string_005ftag-1315"><code>string_tag</code></a>: <a href="#objects-strings">objects strings</a></li>
<li><a href="#index-symbol_005fmask-1325"><code>symbol_mask</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-symbol_005frecord_005fsize-1327"><code>symbol_record_size</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-symbol_005ftag-1326"><code>symbol_tag</code></a>: <a href="#objects-symbols">objects symbols</a></li>
<li><a href="#index-the_005fpcb-1217"><code>the_pcb</code></a>: <a href="#objects-memory">objects memory</a></li>
<li><a href="#index-vector_005ftag-1269"><code>vector_tag</code></a>: <a href="#objects-vectors">objects vectors</a></li>
   </ul><div class="node">
<a name="type-index"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#g_t_0028libffi_0029">(libffi)</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#variable-index">variable index</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix L An entry for each type</h2>



<ul class="index-tp" compact>
<li><a href="#index-g_t_0026errno-445"><code>&amp;errno</code></a>: <a href="#posix-conditions">posix conditions</a></li>
<li><a href="#index-g_t_0026h_005ferrno-449"><code>&amp;h_errno</code></a>: <a href="#posix-conditions">posix conditions</a></li>
<li><a href="#index-g_t_0026i_002fo_002deagain-20"><code>&amp;i/o-eagain</code></a>: <a href="#iklib-conditions-eagain">iklib conditions eagain</a></li>
<li><a href="#index-g_t_0026source_002dposition-15"><code>&amp;source-position</code></a>: <a href="#iklib-conditions-spos">iklib conditions spos</a></li>
<li><a href="#index-directory_002dstream-555"><code>directory-stream</code></a>: <a href="#posix-dir">posix dir</a></li>
<li><a href="#index-enum_002diconv_002dencoding-818"><code>enum-iconv-encoding</code></a>: <a href="#glibc-iconv-set">glibc iconv set</a></li>
<li><a href="#index-ikchar-1305"><code>ikchar</code></a>: <a href="#objects-chars">objects chars</a></li>
<li><a href="#index-ikptr-1206"><code>ikptr</code></a>: <a href="#objects-refs">objects refs</a></li>
<li><a href="#index-struct_002daddrinfo-608"><code>struct-addrinfo</code></a>: <a href="#posix-socket-addresses-info">posix socket addresses info</a></li>
<li><a href="#index-struct_002dgroup-698"><code>struct-group</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-struct_002dhostent-619"><code>struct-hostent</code></a>: <a href="#posix-socket-hosts">posix socket hosts</a></li>
<li><a href="#index-struct_002dnetent-640"><code>struct-netent</code></a>: <a href="#posix-socket-networks">posix socket networks</a></li>
<li><a href="#index-struct_002dpasswd-685"><code>struct-passwd</code></a>: <a href="#posix-users">posix users</a></li>
<li><a href="#index-struct_002dprotoent-623"><code>struct-protoent</code></a>: <a href="#posix-socket-protocols">posix socket protocols</a></li>
<li><a href="#index-struct_002dservent-631"><code>struct-servent</code></a>: <a href="#posix-socket-services">posix socket services</a></li>
<li><a href="#index-struct_002dsiginfo_005ft-830"><code>struct-siginfo_t</code></a>: <a href="#linux-status">linux status</a></li>
<li><a href="#index-struct_002dstat-483"><code>struct-stat</code></a>: <a href="#posix-stat">posix stat</a></li>
<li><a href="#index-struct_002dtimespec-720"><code>struct-timespec</code></a>: <a href="#posix-time-timespec">posix time timespec</a></li>
<li><a href="#index-struct_002dtimeval-715"><code>struct-timeval</code></a>: <a href="#posix-time-timeval">posix time timeval</a></li>
<li><a href="#index-struct_002dtm-732"><code>struct-tm</code></a>: <a href="#posix-time-tm">posix time tm</a></li>
<li><a href="#index-struct_002dtms-725"><code>struct-tms</code></a>: <a href="#posix-time-tms">posix time tms</a></li>
   </ul><div class="footnote">
<hr>
<a name="texinfo-footnotes-in-document"></a><h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> The <samp><span class="command">configure</span></samp> command shown here is very
imposing, and anyone can easily make mistakes.  In general, it's a good
idea to create a shell script that has the sequence of
<samp><span class="command">configure</span></samp> and <samp><span class="command">make</span></samp> commands needed to configure,
build, and install a package; this not only allows us to re&ndash;install
easily, but also gives us a concrete indication of what options we used
to build the software the last time.  Of course, we should put this
script somewhere other than in the actual Vicare software
directory!</p>

   <p class="footnote"><small>[<a name="fn-2" href="#fnd-2">2</a>]</small> Parameters are found in many Scheme
implementations such as Chez Scheme and MzScheme.</p>

   <p class="footnote"><small>[<a name="fn-3" href="#fnd-3">3</a>]</small> The big endian <acronym>BOM</acronym>
for <acronym>UTF</acronym>-16 is the sequence of bytes <code>#xFE #xFF</code>; the little
endian <acronym>BOM</acronym> for <acronym>UTF</acronym>-16 is the sequence of bytes <code>#xFF
#xFE</code>.</p>

   <p class="footnote"><small>[<a name="fn-4" href="#fnd-4">4</a>]</small> For an introduction to such problems see
(<acronym>URL</acronym> last verified Jan 12, 2012):

<div align="center"><a href="http://en.wikipedia.org/wiki/Sequence_point">http://en.wikipedia.org/wiki/Sequence_point</a></div>
   <p></p>

   <hr></div>

</body></html>

