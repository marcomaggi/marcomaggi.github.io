<html lang="en">
<head>
<title>srfi strings ratio shared - Libraries for Vicare Scheme</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Libraries for Vicare Scheme">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="srfi-strings-ratio.html#srfi-strings-ratio" title="srfi strings ratio">
<link rel="prev" href="srfi-strings-ratio-naming.html#srfi-strings-ratio-naming" title="srfi strings ratio naming">
<link rel="next" href="srfi-strings-ratio-r5rs.html#srfi-strings-ratio-r5rs" title="srfi strings ratio r5rs">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This document describes the libraries distributed along with version
0.3d7 of Vicare Scheme, an R6RS compliant native
compiler for the Scheme language.

Copyright (C) 2010-2013 by Marco Maggi.

Copyright (C) 2006-2010 by Abdulaziz Ghuloum.

The documentation of IrRegex is Copyright (C) 2005-2012 Alex
Shinn.  All rights reserved.

The documentation of Pregexp is Copyright (C) 1999-2005 Dorai
Sitaram.  All rights reserved.

The documentation of the library `(vicare formations)' is derived
from the documentation of Guile.  Copyright (C) 1996-2005,
2009-2013 Free Software Foundation.

The documentation of the libraries `(vicare parser-tools silex
---)' are derived form the documentation of SILex.  Copyright
(C) 2001, 2009 Danny Dube'.

     This program is free software: you can redistribute it and/or
     modify it under the terms of the GNU General Public License
     version 3 as published by the Free Software Foundation.

     This program is distributed in the hope that it will be useful, but
     WITHOUT ANY WARRANTY; without even the implied warranty of
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
     General Public License for more details.

     You should have received a copy of the GNU General Public License
     along with this program.  If not, see
     `http://www.gnu.org/licenses/'.

Trademarks used herein are the property of their respective owners.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="srfi-strings-ratio-shared"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="srfi-strings-ratio-r5rs.html#srfi-strings-ratio-r5rs">srfi strings ratio r5rs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="srfi-strings-ratio-naming.html#srfi-strings-ratio-naming">srfi strings ratio naming</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="srfi-strings-ratio.html#srfi-strings-ratio">srfi strings ratio</a>
<hr>
</div>

<h5 class="subsubsection">2.8.2.4 Shared storage</h5>

<p>Some Scheme implementations, e.g. Guile and T, provide ways to construct
substrings that share storage with other strings.  This facility is
called &ldquo;shared&ndash;text substrings&rdquo;.  Shared&ndash;text substrings can be used
to eliminate the allocation and copying time and space required to
produce substrings, which can be a tremendous savings for some
applications, reducing a linear&ndash;time operation to constant time. 
Additionally, some algorithms rely on the sharing property of these
substrings: the application assumes that if the underlying storage is
mutated, then all strings sharing that storage will show the change. 
However, shared&ndash;text substrings are not a common feature; most Scheme
implementations do not provide them.

   <p><acronym>SRFI</acronym>-13 takes a middle ground with respect to shared&ndash;text substrings. 
In particular, a Scheme implementation does not need to have
shared&ndash;text substrings in order to implement this <acronym>SRFI</acronym>.

   <p>There is an additional form of storage sharing enabled by some <acronym>SRFI</acronym>-13
procedures, even without the benefit of shared&ndash;text substrings.  In
some cases, some <acronym>SRFI</acronym>-13 routines are allowed to return as a result
one of the strings that was passed in as a parameter.  For example, when
constructing a substring with the <code>substring/shared</code> procedure, if
the requested substring is the entire string, the procedure is permitted
simply to return the original value.  That is:

<pre class="example">     (eq? s (substring/shared s 0 (string-length s)))
     &rArr; #t or #f
</pre>
   <p class="noindent">whereas the <acronym>R5RS</acronym> <code>substring</code> function is required to allocate a
fresh copy:

<pre class="example">     (eq? s (substring s 0 (string-length s)))
     &rArr; #f
</pre>
   <p>In keeping with <acronym>SRFI</acronym>-13's general approach to sharing, compliant
implementations are allowed, but not required, to provide this kind of
sharing.  Hence, procedures may not rely upon sharing in these cases.

   <p>Most procedures that permit results to share storage with inputs have
equivalent procedures that require allocating fresh storage for results. 
If an application wishes to be sure a new, fresh string is allocated,
then these &ldquo;pure&rdquo; procedures should be used.

   <p><table summary=""><tr align="left"><th valign="top">Fresh copy guaranteed </th><th valign="top">Sharing permitted
<br></th></tr><tr align="left"><td valign="top"><code>string-copy</code> </td><td valign="top"><code>substring/shared</code>
<br></td></tr><tr align="left"><td valign="top"><code>string-copy</code> </td><td valign="top"><code>string-take</code> <code>string-take-right</code>
<br></td></tr><tr align="left"><td valign="top"><code>string-copy</code> </td><td valign="top"><code>string-drop</code> <code>string-drop-right</code>
<br></td></tr><tr align="left"><td valign="top"><code>string-concatenate</code> </td><td valign="top"><code>string-concatenate/shared</code>
<br></td></tr><tr align="left"><td valign="top"><code>string-append</code> </td><td valign="top"><code>string-append/shared</code>
<br></td></tr><tr align="left"><td valign="top"><code>string-concatenate-reverse</code> </td><td valign="top"><code>string-concatenate-reverse/shared</code>
<br></td></tr><tr align="left"><td valign="top"></td><td valign="top"><code>string-pad string-pad-right</code>
<br></td></tr><tr align="left"><td valign="top"></td><td valign="top"><code>string-trim string-trim-right</code>
<br></td></tr><tr align="left"><td valign="top"></td><td valign="top"><code>string-trim-both</code>
<br></td></tr><tr align="left"><td valign="top"></td><td valign="top"><code>string-filter string-delete</code>
   <br></td></tr></table>

   <p>On the other hand, the functionality is present to allow one to write
efficient code without shared&ndash;text substrings.  You can write efficient
code that works by passing around start/end ranges indexing into a
string instead of simply building a shared&ndash;text substring.  The <acronym>API</acronym>
would be much simpler without this consideration; if we had cheap
shared&ndash;text substrings, all the start/end index parameters would
vanish.  However, since <acronym>SRFI</acronym>-13 does not require implementations to
provide shared&ndash;text substrings, the extended <acronym>API</acronym> is provided.

<!-- page -->
   </body></html>

