<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>March 06 (Marco&rsquo;s 2015 Weblog)</title>

<meta name="description" content="March 06 (Marco&rsquo;s 2015 Weblog)">
<meta name="keywords" content="March 06 (Marco&rsquo;s 2015 Weblog)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html" rel="start" title="Top">
<link href="index.html" rel="up" title="Top">
<link href="March-05-bis.html" rel="next" title="March 05 bis">
<link href="March-06-bis.html" rel="prev" title="March 06 bis">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="weblog.css">


</head>

<body lang="en">
<span id="March-06"></span><div class="header">
<p>
Next: <a href="March-05-bis.html" accesskey="n" rel="next">March 05 bis</a>, Previous: <a href="March-06-bis.html" accesskey="p" rel="prev">March 06 bis</a>, Up: <a href="index.html" accesskey="u" rel="up">Top</a> &nbsp; </p>
</div>
<hr>
<span id="Compiler-review_2026-damn_0021-_00282015-March-06_0029"></span><h2 class="unnumbered">Compiler review&hellip; damn! (2015 March 06)</h2>


<p>I have merged the <a href="https://github.com/marcomaggi/vicare/tree/master">master</a> branch of <a href="http://marcomaggi.github.io/vicare.html">Vicare</a> into the branch
<a href="https://github.com/marcomaggi/vicare/tree/wip-compiler-review.marcomaggi-2014-07-14"><code>wip-compiler-review</code></a>, which is a work&ndash;in&ndash;progress review of the compiler.
This merge was somewhat a fight: the code had diverged here and there and many things
about the changes in <code>wip-compiler-review</code> have gone out of my mind.  I should
whip myself into being more organised in the way use branches.
</p>
<p>Anyway, I should be somewhat happy of the work I have done on this branch: the code
is better understandable, there is a lot more documentation&ndash;in&ndash;comments, the
generated code is a bit better (nothing extraordinary, only a bit better).  The thing
is: the compiler is detectably slower, even on my Intel Core i5; building the boot
image takes unbearably more time.  I hate this.
</p>
<p>There are three blocks of code that especially slow down boot image building:
</p>
<ol>
<li> The greatly expanded
<a href="https://github.com/marcomaggi/vicare/blob/wip-compiler-review.marcomaggi-2014-07-14/scheme/ikarus.compiler.core-primitive-properties.sls">table of primitives</a> used to: validate the number of arguments to which core
primitives are applied; replace safe primitives with unsafe primitives when the
arguments have the correct type.

</li><li> The compiler library, which was already big before and now it is bigger.

</li><li> The expander library, which was already big before I started reorganising it and
implementing the tagged language, and now it is bigger.
</li></ol>

<p>The compiler does a bit more, there a couple more passes, but, I guess, the true
thing is that the compiler&rsquo;s code does not scale well with the size of the source
code.  The situation is so bad that I do not want to merge back
<code>wip-compiler-review</code> into <code>master</code>.  I will have to do some code analysis and
change some data representations; I will do it in one of the possible futures.
</p>
<hr>
<div class="header">
<p>
Next: <a href="March-05-bis.html" accesskey="n" rel="next">March 05 bis</a>, Previous: <a href="March-06-bis.html" accesskey="p" rel="prev">March 06 bis</a>, Up: <a href="index.html" accesskey="u" rel="up">Top</a> &nbsp; </p>
</div>



</body>
</html>
