<html lang="en">
<head>
<title>2015 March 06 - Marco's Weblog</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Marco's Weblog">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="2015.html#g_t2015" title="2015">
<link rel="prev" href="2015-March-06-bis.html#g_t2015-March-06-bis" title="2015 March 06 bis">
<link rel="next" href="2015-March-05-bis.html#g_t2015-March-05-bis" title="2015 March 05 bis">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 2015, 2016 by Marco Maggi <marco.maggi-ipsu@poste.it>

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with Invariant Sections being ``GNU Free Documentation
     License'' and ``GNU General Public License'', no Front--Cover
     Texts, and no Back--Cover Texts.  A copy of the license is
     included in the section entitled ``GNU Free Documentation
     License''.
-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
<link rel="stylesheet" type="text/css" href="weblog.css">
</head>
<body>
<div class="node">
<a name="g_t2015-March-06"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="2015-March-05-bis.html#g_t2015-March-05-bis">2015 March 05 bis</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="2015-March-06-bis.html#g_t2015-March-06-bis">2015 March 06 bis</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="2015.html#g_t2015">2015</a>
<hr>
</div>

<h3 class="unnumberedsec">Compiler review<small class="dots">...</small> damn! (2015 March 06)</h3>

<p>I have merged the <a href="References.html#References">master</a> branch of <a href="References.html#References">Vicare</a> into the branch
<a href="https://github.com/marcomaggi/vicare/tree/wip-compiler-review.marcomaggi-2014-07-14"><code>wip-compiler-review</code></a>, which is a work&ndash;in&ndash;progress review of the compiler. 
This merge was somewhat a fight: the code had diverged here and there and many things
about the changes in <code>wip-compiler-review</code> have gone out of my mind.  I should
whip myself into being more organised in the way use branches.

   <p>Anyway, I should be somewhat happy of the work I have done on this branch: the code
is better understandable, there is a lot more documentation&ndash;in&ndash;comments, the
generated code is a bit better (nothing extraordinary, only a bit better).  The thing
is: the compiler is detectably slower, even on my Intel Core i5; building the boot
image takes unbearably more time.  I hate this.

   <p>There are three blocks of code that especially slow down boot image building:

     <ol type=1 start=1>
<li>The greatly expanded
<a href="https://github.com/marcomaggi/vicare/blob/wip-compiler-review.marcomaggi-2014-07-14/scheme/ikarus.compiler.core-primitive-properties.sls">table of primitives</a> used to: validate the number of arguments to which core
primitives are applied; replace safe primitives with unsafe primitives when the
arguments have the correct type.

     <li>The compiler library, which was already big before and now it is bigger.

     <li>The expander library, which was already big before I started reorganising it and
implementing the tagged language, and now it is bigger.
        </ol>

   <p>The compiler does a bit more, there a couple more passes, but, I guess, the true
thing is that the compiler's code does not scale well with the size of the source
code.  The situation is so bad that I do not want to merge back
<code>wip-compiler-review</code> into <code>master</code>.  I will have to do some code analysis and
change some data representations; I will do it in one of the possible futures.

<!-- page -->
   </body></html>

