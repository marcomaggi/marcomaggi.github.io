<!-- -*- fill-column: 90 -*- -->
<!DOCTYPE html PUBLIC
	  "-//W3C//DTD XHTML 1.0 Strict//EN"
	  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
    Design by Free CSS Templates
    http://www.freecsstemplates.org
    Released for free under a Creative Commons Attribution 2.5 License

    Name       : Altruism
    Description: A two-column, fixed-width template fit for 1024x768 screen resolutions.
    Version    : 1.0
    Released   : 20080308

  -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>Marco's GitHub Pages</title>
<meta name="keywords" content="" />
<meta name="description" content="" />
<link href="altruism.css" rel="stylesheet" type="text/css" media="screen" />
</head>
<body>
<!-- start header -->
<div id="header">
<div id="logo">
<h1>Useless Tcl Pacakges</h1>
<h2>A collection of libraries for Tcl</h2>
</div>
<div id="menu">
<ul>
<li><a href="http://marcomaggi.github.com/">home</a></li>
<li><a href="http://github.com/marcomaggi/">GitHub Profile</a></li>
</ul>
</div>
</div>
<!-- end header -->
<!-- start page -->
<div id="page">
<!-- start content -->
<div id="content">
<!-- start latest-post -->
<div id="latest-post" class="post">
<h1 class="title">Abstract</h1>
<div class="entry">

<p class="content">This is the home page of <acronym>UTP</acronym>, a collection of
packages for <a href="http://tcl.tk">Tcl</a>, and other collections which depend on it.
While not actively developed, the code should work with current Tcl and Tk and may be
useful to people seeking code snippets and ideas.</p>
</div>

<h2 class="title">Introduction</h2>
<div class="entry">

<p class="content">Tcl (Tool Command Language) is a very powerful but easy to learn
dynamic programming language, suitable for a very wide range of uses, including web and
desktop applications, networking, administration, testing and many more. Open source and
business-friendly, Tcl is a mature yet evolving language that is truly cross platform,
easily deployed and highly extensible.</p>

<p class="content">Tk is a graphical user interface toolkit that takes developing desktop
applications to a higher level than conventional approaches. Tk is the standard GUI not
only for Tcl, but for many other dynamic languages, and can produce rich, native
applications that run unchanged across Windows, Mac OS X, Linux and more.</p>
</div>

<h2 class="title">Concepts</h2>
<div class="entry">

<p class="content"><strong>Preprocessing.</strong>  The core idea
of <acronym>UTP</acronym> packages is to
<a href="http://marcomaggi.github.com/docs/utp.html#preprocessor">
preprocess</a> Tcl code; files are not written in Tcl code, they are
written in <acronym>UTP</acronym> code (and have
extension <code>.utp</code>).  When the Tcl interpreter evaluates:
<pre>
package require UTP::preprocessor
</pre>
the code of the package is loaded and evaluated; it can do anything, for
example:
<pre>
rename proc utp_macro
utp_macro proc { name arglist body } { ... }
</pre>
and from there on the <code>proc</code> command is the one defined by
the <code>UTP::preprocessor</code> package.</p>

<p class="content">Using this technique, <code>.utp</code> files can be considered as
split into two sections: everything before the line:
<pre>
package require UTP::preprocessor
</pre>
and everything after this line; the code in the first section is
evaluated as normal Tcl code, the code in the second section is under
the control of <code>UTP::preprocessor</code>.</p>

<p class="content">Code in the first section can be used to define preprocessor macros
that generate Tcl code; code in the second section generates Tcl code and writes it to a
selected file (or standard output).  In the end, <code>.utp</code> packages are Tcl
scripts evaluated to generate normal Tcl code:
<pre>
$ tclsh module.utp > module.tcl
</pre>
all the <acronym>UTP</acronym> packages are written this way.</p>

<p class="content"><strong>Data structures.</strong>  Tcl up to revision 8.5 does not
provide records, also called data structures or aggregate data types; the preprocessor can
be used to generate the needed infrastructure.  A <acronym>UTP</acronym> structure is a
set of regular Tcl variables whose lifespan is made the same using traces (see
the <code>[trace]</code> command).</p>

<p class="content">A structure is controlled by a <em>main variable</em> having an
automatically-generated fully-qualified name (for
example <code>::1</code>, <code>::2</code>, ...); the main variable is
called <em>token</em>.  In Tcl, variable names in dollar indirection cannot contain dot
characters, unless the whole name is quoted inside braces:
<pre>
set a 1
set a.b 2
puts $a.b   ; # prints '1.b'
puts ${a.b} ; # prints '2'
</pre>
this allows us to build names for Tk widgets with code like:
<pre>
set w $toplevel.$frame.$entry
</pre>
the same trick is used to build <acronym>UTP</acronym> structure field
names.  If the token of a structure is stored in a variable
named <code>self</code>:
<pre>
set self ::123
</pre>
the following two lines are equivalent:
<pre>
set ::123.a "this is a string"
set $self.a "this is a string"
</pre>
both of them store a string value into a varable;
under <acronym>UTP</acronym>, such operation is interpreted as storing a
value in the structure field <code>a</code>; the field value can be
retrieved with:
<pre>
set value [set $self.a]
</pre>

<p class="content">Setting new values in fields has a nice syntax; that is not true for
retrieving the value from a field.  That is why the preprocessor scans the code looking
for field retrieval requests and processes them.  The preprocessor interprets double
dollar signs <code>$$</code> as a double indirection operator, so:
<pre>
set value $$self.a
</pre>
is converted to:
<pre>
set value [set $self.a]
</pre>
</p>

<p class="content"><acronym>UTP</acronym> provides the infrastructure needed to make the
following work:
<pre>
utp_struct alpha_t {
  utp_integer_t   a 0
  utp_integer_t   b 1
  utp_double_t    c 2.0
  utp_double_t    d 3.0
  utp_array_t     e { A 1 B 2 }
}

# allocate a struct and store the token in "S"
alpha_t* S

set $S.a 1
set $S.b 2

# release the struct and all its fields
unset $S
</pre>
</p>
</div>

<h2 class="title">Prerequisites</h2>
<div class="entry">

<p class="content">The <acronym>UTP</acronym> installation infrastructure supports
only <acronym>GNU</acronym> systems. This means Unix like systems in which the following
common tools and packages are installed: <acronym>GNU</acronym>
Bash, <acronym>GNU</acronym> Make, <acronym>GNU</acronym>
Coreutils, <acronym>GNU</acronym> Find, <acronym>GNU</acronym> tar, Gzip, Bzip2. The
interfaces to foreign C language libraries are tested only with the <acronym>GNU</acronym>
C library and the <acronym>GNU</acronym> C compiler.</p>

<p class="content">All the distributions depend upon <acronym>UTP</acronym>.</p>
</div>

<h2 class="title">License</h2>
<div class="entry">

<p class="content">Unless explicitly stated: all the code is distributed under the terms
of the
<acronym>GNU</acronym> General Public License version 3; all the
documentation is distributed under the terms of
the <acronym>GNU</acronym> Free Documentation License version 1.3.</p>
</div>

<h2 class="title">Download</h2>
<div class="entry">
<p class="content">Explicit tarball distribution is not supported; we can download the
source code directly from the <acronym>GIT</acronym> repository at Github, or checkout one
of the tagged revisions using the Github interface.</p>

<p class="content">The documentation of every released distribution is available online;
see below for package-specific informations.</p>
</div>

<h2 class="title">Bugs</h2>
<div class="entry">

<p class="content">If you feel the need to report a bug you can use the project-specific
issue tracker at the GitHub project page.</p>
</div>

<h2 class="title">Credits</h2>
<div class="entry">

<p class="content">The distributions and installation infrastructure is the creation of
Marco Maggi.  If this work exists, it is because of the <acronym>GNU</acronym> Software
tools that he uses all the time.</p>

<p class="meta"></p> <!-- this draws an empty separator -->
</div>

<h2 class="title"><acronym>UTP</acronym></h2>
<div class="entry">

<p class="content">This is the core package.  It includes pure Tcl foundation libraries
and the <acronym>UTP</acronym> preprocessor.</p>
<p class="meta">
<a href="http://github.com/marcomaggi/utp" class="github">Github</a>
<a href="http://marcomaggi.github.com/docs/utp.html" class="documentation">Documentation</a>
<a href="http://github.com/marcomaggi/utp/downloads" class="download">Download</a>
</p>
</div>

</div>
<!-- end-post -->
<!-- start recent-posts -->
<div id="sidebar1">
<ul>
<li>
<h2>About me</h2>
<ul>
<li><p>My name is Marco Maggi. I live in the northern part of Italy.  I am the one who is
not smiling in this photo.</p>
<p align="center"><img src="images/faccia-piccola-01.jpg"></p></li>
</ul>
</li>
<li>
<h2>Contact</h2>
<ul>
<li><p>You can contact me by <a href="mailto:marco.maggi-ipsu@poste.it">email</a>.  You
can download the <a href="keys/marcomaggi.pub">marcomaggi</a> GPG public key and use it to
email me or verify the signatures of my software packages.</p></li>
</ul>
</li>
<li>
<h2>Stuff</h2>
<ul>
<li>
<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"
width="160" height="130"
codebase="http://fpdownload.adobe.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0">
<param name="allowScriptAccess" value="always" />
<param name="movie"
value="http://www.uniqlo.jp/uniqlock/swf/blog_small.swf?user_id=1Un4mIbTrukrab9R"/>
<param name="base" value="." />
<param name="quality" value="high" />
<param name="wmode" value="transparent" />
<!-- the embed tag is part of html 5 -->
<embed src="http://www.uniqlo.jp/uniqlock/swf/blog_small.swf?user_id=1Un4mIbTrukrab9R"
width="160" height="130" allowScriptAccess="always" base="."
quality="high" wmode="transparent"
pluginspage="http://www.adobe.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash"/>
</object>
</li>
<li>
<a href="http://stopsoftwarepatents.eu/691001728008/">
<img src="http://stopsoftwarepatents.eu/banner/691001728008/ssp-181-30.gif"
alt="stopsoftwarepatents.eu petition banner"
width="181" height="30" /></a>
</li>
<li>
<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
<img style="border:0;width:88px;height:31px"
src="http://jigsaw.w3.org/css-validator/images/vcss"
alt="Valid CSS!"></img></a>
<a href="http://validator.w3.org/check?uri=referer" target="_blank">
<img style="border:0;width:88px;height:31px"
src="http://www.w3.org/Icons/valid-html401"
alt="Valid HTML 4.01 Transitional"></img></a>
</li>
<li><div style="text-align:center">
<a href="https://www.eff.org/pages/blue-ribbon-campaign">
<img src="https://www.eff.org/sites/default/files/br.gif"
     alt="Join the Blue Ribbon Online Free Speech Campaign" />
<br/>Join the Blue Ribbon Online Free Speech Campaign!</a></div></li>
<li>
<a href="http://www.slackware.org/">
<img src="images/slackweb.jpg"></a>
</li>
</ul>
</li>
</ul>
</div>
<!-- end sidebar -->
<!-- start sidebar -->
<div style="clear: both;">&nbsp;</div>
<div class="hr1">&nbsp;</div>
<div id="sidebar">
<ul>
<li>
<h2><a href="http://gna.org/">Gna!</a></h2>
<ul>
<li>It provides Source Code Repositories (CVS, <acronym>GNU</acronym> Arch, Subversion), Download
Area, Web Pages, Mailing-Lists and Trackers (Bugs, Task, Support Requests,
Patches). <a href="http://gna.org/users/marcomaggi/">I am a Gna!  user</a>.</li>
</ul>
</li>
<li>
<h2><a href="http://sites.google.com/site/mrcmgg/">Google Sites</a></h2>
<ul>
<li>Another vanity site of mine.</li>
</ul>
</li>
</ul>
<div style="clear: both;">&nbsp;</div>
</div>
<!-- end sidebar1 -->
</div>
</div>
<div id="footer">
<p>Copyright (c) 2009, 2010 Marco Maggi.  All rights reserved. Design by
<a href="http://www.nodethirtythree.com/">NodeThirtyThree</a> +
<a href="http://www.freecsstemplates.org/">Free CSS Templates</a>.</p>
</div>
<!-- end page -->
</body>
</html>
